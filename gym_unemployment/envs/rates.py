'''

    rates.py

    rates for moving agents from state to another

'''

import numpy as np
from scipy.interpolate import interp1d

class Rates():
    def __init__(self,year=2018,silent=True,max_age=70,n_groups=6,timestep=0.25,min_age=18,inv_timestep=0,n_empl=14):
        self.year=year
        self.max_age=max_age
        self.min_age=min_age
        self.n_groups=n_groups
        self.timestep=timestep
        self.inv_timestep=inv_timestep
        self.silent=silent
        self.n_empl=n_empl
        
        if False:
            # ryhmäjako palkkadesiilien mukaan
            self.group_weights=np.array([[0.3,0.5,0.2],[0.3,0.5,0.2]])
        else:
            # ryhmäjako, data työssäkäyntitilastosta, Työntekijä, alempi toimihenkilö, ylempi toimihenkilö
            self.group_weights=np.array([[0.45,0.25,0.3],[0.2,0.55,0.25]]) # miehet, naiset

    def get_group_weights(self):
        return self.group_weights
        
    def get_wees(self,g,w0,w1,intensity=1.0):
        '''
        Säätää kolmannen ryhmän intensiteetin niin että kaikkien kolmen ryhmän painot ovat 1.0
        '''
        return w0*intensity,w1*intensity,self.get_w(g,w0,w1)*intensity

    def get_w(self,g,a0,a1):
        return (1-a0*self.group_weights[g,0]-a1*self.group_weights[g,1])/self.group_weights[g,2]
        
    def get_mort_rate_nogroups(self):
        # tilastokeskuksen kuolleisuusdata 2017 sukupuolittain
        mort=np.array([2.12,0.32,0.17,0.07,0.07,0.10,0.00,0.09,0.03,0.13,0.03,0.07,0.10,0.10,0.10,0.23,0.50,0.52,0.42,0.87,0.79,0.66,0.71,0.69,0.98,0.80,0.77,1.07,0.97,0.76,0.83,1.03,0.98,1.20,1.03,0.76,1.22,1.29,1.10,1.26,1.37,1.43,1.71,2.32,2.22,1.89,2.05,2.15,2.71,2.96,3.52,3.54,4.30,4.34,5.09,4.75,6.17,5.88,6.67,8.00,9.20,10.52,10.30,12.26,12.74,13.22,15.03,17.24,18.14,17.78,20.35,25.57,23.53,26.50,28.57,31.87,34.65,40.88,42.43,52.28,59.26,62.92,68.86,72.70,94.04,99.88,113.11,128.52,147.96,161.89,175.99,199.39,212.52,248.32,260.47,284.01,319.98,349.28,301.37,370.17,370.17])/1000.0
        
        return mort
                
    def get_mort_rate(self,debug=False):
        '''
        Kuolleisuus-intensiteetit eri ryhmille
        '''
        mort=np.zeros((101,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
            dfactor=np.array([1.3,1.0,0.78,1.15,1.0,0.8])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            
        # tilastokeskuksen kuolleisuusdata 2017 sukupuolittain
        mort[:,1]=np.array([2.12,0.32,0.17,0.07,0.07,0.10,0.00,0.09,0.03,0.13,0.03,0.07,0.10,0.10,0.10,0.23,0.50,0.52,0.42,0.87,0.79,0.66,0.71,0.69,0.98,0.80,0.77,1.07,0.97,0.76,0.83,1.03,0.98,1.20,1.03,0.76,1.22,1.29,1.10,1.26,1.37,1.43,1.71,2.32,2.22,1.89,2.05,2.15,2.71,2.96,3.52,3.54,4.30,4.34,5.09,4.75,6.17,5.88,6.67,8.00,9.20,10.52,10.30,12.26,12.74,13.22,15.03,17.24,18.14,17.78,20.35,25.57,23.53,26.50,28.57,31.87,34.65,40.88,42.43,52.28,59.26,62.92,68.86,72.70,94.04,99.88,113.11,128.52,147.96,161.89,175.99,199.39,212.52,248.32,260.47,284.01,319.98,349.28,301.37,370.17,370.17])/1000.0
        mort[:,0]=dfactor[0]*mort[:,1]
        mort[:,2]=dfactor[2]*mort[:,1]
        mort[:,4]=np.array([1.89,0.30,0.11,0.03,0.14,0.03,0.16,0.07,0.13,0.03,0.00,0.07,0.07,0.07,0.18,0.14,0.07,0.31,0.31,0.30,0.33,0.26,0.18,0.33,0.56,0.17,0.32,0.29,0.35,0.24,0.55,0.35,0.23,0.39,0.48,0.38,0.35,0.80,0.42,0.65,0.50,0.68,0.80,1.12,0.99,0.88,1.13,1.01,1.07,1.68,1.79,2.16,1.87,2.32,2.67,2.69,2.88,2.86,3.73,4.19,3.66,4.97,5.20,5.52,6.05,7.17,7.48,7.32,8.88,10.33,10.72,12.77,12.13,13.30,16.18,18.30,17.50,24.63,26.53,29.88,32.65,38.88,46.95,51.30,60.00,64.73,79.35,90.94,105.11,118.46,141.44,155.07,163.11,198.45,207.92,237.21,254.75,311.31,299.59,356.64,356.64])/1000.0
        mort[:,3]=dfactor[3]*mort[:,4]
        mort[:,5]=dfactor[5]*mort[:,4]
        
        mort=1-(1-mort)**self.timestep

        return mort

    def get_mort_rate_1980(self,year=1980,debug=False):
        '''
        Kuolleisuus-intensiteetit eri ryhmille
        '''
        mort=np.zeros((111,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
            dfactor=np.array([1.3,1.0,0.8,1.15,1.0,0.85])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])

        if year==1980:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==1990:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2000:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2010:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2020:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==1950:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==1960:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        
        elif year==1970:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        
        mort=1-(1-mort)**self.timestep

        return mort

    def get_student_rate_v1(self,debug=False):
        '''
        opiskelijoiden intensiteetit eri ryhmille
        
        vanha rutiini, ei kurantti
        '''
        if not self.silent:
            print('student year',self.year)
        if self.year==2018:
            miehet_in=np.array([0.14161,0.17243,0.13722,0.09268,0.08827,0.07784,0.05886,0.04234,0.03108,0.02376,0.02297,0.01840,0.01626,0.01347,0.01075,0.01019,0.00896,0.00814,0.00742,0.00710,0.00648,0.00578,0.00542,0.00527,0.00451,0.00409,0.00397,0.00385,0.00359,0.00355,0.00346,0.00300,0.00284,0.00262,0.00243,0.00244,0.00211,0.00201,0.00194,0.00175,0.00133,0.00110,0.00094,0.00094,0.00107,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000])
            naiset_in=np.array([0.06791,0.09761,0.10086,0.09411,0.08530,0.06874,0.05102,0.04067,0.03265,0.02571,0.02824,0.02500,0.02147,0.01935,0.01808,0.01668,0.01558,0.01477,0.01286,0.01175,0.01105,0.00932,0.00859,0.00810,0.00741,0.00657,0.00617,0.00569,0.00562,0.00502,0.00459,0.00447,0.00414,0.00325,0.00301,0.00301,0.00291,0.00244,0.00238,0.00183,0.00154,0.00135,0.00094,0.00070,0.00071,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000])
            miehet_ulos=np.array([0.49960,0.36251,0.35144,0.22735,0.28455,0.39111,0.43548,0.43147,0.41566,0.40867,0.43562,0.36303,0.41632,0.44223,0.30343,0.36754,0.33380,0.33538,0.28808,0.33422,0.35189,0.31087,0.27147,0.39144,0.33943,0.28357,0.28192,0.31797,0.26326,0.27507,0.38591,0.30785,0.33354,0.32441,0.43705,0.25007,0.37159,0.25007,0.36427,0.50069,0.44014,0.47994,0.25003,0.63541,0.25002,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000])
            naiset_ulos=np.array([0.56309,0.21796,0.20379,0.27074,0.35122,0.40776,0.37704,0.38145,0.39233,0.31660,0.35885,0.38048,0.34256,0.31260,0.31512,0.30657,0.28801,0.36577,0.33033,0.30241,0.39329,0.31962,0.29713,0.32875,0.35980,0.30874,0.32830,0.26172,0.35346,0.33895,0.27776,0.32496,0.46528,0.32964,0.25009,0.28992,0.41271,0.28992,0.48613,0.41931,0.38657,0.58156,0.52913,0.56370,0.25002,1.00000,0.00000,0.00000,0.00000,0.00000,0.25666,0.00000,1.00000])
        elif self.year==2019:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,1.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        elif self.year==2020:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,0.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        elif self.year==2021:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,0.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        elif self.year==2022:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,0.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        elif self.year==2023:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,0.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        elif self.year==2024:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,0.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        else:
            error(1)        
            
        inrate=np.zeros((101,self.n_groups))
        inrate[18:71,0] = miehet_in
        inrate[18:71,1] = miehet_in
        inrate[18:71,2] = miehet_in
        inrate[18:71,3] = naiset_in
        inrate[18:71,4] = naiset_in
        inrate[18:71,5] = naiset_in
        
        outrate=np.zeros((101,self.n_groups))
        outrate[18:71,0] = miehet_ulos
        outrate[18:71,1] = miehet_ulos
        outrate[18:71,2] = miehet_ulos
        outrate[18:71,3] = naiset_ulos
        outrate[18:71,4] = naiset_ulos
        outrate[18:71,5] = naiset_ulos
        
        inrate=1-(1-inrate)**self.timestep
        outrate=1-(1-outrate)**self.timestep

        return inrate,outrate
        
        
    def get_student_rate_v2(self,debug=False):
        '''
        opiskelijoiden intensiteetit eri ryhmille
        päivitetty 21.2.2022
        '''
        if not self.silent:
            print('student year',self.year)
            
        ### ['opiskelija in', 'opiskelija out']
        if self.year==2018:
            naiset_in=np.array([0.12273279965675322,0.11160450828860331,0.11731808442957334,0.11297465796993778,0.1036337012895957,0.08614210895078861,0.06595860746885851,0.05526268639402809,0.04518933967358721,0.03669596674957286,0.03904118933398032,0.03524312992209766,0.0308088572028457,0.028277093715385462,0.026154405568812586,0.023612404118019854,0.021286949002170447,0.019793881820456903,0.016790378266100563,0.014461977089580701,0.013149323005914872,0.011154074629404275,0.009679151345983497,0.008914111813389688,0.008356441962765422,0.007031121214976955,0.0067537277268230845,0.006027155021044004,0.005931176421999557,0.005308775114922137,0.004942562468518337,0.004736116932028795,0.004387121528739661,0.003441813518177192,0.0031956728322490298,0.003198154389539424,0.003165091636940377,0.002664034524897889,0.0026475727879515056,0.0020448401636525256,0.001760684954479292,0.001578802363656014,0.001095260576984527,0.0008840293841805821,0.000845775274135775,0.0018710735474410396,0.002786111898034722,0.006073111662636183,0.00863606133703361,0.010012998983984348,0.042129766116038414,0.11588565436677467,0.24507559569349688])
            naiset_out=np.array([0.5228111010820958,0.21239287000743168,0.2,0.268444411599006,0.3496437890042915,0.4069219402237887,0.37685254534074997,0.3814531842717387,0.3923321008025937,0.31659522010249896,0.3588454913474014,0.3804768519576042,0.3425557217376521,0.31259757912850183,0.315117942987157,0.3065745833243501,0.28800705718062014,0.3657724729975767,0.3303288477443407,0.3022656096496189,0.3930249150992685,0.31928303592324836,0.2969500843316849,0.3284890227512799,0.3594643130496862,0.30851432959732217,0.3280711318946801,0.26151237915554065,0.35328616384958683,0.3387699591704013,0.2776221665774053,0.32482110297848443,0.4651571127877313,0.32953338153558054,0.25,0.2898026793452976,0.412603275261479,0.28984209826474294,0.48604318444354144,0.4192466953703501,0.38650578989772577,0.581503542003106,0.5290910570428838,0.5636654908877131,0.25,1.0,0.0,0.0,0.0,0.0,0.2566558232149934,0.0,1.0])
            miehet_in=np.array([0.21782988924669733,0.21214885739343697,0.1621167362241827,0.10379486918687938,0.0991048965293504,0.08770050199668936,0.0678042572270642,0.04953656351292324,0.03672255446142088,0.028643379895209077,0.026915570738710815,0.021771720886351015,0.019491722875055715,0.01605328959126637,0.012715734674880718,0.011925848447666506,0.010374911195920586,0.009276414175165103,0.008397060365536025,0.007858634755485433,0.007158026349006284,0.006310097534706876,0.005846569152680486,0.005590293537828337,0.004786858192350428,0.004385512191567191,0.0042029040055697525,0.004072579326691882,0.0038160925494856654,0.0037581531207418893,0.0036811714533191895,0.003215385195096296,0.0030297329742298095,0.002807293915826274,0.002595621096410721,0.0026046269178138935,0.0022984372138415443,0.0022557352242213195,0.0021652826225823695,0.001960516964112717,0.0015276772153852832,0.0013036163077796768,0.0011094309417216772,0.0011998245426115383,0.00125651774787186,0.001701366485683156,0.0027132381439474193,0.0044309293605683635,0.005497353643468828,0.00657657294540393,0.02272677088090291,0.14431713166020116,0.188129628324588])
            miehet_out=np.array([0.44265906751087825,0.335480094305333,0.3400259997150715,0.22310101256254997,0.28108536579094867,0.38818687044500555,0.4332153962408911,0.4297560781058031,0.4143573845067755,0.4076486336494217,0.4348335082082421,0.36231987097941065,0.41565646758223485,0.44172571283482154,0.3030155612559544,0.36712608200081687,0.33348631574962295,0.33508362330282326,0.2878333428594163,0.3339336771049854,0.35166810966810963,0.31066460086348846,0.27128749843141015,0.3912505404505444,0.3392794366059181,0.28341562032615963,0.2817902144211211,0.3178420418831205,0.26314019036211694,0.2749511456719621,0.3857667891747411,0.30774872181711505,0.33342254735777793,0.3243231351500182,0.43695239424340937,0.25,0.37151397109465906,0.25,0.364191249087552,0.5006249839623089,0.4400929071830182,0.4799082562926422,0.25,0.6353814007837881,0.25,1.0,0.0,0.0,0.0,0.0,0.0,0.055666198834610714,1.0])
        elif self.year==2019:
            naiset_in=np.array([0.10523534828999995,0.11844760168675209,0.12003403430857121,0.11323833045182108,0.10389768556181984,0.09042663563792232,0.06951430338069839,0.05327347824718165,0.04392400131526796,0.03904888763863867,0.03843848001048897,0.03498221484706152,0.0342443822239913,0.03039639824621556,0.029106351176580177,0.02479021341417345,0.023412478607836656,0.02151877849661684,0.019255980537370848,0.015800666946495828,0.015090247422601899,0.013488524115611833,0.011662928695957064,0.010363981101177493,0.009130525858894177,0.008636183296121872,0.00741883161749936,0.007322421439782055,0.0070257868744936815,0.006186765019846357,0.005763276964039772,0.005280994326806069,0.0046652590532804605,0.004247025275716855,0.0038981133129516055,0.003609573792021186,0.003510466748501272,0.0033493082146649664,0.0026721884881477894,0.002573932083469642,0.0021195866762574503,0.0017753720514176942,0.0013698468051903737,0.0012445971275024702,0.0010890431303503792,0.0012500769438811567,0.0028955947520914217,0.005342564239509277,0.007397985864525227,0.013451657341740796,0.025025908596324756,0.043479971801815766,0.045890246040276084])
            naiset_out=np.array([0.5248914483851739,0.2,0.2,0.267584046799154,0.33019906131306076,0.39787466471120925,0.4118926057157116,0.3942395256577998,0.31964314205880395,0.37067216074996157,0.3516285023523088,0.29257913913619993,0.3608610215451164,0.28733271803025606,0.36846022345667784,0.27848621878733876,0.30478402056005227,0.309426559886036,0.38083550777888764,0.2695471386867477,0.3064718778301726,0.3680602919513841,0.31120581428822736,0.341992585251862,0.30154562625592274,0.368498515665744,0.3112915687370548,0.25,0.3621800887534872,0.318581974150732,0.3494399940652296,0.35838154094389985,0.3407937374653224,0.33715866350479057,0.33155848165529656,0.28923028821983987,0.31832546065936584,0.45975484511545917,0.32210486152471707,0.44370977737081124,0.45148551411938254,0.5147251957722068,0.45023525752592464,0.6875318714941356,0.25,1.0,0.0,0.0,0.0,0.0,0.2974496148091832,0.2984572098475967,1.0])
            miehet_in=np.array([0.20719876017186467,0.1903006922573759,0.15311565961773785,0.10738878856300604,0.10162451046488731,0.08828630663917773,0.06780938941065075,0.049722146272362204,0.037631655013861585,0.029169078387498014,0.027148096535251343,0.022221132040256823,0.01880357775290969,0.016984245959021115,0.01418690728741057,0.011926042845518577,0.011326679403597916,0.010547899913173125,0.009095138195318505,0.00909022112738829,0.007923332089534588,0.006977129404598227,0.006811472396708932,0.005896017315554813,0.005371397522274683,0.005010895674944528,0.004455251811322223,0.004337637001844833,0.00419706571760956,0.004634965030871847,0.003887734872833062,0.0034792656997109073,0.0033516301914347187,0.0029493282332823884,0.0029023921514525672,0.0026417854335887793,0.0024596233757094685,0.0022411607285372204,0.001948677287405627,0.0018475334466658624,0.0018677982235958512,0.0015627268296895046,0.0012091043099706645,0.0010384409636030843,0.0010692547989827866,0.001983033095093203,0.0039130327430301395,0,0,0,0,0,0])
            miehet_out=np.array([0.470017631413036,0.31084336225430076,0.29608834539961304,0.22185944325912393,0.303533120856546,0.3786308350823537,0.43055792678730065,0.42467150905252377,0.406364535982763,0.42180562278395045,0.42118135475615015,0.39594489855445325,0.3503479654387036,0.3967628156328855,0.4029506397196829,0.2843763146004393,0.30377671564435277,0.38468738387891466,0.3912755289914529,0.25,0.3559900350457295,0.257094787517675,0.37318598783288687,0.3207389625300073,0.32386790092569423,0.3569794584500467,0.28210386989692193,0.2816295947000035,0.3859154836927205,0.25,0.35965938405749676,0.3023622178123468,0.3705329153605014,0.2696432089307213,0.3656780426831494,0.31757504150228844,0.350211953392506,0.4054171351518295,0.3233909612064559,0.2783820372328495,0.4414376113832041,0.5238724404086632,0.5045191503782247,0.2849494264564616,0.460271302861321,1.0,0.0,0.0,0.0,0.0,0.15668368203802344,0.03551399230355665,1.0])
        elif self.year==2020:
            naiset_in=np.array([0.1485104671979425,0.13793386905874733,0.14357488180908656,0.13718483675034562,0.12987213514372423,0.10497729832125118,0.08087273688556554,0.060733532267360286,0.04670614770007605,0.040330165178329394,0.04435109430482806,0.038380034271074615,0.03551819291131552,0.033810570758919675,0.030649176831848635,0.027992941498853886,0.025166287729470074,0.022050420347387703,0.020409793203779815,0.017393252168580453,0.015293736812778649,0.013937092550361182,0.012812840846256602,0.010936511415721058,0.009741214782327529,0.008213657388869866,0.007733507728614818,0.007071105200944467,0.006702211468574501,0.006498609352974315,0.005657746350653562,0.005066339463435616,0.004826891640029522,0.0046838284476973585,0.0042214765764305145,0.003864311578883582,0.003535178104711032,0.0032480930611129394,0.002694189377798278,0.002587324883403604,0.0023053015207326415,0.0018214708301271957,0.0013700366521230561,0.0012452664521397688,0.0008334607034307489,0.001869292763165573,0.0033775081455934535,0.004408039826176579,0.006340569382428879,0.00901398905160636,0.022587383498804986,0.04697486789083566,0.06347987396464033])
            naiset_out=np.array([0.4968599434581046,0.22145732958455536,0.2,0.2500984450809274,0.3515846580081742,0.39997129267585785,0.43861354303984224,0.415044415097947,0.3570804220785046,0.2706295682117775,0.39529781590073304,0.33477623521425837,0.31334126654478967,0.3202220331882354,0.31040623290275493,0.3274318375906057,0.33618946114634274,0.2849937531548281,0.3429736300232481,0.3491301581421018,0.2799334902905959,0.3242390295010535,0.34797690380325974,0.3421099985825781,0.37680545269366605,0.2980121829449926,0.322775907670113,0.30031510395614563,0.2806647656802402,0.3857305987192692,0.3488573074707125,0.30043641443988106,0.2903743712966954,0.34905353929488336,0.4642664562626796,0.25,0.33296814999889485,0.4448622029800109,0.30602765815862143,0.39474352921124933,0.49593776007203566,0.5354119549124863,0.4507932496568584,0.6017117364021604,0.5805647247535026,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.25429564457676956,0.22588085908825167,0.16319822050339816,0.12204753992794395,0.11672902878634064,0.09935031667095802,0.07534724531473859,0.055343672831623315,0.04101419724321663,0.030837418932912114,0.031075997257730074,0.025254576380984904,0.020976889539311004,0.017852977633895956,0.016436413054250167,0.013554836517439066,0.012015433493510082,0.011662362021193147,0.010445343392600837,0.009097455677475243,0.007962444511826379,0.007523093959597622,0.007335840824050148,0.006708752531496065,0.0057285614804552,0.005094398854943061,0.004768005229740315,0.0044453489088635435,0.004356858330164833,0.004346618177246509,0.004744854229795004,0.0038918765380745292,0.0032147456338948214,0.0031416152998650043,0.002931402853771187,0.002521744235066671,0.0023330334675110307,0.0022498111761890464,0.00200422843055356,0.0018209829957033595,0.002075385639437433,0.001736664630683506,0.0011831972046808313,0.0009882516585847856,0.000796618300160854,0.0017442595347812993,0.003493341976600942,0,0,0,0,0,0])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.22653894983794862,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.35422920284762194,0.4319606430323576,0.4098603815584948,0.39090428851227366,0.3263666078373553,0.40466051757680177,0.354935844886245,0.26397593399976665,0.3368294343719255,0.36173965374677364,0.3528932425456602,0.2947969513399838,0.262779987716272,0.31708733692421825,0.3854086030025783,0.35006018363005276,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.42016962782442946,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.33331934747583236,0.30410074309687685,0.37212510868166776,0.36982066002876857,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.37831827529537276,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.12301918265221023,1.0])
        elif self.year==2021:
            naiset_in=np.array([0.15251093544945982,0.1398967185094771,0.15553120855295818,0.13964315829080687,0.1321693390379109,0.10781950795070083,0.08288467323866153,0.06246682968843306,0.04825678613150534,0.0415764678437453,0.0459397115307063,0.039752867667625084,0.03665239439755327,0.03417913566960126,0.0315902426307067,0.028707310055128478,0.025905758534010916,0.023157263367007887,0.021053491999596798,0.018350314494996002,0.01581962753805827,0.014489958801581677,0.01350108081884488,0.011447601703444197,0.010262689441690367,0.00869253333328537,0.008069267594324955,0.0075343305360571905,0.007092369998670866,0.007181027813796311,0.006011524051851076,0.00537639669686361,0.005191508383996944,0.0049321508531840665,0.004404332260001851,0.0035259201111810185,0.0036506162941635826,0.0034898676037654875,0.0028761978509944204,0.00271238487460538,0.002444478212794796,0.0019190800886052573,0.0014363792248516536,0.001242885450969854,0.0008979934252536269,0.0017840009040200173,0.0033950642577484855,0.00695004527495782,0.007688560779158271,0.011613397447783067,0.026498400947465653,0.05370996044021562,0.07734707408005627])
            naiset_out=np.array([0.4778280459857167,0.23020734653700103,0.2,0.274348380842367,0.3037482147859713,0.4178404740871059,0.4238268171328411,0.4139090260896656,0.3829372069765426,0.24878097978577185,0.42273119179452223,0.31308158635851735,0.34437642480072306,0.2941789300457664,0.3651983460499204,0.2598831519447992,0.3206263640122158,0.27989521058341854,0.354323170411218,0.3780097789051342,0.29791892570923273,0.298110559844993,0.34295360313789036,0.32610300566052774,0.3690920349447535,0.3077460456211444,0.33977039308241286,0.31802042422345544,0.3417546323881841,0.25,0.34600534731996435,0.2983178953042773,0.32364355009642565,0.29631337118414386,0.4903673161149987,0.2532245630299883,0.3099773167199287,0.42872026142054437,0.33019837342412184,0.4050937541929426,0.4922755475816699,0.5278790999384048,0.49266759542674965,0.5758476685657392,0.5242966890116438,1.0,0.0,0.0,0.0,0.0,0.0,0.1355118324227565,1.0])
            miehet_in=np.array([0.2593226766667572,0.22894442172545,0.1630075621846445,0.12208217430432015,0.11684466612508566,0.09950547473584158,0.0753281818709333,0.05527178941677515,0.04074583371106798,0.0311439074238384,0.03107999584196497,0.025256648090347427,0.020888747091378692,0.01794388163188276,0.016329040420070363,0.013560609192009264,0.012078274480339976,0.011669007014707735,0.010434642058839459,0.009044271791276369,0.007956512382079877,0.00858262726409275,0.007355814870570229,0.006712407569844331,0.0057362540446001765,0.005092104473763222,0.004728451539575374,0.004276915593185261,0.004376493035788588,0.004436383132129839,0.004563853263975466,0.003901873991843953,0.003228328106442919,0.003140201567150707,0.0029214580390850725,0.002506271969248166,0.0023326145702054074,0.0022519014768454418,0.0019990210095920647,0.0018121342641469302,0.002053664128967568,0.0017407450222581618,0.001176656492117002,0.000981760576953524,0.0007950262547229659,0.0016683757355041825,0.0034155818343578853,0,0,0,0,0,0])
            miehet_out=np.array([0.4180127713196594,0.3469104329624327,0.2829980284473801,0.2618081019673449,0.25833182111807285,0.3881319190665602,0.4230031544209656,0.44238590380533827,0.4504782664499435,0.3162921441222484,0.47840582998721726,0.3881811023109042,0.42178632190632515,0.3031452914725999,0.44406636741301964,0.3005448860615018,0.25,0.33453594230966427,0.3719240892587405,0.3676802365664384,0.34168714581207604,0.25,0.3266420561488364,0.36564800140547626,0.35302647009549337,0.32030296989570983,0.366008686492989,0.2800833848247918,0.2798823129038925,0.34428590338650883,0.25,0.4074653994640608,0.28003151228419526,0.28970346974391076,0.43082171296724325,0.35251541278903054,0.3029295226588249,0.3610236670017186,0.37614191407319764,0.464652044374537,0.25,0.6039795861453512,0.5026904723881953,0.5067513093982817,0.3120259358942991,1.0,0.0,0.0,0.0,0.0,0.13420804251976937,0.0640169037358073,1.0])
        elif self.year==2022:
            naiset_in=np.array([0.14508316998666182,0.13976562999909212,0.14583773650513904,0.13927340237585442,0.13247928165455078,0.10770366983059665,0.08268922458911628,0.0619492113150621,0.047858485191493286,0.041686993497395394,0.04596707386821721,0.03990052508741284,0.036606813078342744,0.034365040823565986,0.03158283777583493,0.028856329765616938,0.025716723773763016,0.022966053506910142,0.020915933587782452,0.01847520555151167,0.01592941273686207,0.014504898098064814,0.01347102590261455,0.011441298969085158,0.010223926332770514,0.008722752878836006,0.008092479393069348,0.007594092851287186,0.007061339859824428,0.006944824758093533,0.00596186580653943,0.005386993028574045,0.005181319912553125,0.004935146180855208,0.0044189602881005135,0.003711205141205939,0.0036516717453819103,0.003478828141481401,0.00288643219026182,0.002720853657184546,0.0024449180826398207,0.0019190193838563633,0.0014490135623537327,0.0012549677996123577,0.0008993745981639499,0.0018459646142574327,0.003472686792634839,0.007027167355859332,0.007830535849131664,0.011792344317052263,0.0275393665856176,0.055814777384515894,0.08036714812831067])
            naiset_out=np.array([0.497750581969366,0.22225055681866535,0.2,0.24662135115765288,0.3505013672751097,0.39691781337031046,0.44011414295012463,0.41056403323208324,0.35541863088453685,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.32581785754323855,0.33602537866689935,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.38691371118116674,0.2940538895511239,0.3174181620643195,0.306909227897189,0.28049469211609407,0.378611367938096,0.35055787940249294,0.29107929344623307,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.30810320135720287,0.44018670398661497,0.32359553780848765,0.38513634081472026,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.25429564457676956,0.22588085908825167,0.16319822050339816,0.12204753992794395,0.11672902878634064,0.09935031667095802,0.07534724531473859,0.055343672831623315,0.04101419724321663,0.030837418932912114,0.031075997257730074,0.025254576380984904,0.020976889539311004,0.017852977633895956,0.016436413054250167,0.013554836517439066,0.012015433493510082,0.011662362021193147,0.010445343392600837,0.009097455677475243,0.007962444511826379,0.007523093959597622,0.007335840824050148,0.006708752531496065,0.0057285614804552,0.005094398854943061,0.004768005229740315,0.0044453489088635435,0.004356858330164833,0.004346618177246509,0.004744854229795004,0.0038918765380745292,0.0032147456338948214,0.0031416152998650043,0.002931402853771187,0.002521744235066671,0.0023330334675110307,0.0022498111761890464,0.00200422843055356,0.0018209829957033595,0.002075385639437433,0.001736664630683506,0.0011831972046808313,0.0009882516585847856,0.000796618300160854,0.0017442595347812993,0.003493341976600942,0,0,0,0,0,0])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.22653894983794862,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.35422920284762194,0.4319606430323576,0.4098603815584948,0.39090428851227366,0.3263666078373553,0.40466051757680177,0.354935844886245,0.26397593399976665,0.3368294343719255,0.36173965374677364,0.3528932425456602,0.2947969513399838,0.262779987716272,0.31708733692421825,0.3854086030025783,0.35006018363005276,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.42016962782442946,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.33331934747583236,0.30410074309687685,0.37212510868166776,0.36982066002876857,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.37831827529537276,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.12301918265221023,1.0])
        elif self.year==2023:
            naiset_in=np.array([0.14508316998666182,0.13976562999909212,0.14583773650513904,0.13927340237585442,0.13247928165455078,0.10770366983059665,0.08268922458911628,0.0619492113150621,0.047858485191493286,0.041686993497395394,0.04596707386821721,0.03990052508741284,0.036606813078342744,0.034365040823565986,0.03158283777583493,0.028856329765616938,0.025716723773763016,0.022966053506910142,0.020915933587782452,0.01847520555151167,0.01592941273686207,0.014504898098064814,0.01347102590261455,0.011441298969085158,0.010223926332770514,0.008722752878836006,0.008092479393069348,0.007594092851287186,0.007061339859824428,0.006944824758093533,0.00596186580653943,0.005386993028574045,0.005181319912553125,0.004935146180855208,0.0044189602881005135,0.003711205141205939,0.0036516717453819103,0.003478828141481401,0.00288643219026182,0.002720853657184546,0.0024449180826398207,0.0019190193838563633,0.0014490135623537327,0.0012549677996123577,0.0008993745981639499,0.0018459646142574327,0.003472686792634839,0.007027167355859332,0.007830535849131664,0.011792344317052263,0.0275393665856176,0.055814777384515894,0.08036714812831067])
            naiset_out=np.array([0.497750581969366,0.22225055681866535,0.2,0.24662135115765288,0.3505013672751097,0.39691781337031046,0.44011414295012463,0.41056403323208324,0.35541863088453685,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.32581785754323855,0.33602537866689935,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.38691371118116674,0.2940538895511239,0.3174181620643195,0.306909227897189,0.28049469211609407,0.378611367938096,0.35055787940249294,0.29107929344623307,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.30810320135720287,0.44018670398661497,0.32359553780848765,0.38513634081472026,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.25429564457676956,0.22588085908825167,0.16319822050339816,0.12204753992794395,0.11672902878634064,0.09935031667095802,0.07534724531473859,0.055343672831623315,0.04101419724321663,0.030837418932912114,0.031075997257730074,0.025254576380984904,0.020976889539311004,0.017852977633895956,0.016436413054250167,0.013554836517439066,0.012015433493510082,0.011662362021193147,0.010445343392600837,0.009097455677475243,0.007962444511826379,0.007523093959597622,0.007335840824050148,0.006708752531496065,0.0057285614804552,0.005094398854943061,0.004768005229740315,0.0044453489088635435,0.004356858330164833,0.004346618177246509,0.004744854229795004,0.0038918765380745292,0.0032147456338948214,0.0031416152998650043,0.002931402853771187,0.002521744235066671,0.0023330334675110307,0.0022498111761890464,0.00200422843055356,0.0018209829957033595,0.002075385639437433,0.001736664630683506,0.0011831972046808313,0.0009882516585847856,0.000796618300160854,0.0017442595347812993,0.003493341976600942,0,0,0,0,0,0])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.22653894983794862,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.35422920284762194,0.4319606430323576,0.4098603815584948,0.39090428851227366,0.3263666078373553,0.40466051757680177,0.354935844886245,0.26397593399976665,0.3368294343719255,0.36173965374677364,0.3528932425456602,0.2947969513399838,0.262779987716272,0.31708733692421825,0.3854086030025783,0.35006018363005276,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.42016962782442946,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.33331934747583236,0.30410074309687685,0.37212510868166776,0.36982066002876857,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.37831827529537276,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.12301918265221023,1.0])
        elif self.year==2024:
            naiset_in=np.array([0.14508316998666182,0.13976562999909212,0.14583773650513904,0.13927340237585442,0.13247928165455078,0.10770366983059665,0.08268922458911628,0.0619492113150621,0.047858485191493286,0.041686993497395394,0.04596707386821721,0.03990052508741284,0.036606813078342744,0.034365040823565986,0.03158283777583493,0.028856329765616938,0.025716723773763016,0.022966053506910142,0.020915933587782452,0.01847520555151167,0.01592941273686207,0.014504898098064814,0.01347102590261455,0.011441298969085158,0.010223926332770514,0.008722752878836006,0.008092479393069348,0.007594092851287186,0.007061339859824428,0.006944824758093533,0.00596186580653943,0.005386993028574045,0.005181319912553125,0.004935146180855208,0.0044189602881005135,0.003711205141205939,0.0036516717453819103,0.003478828141481401,0.00288643219026182,0.002720853657184546,0.0024449180826398207,0.0019190193838563633,0.0014490135623537327,0.0012549677996123577,0.0008993745981639499,0.0018459646142574327,0.003472686792634839,0.007027167355859332,0.007830535849131664,0.011792344317052263,0.0275393665856176,0.055814777384515894,0.08036714812831067])
            naiset_out=np.array([0.497750581969366,0.22225055681866535,0.2,0.24662135115765288,0.3505013672751097,0.39691781337031046,0.44011414295012463,0.41056403323208324,0.35541863088453685,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.32581785754323855,0.33602537866689935,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.38691371118116674,0.2940538895511239,0.3174181620643195,0.306909227897189,0.28049469211609407,0.378611367938096,0.35055787940249294,0.29107929344623307,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.30810320135720287,0.44018670398661497,0.32359553780848765,0.38513634081472026,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.25429564457676956,0.22588085908825167,0.16319822050339816,0.12204753992794395,0.11672902878634064,0.09935031667095802,0.07534724531473859,0.055343672831623315,0.04101419724321663,0.030837418932912114,0.031075997257730074,0.025254576380984904,0.020976889539311004,0.017852977633895956,0.016436413054250167,0.013554836517439066,0.012015433493510082,0.011662362021193147,0.010445343392600837,0.009097455677475243,0.007962444511826379,0.007523093959597622,0.007335840824050148,0.006708752531496065,0.0057285614804552,0.005094398854943061,0.004768005229740315,0.0044453489088635435,0.004356858330164833,0.004346618177246509,0.004744854229795004,0.0038918765380745292,0.0032147456338948214,0.0031416152998650043,0.002931402853771187,0.002521744235066671,0.0023330334675110307,0.0022498111761890464,0.00200422843055356,0.0018209829957033595,0.002075385639437433,0.001736664630683506,0.0011831972046808313,0.0009882516585847856,0.000796618300160854,0.0017442595347812993,0.003493341976600942,0,0,0,0,0,0])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.22653894983794862,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.35422920284762194,0.4319606430323576,0.4098603815584948,0.39090428851227366,0.3263666078373553,0.40466051757680177,0.354935844886245,0.26397593399976665,0.3368294343719255,0.36173965374677364,0.3528932425456602,0.2947969513399838,0.262779987716272,0.31708733692421825,0.3854086030025783,0.35006018363005276,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.42016962782442946,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.33331934747583236,0.30410074309687685,0.37212510868166776,0.36982066002876857,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.37831827529537276,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.12301918265221023,1.0])
        else:
            error(1)        
            
        inrate=np.zeros((101,self.n_groups))
        inrate[18:71,0] =0.8*miehet_in
        inrate[18:71,1] =1.0*miehet_in
        inrate[18:71,2] =1.3*miehet_in
        inrate[18:71,3] =0.7*naiset_in
        inrate[18:71,4] =1.0*naiset_in
        inrate[18:71,5] =1.45*naiset_in
        
        outrate=np.zeros((101,self.n_groups))
        outrate[18:71,0]=miehet_out
        outrate[18:71,1]=miehet_out
        outrate[18:71,2]=miehet_out
        outrate[18:71,3]=naiset_out
        outrate[18:71,4]=naiset_out
        outrate[18:71,5]=naiset_out
        
        inrate=1-(1-inrate)**self.timestep
        outrate=1-(1-outrate)**self.timestep

        return inrate,outrate
        
    def get_student_rate_v5(self,debug=False):
        '''
        opiskelijoiden intensiteetit eri ryhmille
        päivitetty 21.2.2022
        '''
        if not self.silent:
            print('student year',self.year)
            
        ### ['opiskelija in', 'opiskelija out']
        if self.year==2018:
            naiset_in=np.array([0.1114716601818551,0.1121155693456366,0.1173054093126037,0.1109694756934904,0.1025134780836854,0.08653542932024069,0.06709929115273645,0.05607222606797879,0.04615933811669776,0.03813708782422008,0.04095771453213893,0.03750854283239417,0.0328893791922635,0.02998889363479344,0.02748682955828906,0.02497149843379258,0.02271983285613797,0.02068002510928494,0.01734492817666234,0.01509941079047785,0.01356931177039853,0.01099863848463952,0.009746246320171847,0.008883897888119866,0.008155214160121787,0.007004853058589053,0.006753944543661797,0.005997593861057216,0.005952687969480417,0.005370227972661151,0.004841720860273804,0.00474578825291402,0.004392211700782052,0.003449457551682083,0.003196672905290177,0.003224332553017181,0.003155175605623664,0.002672106815573777,0.002644367747128987,0.002051639769785913,0.001768262170350147,0.00158186183221426,0.001101082512783503,0.0008348544396502006,0.000827549192760042,0.001700217684560471,0.002221062513768586,0.004602114721924602,0.005621797906184915,0.006216081523832599,0.008035009159954977,0.0199285726734077,0.0385458317756493])
            naiset_out=np.array([0.5228111010820958,0.2123928700074317,0.2,0.268444411599006,0.3496437890042915,0.4069219402237887,0.37685254534075,0.3814531842717387,0.3923321008025937,0.316595220102499,0.3588454913474014,0.3804768519576042,0.3425557217376521,0.3125975791285018,0.315117942987157,0.3065745833243501,0.2880070571806201,0.3657724729975767,0.3303288477443407,0.3022656096496189,0.3930249150992685,0.3192830359232484,0.2969500843316849,0.3284890227512799,0.3594643130496862,0.3085143295973222,0.3280711318946801,0.2615123791555407,0.3532861638495868,0.3387699591704013,0.2776221665774053,0.3248211029784844,0.4651571127877313,0.3295333815355805,0.25,0.2898026793452976,0.412603275261479,0.2898420982647429,0.4860431844435414,0.4192466953703501,0.3865057898977258,0.581503542003106,0.5290910570428838,0.5636654908877131,0.25,1.0,0.0,0.0,0.0,0.0,0.2566558232149934,0.0,1.0])
            miehet_in=np.array([0.2059344238988978,0.2124051752937393,0.1630901714366919,0.1044289210856575,0.09944409269740177,0.08851198749275865,0.06848930113451357,0.04994570004415311,0.0375825337538772,0.02857539846082108,0.02723177631550228,0.02192226641300822,0.01963490274056459,0.01608045917150201,0.01289318483934101,0.01191664812152443,0.01040562666108068,0.00929817489817931,0.008365661072367489,0.007928856161395104,0.007144788722350389,0.006341279781557452,0.005858247347268122,0.005649684027739139,0.004790703533739942,0.004381427536256732,0.00420878281759973,0.004074048795483027,0.003794414362371896,0.003758226848705737,0.003676647000623904,0.003191908677109468,0.003077685831818906,0.002808753750705381,0.00267398253623898,0.002603257947735005,0.002300487125324659,0.002236924544096718,0.002157237836557511,0.001969188283523996,0.001534143935536621,0.001311133351207852,0.001114200271060258,0.001145554463817584,0.00125062955965187,0.001599533330726926,0.002430750816979452,0.003773635334232536,0.004613283201784729,0.005122478638097854,0.009679200172346107,0.05837567004555449,0.07288939691817975])
            miehet_out=np.array([0.4426590675108782,0.335480094305333,0.3400259997150715,0.22310101256255,0.2810853657909487,0.3881868704450055,0.4332153962408911,0.4297560781058031,0.4143573845067755,0.4076486336494217,0.4348335082082421,0.3623198709794107,0.4156564675822348,0.4417257128348215,0.3030155612559544,0.3671260820008169,0.333486315749623,0.3350836233028233,0.2878333428594163,0.3339336771049854,0.3516681096681096,0.3106646008634885,0.2712874984314101,0.3912505404505444,0.3392794366059181,0.2834156203261596,0.2817902144211211,0.3178420418831205,0.2631401903621169,0.2749511456719621,0.3857667891747411,0.307748721817115,0.3334225473577779,0.3243231351500182,0.4369523942434094,0.25,0.3715139710946591,0.25,0.364191249087552,0.5006249839623089,0.4400929071830182,0.4799082562926422,0.25,0.6353814007837881,0.25,1.0,0.0,0.0,0.0,0.0,0.0,0.05566619883461071,1.0])
        elif self.year==2019:
            naiset_in=np.array([0.08978286820300581,0.1191863082059514,0.1197204057459986,0.1107652082339353,0.1029673466574788,0.08962484905775346,0.07095298442953046,0.05561878382264596,0.0459349203755209,0.04113109845492881,0.04123381708212073,0.03803603491021,0.03731722659652547,0.03292757165416349,0.03158986335232555,0.0266621156499649,0.02503978541973434,0.02287108428137753,0.02016687791612892,0.01627133037724333,0.01491451692064741,0.01353197126984024,0.01148162937169096,0.01039591966492195,0.009260997574506196,0.008696780539317217,0.007618053630622204,0.007237273008650452,0.007019635762067025,0.006211418164746458,0.005790183524388062,0.005217253259211228,0.004758493033298548,0.004265065196626419,0.003922028672316252,0.003654191355702344,0.003529572454237042,0.003369300970359896,0.002737826539605737,0.002585193184532145,0.002143021195398602,0.001767277822295721,0.001371338538145993,0.001162185422195854,0.001035644420235944,0.001154251408093966,0.002059911215007954,0.00424648766968211,0.005187653009271473,0.0103742584180117,0.006476447923181738,0.01039636032372331,0.01026174569567231])
            naiset_out=np.array([0.5248914483851739,0.2,0.2,0.267584046799154,0.3301990613130608,0.3978746647112092,0.4118926057157116,0.3942395256577998,0.319643142058804,0.3706721607499616,0.3516285023523088,0.2925791391361999,0.3608610215451164,0.2873327180302561,0.3684602234566778,0.2784862187873388,0.3047840205600523,0.309426559886036,0.3808355077788876,0.2695471386867477,0.3064718778301726,0.3680602919513841,0.3112058142882274,0.341992585251862,0.3015456262559227,0.368498515665744,0.3112915687370548,0.25,0.3621800887534872,0.318581974150732,0.3494399940652296,0.3583815409438998,0.3407937374653224,0.3371586635047906,0.3315584816552966,0.2892302882198399,0.3183254606593658,0.4597548451154592,0.3221048615247171,0.4437097773708112,0.4514855141193825,0.5147251957722068,0.4502352575259246,0.6875318714941356,0.25,1.0,0.0,0.0,0.0,0.0,0.2974496148091832,0.2984572098475967,1.0])
            miehet_in=np.array([0.1996759129706719,0.1918281642068894,0.1535006954129864,0.1077199307109714,0.1024034642480518,0.08882135203903957,0.06873651430114791,0.05014443931356175,0.03832043872484713,0.02940372169080998,0.02748631452828898,0.02243436178721783,0.01895169395419256,0.01715862314096507,0.01431289891442571,0.01196126725238479,0.01152190274557491,0.01066115873761973,0.009016724669895962,0.009137926099164298,0.008063666928787636,0.007063912002338275,0.006824350750476096,0.005920048811973598,0.00536891203250933,0.004991938791430665,0.004497727643380938,0.004323288702514186,0.004208827876819842,0.004659208660641458,0.003898192743450928,0.003488286427012475,0.003327476883985215,0.002958417987712103,0.002910807738235678,0.00260789729264835,0.002470276649183745,0.002249720523390207,0.001963515117380374,0.001851220457618235,0.001871462058807771,0.001577868927350314,0.001257582529696136,0.0009806023290845494,0.001039410815711362,0.001866040142139384,0.003100074314016084,0.004607755338758408,0.004890301954944162,0.009056470748786247,0.00475766858394425,0.007691248382555722,0.01022611430857674])
            miehet_out=np.array([0.470017631413036,0.3108433622543008,0.296088345399613,0.2218594432591239,0.303533120856546,0.3786308350823537,0.4305579267873006,0.4246715090525238,0.406364535982763,0.4218056227839505,0.4211813547561502,0.3959448985544533,0.3503479654387036,0.3967628156328855,0.4029506397196829,0.2843763146004393,0.3037767156443528,0.3846873838789147,0.3912755289914529,0.25,0.3559900350457295,0.257094787517675,0.3731859878328869,0.3207389625300073,0.3238679009256942,0.3569794584500467,0.2821038698969219,0.2816295947000035,0.3859154836927205,0.25,0.3596593840574968,0.3023622178123468,0.3705329153605014,0.2696432089307213,0.3656780426831494,0.3175750415022884,0.350211953392506,0.4054171351518295,0.3233909612064559,0.2783820372328495,0.4414376113832041,0.5238724404086632,0.5045191503782247,0.2849494264564616,0.460271302861321,1.0,0.0,0.0,0.0,0.0,0.1566836820380234,0.03551399230355665,1.0])
        elif self.year==2020:
            naiset_in=np.array([0.1338024950522499,0.1384718938655808,0.1442048579637084,0.133870623897945,0.1280377863240081,0.1056121639857154,0.08244593137833853,0.06247065143401307,0.04892351141284627,0.04279451985676697,0.04879021940716614,0.04176366165937764,0.03905598323561175,0.0368196859725744,0.03379012062363143,0.03108741182437278,0.02752523691396425,0.02377089016848716,0.02162867931171521,0.01832235637998641,0.01556984313268985,0.01435161739820631,0.01262127855311362,0.01091194569628391,0.009596236596184233,0.008329802811816535,0.007701167673569986,0.007182864106533548,0.006815391381540883,0.006528308343814274,0.005627107749953447,0.005151608513334861,0.004852018190469008,0.004800443233303506,0.004235073484477267,0.003936579375192058,0.003523685629099256,0.003330007857706792,0.00270669841701902,0.00259814062563161,0.002318761865348611,0.001829619815145794,0.001338826100514068,0.001182630299579618,0.0007952653886669597,0.001711037487261565,0.002276427625685982,0.003234118756758808,0.004217010974696862,0.005475113258296395,0.005450075882936212,0.01040627017000049,0.01308464413597054])
            naiset_out=np.array([0.4968599434581046,0.2214573295845554,0.2,0.2500984450809274,0.3515846580081742,0.3999712926758578,0.4386135430398422,0.415044415097947,0.3570804220785046,0.2706295682117775,0.395297815900733,0.3347762352142584,0.3133412665447897,0.3202220331882354,0.3104062329027549,0.3274318375906057,0.3361894611463427,0.2849937531548281,0.3429736300232481,0.3491301581421018,0.2799334902905959,0.3242390295010535,0.3479769038032597,0.3421099985825781,0.3768054526936661,0.2980121829449926,0.322775907670113,0.3003151039561456,0.2806647656802402,0.3857305987192692,0.3488573074707125,0.3004364144398811,0.2903743712966954,0.3490535392948834,0.4642664562626796,0.25,0.3329681499988948,0.4448622029800109,0.3060276581586214,0.3947435292112493,0.4959377600720357,0.5354119549124863,0.4507932496568584,0.6017117364021604,0.5805647247535026,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.2508027361472434,0.228477918706185,0.1638484941513501,0.1226659519110968,0.1172745876836528,0.1004054310390758,0.07562028639692071,0.05571104109666392,0.04065026604968504,0.0316376190426295,0.03117145363376908,0.02530710700793364,0.02095206899979775,0.0178966519081175,0.01643086885467424,0.01355586892563787,0.01194456706810071,0.01169356809523234,0.01048277667523813,0.009069414780442629,0.00798251717294562,0.007537151971564638,0.007360322329335508,0.006732716182562845,0.005746699078648256,0.005112663637536687,0.004743845498922721,0.004490508901986324,0.004368098696835525,0.004356030383858386,0.004763914656661828,0.003857091994083656,0.003226099956246632,0.003156795455271489,0.002938710501864653,0.002528272914309894,0.002334250395056785,0.002256467664317479,0.002029475160398391,0.001839114480590703,0.002075941886041202,0.001744265938262015,0.001175522406930295,0.0009408732873656773,0.0007593839919705333,0.001596976948416235,0.002566321192062436,0.003887397712966482,0.00475351055725213,0.005437463062481933,0.003255356244138251,0.004649130490550418,0.005804928092454595])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.2265389498379486,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.3542292028476219,0.4319606430323576,0.4098603815584948,0.3909042885122737,0.3263666078373553,0.4046605175768018,0.354935844886245,0.2639759339997667,0.3368294343719255,0.3617396537467736,0.3528932425456602,0.2947969513399838,0.262779987716272,0.3170873369242183,0.3854086030025783,0.3500601836300528,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.4201696278244295,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.3333193474758324,0.3041007430968768,0.3721251086816678,0.3698206600287686,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.3783182752953728,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.1230191826522102,1.0])
        elif self.year==2021:
            naiset_in=np.array([0.1425583281969659,0.1402157732434426,0.1461205951816334,0.1385145742863193,0.1303329358665175,0.106273071243608,0.0829075682966515,0.06257098373764731,0.04935151411589772,0.04281898599269185,0.04802416013607025,0.04244628127579975,0.03919040326514521,0.03751126706624197,0.03409462985366073,0.03054229035421271,0.02737337185793532,0.02396788048706745,0.02228619161402907,0.01895721832182131,0.01588733910828007,0.01468977824001583,0.01323695983293674,0.01134884547708409,0.01043448274153342,0.008736843720520263,0.00816784870490207,0.007575667310026131,0.007175880210050677,0.00688877552649624,0.006032793102696373,0.005409941840638859,0.005194779257084657,0.004960080444161048,0.00443930711626543,0.00377309577681268,0.003688134373620051,0.003485211937124852,0.00295664831025389,0.002728192028503812,0.002471194461476683,0.001906378735022376,0.001447752260291681,0.00118381469259426,0.0008646322233545048,0.001694872809230087,0.002481779317607981,0.003791442492196795,0.00521171211864033,0.007180200091655898,0.006707559074848215,0.01250193794883516,0.01677658634188052])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.2498498474424597,0.2303117307002553,0.1640481763144284,0.1226444157198406,0.1172010748108264,0.09996588747771305,0.07615287924830752,0.05577787758965223,0.04106619853184783,0.03105904990045609,0.0313931218335788,0.02546300038676402,0.02126779196142971,0.01805805968602136,0.01651408279704837,0.01367017078705815,0.01204321723560065,0.0117806330350013,0.01054605737793029,0.009199279915595044,0.008012122137860483,0.007547195010054803,0.007421238391655809,0.006741317558599671,0.005766821803224964,0.00511690054994442,0.004794422125251109,0.004460810912230346,0.004366845085316488,0.004357341452495841,0.004765128585322682,0.003867938332258372,0.003227057247043034,0.003152974420948762,0.002940016278410022,0.002549476960763181,0.002338855544190829,0.002256166232758959,0.002010728276531371,0.001829762356678323,0.002074975934753236,0.001744692900052567,0.001179553433419373,0.0009211778975099093,0.0007598557505752446,0.001600007155663411,0.002661733569057531,0.003887447486829452,0.004753622031140239,0.005437625564583125,0.003256002915940847,0.004650201867677502,0.005806427900155066])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.2265389498379486,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.3542292028476219,0.4319606430323576,0.4098603815584948,0.3909042885122737,0.3263666078373553,0.4046605175768018,0.354935844886245,0.2639759339997667,0.3368294343719255,0.3617396537467736,0.3528932425456602,0.2947969513399838,0.262779987716272,0.3170873369242183,0.3854086030025783,0.3500601836300528,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.4201696278244295,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.3333193474758324,0.3041007430968768,0.3721251086816678,0.3698206600287686,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.3783182752953728,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.1230191826522102,1.0])
        elif self.year==2022:
            naiset_in=np.array([0.1397186733444702,0.140334247012429,0.1459669912889965,0.1388918320237301,0.1310420732315936,0.1067597625023858,0.08260155051132552,0.06176184790666599,0.04834953538466417,0.04241312601188903,0.04738716960197704,0.04147078122624242,0.03858823679934858,0.03653432607961587,0.03347363386933646,0.03018729711109218,0.02711734402018969,0.02358672078263553,0.02181350391421922,0.01842778525553212,0.01570832288692248,0.01472011925502511,0.01324648219304253,0.01170581748238978,0.01032720763026617,0.008712063523883104,0.008141673459059452,0.00772478777900576,0.007107145661754708,0.006890668398678426,0.006010880339618728,0.005414108483666258,0.005199013252689184,0.004961390365528365,0.00443533230324643,0.003735597535809669,0.003732423664269294,0.003485214890233508,0.002904541572888714,0.002747066199893487,0.002470928530183955,0.001918038667030483,0.001439118642132236,0.001174144364889885,0.00086572292812237,0.001692282327960727,0.002466270874631719,0.003790108678209439,0.005208604809830061,0.007173961224886002,0.006676559862961638,0.01243254538348102,0.01666846051438012])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.2520757321786964,0.2281861844129264,0.1638968447181609,0.1225378996121954,0.1171904182178254,0.1000397834892624,0.07585742139077237,0.05551802987765592,0.04062386519788662,0.03124891447716517,0.031208745755929,0.02536662212353809,0.02096517050708702,0.01792141102407786,0.01637550552588535,0.01358105503938927,0.01225861963478155,0.01171411893932592,0.01049996011755544,0.00912100579047155,0.007978260603403509,0.007536937082458193,0.007368459547827683,0.00673175504452516,0.005782694029372138,0.005104801981751261,0.004767544956322453,0.004462683665621575,0.004367894639163635,0.004359263271066529,0.004766487047178482,0.003922420663670266,0.003224618259004545,0.003152321988905935,0.002940381796005419,0.0025288436235188,0.00234291194548669,0.002258264325812594,0.002012875055510275,0.001887208429477033,0.002072653399090928,0.001742912658611277,0.001175379259961563,0.0009187729999713006,0.0007705754758898388,0.001601280903622625,0.002594808347950663,0.003887767543208396,0.004754164678687384,0.005438323621654,0.003258588833867479,0.00465429141559404,0.005811968812928351])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.2265389498379486,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.3542292028476219,0.4319606430323576,0.4098603815584948,0.3909042885122737,0.3263666078373553,0.4046605175768018,0.354935844886245,0.2639759339997667,0.3368294343719255,0.3617396537467736,0.3528932425456602,0.2947969513399838,0.262779987716272,0.3170873369242183,0.3854086030025783,0.3500601836300528,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.4201696278244295,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.3333193474758324,0.3041007430968768,0.3721251086816678,0.3698206600287686,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.3783182752953728,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.1230191826522102,1.0])
        elif self.year==2023:
            naiset_in=np.array([0.138029642436825,0.1402315953514695,0.1457450351484171,0.1361584264318642,0.1299647727654493,0.1066712085731226,0.08289719618365421,0.06319766496730447,0.04930604917184055,0.04357887231449166,0.04905813428814761,0.04298445862093447,0.04043573850359895,0.03797595377082061,0.03480808103277119,0.0316590838161579,0.02790543277764684,0.02438655935090167,0.02265080562642708,0.01894929067722408,0.01604727688206212,0.01473380124955053,0.0132113457636058,0.01134065489432104,0.01039189567592582,0.008652209497948272,0.008192989793952226,0.007609444126949838,0.007100871760429823,0.006981252817358847,0.006022945774229948,0.005412659376654938,0.0052043948145191,0.004958492196567486,0.004437071327062346,0.00375743568432756,0.003750946701388696,0.003483407300168469,0.002909449984231278,0.002731396661611528,0.002471763018637804,0.001923798134026258,0.001435501499531621,0.001169887951884721,0.0008650967141156491,0.001695195722028936,0.002494177227185837,0.003786375503081927,0.005202748142164794,0.007164972501163642,0.00663993253299884,0.01236224701883895,0.01657164359911649])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.2460364496346339,0.2276384128768441,0.1634271422900199,0.1222128317673607,0.1167011122506687,0.09920431444577034,0.07507659868782406,0.05519208798587215,0.04039115835533194,0.03103726588834959,0.03113376019891859,0.02523111175786676,0.02096675841958466,0.01784482104734037,0.01647778604047585,0.01353725736617759,0.01211941318451931,0.01176641940911961,0.01045410270589246,0.009163243747329066,0.007966769142453234,0.007505396837234798,0.007429326966943087,0.006722780878751384,0.005764280998879378,0.00512377701283729,0.004708533741494441,0.004472282405888584,0.00436860341821105,0.004372765234087675,0.004770191549815219,0.003857276465799268,0.003251722958356237,0.003150903800689907,0.002938766045808412,0.00256010107228205,0.002330031614418288,0.002256227653087276,0.002009479473171775,0.001826024083133353,0.002076966564717011,0.001743525806225692,0.001175141497653914,0.0009351921818995711,0.0007597417625428068,0.001605988076276308,0.002624762780474808,0.003887072997116498,0.004753019025985178,0.005436872387392923,0.003253265500738893,0.004645930134587875,0.005800696978852438])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.2265389498379486,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.3542292028476219,0.4319606430323576,0.4098603815584948,0.3909042885122737,0.3263666078373553,0.4046605175768018,0.354935844886245,0.2639759339997667,0.3368294343719255,0.3617396537467736,0.3528932425456602,0.2947969513399838,0.262779987716272,0.3170873369242183,0.3854086030025783,0.3500601836300528,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.4201696278244295,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.3333193474758324,0.3041007430968768,0.3721251086816678,0.3698206600287686,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.3783182752953728,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.1230191826522102,1.0])
        elif self.year==2024:
            naiset_in=np.array([0.138029642436825,0.1402315953514695,0.1457450351484171,0.1361584264318642,0.1299647727654493,0.1066712085731226,0.08289719618365421,0.06319766496730447,0.04930604917184055,0.04357887231449166,0.04905813428814761,0.04298445862093447,0.04043573850359895,0.03797595377082061,0.03480808103277119,0.0316590838161579,0.02790543277764684,0.02438655935090167,0.02265080562642708,0.01894929067722408,0.01604727688206212,0.01473380124955053,0.0132113457636058,0.01134065489432104,0.01039189567592582,0.008652209497948272,0.008192989793952226,0.007609444126949838,0.007100871760429823,0.006981252817358847,0.006022945774229948,0.005412659376654938,0.0052043948145191,0.004958492196567486,0.004437071327062346,0.00375743568432756,0.003750946701388696,0.003483407300168469,0.002909449984231278,0.002731396661611528,0.002471763018637804,0.001923798134026258,0.001435501499531621,0.001169887951884721,0.0008650967141156491,0.001695195722028936,0.002494177227185837,0.003786375503081927,0.005202748142164794,0.007164972501163642,0.00663993253299884,0.01236224701883895,0.01657164359911649])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.2460364496346339,0.2276384128768441,0.1634271422900199,0.1222128317673607,0.1167011122506687,0.09920431444577034,0.07507659868782406,0.05519208798587215,0.04039115835533194,0.03103726588834959,0.03113376019891859,0.02523111175786676,0.02096675841958466,0.01784482104734037,0.01647778604047585,0.01353725736617759,0.01211941318451931,0.01176641940911961,0.01045410270589246,0.009163243747329066,0.007966769142453234,0.007505396837234798,0.007429326966943087,0.006722780878751384,0.005764280998879378,0.00512377701283729,0.004708533741494441,0.004472282405888584,0.00436860341821105,0.004372765234087675,0.004770191549815219,0.003857276465799268,0.003251722958356237,0.003150903800689907,0.002938766045808412,0.00256010107228205,0.002330031614418288,0.002256227653087276,0.002009479473171775,0.001826024083133353,0.002076966564717011,0.001743525806225692,0.001175141497653914,0.0009351921818995711,0.0007597417625428068,0.001605988076276308,0.002624762780474808,0.003887072997116498,0.004753019025985178,0.005436872387392923,0.003253265500738893,0.004645930134587875,0.005800696978852438])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.2265389498379486,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.3542292028476219,0.4319606430323576,0.4098603815584948,0.3909042885122737,0.3263666078373553,0.4046605175768018,0.354935844886245,0.2639759339997667,0.3368294343719255,0.3617396537467736,0.3528932425456602,0.2947969513399838,0.262779987716272,0.3170873369242183,0.3854086030025783,0.3500601836300528,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.4201696278244295,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.3333193474758324,0.3041007430968768,0.3721251086816678,0.3698206600287686,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.3783182752953728,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.1230191826522102,1.0])
        else:
            print("Error: Unknown year in ['opiskelija in', 'opiskelija out']")
            
        inrate=np.zeros((101,self.n_groups))
        inrate[18:71,0] =0.8*miehet_in
        inrate[18:71,1] =1.0*miehet_in
        inrate[18:71,2] =1.3*miehet_in
        inrate[18:71,3] =0.7*naiset_in
        inrate[18:71,4] =1.0*naiset_in
        inrate[18:71,5] =1.45*naiset_in
        
        outrate=np.zeros((101,self.n_groups))
        outrate[18:71,0]=miehet_out
        outrate[18:71,1]=miehet_out
        outrate[18:71,2]=miehet_out
        outrate[18:71,3]=naiset_out
        outrate[18:71,4]=naiset_out
        outrate[18:71,5]=naiset_out
        
        inrate=1-(1-inrate)**self.timestep
        outrate=1-(1-outrate)**self.timestep

        return inrate,outrate
            
    def get_outsider_rate(self,debug=False):
        '''
        työelämän ulkopuolelle jäävien osuudet
        '''
        inrate=np.zeros((101,self.n_groups))
        outrate=np.zeros((101,self.n_groups))
        
        ### ['outsider in', 'outsider out']
        if self.year==2018:
            naiset_in=np.array([0.06093168536298272,0.0187871859640927,0.01315479418647424,0.007505376162794254,0.005039043169163814,0.0004175631889334874,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.002721804433253329,0.0019315144269266276,0.004371519286673804,0.008695211327940154,0.00930600118269021,0.004293116263542735,0.0039707077263361245,0.0039045363495496784,0.004460718191868281,0.003570175778726598,0.0034799633768473185,0.002774746020329378,0.0027640791749471297,0.004126625550373971,0.0031252022458309143,0.007110578404659706,0.003519049010467123,0.0034298926594705306,0.007278060200734379,0.004395878336397145,0.0035040161089653567,0.0006169440594463567,0.0,0.02120183461042057,0.011356093635399727,0.0145838360701665,0.016769395930676757,0.02004291546518168,0.13711066719183918,0.47813974568298534,0.6347439862014255])
            naiset_out=np.array([0.2,0.5211480018488064,0.6474675811645674,0.5467552074594024,0.7735747186894015,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2,0.2904783757207509,0.2,0.3601756921192828,0.2,0.22737290051116665,0.408111165083062,0.20860755273246337,0.20701523860594354,0.2,0.4363636295096429,0.2,0.2449533974912173,0.2601439303069606,0.2,0.4388589265253159,0.46690449563076086,1.0,1.0,1.0,0.5849472563258108,0.4596875563627144,0.34080300054107426,0.2541649485679841,1.0,0.0,0.0])
            miehet_in=np.array([0.08286437817196302,0.07055334359889562,0.036342329067319885,0.015206877037054015,0.012563356958145509,0.010513923026630016,0.010359313067145779,0.009639710498139428,0.009766287356233415,0.009363514991772678,0.009310519986283768,0.008619906531559871,0.011215987867474636,0.009288073285746042,0.010652069880300286,0.007677119215957597,0.00702025797451516,0.010598532748947943,0.00706609052617316,0.0068748640655706544,0.0110761100275863,0.007115830405204209,0.00698155805393518,0.007633373666129847,0.006280424109233289,0.007649122086460418,0.006953710487768652,0.0069674145033202396,0.006448272311210921,0.005567367928415936,0.00903707819943621,0.00625082771461599,0.01149226501108486,0.006965860716476162,0.009096168970850731,0.00690229903704187,0.005933885126300091,0.006445116947086562,0.0060358695351934106,0.005963302040047031,0.00805085965862976,0.006368075780281491,0.002323030953940885,0.000498335507665816,0.0,0.015692600444926028,0.00759525586863778,0.010797518383331844,0.011646969587752527,0.014949517738211321,0.09850132367585956,0.34210149905678877,0.442397790341296])
            miehet_out=np.array([0.2,0.2,0.7479915399627535,0.3722756223374621,0.3760700882358714,0.23227664942315793,0.28771336590195296,0.20042539832426098,0.258730404537315,0.21791683082972746,0.29502638455285396,0.2,0.2,0.4552470892583813,0.2,0.2762972172998646,0.3100380950459011,0.2,0.2,0.2918926243665347,0.2,0.2049531819844638,0.3299951649985108,0.2,0.27961959825358124,0.2,0.2,0.2,0.3437156083861733,0.21611955063117394,0.2,0.2945975165471049,0.2,0.3157345223432484,0.2,0.35640792250845676,0.2575665631680676,0.2,0.2440772101123593,0.3334384796184434,0.2,0.8586476968388586,0.3566769743397211,1.0,1.0,1.0,0.3862125686910429,0.42179943487842103,0.21519357940876463,0.32490679556732577,1.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.05857021377313951,0.018593686983024348,0.012983933710444952,0.009279155475058868,0.007949138030929241,0.007896391498155946,0.007130474314380797,0.0049395879948348365,0.004128751234979947,0.003963883047652917,0.0008299997341372769,0.0,0.0,0.0,0.002024852077080073,0.000583366216516873,6.571531749141568e-05,0.005755865117072202,0.00037784526940454026,0.008133613003350294,0.011596559148988276,0.00412032785213574,0.010489851088884675,0.0038737338629141883,0.005873072618051838,0.013825469296020854,0.005826439074365406,0.004662312693358298,0.005992789638414871,0.00444541512428524,0.003852649490085183,0.008506308761802476,0.004639996373760077,0.003978055305840728,0.0034297536751937176,0.006124899362535048,0.004048784366933968,0.0034982263139883177,0.010397934198662521,0.007270620676634665,0.004848070837323274,0.01287154873522795,0.006290469245131891,0.006798216471791894,0.002412363573622812,0.01907384631789153,0.01215740869111223,0.015232748714805714,0.015559590526064489,0.020661554982691177,0.07539707216625191,0.16954609771541834,0.26906474500806066])
            naiset_out=np.array([0.2,0.5107353212925555,0.5075636693791012,0.4319815391946969,0.2,0.32804391930902665,0.535420084493154,0.4126102055158425,0.2674812898556903,0.5380599829689353,1.0,1.0,1.0,1.0,1.0,0.8173846860247009,1.0,1.0,1.0,1.0,0.2,0.6627099028076533,0.2,0.29891970401856005,0.2,0.2,0.3976441146926607,0.32588850591418117,0.2,0.3371757460358915,0.26650699263818683,0.2,0.34635940560618517,0.3465688080513495,0.20579075210650427,0.2,0.36248474221650784,0.6149053370667769,0.2,0.2,0.5302821494959631,0.2,0.2,0.8296897046936675,1.0,0.2,0.5625559536987284,0.6572860803954661,0.2,0.3124141200640719,1.0,0.0,0.0])
            miehet_in=np.array([0.08282411884519901,0.07370387706335267,0.03688787007562477,0.016075829539380897,0.013680798257344506,0.012963405845446859,0.0117807638620803,0.014153587193769121,0.012888284409593024,0.012848107837677404,0.015024109201930112,0.012442187326067142,0.01167034722425753,0.0144146828032842,0.011826532408137164,0.011546364573607797,0.011354522216841089,0.010700717796700242,0.009634616124464248,0.008964218370759508,0.009214368216638052,0.009864697758489282,0.008775434775813171,0.007785322524029375,0.007112122642265299,0.010028817642540428,0.007542419815908751,0.011196825574857966,0.007470055488380053,0.006902751809751145,0.006796191315762158,0.009235997997325284,0.0064006434681258976,0.006448055867095305,0.010420712248957022,0.00972472815673904,0.006988176767100979,0.0068363115838210595,0.00677915897932604,0.007813014680773611,0.006728627849728186,0.006874297153000178,0.008796915997517373,0.007205103182429206,0.0008992106538110667,0.019551357093993426,0.01060326808082919,0,0,0,0,0,0])
            miehet_out=np.array([0.2,0.2,0.7355948236896337,0.34188327308108524,0.2721959287418785,0.29736719463180283,0.2090270346860484,0.2,0.2,0.3215232046074333,0.2,0.26619817127789247,0.24945569279747928,0.2,0.21260663632261614,0.2131808784614473,0.24484796629064196,0.2832850897183049,0.24517297657347234,0.21390916640034016,0.2,0.2,0.3080027271125533,0.2656852039293956,0.2364102314264272,0.2,0.3415314991242331,0.2,0.27674755396220335,0.2164299285010305,0.38038084052808396,0.2,0.20572849927606923,0.4390456550942792,0.2,0.2,0.2877475296138433,0.2,0.324469308634705,0.2,0.22516248373907644,0.4573306878113968,0.2,0.556391494088387,1.0,1.0,0.5654926937330629,0.5680058257122451,0.2,0.2,1.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.05621769005948111,0.017241858327607957,0.013022452621961254,0.009205726569014552,0.0073164333493852315,0.007035878459833429,0.003790179022225582,0.00046936577945366325,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.002586143123627575,0.0005998522926420653,0.002644858505494426,0.011052848318448641,0.0029262083360282343,0.002420393038795654,0.006562259341572571,0.004481916415382406,0.0031172648822878706,0.0027314156944842514,0.0025234086992059514,0.0026366092062594863,0.0030036417874646673,0.0024184678549255623,0.0018103259508826617,0.0035247754645069736,0.0058948105333647555,0.0026043518833659455,0.004172227669507683,0.002979404233925693,0.0023594918948856964,0.004636850943366346,0.0029299170071415944,0.00196011687873007,7.631544549327946e-05,0.0,0.025061178956606256,0.013868734148631531,0.011468756705838898,0.019081723324789565,0.08213313977342881,0.1249950740047899,0.2035791449455866])
            naiset_out=np.array([0.2,0.4666008145460734,0.502477774580181,0.43665939429426937,0.8605558673834772,0.2,0.7133971492214775,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.6637428777118108,0.2,0.2,0.3543834257681302,0.4333237784628734,0.2,0.2,0.32750777786581264,0.27674629837802533,0.3683877940436784,0.2,0.2,0.45315033954752176,0.529897281471368,0.2,0.2,0.23895588679432644,0.2,0.44871200329388733,0.27600251862545766,0.2,0.6223692578430452,0.9962732613746867,1.0,1.0,1.0,0.6431891629921518,0.28692831285006004,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07811439216994912,0.04855965464380692,0.029934190724519964,0.014344826754985975,0.012435687698100082,0.011716539710432137,0.011511018814122186,0.01086455415935278,0.013108352967269036,0.011819730759027595,0.011308521208348018,0.011230529750426326,0.010910051540930008,0.010325410072045203,0.012301232888130152,0.010415147624299927,0.01114677376679137,0.009250092256369916,0.009053681842030847,0.009584744296765917,0.008808489657160832,0.009184283833387602,0.008354113081205126,0.007793993849544974,0.007331428356560184,0.007104749789395304,0.011525327789766312,0.008037671773607088,0.007750547173606905,0.007130630733668424,0.006815139241345253,0.009870137934959894,0.00751790340669218,0.007280687308200393,0.006680888787180822,0.00602459525116045,0.007249134082049217,0.00636113158142002,0.005568107893913305,0.004848207189655091,0.0030310552377864346,0.00010258366510803203,0.0,0.0,0.0,0.0,0.030552878472345616,0,0,0,0,0,0])
            miehet_out=np.array([0.2,0.2,0.6926241984064737,0.3403486104566906,0.26290998076604477,0.23086509117983986,0.272527630642742,0.28565779603926755,0.2,0.2,0.22195398934937413,0.34407908902388623,0.2,0.2,0.2,0.34984099288391995,0.2,0.2,0.20116296473463066,0.2,0.2507263626642224,0.2,0.24899565134339113,0.2500752318508267,0.22027378259819924,0.20457989859423464,0.2,0.24017792859708714,0.2846512746125198,0.24275784245867996,0.20266134158845292,0.2,0.2378180888406557,0.2915710203384296,0.31450969192128053,0.22098862491423382,0.2,0.3425029625764161,0.3635299057910837,0.6041138344599282,0.9290274351135819,1.0,1.0,1.0,1.0,1.0,1.0,0.6915097713557066,0.22747198163541976,0.2,1.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.05714283758496749,0.01708175702402566,0.014114577431038024,0.011115983323509701,0.009197800879310712,0.008173396863203102,0.008433597647169113,0.00756749942651635,0.006165578060145732,0.004991936848401343,0.0033370639302492773,0.003044531023655609,0.00021697411906636613,0.0,0.0,0.0,0.001440487386815517,0.004948330677963483,0.0013776356232934757,0.005123603281374077,0.009593004402487287,0.004328993530625167,0.012076732091180672,0.007903711730470098,0.008024533294503103,0.009432929052184008,0.006504497393243946,0.008399099950836587,0.006671945762766037,0.015995569495963122,0.007034615259778728,0.00674638078006018,0.006385538762251631,0.006483582617472056,0.005845372198513763,0.005763811888760463,0.006400061366512808,0.00723401323169919,0.006175436285567628,0.004074852369497738,0.00024024018199134752,0.0,0.0,0.0,0.0,0.0,0.0,0.03725117333691057,0.016302201090384133,0.029375061301646747,0.10703651247637756,0.15997538291413493,0.2666396013739544])
            naiset_out=np.array([1.0,0.399725534557764,0.41332165243328095,0.4207885443027931,0.3346764870747581,0.2,0.34447728336199124,0.41283312763271884,0.45501155492333734,0.5361498058021881,0.346277320865478,0.9873513968423124,1.0,1.0,1.0,1.0,1.0,0.2,1.0,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2848688144587221,0.2,0.35856044901625594,0.2,0.2321896324601158,0.27050525670070635,0.21112941852497016,0.24036861410896038,0.2677439948318233,0.2785879791198167,0.2,0.2,0.5633500231292432,0.688068477257282,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.3698643237104776,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.08297547897420822,0.05172842177855999,0.030423630863875832,0.014053085263695293,0.012969526283420364,0.011107271294010118,0.010873706564362939,0.010818266975279798,0.01221604801789461,0.014723383847488223,0.011163508925361963,0.014164704074691104,0.009802537418325092,0.019640904395780825,0.010518902498461036,0.012303167870519027,0.009991957709599555,0.010818188673439422,0.008942696462271187,0.007614738722045647,0.007612160261496287,0.018607044629679343,0.008270278549645441,0.007073325536690776,0.011366701557110098,0.006603694053053936,0.009251805958065538,0.0058413692532192345,0.006095309790642893,0.013961480959052443,0.01059395493630796,0.007007174056982989,0.006930248251227575,0.00537210805017926,0.005907842120845346,0.005080110980419661,0.013667922696144164,0.00644596506850264,0.004778244972656686,0.006968753844846796,0.005543417346940183,0.004706533362446124,0.0013689104338531935,4.446543814490208e-05,0.021144014306391547,0.0014784979205874715,0.027513204934495012,0,0,0,0,0,0])
            miehet_out=np.array([0.2,0.2,0.7186739950066592,0.3174128199683395,0.306807353965325,0.2329253848693823,0.22007678466734706,0.34698333368973466,0.2,0.2,0.47167797129056827,0.2,0.5234952862514566,0.2,0.2,0.2,0.3168727141025669,0.2,0.3324397395144955,0.2004290499600925,0.4229020293174349,0.2,0.33972644683610287,0.3962626138662651,0.2,0.4784941861014128,0.2,0.20964948600384914,0.4170274905704002,0.2,0.2,0.21343468343270292,0.43253794368623577,0.32294607643306794,0.2,0.36208189117432205,0.2,0.4645423944401177,0.2415827137433811,0.2,0.4012296652200928,0.3657772253801257,1.0,1.0,1.0,1.0,1.0,0.6914180784487377,0.22119594015186148,0.2,1.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.0576406690615292,0.017757679234766795,0.014720428491045996,0.01237998745384388,0.006813387232902256,0.006261144962589234,0.012599102329903479,0.0077126170346886545,0.006427696722262033,0.0011125769716161873,0.0020321068993156637,0.00019701442602240406,0.0071402227643939204,0.0007396573615850259,0.0,0.0,0.0081433163748797,0.0022569419953027596,0.0069030811395962765,0.0005576476368017222,0.00043032440006803225,0.005583113788691521,0.007453109524319229,0.009142744261377442,0.006547392721393779,0.004330511988130226,0.009533648117891801,0.00456816623159245,0.004135591890615265,0.004124441740753086,0.008187021558525317,0.0040285162322281414,0.003924833086876092,0.007770027162989748,0.004388619711628278,0.003176824452715766,0.003072742768238787,0.016316838265339844,0.004650954022083639,0.003623086256108097,0.001867638949753895,0.01483156338276654,0.004848215767618086,0.0006755368415230931,0.017115724933708082,0.0016312059588336441,0.03244695492055409,0.01939407714929378,0.01663759433101767,0.026977420340615413,0.10969944411357191,0.16420921486903772,0.2740438962082976])
            naiset_out=np.array([0.2,0.5708353701236553,0.2,0.6738980912848219,0.3102450771056498,0.355746502684114,0.2,0.393187360682488,0.6447042232171137,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.6268932910441369,0.2,1.0,1.0,0.2,0.2,0.2,0.2,0.4194134336310376,0.2,0.2936791770519734,0.20321054475943523,0.48872917949617245,0.2,0.22641421347668714,0.313654585843695,0.2,0.48615346540118715,0.2448741223031239,0.7354095738583435,0.2,0.43860735798545414,0.7952721939791176,0.2,0.2,0.6549417327806086,1.0,1.0,1.0,1.0,0.660565891962546,0.33684933983709386,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.08145356408181546,0.04842317467959222,0.030435266325048196,0.014030076547012745,0.012986304190324179,0.011029315430657546,0.010807126114479733,0.010776451153951122,0.013849496111841293,0.011942953052927264,0.011041676849939746,0.012599876444694836,0.009792734133814322,0.0179785978519505,0.013258710284601597,0.010273624015191891,0.009957915284960206,0.010645541783024213,0.008887824479299531,0.008463189393321437,0.007652137743305776,0.015839058369220345,0.008266080218471217,0.00712210144877303,0.011501835381991293,0.006619065994924662,0.010555727334272028,0.007393207387983582,0.006248553268615368,0.00861919418935984,0.011215629504764627,0.0069854504891105115,0.006829353245297174,0.00527975059938876,0.007415622822488557,0.0050252507380654015,0.013621338626445418,0.00642432912108172,0.004710498748495144,0.007772973656165582,0.005599776432475792,0.0047528630797730245,0.0014431616530456558,4.8626688014972534e-05,0.018357305522403652,0.001442689599001405,0.028656257728178387,0,0,0,0,0,0])
            miehet_out=np.array([0.2,0.2,0.7148829235753305,0.28073211627939954,0.3577558384768562,0.23481460297415474,0.21764015237565465,0.3451049141467112,0.2,0.2,0.4071387484631438,0.2,0.47336268814496174,0.2,0.2,0.2284223410313703,0.33584016832178715,0.2,0.3185198439093867,0.2,0.35353158353657654,0.2,0.32651646649903054,0.4207829516435011,0.2,0.4891321252767336,0.2,0.2,0.36782307649149915,0.2,0.2,0.23469965882816946,0.4368339477676776,0.3889410738445235,0.2,0.3308600987935749,0.2,0.4849093301714502,0.22827494490591588,0.2,0.39431201264598525,0.3653928461638221,1.0,1.0,1.0,1.0,1.0,0.6915097713557066,0.22747198163541976,0.2,1.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.0576406690615292,0.017757679234766795,0.014720428491045996,0.01237998745384388,0.006813387232902256,0.006261144962589234,0.012599102329903479,0.0077126170346886545,0.006427696722262033,0.0011125769716161873,0.0020321068993156637,0.00019701442602240406,0.0071402227643939204,0.0007396573615850259,0.0,0.0,0.0081433163748797,0.0022569419953027596,0.0069030811395962765,0.0005576476368017222,0.00043032440006803225,0.005583113788691521,0.007453109524319229,0.009142744261377442,0.006547392721393779,0.004330511988130226,0.009533648117891801,0.00456816623159245,0.004135591890615265,0.004124441740753086,0.008187021558525317,0.0040285162322281414,0.003924833086876092,0.007770027162989748,0.004388619711628278,0.003176824452715766,0.003072742768238787,0.016316838265339844,0.004650954022083639,0.003623086256108097,0.001867638949753895,0.01483156338276654,0.004848215767618086,0.0006755368415230931,0.017115724933708082,0.0016312059588336441,0.03244695492055409,0.01939407714929378,0.01663759433101767,0.026977420340615413,0.10969944411357191,0.16420921486903772,0.2740438962082976])
            naiset_out=np.array([0.2,0.5708353701236553,0.2,0.6738980912848219,0.3102450771056498,0.355746502684114,0.2,0.393187360682488,0.6447042232171137,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.6268932910441369,0.2,1.0,1.0,0.2,0.2,0.2,0.2,0.4194134336310376,0.2,0.2936791770519734,0.20321054475943523,0.48872917949617245,0.2,0.22641421347668714,0.313654585843695,0.2,0.48615346540118715,0.2448741223031239,0.7354095738583435,0.2,0.43860735798545414,0.7952721939791176,0.2,0.2,0.6549417327806086,1.0,1.0,1.0,1.0,0.660565891962546,0.33684933983709386,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.08145356408181546,0.04842317467959222,0.030435266325048196,0.014030076547012745,0.012986304190324179,0.011029315430657546,0.010807126114479733,0.010776451153951122,0.013849496111841293,0.011942953052927264,0.011041676849939746,0.012599876444694836,0.009792734133814322,0.0179785978519505,0.013258710284601597,0.010273624015191891,0.009957915284960206,0.010645541783024213,0.008887824479299531,0.008463189393321437,0.007652137743305776,0.015839058369220345,0.008266080218471217,0.00712210144877303,0.011501835381991293,0.006619065994924662,0.010555727334272028,0.007393207387983582,0.006248553268615368,0.00861919418935984,0.011215629504764627,0.0069854504891105115,0.006829353245297174,0.00527975059938876,0.007415622822488557,0.0050252507380654015,0.013621338626445418,0.00642432912108172,0.004710498748495144,0.007772973656165582,0.005599776432475792,0.0047528630797730245,0.0014431616530456558,4.8626688014972534e-05,0.018357305522403652,0.001442689599001405,0.028656257728178387,0,0,0,0,0,0])
            miehet_out=np.array([0.2,0.2,0.7148829235753305,0.28073211627939954,0.3577558384768562,0.23481460297415474,0.21764015237565465,0.3451049141467112,0.2,0.2,0.4071387484631438,0.2,0.47336268814496174,0.2,0.2,0.2284223410313703,0.33584016832178715,0.2,0.3185198439093867,0.2,0.35353158353657654,0.2,0.32651646649903054,0.4207829516435011,0.2,0.4891321252767336,0.2,0.2,0.36782307649149915,0.2,0.2,0.23469965882816946,0.4368339477676776,0.3889410738445235,0.2,0.3308600987935749,0.2,0.4849093301714502,0.22827494490591588,0.2,0.39431201264598525,0.3653928461638221,1.0,1.0,1.0,1.0,1.0,0.6915097713557066,0.22747198163541976,0.2,1.0,0.0,0.0])
        else:
            error(990)
        
        min_age=18
        max_spv=71
        in_m=self.get_w(0,1.5,1.0)
        out_m=self.get_w(0,0.8,1.0)
        in_n=self.get_w(0,1.25,1.0)
        out_n=self.get_w(0,0.85,1.0)
        
        inrate[min_age:max_spv,0]=1.5*miehet_in
        inrate[min_age:max_spv,1]=1.0*miehet_in
        inrate[min_age:max_spv,2]=in_m*miehet_in
        inrate[min_age:max_spv,3]=1.25*naiset_in
        inrate[min_age:max_spv,4]=1.0*naiset_in
        inrate[min_age:max_spv,5]=in_n*naiset_in
        outrate[min_age:max_spv,0]=0.8*miehet_out
        outrate[min_age:max_spv,1]=1.0*miehet_out
        outrate[min_age:max_spv,2]=out_m*miehet_out
        outrate[min_age:max_spv,3]=0.85*naiset_out
        outrate[min_age:max_spv,4]=1.0*naiset_out
        outrate[min_age:max_spv,5]=out_n*naiset_out
        
        inrate=1-(1-inrate)**self.timestep
        outrate=1-(1-outrate)**self.timestep

        return inrate,outrate
        
    def get_outsider_rate_v5(self,debug=False):
        '''
        työelämän ulkopuolelle jäävien osuudet
        '''
        inrate=np.zeros((101,self.n_groups))
        outrate=np.zeros((101,self.n_groups))
        
        ### ['outsider in', 'outsider out']
        if self.year==2018:
            naiset_in=np.array([0.05813909835788606,0.01825430746811555,0.01143545548171377,0.001653222740496463,4.056120566114031e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.005015400574362669,0.001681156729206162,0.009756708885757833,0.002915753427071975,0.003195324793285517,0.006136745575031571,0.003318543120352998,0.003286734175591422,0.00326686642113839,0.002044177731037369,0.001698538792564141,0.002992671182267969,0.001927930943242704,0.001955803791269436,0.002086562545752273,0.00206012182105783,0.002689137740737255,0.001904682460186868,0.001940792421481506,0.001596588134838969,6.081211206165336e-05,0.02345512173400597,0.00969988013617021,0.01033324865843552,0.01023944700412324,0.01098514498664292,0.06776990174609025,0.2141783565837756,0.2589554423003119])
            naiset_out=np.array([0.2,0.5933103837226086,0.8560026350645074,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.3650132552581095,0.2,0.2,0.2192582058837674,0.2077161266611846,0.5802428398082061,0.3746473195826132,0.2723041212757545,0.2,0.2001788916984872,0.2111421675026458,0.2,0.4991519382689426,0.2,0.2,0.421601092644311,0.9861054335853168,1.0,1.0,0.6289136959016923,0.4873802623978203,0.3408030005410743,0.2541649485679841,1.0,0.0,0.0])
            miehet_in=np.array([0.07870490483312652,0.06781953479493286,0.03512293260130921,0.014499621804063,0.01116045376270373,0.01082826812840657,0.01058139763345257,0.010371219414291,0.01355213637361344,0.01084047947666745,0.01175253419633536,0.01098980823587663,0.01268057748984734,0.01052197467352315,0.01157043727075314,0.009293142807241467,0.008811287726586063,0.007063884428958569,0.008473495582842494,0.008584654731809796,0.007245317767216704,0.008619409381952329,0.006799939174002476,0.008587500343362791,0.006337038479948501,0.008595260342456446,0.006645223190944306,0.006538255083948854,0.006072655335658257,0.005810053794097918,0.006661678958086706,0.005917191337736302,0.009528700050915245,0.006312747362276412,0.01210742223929497,0.006344921287267142,0.00515663378329645,0.007372452361198459,0.00509675680739735,0.004843481872455889,0.004978285907376603,0.004529510184778898,0.003998094396345396,0.003527174139075712,0.0001614759393497946,0.01733390895883103,0.007382332458116963,0.009345048284317484,0.009164025408242186,0.0112132186409339,0.07071686520911177,0.2359032159890982,0.2939151844907316])
            miehet_out=np.array([0.2,0.2,0.753346781005193,0.4323744098315138,0.2370346457958877,0.291084566960607,0.2,0.2580518900067109,0.2,0.2387795625219543,0.2,0.3153974163872576,0.2,0.3620639313262475,0.2,0.2456095291330304,0.4125014904222786,0.2,0.2,0.2,0.3000295315374324,0.2,0.3308459536515205,0.2,0.2564614700667149,0.2,0.2,0.2726237673235501,0.247851259818112,0.2277262511821998,0.2,0.2970123575082999,0.2,0.4546851566871665,0.2,0.4036235117642701,0.383551059824678,0.2,0.2819662622814372,0.2192108784583814,0.3462883294270591,0.3616361594996171,0.3766628897542967,0.9929766326160558,1.0,1.0,0.4331032950301738,0.4555413859598034,0.2151935794087646,0.3249067955673258,1.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.04988275378554197,0.01676108948760565,0.01050479412035869,0.0005067855274349651,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.004133007779414557,0.007330544797280163,0.008123536247473643,0.003417227329100188,0.003387227581514272,0.003065828773688477,0.003065196245551204,0.002816284068379865,0.005883552984899917,0.003044439099934561,0.001989226220754513,0.005092552074251125,0.002602225714175385,0.002498682388676276,0.006946271699418791,0.00311422815804707,0.00339811080961369,0.003296016018717816,0.006392998045326859,0.004398779768025768,0.001491221308776173,0.02105056697314644,0.01007650442665273,0.01105855931879206,0.01128218063515416,0.0125556251788902,0.0422141992794256,0.08786140276259613,0.1296212910240166])
            naiset_out=np.array([0.2,0.5787470432727233,0.8359209830292993,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2950403269573997,0.2033816156543772,0.2844264508026469,0.3890920671988113,0.2,0.595053981208949,0.2,0.2,0.2677872861342933,0.5498799630637524,0.2,0.2,0.2,0.2,0.2,0.2106974825254494,1.0,0.2,0.586395343796859,0.6572860803954661,0.2,0.3124141200640719,1.0,0.0,0.0])
            miehet_in=np.array([0.08011765777967124,0.06910708476969235,0.03554749863996413,0.01520348071814475,0.01203470295229802,0.01135104692543075,0.01135118146057044,0.01020001871970338,0.01417205355837413,0.01117950660931606,0.01288656569220467,0.01029589733224047,0.009974615799967487,0.01099487334827143,0.009654787574206172,0.009452059831049062,0.01032491513568403,0.008668247680845164,0.007540079451471085,0.006522347184794724,0.01283402755006931,0.01104048899799141,0.007925881728845867,0.007451098456352605,0.006308504206451295,0.006824649442254046,0.007794559424562345,0.006529139452786762,0.006497101345371241,0.007548525028564095,0.006623315519806261,0.006254454817034944,0.005939934094747326,0.005879905663002733,0.00520918662750757,0.006751732844402664,0.005648529532292673,0.004930900091332866,0.005772313707411688,0.005199209479851939,0.004743308517189699,0.004810321138730118,0.01672123746057937,0.01063106421500856,0.005794365360708931,0.01570099379614183,0.00949304404189016,0.009817749229003365,0.0117198105257588,0.02021080217672225,0.0476643577092257,0.07397525458867904,0.0783118474311515])
            miehet_out=np.array([0.2,0.2,0.7425307598137671,0.4065020159626029,0.2730078020527146,0.3583815282772143,0.2,0.2218524595731482,0.2,0.3765898447430197,0.2,0.2343030094581838,0.2687881547681231,0.2,0.3553374070003555,0.2,0.2,0.3152906946128088,0.3116812989852384,0.2868596459532016,0.2,0.2,0.2518390533699589,0.3346272272647444,0.2521029082280238,0.2,0.2,0.2100781838885242,0.2164073995529072,0.2,0.2641337096915374,0.2586711366085322,0.2236692505171769,0.3298656041868026,0.2,0.2,0.3428267277781241,0.2399087891930674,0.2,0.3289791995911246,0.2332493667866564,0.4362403692219248,0.2,0.2,1.0,0.2,0.580262282650854,0.5680058257122451,0.2,0.2,1.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.05075016906649223,0.01606837015056801,0.01103266338051705,0.000525704567326351,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.004616708449063513,0.001540840186857661,0.003888302845444424,0.005246758950051094,0.002375162729596949,0.001529959149764565,0.004108103386079344,0.001896060556289897,0.00553206193578647,0.00177275211960543,0.004170023170168077,0.001512944116910984,0.005364852503619072,0.001497579497793089,0.0006075486964431207,0.0004778415205615703,0.004217102759970124,0.0001612848348475903,0.01110682894052927,0.002834238116334195,0.0003077318129152653,0.02239981697909705,0.009700667130851012,0.007193067171386458,0.01259382677651117,0.04211395513964888,0.05846674811574193,0.08737778879761729])
            naiset_out=np.array([0.2,0.5335516867020149,0.7933186152819698,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.5581830086500694,0.3428183947565901,0.2,0.7823832357020521,0.2,0.75264141661626,0.2,0.9294174662776502,0.2,0.8034610284265586,0.452663702791234,0.9307377226499636,0.2,1.0,0.2,0.7443152294395576,1.0,1.0,0.6431891629921518,0.28692831285006,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.0769670006611215,0.05065820131456086,0.03020802757397285,0.01373915657128724,0.01151499061112891,0.01169502394079965,0.01088940546341015,0.009984852794485464,0.009787655346558117,0.01555733460707849,0.01069234470726504,0.01059510772945831,0.009818406527854378,0.00971672025213179,0.01124909489297627,0.009784355377546917,0.008768887340235959,0.008970132289824045,0.008541596579505938,0.007650419458643306,0.007274692430616243,0.007429799975158066,0.006973771234478044,0.006413166284747621,0.005251765158332073,0.005136514633646095,0.007085492924512781,0.007035219275592013,0.005791831486737056,0.005655380371263762,0.005198321291619929,0.005166060590913507,0.005125996978183529,0.005156636820431636,0.00491864869454421,0.004388757501929747,0.005110941765094635,0.004608010556533058,0.004821143578498535,0.00497314433412614,0.003778358778192123,0.002724858142744044,0.002095514734775165,0.008881915562004471,0.003896578336324179,0.0007590686097961065,0.02563267505794734,0.01042793899700084,0.006918995824770059,0.01865701911367032,0.03382686418504989,0.04054193722597838,0.04909613971845735])
            miehet_out=np.array([0.2,0.2,0.7200525129335935,0.369507600671247,0.2931315177422832,0.2,0.3411680120990328,0.2,0.2866762613130346,0.2,0.2233516945965822,0.2765853249403041,0.2158476301775439,0.213941047082277,0.2,0.2961948296407479,0.2082051055534248,0.2,0.283863173527517,0.2308663044184734,0.231932243815416,0.2,0.2628911135739672,0.3749337049777267,0.2112686598587357,0.2298002860547767,0.2,0.2,0.2263553416589186,0.2801541908419937,0.2135164061539813,0.2186424804917736,0.266506084563805,0.2,0.3235339923611794,0.2192861456166096,0.2,0.6273524161051888,0.2,0.2,0.5165897633708353,0.4690743006654455,0.3065838404943871,0.2,0.3328966736116549,1.0,1.0,0.6915097713557066,0.2274719816354198,0.2,1.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.05299556363512203,0.01683633835834926,0.01092098270668104,0.006156341975429542,0.0002097251582870559,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.006728666359982767,0.005061870517002724,0.003316549945127076,0.003119168618345111,0.005112756768136119,0.003303191658639153,0.004994062178819924,0.003503978967677614,0.003122641582977597,0.002776044515366403,0.001548191849179531,0.004047912869524208,0.004192214944047459,0.0024420943911619,0.006907218352714858,0.003180665455241062,0.002465267774149378,0.002299811380633067,0.004549888958938961,0.00864231336774426,0.004726618233310778,0.0006169781753251652,0.02905549575129735,0.01357922722166972,0.01045104497568298,0.01763313033410063,0.05640884810614297,0.07708558915092523,0.1181393519404531])
            naiset_out=np.array([0.2,0.5720689748713248,0.644707033036561,0.9797560583228804,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2,0.2,0.2,0.3120463981911065,0.32462919003888,0.645520755814087,0.3202607080269244,0.2,0.2,0.3660779004612708,0.2,0.4679152628789577,0.3013425615927822,0.2227433164535174,0.2,0.2,0.6554995482723047,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07665398460851491,0.05233494356185711,0.03050369101602954,0.01373788026863101,0.0120587897841232,0.01077983189751312,0.01034257752460372,0.009891170079539118,0.01115398986443029,0.01155447947783747,0.01081142576454047,0.01057944651790033,0.01252878678348345,0.01052443210627219,0.01075694479686823,0.01029781040312021,0.01056643296680267,0.009531883013015904,0.008963450823044835,0.01027099490417674,0.008109997690547176,0.007237046191301072,0.008071126514431542,0.0069703080318486,0.006409677980539497,0.00568149087077491,0.01005376142104967,0.006261273381928437,0.006092513335243491,0.005430442744574143,0.005088458414837029,0.005312573315748522,0.004899436912350558,0.004748561934195902,0.004577932406269015,0.005914365884558499,0.005621500919994682,0.004709676895953744,0.003765382931321758,0.004213487521401543,0.003986715768917211,0.002540736513531419,0.003316962927095252,0.003560206044412915,0.003118386775330459,0.0006663482891723618,0.0265074620964544,0.01042809759799032,0.006919188405521587,0.01865736644169077,0.03382861348687163,0.04054449207223001,0.0490997692484996])
            miehet_out=np.array([0.2,0.2,0.7247040045139843,0.3285578811346876,0.3138928678325518,0.2579799485171585,0.2582092013174381,0.2128132625699339,0.2,0.2,0.2352167021798089,0.2747709635478829,0.2,0.2102248807358468,0.2,0.2842572991673334,0.2,0.2425614876407198,0.3167954056177681,0.2,0.2974787571968061,0.2390642101702877,0.2,0.3942398373887311,0.2,0.2784413779873532,0.2,0.2301118524910814,0.3135091071034339,0.261745713995005,0.2783754979885661,0.2,0.23654645051262,0.2434131122771361,0.3664304955684028,0.2,0.2,0.4176069549708976,0.245961390758942,0.2,0.597255902261959,0.3469872691264162,0.2,0.2,0.2476577845952459,1.0,1.0,0.6915097713557066,0.2274719816354198,0.2,1.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.05176198901728205,0.01657191993380829,0.01163141192103346,0.005665848711048765,0.0003838665395535246,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.001069367059601734,0.007970455953902146,0.004343155771644389,0.004433337855504199,0.002726324062557906,0.008093348147704021,0.003738380237217401,0.003311675912234746,0.003777494026394442,0.003182788294884554,0.002568409746956153,0.002564306795536228,0.002086524223148544,0.001393236239555336,0.006552366264210208,0.00244141312059728,0.002063099514447315,0.003580908431809114,0.002546720791243441,0.003184028396194889,0.002518302770801069,0.005322509711909638,0.003319993563117562,0.0006962105017617221,0.02889311149389539,0.01357358560566494,0.01044370445898719,0.01762049027395487,0.05632954790733198,0.07694600624732659,0.117874260590629])
            naiset_out=np.array([0.2,0.51802066214551,0.7227960412276595,0.7619734253986312,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2271767918820226,0.2,0.3158663536238691,0.2953928283366851,0.2,0.3966984552974554,0.2150855855843649,0.387757705436659,0.5399874833028834,0.253258738639053,0.2,0.3858565707442889,0.2011364826738007,0.2,0.5630558287151486,0.2,0.2,0.2,0.3185477857707017,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07738516932105931,0.05060776756098695,0.03028127640059342,0.01350571362646268,0.01071052751371457,0.01037046673296402,0.009963213427578738,0.009569770506381584,0.009065238081002966,0.01245996736523692,0.009686485244717003,0.00886599040683404,0.008600784187984004,0.008628388562276355,0.008488791685873664,0.008296074686761738,0.01401396348141651,0.00860121014628255,0.007913580160260093,0.008258872571306444,0.00684624169745373,0.007198482732600884,0.006584254155664759,0.006249544171019786,0.007037231033160645,0.005507869385808428,0.008506473983895495,0.005892995077446748,0.005468675620846597,0.005008346511838073,0.004965337717500228,0.008768982355209367,0.005473718130126542,0.004906909986982852,0.004481941638812749,0.004213947362373689,0.005089208339105407,0.003995824948159428,0.00292691666070898,0.01102659518419011,0.004485619990713802,0.00330294033405547,0.002187725691887847,0.002078369162856965,0.005729596747431215,0.00062790388181262,0.02589326080766892,0.01042911743561918,0.00692012587593924,0.01865885845181746,0.03383560861318111,0.04055424416222826,0.04911317824044291])
            miehet_out=np.array([0.2,0.2,0.7293519379444138,0.4156572455641555,0.2382022690018236,0.253461366465672,0.2531862720711026,0.2694030746669447,0.2577016791026259,0.2,0.3009156257891648,0.23030112032099,0.2026876371799877,0.2091942842344174,0.2104323799025319,0.332837941515374,0.2,0.2648179174805011,0.3418739862271322,0.2,0.2381015347418834,0.2,0.2308118760938376,0.3600156616950867,0.2,0.2648567840319446,0.2,0.2757955222705187,0.288633703858889,0.2058838090672735,0.2851398052040011,0.2,0.3107696628627957,0.2948703543838416,0.2752070411190861,0.3566198408541948,0.2,0.4836134713023438,0.3798477178555054,0.2,0.5026966284103362,0.5719896535429445,0.3034981877935909,0.3672201851654149,0.2,1.0,1.0,0.6915097713557066,0.2274719816354198,0.2,1.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.05102825700946879,0.01640208389163639,0.01049493210491511,0.001193134297542657,2.635700597823275e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.005351067290571127,0.002772139516799534,0.004082401270367765,0.004059969942685491,0.002395241669049179,0.005561262795613215,0.004166991924545351,0.003201713554301075,0.003006673155346265,0.002834553951870844,0.001763884401090477,0.002548820362685858,0.007893840949358404,0.002755692639736415,0.002602675320889047,0.002270875557561567,0.002290550008385015,0.004823854527628102,0.002975880557915788,0.004814805813157197,0.003461750504780902,0.0005889610170700427,0.02921231157205575,0.01355779544245806,0.01042986902472443,0.01760227895246418,0.05623585021725544,0.0768046013316141,0.1176368952233865])
            naiset_out=np.array([0.2,0.5794741566749106,0.8457974492658307,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2581513739168588,0.2,0.2,0.3461368704922949,0.2,0.5808243675866984,0.60655545394669,0.2,0.2,0.4562651669142593,0.2,0.2437559477524545,0.248568278579747,0.2,0.3532096630552465,0.2,0.4842237683582652,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07540131499155772,0.04921475781997333,0.02959077147099571,0.01298488790383987,0.0101035776199542,0.008619440865510959,0.008407712437165017,0.007759230556818882,0.007805002568300306,0.0108992167276191,0.008649364264432623,0.008069481501882808,0.00748298911884484,0.007318517619947429,0.009965196768776125,0.007651850570789808,0.01022318084054195,0.009723298142425646,0.007151673203194995,0.009331536261954133,0.006273582483326842,0.006169681215901438,0.008674604002562864,0.006270053958537147,0.005904743190458033,0.005999599875106022,0.00593003593781859,0.006134283415316856,0.005707488009267883,0.005827143658180019,0.005636839206564321,0.005312245267777031,0.006792376425569099,0.005248595531973121,0.004904224803475559,0.006945373333155391,0.004855766592843877,0.004688984963578818,0.0042440232906252,0.003927170644748863,0.00355677560820175,0.003042045106296659,0.002340426290851226,0.006955177717169283,0.003304823288364261,0.0004829431157936899,0.02617046609523242,0.01042690431228813,0.006918146662133016,0.01865575661916786,0.03382120854764215,0.04053430553660584,0.04908590043649715])
            miehet_out=np.array([0.2,0.2,0.7368321091318872,0.4298496859038839,0.3530527077212718,0.2368375454229087,0.2940969054853145,0.2099625449529801,0.2161447343484078,0.2,0.2803734722801821,0.3080139882760346,0.2,0.2261572099728457,0.2,0.4646182656196687,0.2,0.2,0.4029301933555532,0.2,0.2027849947860008,0.2496594776035194,0.2,0.3672915413201083,0.2,0.2,0.2,0.2,0.3212256173079712,0.2,0.2,0.3024294893819597,0.2,0.2736882785007378,0.4335589573572109,0.2,0.2,0.3120138684223359,0.3099350705075117,0.3316169803172053,0.3873222607659655,0.4690366055668436,0.4539080858338205,0.2,0.551718117303488,1.0,1.0,0.6915097713557066,0.2274719816354198,0.2,1.0,0.0,0.0])
        elif self.year==2024:
            naiset_in=np.array([0.05102825700946879,0.01640208389163639,0.01049493210491511,0.001193134297542657,2.635700597823275e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.005351067290571127,0.002772139516799534,0.004082401270367765,0.004059969942685491,0.002395241669049179,0.005561262795613215,0.004166991924545351,0.003201713554301075,0.003006673155346265,0.002834553951870844,0.001763884401090477,0.002548820362685858,0.007893840949358404,0.002755692639736415,0.002602675320889047,0.002270875557561567,0.002290550008385015,0.004823854527628102,0.002975880557915788,0.004814805813157197,0.003461750504780902,0.0005889610170700427,0.02921231157205575,0.01355779544245806,0.01042986902472443,0.01760227895246418,0.05623585021725544,0.0768046013316141,0.1176368952233865])
            naiset_out=np.array([0.2,0.5794741566749106,0.8457974492658307,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2581513739168588,0.2,0.2,0.3461368704922949,0.2,0.5808243675866984,0.60655545394669,0.2,0.2,0.4562651669142593,0.2,0.2437559477524545,0.248568278579747,0.2,0.3532096630552465,0.2,0.4842237683582652,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07540131499155772,0.04921475781997333,0.02959077147099571,0.01298488790383987,0.0101035776199542,0.008619440865510959,0.008407712437165017,0.007759230556818882,0.007805002568300306,0.0108992167276191,0.008649364264432623,0.008069481501882808,0.00748298911884484,0.007318517619947429,0.009965196768776125,0.007651850570789808,0.01022318084054195,0.009723298142425646,0.007151673203194995,0.009331536261954133,0.006273582483326842,0.006169681215901438,0.008674604002562864,0.006270053958537147,0.005904743190458033,0.005999599875106022,0.00593003593781859,0.006134283415316856,0.005707488009267883,0.005827143658180019,0.005636839206564321,0.005312245267777031,0.006792376425569099,0.005248595531973121,0.004904224803475559,0.006945373333155391,0.004855766592843877,0.004688984963578818,0.0042440232906252,0.003927170644748863,0.00355677560820175,0.003042045106296659,0.002340426290851226,0.006955177717169283,0.003304823288364261,0.0004829431157936899,0.02617046609523242,0.01042690431228813,0.006918146662133016,0.01865575661916786,0.03382120854764215,0.04053430553660584,0.04908590043649715])
            miehet_out=np.array([0.2,0.2,0.7368321091318872,0.4298496859038839,0.3530527077212718,0.2368375454229087,0.2940969054853145,0.2099625449529801,0.2161447343484078,0.2,0.2803734722801821,0.3080139882760346,0.2,0.2261572099728457,0.2,0.4646182656196687,0.2,0.2,0.4029301933555532,0.2,0.2027849947860008,0.2496594776035194,0.2,0.3672915413201083,0.2,0.2,0.2,0.2,0.3212256173079712,0.2,0.2,0.3024294893819597,0.2,0.2736882785007378,0.4335589573572109,0.2,0.2,0.3120138684223359,0.3099350705075117,0.3316169803172053,0.3873222607659655,0.4690366055668436,0.4539080858338205,0.2,0.551718117303488,1.0,1.0,0.6915097713557066,0.2274719816354198,0.2,1.0,0.0,0.0])
        else:
            print("Error: Unknown year in ['outsider in', 'outsider out']")
    
        min_age=18
        max_spv=71
        in_m=self.get_w(0,1.5,1.0)
        out_m=self.get_w(0,0.8,1.0)
        in_n=self.get_w(0,1.25,1.0)
        out_n=self.get_w(0,0.85,1.0)
        
        inrate[min_age:max_spv,0]=1.5*miehet_in
        inrate[min_age:max_spv,1]=1.0*miehet_in
        inrate[min_age:max_spv,2]=in_m*miehet_in
        inrate[min_age:max_spv,3]=1.25*naiset_in
        inrate[min_age:max_spv,4]=1.0*naiset_in
        inrate[min_age:max_spv,5]=in_n*naiset_in
        outrate[min_age:max_spv,0]=0.8*miehet_out
        outrate[min_age:max_spv,1]=1.0*miehet_out
        outrate[min_age:max_spv,2]=out_m*miehet_out
        outrate[min_age:max_spv,3]=0.85*naiset_out
        outrate[min_age:max_spv,4]=1.0*naiset_out
        outrate[min_age:max_spv,5]=out_n*naiset_out
        
        inrate=1-(1-inrate)**self.timestep
        outrate=1-(1-outrate)**self.timestep

        return inrate,outrate        
        
    def get_disability_rate(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Data ETK:n tilastotietokannasta ja skaalattu ikäluokittaisillä miesten ja naisten määrillä
        '''
        disab=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            dfactor=np.array([1.2,0.8,0.4,1.1,0.8,0.5])*0.9
        
        dis_miehet=np.array([0.004697942,00.004697942,00.004697942,0.004435302,0.003631736,0.003141361,0.003457091,0.003005607,0.002905609,0.003029283,0.002289213,0.002137714,0.001854558,0.002813517,0.002607335,0.00292628,0.002937462,0.002784612,0.002846377,0.002776506,0.003017675,0.003129845,0.003349059,0.002991577,0.00305634,0.003446143,0.003633971,0.004045113,0.004002001,0.004517725,0.005527525,0.005565513,0.006319492,0.007399175,0.00731299,0.009142823,0.010254463,0.011784364,0.013783743,0.015299156,0.018282001,0.024051257,0.032338044,0.028290544,0.019444444,0.00454486,0.000330718,0,0,0,0,0,0])
        dis_naiset=np.array([0.00532654,0.00532654,0.00532654,0.004917401,0.00453191,0.003799551,0.003253733,0.003092307,0.002822592,0.003309772,0.002482279,0.002615887,0.002416545,0.003546203,0.002665276,0.003095104,0.003129633,0.003406418,0.003171677,0.003320357,0.003391292,0.004007371,0.004310094,0.00438571,0.004267343,0.004889399,0.005043702,0.005793425,0.005569451,0.006298434,0.006363081,0.007043361,0.009389811,0.007457667,0.009251373,0.011154836,0.009524088,0.013689796,0.014658423,0.017440417,0.022804727,0.02677838,0.037438459,0.034691279,0.022649573,0.004414073,0.000264568,0,0,0,0,0,0])
        # ei varhaiseläkkeitä mukana, joten oletetaan ettei tk-intensiteetti laske
        dis_miehet[41:51]=np.maximum(dis_miehet[41:51],0.02829054)
        dis_naiset[41:51]=np.maximum(dis_naiset[41:51],0.03469128)
        
        for g in range(3):
            disab[18:71,g]=dfactor[g]*dis_miehet
            disab[70:(self.max_age+1),g]=24.45*dfactor[g]/1000
        for g in range(3,6):
            disab[18:71,g]=dfactor[g]*dis_naiset
            disab[70:(self.max_age+1),g]=24.45*dfactor[g]/1000

        disab=1-(1-disab)**self.timestep

        return disab        
        
    def get_eff_disab_rate(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Laskettu havaitusta työkyvyttömien lukumäärästä
        Siksi efektiivinen 
        '''
        disab=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            dfactor=np.array([1.3,0.95,0.6,1.2,1.0,0.9])
            
        if self.year==2018:
            dis_miehet=np.array([0.003844207,0.003844207,0.003844207,0.002157312,0,0.002915577,0.00081677,0.001404834,0.00177282,0,0,0.001891443,0,0.002265095,0,0.00268058,0.000697237,0,0.002079174,0.000263783,0,0.004538401,0,0.000631472,0.001079217,0.003555183,0.00458235,0.001800932,0.004376534,0.004341663,0.002335098,0.006036927,0.005459469,0.005254058,0.007632643,0.004282522,0.009607954,0.015170352,0.014231176,0.010977463,0.023104034,0.03462797,0.034507729,0.025464606,0.026129996,0.023528766,0.023334155,0.020393979,0.020180711,0.0201807,0.020180711,0.020180711,0.020180711])
            dis_naiset=np.array([0.003152456,0.003152456,0.003152456,0.001820899,0.003082487,0,0.001199533,0.00071851,0.000822116,0,0,3.56077E-05,0.002908854,0,6.90884E-05,0.001931247,0.000380501,0.002139637,0,0.001647453,0.002016588,0.001331603,0.001264028,0.002000195,0.001846965,0.003387732,0.003038917,0.003380599,0.00250926,0.003730162,0.004742885,0.002853525,0.007630704,0.004648271,0.00473735,0.007128777,0.007198634,0.01655657,0.011752225,0.019697643,0.023829746,0.026050823,0.037670072,0.022548783,0.024075564,0.021665082,0.021334812,0.018765714,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929])
        elif self.year==2019:
            dis_miehet=np.array([0.003844207,0.002157312,0,0.002915577,0.00081677,0.001404834,0.00177282,0,0,0.001891443,0,0.002265095,0,0.00268058,0.000697237,0,0.002079174,0.000263783,0,0.004538401,0,0.000631472,0.001079217,0.003555183,0.00458235,0.001800932,0.004376534,0.004341663,0.002335098,0.006036927,0.005459469,0.005254058,0.007632643,0.004282522,0.009607954,0.015170352,0.014231176,0.010977463,0.023104034,0.03462797,0.034507729,0.025464606,0.026129996,0.023528766,0.023334155,0.020393979,0.020180711,0.0201807,0.020180711,0.020180711,0.020180711,0.020180711,0.020180711])
            dis_naiset=np.array([0.003152456,0.001820899,0.003082487,0,0.001199533,0.00071851,0.000822116,0,0,3.56077E-05,0.002908854,0,6.90884E-05,0.001931247,0.000380501,0.002139637,0,0.001647453,0.002016588,0.001331603,0.001264028,0.002000195,0.001846965,0.003387732,0.003038917,0.003380599,0.00250926,0.003730162,0.004742885,0.002853525,0.007630704,0.004648271,0.00473735,0.007128777,0.007198634,0.01655657,0.011752225,0.019697643,0.023829746,0.026050823,0.037670072,0.022548783,0.024075564,0.021665082,0.021334812,0.018765714,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929])
        elif self.year==2020:
            dis_miehet=np.array([0.003844207,0.002157312,0,0.002915577,0.00081677,0.001404834,0.00177282,0,0,0.001891443,0,0.002265095,0,0.00268058,0.000697237,0,0.002079174,0.000263783,0,0.004538401,0,0.000631472,0.001079217,0.003555183,0.00458235,0.001800932,0.004376534,0.004341663,0.002335098,0.006036927,0.005459469,0.005254058,0.007632643,0.004282522,0.009607954,0.015170352,0.014231176,0.010977463,0.023104034,0.03462797,0.034507729,0.025464606,0.026129996,0.023528766,0.023334155,0.020393979,0.020180711,0.0201807,0.020180711,0.020180711,0.020180711,0.020180711,0.020180711])
            dis_naiset=np.array([0.003152456,0.001820899,0.003082487,0,0.001199533,0.00071851,0.000822116,0,0,3.56077E-05,0.002908854,0,6.90884E-05,0.001931247,0.000380501,0.002139637,0,0.001647453,0.002016588,0.001331603,0.001264028,0.002000195,0.001846965,0.003387732,0.003038917,0.003380599,0.00250926,0.003730162,0.004742885,0.002853525,0.007630704,0.004648271,0.00473735,0.007128777,0.007198634,0.01655657,0.011752225,0.019697643,0.023829746,0.026050823,0.037670072,0.022548783,0.024075564,0.021665082,0.021334812,0.018765714,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929])
        elif self.year==2021:
            dis_miehet=np.array([0.003844207,0.002157312,0,0.002915577,0.00081677,0.001404834,0.00177282,0,0,0.001891443,0,0.002265095,0,0.00268058,0.000697237,0,0.002079174,0.000263783,0,0.004538401,0,0.000631472,0.001079217,0.003555183,0.00458235,0.001800932,0.004376534,0.004341663,0.002335098,0.006036927,0.005459469,0.005254058,0.007632643,0.004282522,0.009607954,0.015170352,0.014231176,0.010977463,0.023104034,0.03462797,0.034507729,0.025464606,0.026129996,0.023528766,0.023334155,0.020393979,0.020180711,0.0201807,0.020180711,0.020180711,0.020180711,0.020180711,0.020180711])
            dis_naiset=np.array([0.003152456,0.001820899,0.003082487,0,0.001199533,0.00071851,0.000822116,0,0,3.56077E-05,0.002908854,0,6.90884E-05,0.001931247,0.000380501,0.002139637,0,0.001647453,0.002016588,0.001331603,0.001264028,0.002000195,0.001846965,0.003387732,0.003038917,0.003380599,0.00250926,0.003730162,0.004742885,0.002853525,0.007630704,0.004648271,0.00473735,0.007128777,0.007198634,0.01655657,0.011752225,0.019697643,0.023829746,0.026050823,0.037670072,0.022548783,0.024075564,0.021665082,0.021334812,0.018765714,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929])
        else:
            error(999)
            
        # oletetaan, että tk-alkavuus kasvaa 0,7% vuodessa iästä 59 alkaen
        y=np.arange(53-41)*0.007
        dis2_miehet=dis_miehet
        dis2_miehet[41:]=dis_miehet[41:]+y

        y=np.arange(53-41)*0.007
        dis2_naiset=dis_naiset
        dis2_naiset[41:]=dis_naiset[41:]+y
            
        for g in range(3):
            disab[18:71,g]=dfactor[g]*dis2_miehet
            disab[70:(self.max_age+1),g]=disab[70,g]
        for g in range(3,6):
            disab[18:71,g]=dfactor[g]*dis2_naiset
            disab[70:(self.max_age+1),g]=disab[70,g]
            
        disab=1-(1-disab)**self.timestep

        return disab        

    def get_eff_disab_rate_v2(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Laskettu havaitusta työkyvyttömien lukumäärästä
        Siksi efektiivinen 
        Revisio 2021
        '''
        disab=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            dfactor=np.array([1.3,0.99,0.7,1.22,0.99,0.7])
            
        if not self.silent:
            print(f'disability rate from year {self.year}')
        
        if self.year==2018:
            naiset_in=np.array([0.0022405691471677346,0.0028029347008399087,0.002653046320194355,0.0026883764894571273,0.0014880964625165272,0.0012831033837961063,0.0004918476488315644,0.0009138700835908024,0.00043764454148174437,0.0003,0.0003,0.0007444843487586423,0.0008866596300537446,0.0009000126307566958,0.000571566314750823,0.0007934915730612233,0.0014854286103005761,0.00035755311664076246,0.0007809005041911009,0.0007380284551836546,0.001665353939184701,0.0015383300480508117,0.0015327426355888634,0.001703357986695096,0.0024114371504144368,0.0027570209892189635,0.0032683686826615135,0.0029800198035666668,0.0032065977965771817,0.003658944888352902,0.0037769439974031467,0.005074179664769313,0.0050419030685216176,0.005678280791766548,0.005507140687843919,0.006348194637514865,0.010284721923118523,0.011802383127200717,0.01602907094765649,0.018361334284173775,0.023195092802516044,0.0289408628852481,0.02891593368444875,0.052675084076576076,0.04479751311501741,0.07943392685117287,0.11944315089789737,0.1648251852551909,0.21558002992305347,0.27170768490148506,0.33320815019048566,0.40008142579005535,0.47232751170019405])
            miehet_in=np.array([0.0020282359412728906,0.004025272690606772,0.004045430215264155,0.0018245008709171565,0.0015864210370592363,0.0010967912746402365,0.0018933663999702722,0.0014722893149959116,0.0008351804620221053,0.00033,0.00033,0.00033,0.0009648151731765731,0.00033,0.0018031750600651891,0.0012185249213899569,0.0012502187826932353,0.0010253712316433913,0.0008647260385692231,0.0007776113773148861,0.0016835582570671706,0.0015185062240844328,0.0018449433152839076,0.0005631234144229169,0.0019349708144611123,0.0033776255489086867,0.0036495336557529705,0.003953764632295431,0.0038545428452270735,0.004056839876306189,0.004665121956632313,0.005065050074281188,0.006146694368839761,0.006728533250916835,0.006295205930812254,0.007892053935929332,0.010623639897704179,0.014281817085207718,0.01484311006203395,0.017706931055202896,0.025066337254444036,0.03363884617419562,0.03512637075043493,0.05712859849691879,0.045516838926810674,0.07012695785362134,0.09473707678043201,0.11934719570724268,0.14395731463405337,0.16856743356086404,0.1931775524876747,0.21778767141448538,0.24239779034129605])
        elif self.year==2019:
            naiset_in=np.array([0.0030467662075624384,0.0031264126629215283,0.002577567813612649,0.001824015431373127,0.0017642527875080258,0.001019297985969914,0.0008209250247937746,0.0006471881252425429,0.0008202368268938103,0.0004567339631660877,0.0003,0.0003,0.0006869591102671889,0.0008225671833487609,0.0007160031711696683,0.0009356463032724046,0.000987271225820792,0.0017840022937542375,0.0005021567605162354,0.0007961770123721067,0.0009289217390011377,0.0015418759832412365,0.001855455789099436,0.001496798136321204,0.0020177635847036337,0.002221848412033196,0.0028634470147270454,0.0033088359912555403,0.003150767309428243,0.003191598010591702,0.004152565907737649,0.004266148243750837,0.005809516184344099,0.005141658242998873,0.0060934417188670984,0.006323873300449263,0.007738751847758353,0.011874009012314163,0.014016708866707115,0.018696103620300757,0.02330672360071526,0.028052408758834173,0.031502056430273324,0.05371744726773898,0.04653143942831896,0.07897481603834451,0.11482752123922337,0.1540895550309555,0.19676091741354096,0.2428416083869797,0.29233162795127177,0.3452309761064171,0.4015396528524158])
            miehet_in=np.array([0.0008768478960776173,0.0029624874342752895,0.0035670299813887873,0.002822114603201518,0.0010906634546966843,0.0011762647360189578,0.0005529001661454683,0.0015407077388677858,0.0007208028002052651,0.0008206187321800574,0.0003,0.0003,0.0003,0.0009114081642699395,0.0003,0.0014071590546393378,0.000989310388436477,0.0010154218919266875,0.00114604106258592,0.0009116335761962793,0.0009321940460377276,0.0016261662441440935,0.0014917658201391982,0.0016299103757713492,0.0005897349965863893,0.0018936394272891118,0.0034001875265309597,0.0036733501427922465,0.003645807292281047,0.0035033343053438334,0.0037024274107012776,0.004668737325009231,0.005074695759797924,0.006276354369372645,0.006724048357576113,0.006636385518222012,0.00803445222304866,0.010541761327601061,0.014852053262604194,0.016064490963544505,0.021260950204543678,0.02686691568391662,0.03260452989879999,0.054115555593402365,0.044294463927808614,0.06768220785561722,0.09106995178342583,0,0,0,0,0,0])
        elif self.year==2020:
            naiset_in=np.array([0.0032096446692947583,0.0037673799131181605,0.0030652243446419648,0.001747364723624794,0.0006124196364131928,0.0012563367899846016,0.00044262450825248775,0.0008516874812164338,0.0004043765384452949,0.0010072337070020914,0.0005247979884547706,0.0003,0.0003,0.0008519371767038075,0.0009526729770681643,0.00112044044357432,0.0009151473348066909,0.000935774600197938,0.0016892832749937378,0.0004938019987728952,0.0009063955998760385,0.001098506505851516,0.0017689864670849067,0.0018522652389991567,0.0014744438266701867,0.0018798248798918928,0.0022894016732453006,0.002993294800853477,0.0033840684015581904,0.0035126827031577443,0.003433939931678483,0.004486248718504473,0.004503821154181344,0.006180521573662441,0.005643536853758908,0.0069389640840172425,0.007380221896408128,0.008825427344891541,0.013668344894919434,0.016080940260259764,0.023754399687428495,0.02881774779990569,0.0319898873216221,0.05631748847885379,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.0033172663907411245,0.003036255541920993,0.002811700904810991,0.0027461543892335033,0.0019014921038241748,0.0007621518544063064,0.0008875415196744792,0.0006630850059563771,0.0011359549242157374,0.0008073981636737504,0.0008043274102045596,0.0003,0.0003,0.0003,0.0010051249840304813,0.0003,0.0014215361890685403,0.0009257315503269268,0.0010244401520617186,0.001199598959515221,0.001041734179510943,0.0011721010447761698,0.0016547127779423193,0.0014767557949190006,0.00151155522338169,0.0007784091649640849,0.0019341428580230018,0.003531666661902588,0.003753512393498012,0.003966748024269306,0.0036412616803970033,0.004194674277407201,0.004727925122861967,0.005496756903404218,0.006028551189916889,0.007784776572525908,0.007285759457239851,0.009772705997325434,0.011781926003470203,0.01691997231793992,0.020880866567773104,0.02673500505374338,0.03034300914359823,0.05154121162964108,0.04451220283252059,0.06811768566504117,0.09172316849756176,0,0,0,0,0,0])
        elif self.year==2021:
            naiset_in=np.array([0.0032096446692947583,0.0037673799131181605,0.0030652243446419648,0.001747364723624794,0.0006124196364131928,0.0012563367899846016,0.00044262450825248775,0.0008516874812164338,0.0004043765384452949,0.0010072337070020914,0.0005247979884547706,0.0003,0.0003,0.0008519371767038075,0.0009526729770681643,0.00112044044357432,0.0009151473348066909,0.000935774600197938,0.0016892832749937378,0.0004938019987728952,0.0009063955998760385,0.001098506505851516,0.0017689864670849067,0.0018522652389991567,0.0014744438266701867,0.0018798248798918928,0.0022894016732453006,0.002993294800853477,0.0033840684015581904,0.0035126827031577443,0.003433939931678483,0.004486248718504473,0.004503821154181344,0.006180521573662441,0.005643536853758908,0.0069389640840172425,0.007380221896408128,0.008825427344891541,0.013668344894919434,0.016080940260259764,0.023754399687428495,0.02881774779990569,0.0319898873216221,0.05631748847885379,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.0033172663907411245,0.003036255541920993,0.002811700904810991,0.0027461543892335033,0.0019014921038241748,0.0007621518544063064,0.0008875415196744792,0.0006630850059563771,0.0011359549242157374,0.0008073981636737504,0.0008043274102045596,0.0003,0.0003,0.0003,0.0010051249840304813,0.0003,0.0014215361890685403,0.0009257315503269268,0.0010244401520617186,0.001199598959515221,0.001041734179510943,0.0011721010447761698,0.0016547127779423193,0.0014767557949190006,0.00151155522338169,0.0007784091649640849,0.0019341428580230018,0.003531666661902588,0.003753512393498012,0.003966748024269306,0.0036412616803970033,0.004194674277407201,0.004727925122861967,0.005496756903404218,0.006028551189916889,0.007784776572525908,0.007285759457239851,0.009772705997325434,0.011781926003470203,0.01691997231793992,0.020880866567773104,0.02673500505374338,0.03034300914359823,0.05154121162964108,0.04451220283252059,0.06811768566504117,0.09172316849756176,0,0,0,0,0,0])
        elif self.year==2022:
            naiset_in=np.array([0.0032096446692947583,0.0037673799131181605,0.0030652243446419648,0.001747364723624794,0.0006124196364131928,0.0012563367899846016,0.00044262450825248775,0.0008516874812164338,0.0004043765384452949,0.0010072337070020914,0.0005247979884547706,0.0003,0.0003,0.0008519371767038075,0.0009526729770681643,0.00112044044357432,0.0009151473348066909,0.000935774600197938,0.0016892832749937378,0.0004938019987728952,0.0009063955998760385,0.001098506505851516,0.0017689864670849067,0.0018522652389991567,0.0014744438266701867,0.0018798248798918928,0.0022894016732453006,0.002993294800853477,0.0033840684015581904,0.0035126827031577443,0.003433939931678483,0.004486248718504473,0.004503821154181344,0.006180521573662441,0.005643536853758908,0.0069389640840172425,0.007380221896408128,0.008825427344891541,0.013668344894919434,0.016080940260259764,0.023754399687428495,0.02881774779990569,0.0319898873216221,0.05631748847885379,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.0033172663907411245,0.003036255541920993,0.002811700904810991,0.0027461543892335033,0.0019014921038241748,0.0007621518544063064,0.0008875415196744792,0.0006630850059563771,0.0011359549242157374,0.0008073981636737504,0.0008043274102045596,0.0003,0.0003,0.0003,0.0010051249840304813,0.0003,0.0014215361890685403,0.0009257315503269268,0.0010244401520617186,0.001199598959515221,0.001041734179510943,0.0011721010447761698,0.0016547127779423193,0.0014767557949190006,0.00151155522338169,0.0007784091649640849,0.0019341428580230018,0.003531666661902588,0.003753512393498012,0.003966748024269306,0.0036412616803970033,0.004194674277407201,0.004727925122861967,0.005496756903404218,0.006028551189916889,0.007784776572525908,0.007285759457239851,0.009772705997325434,0.011781926003470203,0.01691997231793992,0.020880866567773104,0.02673500505374338,0.03034300914359823,0.05154121162964108,0.04451220283252059,0.06811768566504117,0.09172316849756176,0,0,0,0,0,0])
        elif self.year==2023:
            naiset_in=np.array([0.0032096446692947583,0.0037673799131181605,0.0030652243446419648,0.001747364723624794,0.0006124196364131928,0.0012563367899846016,0.00044262450825248775,0.0008516874812164338,0.0004043765384452949,0.0010072337070020914,0.0005247979884547706,0.0003,0.0003,0.0008519371767038075,0.0009526729770681643,0.00112044044357432,0.0009151473348066909,0.000935774600197938,0.0016892832749937378,0.0004938019987728952,0.0009063955998760385,0.001098506505851516,0.0017689864670849067,0.0018522652389991567,0.0014744438266701867,0.0018798248798918928,0.0022894016732453006,0.002993294800853477,0.0033840684015581904,0.0035126827031577443,0.003433939931678483,0.004486248718504473,0.004503821154181344,0.006180521573662441,0.005643536853758908,0.0069389640840172425,0.007380221896408128,0.008825427344891541,0.013668344894919434,0.016080940260259764,0.023754399687428495,0.02881774779990569,0.0319898873216221,0.05631748847885379,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.0033172663907411245,0.003036255541920993,0.002811700904810991,0.0027461543892335033,0.0019014921038241748,0.0007621518544063064,0.0008875415196744792,0.0006630850059563771,0.0011359549242157374,0.0008073981636737504,0.0008043274102045596,0.0003,0.0003,0.0003,0.0010051249840304813,0.0003,0.0014215361890685403,0.0009257315503269268,0.0010244401520617186,0.001199598959515221,0.001041734179510943,0.0011721010447761698,0.0016547127779423193,0.0014767557949190006,0.00151155522338169,0.0007784091649640849,0.0019341428580230018,0.003531666661902588,0.003753512393498012,0.003966748024269306,0.0036412616803970033,0.004194674277407201,0.004727925122861967,0.005496756903404218,0.006028551189916889,0.007784776572525908,0.007285759457239851,0.009772705997325434,0.011781926003470203,0.01691997231793992,0.020880866567773104,0.02673500505374338,0.03034300914359823,0.05154121162964108,0.04451220283252059,0.06811768566504117,0.09172316849756176,0,0,0,0,0,0])
        elif self.year==2024:
            naiset_in=np.array([0.0032096446692947583,0.0037673799131181605,0.0030652243446419648,0.001747364723624794,0.0006124196364131928,0.0012563367899846016,0.00044262450825248775,0.0008516874812164338,0.0004043765384452949,0.0010072337070020914,0.0005247979884547706,0.0003,0.0003,0.0008519371767038075,0.0009526729770681643,0.00112044044357432,0.0009151473348066909,0.000935774600197938,0.0016892832749937378,0.0004938019987728952,0.0009063955998760385,0.001098506505851516,0.0017689864670849067,0.0018522652389991567,0.0014744438266701867,0.0018798248798918928,0.0022894016732453006,0.002993294800853477,0.0033840684015581904,0.0035126827031577443,0.003433939931678483,0.004486248718504473,0.004503821154181344,0.006180521573662441,0.005643536853758908,0.0069389640840172425,0.007380221896408128,0.008825427344891541,0.013668344894919434,0.016080940260259764,0.023754399687428495,0.02881774779990569,0.0319898873216221,0.05631748847885379,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.0033172663907411245,0.003036255541920993,0.002811700904810991,0.0027461543892335033,0.0019014921038241748,0.0007621518544063064,0.0008875415196744792,0.0006630850059563771,0.0011359549242157374,0.0008073981636737504,0.0008043274102045596,0.0003,0.0003,0.0003,0.0010051249840304813,0.0003,0.0014215361890685403,0.0009257315503269268,0.0010244401520617186,0.001199598959515221,0.001041734179510943,0.0011721010447761698,0.0016547127779423193,0.0014767557949190006,0.00151155522338169,0.0007784091649640849,0.0019341428580230018,0.003531666661902588,0.003753512393498012,0.003966748024269306,0.0036412616803970033,0.004194674277407201,0.004727925122861967,0.005496756903404218,0.006028551189916889,0.007784776572525908,0.007285759457239851,0.009772705997325434,0.011781926003470203,0.01691997231793992,0.020880866567773104,0.02673500505374338,0.03034300914359823,0.05154121162964108,0.04451220283252059,0.06811768566504117,0.09172316849756176,0,0,0,0,0,0])
        else:
            error(999)
            
        # oletetaan, että tk-alkavuus kasvaa 0,7% vuodessa iästä 59 alkaen
        #y=np.arange(53-41)*0.007
        dis2_miehet=dis_miehet
        dis2_miehet[41:]=dis_miehet[41:]#+y

        #y=np.arange(53-41)*0.007
        dis2_naiset=dis_naiset
        dis2_naiset[41:]=dis_naiset[41:]#+y
            
        for g in range(3):
            disab[18:71,g]=dfactor[g]*dis2_miehet
            disab[71:(self.max_age+1),g]=disab[70,g]
        for g in range(3,6):
            disab[18:71,g]=dfactor[g]*dis2_naiset
            disab[71:(self.max_age+1),g]=disab[70,g]
            
        disab=1-(1-disab)**self.timestep

        return disab        
        
    def get_eff_disab_rate_v4(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Sisältää myös sairausvakuutuspäivärahasiirtymät
        Laskettu havaitusta työkyvyttömien lukumäärästä
        Siksi efektiivinen 
        Revisio 2022
        
        Huomioi M.Laaksonen: Työkyvyttömyyseläkkeelle siirtyminen: trendit, tilannekuva, tulevaisuus
        '''
        disab=np.zeros((self.max_age+1,self.n_groups,self.n_empl))
        prop=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
            unempfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            dfactor=np.array([1.2,0.99,0.,1.12,0.99,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            
            base=1.05
            unemp=1.0*base
            unempfactor=np.array([unemp,base,base,base,unemp,base,base,base,base,base,base,base,base,unemp,base,0.0])
            
        if not self.silent:
            print(f'disability rate from year {self.year}')
            
        if self.year==2018:
            naiset_in=np.array([0.0022405691471677346,0.0028029347008399087,0.002653046320194355,0.0026883764894571273,0.0014880964625165272,0.0012831033837961063,0.0004918476488315644,0.0009138700835908024,0.00043764454148174437,0.0003,0.0003,0.0007444843487586423,0.0008866596300537446,0.0009000126307566958,0.000571566314750823,0.0007934915730612233,0.0014854286103005761,0.00035755311664076246,0.0007809005041911009,0.0007380284551836546,0.001665353939184701,0.0015383300480508117,0.0015327426355888634,0.001703357986695096,0.0024114371504144368,0.0027570209892189635,0.0032683686826615135,0.0029800198035666668,0.0032065977965771817,0.003658944888352902,0.0037769439974031467,0.005074179664769313,0.0050419030685216176,0.005678280791766548,0.005507140687843919,0.006348194637514865,0.010284721923118523,0.011802383127200717,0.01602907094765649,0.018361334284173775,0.023195092802516044,0.0289408628852481,0.02891593368444875,0.052675084076576076,0.04479751311501741,0.07943392685117287,0.11944315089789737,0.1648251852551909,0.21558002992305347,0.27170768490148506,0.33320815019048566,0.40008142579005535,0.47232751170019405])
            miehet_in=np.array([0.0020282359412728906,0.004025272690606772,0.004045430215264155,0.0018245008709171565,0.0015864210370592363,0.0010967912746402365,0.0018933663999702722,0.0014722893149959116,0.0008351804620221053,0.00033,0.00033,0.00033,0.0009648151731765731,0.00033,0.0018031750600651891,0.0012185249213899569,0.0012502187826932353,0.0010253712316433913,0.0008647260385692231,0.0007776113773148861,0.0016835582570671706,0.0015185062240844328,0.0018449433152839076,0.0005631234144229169,0.0019349708144611123,0.0033776255489086867,0.0036495336557529705,0.003953764632295431,0.0038545428452270735,0.004056839876306189,0.004665121956632313,0.005065050074281188,0.006146694368839761,0.006728533250916835,0.006295205930812254,0.007892053935929332,0.010623639897704179,0.014281817085207718,0.01484311006203395,0.017706931055202896,0.025066337254444036,0.03363884617419562,0.03512637075043493,0.05712859849691879,0.045516838926810674,0.07012695785362134,0.09473707678043201,0.11934719570724268,0.14395731463405337,0.16856743356086404,0.1931775524876747,0.21778767141448538,0.24239779034129605])
        elif self.year==2019:
            naiset_in=np.array([0.0030467662075624384,0.0031264126629215283,0.002577567813612649,0.001824015431373127,0.0017642527875080258,0.001019297985969914,0.0008209250247937746,0.0006471881252425429,0.0008202368268938103,0.0004567339631660877,0.0003,0.0003,0.0006869591102671889,0.0008225671833487609,0.0007160031711696683,0.0009356463032724046,0.000987271225820792,0.0017840022937542375,0.0005021567605162354,0.0007961770123721067,0.0009289217390011377,0.0015418759832412365,0.001855455789099436,0.001496798136321204,0.0020177635847036337,0.002221848412033196,0.0028634470147270454,0.0033088359912555403,0.003150767309428243,0.003191598010591702,0.004152565907737649,0.004266148243750837,0.005809516184344099,0.005141658242998873,0.0060934417188670984,0.006323873300449263,0.007738751847758353,0.011874009012314163,0.014016708866707115,0.018696103620300757,0.02330672360071526,0.028052408758834173,0.031502056430273324,0.05371744726773898,0.04653143942831896,0.07897481603834451,0.11482752123922337,0.1540895550309555,0.19676091741354096,0.2428416083869797,0.29233162795127177,0.3452309761064171,0.4015396528524158])
            miehet_in=np.array([0.0008768478960776173,0.0029624874342752895,0.0035670299813887873,0.002822114603201518,0.0010906634546966843,0.0011762647360189578,0.0005529001661454683,0.0015407077388677858,0.0007208028002052651,0.0008206187321800574,0.0003,0.0003,0.0003,0.0009114081642699395,0.0003,0.0014071590546393378,0.000989310388436477,0.0010154218919266875,0.00114604106258592,0.0009116335761962793,0.0009321940460377276,0.0016261662441440935,0.0014917658201391982,0.0016299103757713492,0.0005897349965863893,0.0018936394272891118,0.0034001875265309597,0.0036733501427922465,0.003645807292281047,0.0035033343053438334,0.0037024274107012776,0.004668737325009231,0.005074695759797924,0.006276354369372645,0.006724048357576113,0.006636385518222012,0.00803445222304866,0.010541761327601061,0.014852053262604194,0.016064490963544505,0.021260950204543678,0.02686691568391662,0.03260452989879999,0.054115555593402365,0.044294463927808614,0.06768220785561722,0.09106995178342583,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176])
        elif self.year==2020:
            naiset_in=np.array([0.0032057900573504252,0.0037665806669729546,0.003063494351008529,0.001746396922614755,0.0006122701824508831,0.0012562114821060876,0.0004424806542084004,0.0008514750837024924,0.0004043160501220667,0.0010071134618272568,0.0005246765706773503,0.0003,0.0003,0.0008519621616641191,0.0009528403622877142,0.0011205097284547314,0.000915063548008863,0.0009357468373485878,0.0016899660304384651,0.0004939560711594078,0.0009065266879820023,0.0010987687887873128,0.0017697888012953042,0.0018529974932293902,0.0014747149721313086,0.0018809028587262256,0.0022907868807317596,0.002994782198499791,0.0033853796324532087,0.0035145742252911216,0.0034373981987301104,0.004488799940429093,0.004507186691935857,0.006185302329706142,0.005649458363183664,0.006948799610713227,0.007385002536567153,0.008833225495820697,0.013685075790395844,0.016101027421286697,0.023759362700734723,0.02884838542248692,0.031942891894368754,0.056270493051600444,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.003312921356677685,0.0030357895520709216,0.002810507502002098,0.0027445417556540615,0.0019006739051494654,0.0007618109716788908,0.00088699580633,0.0006629279823972243,0.0011357265376427702,0.0008074674391362932,0.000804129612326832,0.0003,0.0003,0.0003,0.0010047331504185976,0.0003,0.0014214952075956625,0.0009256277876659401,0.0010246361370275855,0.001199534370179977,0.0010416497882718982,0.001172000728565787,0.0016546178578785268,0.001477014081664504,0.0015113353766801829,0.000778318841281435,0.0019340871316236323,0.0035319782389435154,0.003754687339700251,0.003966748024269306,0.0036423551158887646,0.004194674277407201,0.004729449031040165,0.005498664054739616,0.006026747962114209,0.007790284506777275,0.007292661710263467,0.00977679524007642,0.01179384393409373,0.016933616234332843,0.020878938213157026,0.026739297764895233,0.03020963551685557,0.05140783800289842,0.04451220283252059,0.06811768566504117,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176])            
        elif self.year==2021:
            naiset_in=np.array([0.0032057900573504252,0.0037665806669729546,0.003063494351008529,0.001746396922614755,0.0006122701824508831,0.0012562114821060876,0.0004424806542084004,0.0008514750837024924,0.0004043160501220667,0.0010071134618272568,0.0005246765706773503,0.0003,0.0003,0.0008519621616641191,0.0009528403622877142,0.0011205097284547314,0.000915063548008863,0.0009357468373485878,0.0016899660304384651,0.0004939560711594078,0.0009065266879820023,0.0010987687887873128,0.0017697888012953042,0.0018529974932293902,0.0014747149721313086,0.0018809028587262256,0.0022907868807317596,0.002994782198499791,0.0033853796324532087,0.0035145742252911216,0.0034373981987301104,0.004488799940429093,0.004507186691935857,0.006185302329706142,0.005649458363183664,0.006948799610713227,0.007385002536567153,0.008833225495820697,0.013685075790395844,0.016101027421286697,0.023759362700734723,0.02884838542248692,0.031942891894368754,0.056270493051600444,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.003312921356677685,0.0030357895520709216,0.002810507502002098,0.0027445417556540615,0.0019006739051494654,0.0007618109716788908,0.00088699580633,0.0006629279823972243,0.0011357265376427702,0.0008074674391362932,0.000804129612326832,0.0003,0.0003,0.0003,0.0010047331504185976,0.0003,0.0014214952075956625,0.0009256277876659401,0.0010246361370275855,0.001199534370179977,0.0010416497882718982,0.001172000728565787,0.0016546178578785268,0.001477014081664504,0.0015113353766801829,0.000778318841281435,0.0019340871316236323,0.0035319782389435154,0.003754687339700251,0.003966748024269306,0.0036423551158887646,0.004194674277407201,0.004729449031040165,0.005498664054739616,0.006026747962114209,0.007790284506777275,0.007292661710263467,0.00977679524007642,0.01179384393409373,0.016933616234332843,0.020878938213157026,0.026739297764895233,0.03020963551685557,0.05140783800289842,0.04451220283252059,0.06811768566504117,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176])            
        elif self.year==2022:
            naiset_in=np.array([0.0032057900573504252,0.0037665806669729546,0.003063494351008529,0.001746396922614755,0.0006122701824508831,0.0012562114821060876,0.0004424806542084004,0.0008514750837024924,0.0004043160501220667,0.0010071134618272568,0.0005246765706773503,0.0003,0.0003,0.0008519621616641191,0.0009528403622877142,0.0011205097284547314,0.000915063548008863,0.0009357468373485878,0.0016899660304384651,0.0004939560711594078,0.0009065266879820023,0.0010987687887873128,0.0017697888012953042,0.0018529974932293902,0.0014747149721313086,0.0018809028587262256,0.0022907868807317596,0.002994782198499791,0.0033853796324532087,0.0035145742252911216,0.0034373981987301104,0.004488799940429093,0.004507186691935857,0.006185302329706142,0.005649458363183664,0.006948799610713227,0.007385002536567153,0.008833225495820697,0.013685075790395844,0.016101027421286697,0.023759362700734723,0.02884838542248692,0.031942891894368754,0.056270493051600444,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.003312921356677685,0.0030357895520709216,0.002810507502002098,0.0027445417556540615,0.0019006739051494654,0.0007618109716788908,0.00088699580633,0.0006629279823972243,0.0011357265376427702,0.0008074674391362932,0.000804129612326832,0.0003,0.0003,0.0003,0.0010047331504185976,0.0003,0.0014214952075956625,0.0009256277876659401,0.0010246361370275855,0.001199534370179977,0.0010416497882718982,0.001172000728565787,0.0016546178578785268,0.001477014081664504,0.0015113353766801829,0.000778318841281435,0.0019340871316236323,0.0035319782389435154,0.003754687339700251,0.003966748024269306,0.0036423551158887646,0.004194674277407201,0.004729449031040165,0.005498664054739616,0.006026747962114209,0.007790284506777275,0.007292661710263467,0.00977679524007642,0.01179384393409373,0.016933616234332843,0.020878938213157026,0.026739297764895233,0.03020963551685557,0.05140783800289842,0.04451220283252059,0.06811768566504117,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176])            
        elif self.year==2023:
            naiset_in=np.array([0.0032057900573504252,0.0037665806669729546,0.003063494351008529,0.001746396922614755,0.0006122701824508831,0.0012562114821060876,0.0004424806542084004,0.0008514750837024924,0.0004043160501220667,0.0010071134618272568,0.0005246765706773503,0.0003,0.0003,0.0008519621616641191,0.0009528403622877142,0.0011205097284547314,0.000915063548008863,0.0009357468373485878,0.0016899660304384651,0.0004939560711594078,0.0009065266879820023,0.0010987687887873128,0.0017697888012953042,0.0018529974932293902,0.0014747149721313086,0.0018809028587262256,0.0022907868807317596,0.002994782198499791,0.0033853796324532087,0.0035145742252911216,0.0034373981987301104,0.004488799940429093,0.004507186691935857,0.006185302329706142,0.005649458363183664,0.006948799610713227,0.007385002536567153,0.008833225495820697,0.013685075790395844,0.016101027421286697,0.023759362700734723,0.02884838542248692,0.031942891894368754,0.056270493051600444,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.003312921356677685,0.0030357895520709216,0.002810507502002098,0.0027445417556540615,0.0019006739051494654,0.0007618109716788908,0.00088699580633,0.0006629279823972243,0.0011357265376427702,0.0008074674391362932,0.000804129612326832,0.0003,0.0003,0.0003,0.0010047331504185976,0.0003,0.0014214952075956625,0.0009256277876659401,0.0010246361370275855,0.001199534370179977,0.0010416497882718982,0.001172000728565787,0.0016546178578785268,0.001477014081664504,0.0015113353766801829,0.000778318841281435,0.0019340871316236323,0.0035319782389435154,0.003754687339700251,0.003966748024269306,0.0036423551158887646,0.004194674277407201,0.004729449031040165,0.005498664054739616,0.006026747962114209,0.007790284506777275,0.007292661710263467,0.00977679524007642,0.01179384393409373,0.016933616234332843,0.020878938213157026,0.026739297764895233,0.03020963551685557,0.05140783800289842,0.04451220283252059,0.06811768566504117,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176])            
        else:
            error(999)
            
        # puolet sv:llä olevisa vain 3 kk
        factor_3kk=0.5
            
        sv_miehet=np.maximum(0.005,miehet_in+np.minimum(0.03,miehet_in))
        sv_naiset=np.maximum(0.005,naiset_in+np.minimum(0.03,naiset_in))
        
        proportion_miehet=miehet_in/sv_miehet
        proportion_naiset=naiset_in/sv_naiset
        for g in range(3):
            prop[18:71,g]=proportion_miehet
            prop[18:71,g+3]=proportion_naiset
        prop[71:(self.max_age+1),:]=prop[70,:]

        for s in range(self.n_empl):
            for g in range(3):
                disab[18:71,g,s]=dfactor[g]*sv_miehet*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            for g in range(3,6):
                disab[18:71,g,s]=dfactor[g]*sv_naiset*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            
        disab[18:63,:,:]=disab[18:63,:,:]/factor_3kk

        disab=1-(1-disab)**self.timestep
        
        return disab,prop

    def get_eff_disab_rate_v5(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Sisältää myös sairausvakuutuspäivärahasiirtymät
        Laskettu havaitusta työkyvyttömien lukumäärästä
        Siksi efektiivinen 
        Revisio 2022 v2
        
        Huomioi M.Laaksonen: Työkyvyttömyyseläkkeelle siirtyminen: trendit, tilannekuva, tulevaisuus
        '''
        disab=np.zeros((self.max_age+1,self.n_groups,self.n_empl))
        prop=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
            unempfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            dfactor=np.array([1.15,0.95,0.,1.1,0.95,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            
            base=1.05
            unemp=1.00*base
            unempfactor=np.array([unemp,base,base,base,unemp,base,base,base,base,base,base,base,base,unemp,base,0.0])
            
        if not self.silent:
            print(f'disability rate from year {self.year}')
            
        ### ['tk in']
        if self.year==2018:
            naiset_in=np.array([0.002240569147167735,0.002830792094175196,0.002690638552916054,0.00272539462965543,0.001511331414864907,0.001305885872480597,0.0005014074347163524,0.0009304992547521402,0.0004455429741711683,0.0003,0.0003,0.0007578079670789363,0.0009029803096527555,0.0009174739486199686,0.0005815378983268695,0.000810314284818705,0.00151611451970598,0.000364023348505531,0.00079679832123088,0.0007526040625944612,0.0016984493865818,0.001573732061041452,0.001565309933262707,0.001739588620084315,0.002463681286900348,0.002815673748564049,0.003344147376849488,0.003053901362741829,0.003284840436443889,0.003742058313586392,0.003872459667990953,0.005200805226134803,0.00518059882552615,0.005835058950505146,0.005651122374036269,0.006556463298692298,0.0106217222724708,0.01220213588274599,0.01653472332618251,0.01898953720466576,0.02398277285055633,0.02997251615451202,0.03005136356653999,0.03343052362662936,0.03704077023212025,0.04088210338301268,0.04495452307930664,0.04925802932100213,0.05379262210809915,0.05855830144059769,0.06355506731849776,0.06878291974179937,0.07424185871050251])
            miehet_in=np.array([0.002028235941272891,0.004041682340271664,0.004068878732363647,0.001839773756907295,0.001596828063800841,0.001108195790778645,0.001907292373762196,0.001482518796558867,0.0008401518519162425,0.00033,0.00033,0.00033,0.0009684768490928891,0.00033,0.001805711030853401,0.001225946069360812,0.001254778865976814,0.001029985155906469,0.0008707495156055166,0.0007838989693269955,0.001696600495575451,0.001531571476937895,0.001865215514559851,0.0005693609687273852,0.00195954943847133,0.003424550674633902,0.003703708586506678,0.004014449610758119,0.003908093725796336,0.004116566970070374,0.004738164366019973,0.005157115099014319,0.006270010978006057,0.006872299915014119,0.006425509318077369,0.008061184955702768,0.01086188902921026,0.01465302798220911,0.01530939268911836,0.01821310281212039,0.02583133141558103,0.03470760110326229,0.03641728897492381,0.04169426304637517,0.04756455310493887,0.05343484316350256,0.05930513322206626,0.06517542328062995,0.07104571333919364,0.07691600339775734,0.08278629345632103,0.08865658351488473,0.09452687357344843])
        elif self.year==2019:
            naiset_in=np.array([0.003046766207562438,0.003161670885904248,0.002614329699944849,0.001853248204073921,0.001794469042650925,0.001037029524922693,0.0008359323709872432,0.0006587383999230082,0.0008358649362438317,0.000464176604710346,0.0003,0.0003,0.000700126222816911,0.0008370836495126279,0.0007273909591614877,0.0009538040399438047,0.001006605244931541,0.001810825301772053,0.0005122785669716747,0.0008114470041718097,0.0009461705602037194,0.001575711560027234,0.001895483797692033,0.001525653183390974,0.002058963957858087,0.002273314462871375,0.002934961735887633,0.003393731914041754,0.003224985997661222,0.003273284990869233,0.004254749443587343,0.0043806477804659,0.005962242056031837,0.005284604414421657,0.006271984372196185,0.006496246224537789,0.007969047043333323,0.01223078669054985,0.01447746082163412,0.01937035538994797,0.02407011869194913,0.02901204942646778,0.03276892972520239,0.03734179695109445,0.04183465734138107,0.04670506927358027,0.05195303274769206,0.05757854776371645,0.0635816143216534,0.06996223242150296,0.0767204020632651,0.08385612324693982,0.09136939597252713])
            miehet_in=np.array([0.0008768478960776173,0.002981824602974625,0.003582882716265382,0.00283848413742459,0.001098068524477987,0.001185224045382513,0.0005572278084288149,0.001547911426206377,0.0007257422770331285,0.0008255598103674507,0.0003,0.0003,0.0003,0.0009153967596733879,0.0003,0.001413339866718838,0.0009933290846945095,0.001022140077256083,0.001150717897270704,0.0009175153639854404,0.000941344640850092,0.001639772157581037,0.001504631624237639,0.001650388154099673,0.0005973791107030159,0.001919966756154253,0.003448205789225867,0.003728250946996648,0.003705264437200369,0.003565497468541054,0.003759999567828922,0.004759257017246366,0.005177238330060637,0.006408547070523202,0.006884077194818938,0.006780712558661246,0.008233131336809318,0.01081412911277901,0.01529275831364568,0.01653166588336006,0.02190731030984433,0.02773635301298426,0.03373130819947029,0.03834094567092644,0.04379326561781804,0.04926475444481147,0.05473624327180489,0.06020773209879832,0.06567922092579175,0.07115070975278517,0.0766221985797786,0.08209368740677203,0.08756517623376546])
        elif self.year==2020:
            naiset_in=np.array([0.003209644669294758,0.00379615893773258,0.003098539047623667,0.001769415067368586,0.0006208098498388108,0.001278199165142428,0.0004500728601726862,0.0008659141162124881,0.0004116342894537062,0.001026959750176001,0.0005342033255316593,0.0003,0.0003,0.000866263046345931,0.0009680528757034875,0.001142181135140831,0.0009319957242944616,0.0009519803950999844,0.001720323048269124,0.0005033851237901698,0.0009225593827044794,0.001120438884745194,0.001806613491544505,0.001892427546388536,0.001502924453271588,0.001922499388763897,0.002343139926101875,0.00307348178646709,0.003472010039492387,0.003601921862634589,0.003513513127237296,0.004614871775104223,0.00463065605657722,0.006360213986101528,0.005804759362563465,0.00716504185003133,0.007616214308979347,0.009091350031595847,0.014076390721093,0.0166303594948796,0.02460817392198633,0.02984206165559907,0.03317982851194499,0.03795568795965799,0.04328702007585259,0.04917382486052879,0.05561610231368658,0.06261385243532597,0.07016707522544696,0.07827577068404956,0.08693993881113375,0.09615957960669955,0.1059346930707469])
            miehet_in=np.array([0.003317266390741124,0.003047716402255182,0.002826744363730592,0.002766259127362885,0.001915990988237452,0.0007686741680827649,0.0008942131970693943,0.0006673524744103296,0.001144232136544294,0.0008132181815848761,0.000807160354390897,0.0003,0.0003,0.0003,0.001007862824655675,0.0003,0.001429189627459313,0.0009316649182862742,0.001031708316904116,0.001209451035151632,0.001047904649906689,0.001181864970488541,0.001671221705435745,0.001493147233936331,0.00152692433165725,0.0007896161970417699,0.00196155166365446,0.003579254656082236,0.003816955271601414,0.004045152834247611,0.003704475134036162,0.004263873446691281,0.004816350095321185,0.005604838433351037,0.006156780009868524,0.007966696492106448,0.007454418075950045,0.01004661634333996,0.01213781672489574,0.01743899871822331,0.02147055520532185,0.0275590402388545,0.03140263688001486,0.03621884191879465,0.04103504695757443,0.04592616989563757,0.05081729283370072,0.05570841577176387,0.06059953870982701,0.06549066164789016,0.07038178458595332,0.07527290752401647,0.08016403046207962])
        elif self.year==2021:
            naiset_in=np.array([0.003205790057350425,0.003795968532609327,0.003095235291244006,0.001768282253071127,0.0006220974874414697,0.001276808343618545,0.0004500764064916013,0.0008661358923035171,0.0004116111650440503,0.001025741880948096,0.0005334192735845339,0.0003,0.0003,0.0008666688244184955,0.0009705872407498243,0.001139983859041177,0.0009303668513356445,0.0009547644037889139,0.001720473477482529,0.0005040210703660176,0.0009258250232173741,0.001123956672276702,0.001807331701630054,0.001895797354894505,0.00150720809064453,0.001923694023977586,0.002346650653407229,0.003063812768637478,0.00346627604241047,0.003602114960749179,0.003526378965837948,0.0046130605305727,0.004627206862920016,0.006366326928837228,0.005808960525349765,0.007163938329714907,0.007614442510294168,0.00910449564720061,0.01410150427263879,0.0166681593700444,0.02462041364363211,0.02992658435928756,0.03318713630401337,0.03795854431185702,0.04328114054731017,0.04915492501037284,0.05557989770104501,0.06255605861932668,0.07008340776521788,0.07816194513871857,0.08679167073982878,0.0959725845685485,0.1057046866248777])
            miehet_in=np.array([0.003317266390741124,0.003047997153802165,0.00282823869809145,0.002767651875685088,0.001914091059116312,0.0007667637193838929,0.0008938481102064972,0.0006675246057817688,0.001141962252840963,0.0008112004137585061,0.0008077168352582139,0.0003,0.0003,0.0003,0.001007726957851228,0.0003,0.001429861330332352,0.0009291223308835247,0.001030459404853624,0.001211164943688589,0.00105196691770267,0.001185257398669406,0.001669467108182806,0.001494382262407002,0.001531059977276288,0.0007889663432525325,0.001962494231977099,0.003588141676835075,0.003821143803398868,0.004036054619348345,0.003707633427720485,0.004267911795550338,0.00480710103827251,0.005610569771166016,0.006151206677435544,0.007969736589561165,0.007464218684689885,0.01005020602478583,0.01208006281279191,0.01744386538253996,0.02159785507014311,0.0276245615730837,0.03145850943796004,0.03630312109425207,0.04114773275054411,0.04603520217064436,0.05092267159074461,0.05581014101084486,0.06069761043094511,0.06558507985104536,0.07047254927114562,0.07536001869124587,0.08024748811134612])
        elif self.year==2022:
            naiset_in=np.array([0.003205790057350425,0.003799088690703686,0.003103158508890347,0.001769745113421765,0.0006204534909277931,0.001279345257128309,0.0004505227757194454,0.0008662103473345924,0.0004114748965848777,0.001025572490359193,0.0005332408663628125,0.0003,0.0003,0.0008665219222893001,0.0009692084190150672,0.001138937040240728,0.0009312207521873654,0.000952201411325622,0.001723947436516343,0.0005035115396581173,0.0009244958672555311,0.001121389917571034,0.001808544913334873,0.001893044705226751,0.001506159674748153,0.00192249918008461,0.002347206393156604,0.003068484474950675,0.003465971429970088,0.003599935556717874,0.003524228775996236,0.004595039038300002,0.004626396372390337,0.006360673382525006,0.005813495426616575,0.007174163207681809,0.007601380323502255,0.00912033768810586,0.01413064146410218,0.01661843244480895,0.02462950138997641,0.02983151938130562,0.03300696991707418,0.03772605203031719,0.04300295692669425,0.04883768460620537,0.05523023506885055,0.06218060831462978,0.06968880434354308,0.07775482315559043,0.08637866475077184,0.09556032912908731,0.1052998162905368])
            miehet_in=np.array([0.003317266390741124,0.003047716402255182,0.002831010422575212,0.00276145023819266,0.001913627035594809,0.0007677877478048627,0.0008948143610481855,0.0006680806441650282,0.001141385098170439,0.0008113291817019852,0.0008077073012079807,0.0003,0.0003,0.0003,0.001007789117880688,0.0003,0.001428014676707239,0.0009301881494751067,0.001030946421929532,0.001206818556235668,0.001051385123500979,0.001183580314376484,0.001669671356946299,0.001497220745415912,0.001531099875621025,0.0007894021050097726,0.00196035992529619,0.003581102408567424,0.003813582044171579,0.004034056672150553,0.003704069473386328,0.004265603730741192,0.00482259080788809,0.005602501964363065,0.006158572261391742,0.007951362252235143,0.007469515768044155,0.01003629842431445,0.0121157876626815,0.01739087201755622,0.02149655987936478,0.02754664590587735,0.03134489157637704,0.03615216755480092,0.0409594435332248,0.04582516444668981,0.05069088536015481,0.05555660627361982,0.06042232718708482,0.06528804810054982,0.07015376901401482,0.07501948992747982,0.07988521084094483])
        elif self.year==2023:
            naiset_in=np.array([0.003205790057350425,0.003796594574976805,0.003099075124529165,0.00177047762767568,0.0006200474002720954,0.001277448230666056,0.0004503758438503703,0.0008680131127182865,0.0004114389500818496,0.001025903619368891,0.0005338625625263971,0.0003,0.0003,0.0008670365046296052,0.0009697060054499957,0.001142478430240667,0.0009314680177790975,0.0009542926851624869,0.001722382711956906,0.0005042843188722066,0.0009251415543630559,0.001120091350068751,0.001811496276883386,0.001894849200171502,0.001503383079309587,0.001920928068510326,0.00234246722366471,0.003066757138882015,0.003463985397775599,0.003594139004836162,0.003533875030230373,0.004616499062404188,0.004625794375501741,0.006365458532706194,0.00582622382854179,0.007167964524526807,0.007607534063722007,0.009107992384524387,0.01410714278597224,0.01663342513256605,0.02456026635639217,0.02987429753666502,0.03312814286814857,0.03788339288869265,0.0431958848277243,0.04906561868524352,0.05549259446125031,0.06247681215574467,0.07001827176872659,0.07811697330019608,0.08677291675015315,0.09598610211859779,0.10575652940553])
            miehet_in=np.array([0.003317266390741124,0.003049701163393693,0.002826735236513108,0.002764654516269687,0.001913932491803634,0.0007672776413688443,0.0008937034463201729,0.000666636866999967,0.001144919180944081,0.0008103175656282817,0.0008070382578931346,0.0003,0.0003,0.0003,0.001008303560552758,0.0003,0.001424897054394423,0.0009308942949620175,0.001030422283670425,0.001208345889770902,0.001049431458415809,0.001183191127039756,0.001670823731093689,0.001492414552937948,0.001530763974692262,0.0007885456223264353,0.00195906125367179,0.003582427851647383,0.003807711764691512,0.004035257137803676,0.003702864315087985,0.004269913816260024,0.004818814175162051,0.005600151544111258,0.006158211115672928,0.007963569488569376,0.007465054850861024,0.01002862342637888,0.01211441928357358,0.01745274275360443,0.02149143620855803,0.02772341757053785,0.03132145156767138,0.03612320963869584,0.04092496770972029,0.04578335058501085,0.05064173346030142,0.05550011633559198,0.06035849921088254,0.06521688208617311,0.07007526496146368,0.07493364783675426,0.07979203071204483])
        elif self.year==2024:
            naiset_in=np.array([0.003205790057350425,0.003796594574976805,0.003099075124529165,0.00177047762767568,0.0006200474002720954,0.001277448230666056,0.0004503758438503703,0.0008680131127182865,0.0004114389500818496,0.001025903619368891,0.0005338625625263971,0.0003,0.0003,0.0008670365046296052,0.0009697060054499957,0.001142478430240667,0.0009314680177790975,0.0009542926851624869,0.001722382711956906,0.0005042843188722066,0.0009251415543630559,0.001120091350068751,0.001811496276883386,0.001894849200171502,0.001503383079309587,0.001920928068510326,0.00234246722366471,0.003066757138882015,0.003463985397775599,0.003594139004836162,0.003533875030230373,0.004616499062404188,0.004625794375501741,0.006365458532706194,0.00582622382854179,0.007167964524526807,0.007607534063722007,0.009107992384524387,0.01410714278597224,0.01663342513256605,0.02456026635639217,0.02987429753666502,0.03312814286814857,0.03788339288869265,0.0431958848277243,0.04906561868524352,0.05549259446125031,0.06247681215574467,0.07001827176872659,0.07811697330019608,0.08677291675015315,0.09598610211859779,0.10575652940553])
            miehet_in=np.array([0.003317266390741124,0.003049701163393693,0.002826735236513108,0.002764654516269687,0.001913932491803634,0.0007672776413688443,0.0008937034463201729,0.000666636866999967,0.001144919180944081,0.0008103175656282817,0.0008070382578931346,0.0003,0.0003,0.0003,0.001008303560552758,0.0003,0.001424897054394423,0.0009308942949620175,0.001030422283670425,0.001208345889770902,0.001049431458415809,0.001183191127039756,0.001670823731093689,0.001492414552937948,0.001530763974692262,0.0007885456223264353,0.00195906125367179,0.003582427851647383,0.003807711764691512,0.004035257137803676,0.003702864315087985,0.004269913816260024,0.004818814175162051,0.005600151544111258,0.006158211115672928,0.007963569488569376,0.007465054850861024,0.01002862342637888,0.01211441928357358,0.01745274275360443,0.02149143620855803,0.02772341757053785,0.03132145156767138,0.03612320963869584,0.04092496770972029,0.04578335058501085,0.05064173346030142,0.05550011633559198,0.06035849921088254,0.06521688208617311,0.07007526496146368,0.07493364783675426,0.07979203071204483])
        else:
            print("Error: Unknown year in ['tk in']")
            
        # puolet sv:llä olevisa vain 3 kk, puolet yhden vuoden, skaalataan alkavuus
        
        # naisilla liian korkea alkavuus! FIXME
        
        svrate_men,svrate_women,mfactor_3m,wfactor_3m=self.get_svrate()

        mfactor_1y=1.0-mfactor_3m
        mlfactor_3m=mfactor_3m*0.25+mfactor_1y*1.0

        wfactor_1y=1.0-wfactor_3m
        wlfactor_3m=wfactor_3m*0.25+wfactor_1y*1.0

        # skaalataan päivät oikeiksi
        svrate_men_scaled = svrate_men/mlfactor_3m
        svrate_women_scaled = svrate_women/wlfactor_3m
        
        sv_miehet = np.maximum(miehet_in,svrate_men_scaled)
        sv_naiset = np.maximum(naiset_in,svrate_women_scaled)

        # vuoden kestäviä sairauspoissaoloja
        sv_miehet_1y = np.maximum(miehet_in,mfactor_1y*sv_miehet)
        sv_naiset_1y = np.maximum(naiset_in,wfactor_1y*sv_naiset)
        
        # mikä osuus menee vuoden kuluttua tk:lle sv:tlä
        proportion_miehet=miehet_in/sv_miehet_1y
        proportion_naiset=naiset_in/sv_naiset_1y
        for g in range(3):
            prop[18:71,g]=proportion_miehet
            prop[18:71,g+3]=proportion_naiset
        prop[71:(self.max_age+1),:]=prop[70,:]

        for s in range(self.n_empl):
            for g in range(3):
                disab[18:71,g,s]=dfactor[g]*sv_miehet*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            for g in range(3,6):
                disab[18:71,g,s]=dfactor[g]*sv_naiset*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            
        #disab[18:63,:,:]=disab[18:63,:,:]
            
        disab=1-(1-disab)**self.timestep
        prop2=1-prop**self.timestep
        sv_3m=np.zeros((self.max_age+1,6))
        for k in range(3):
            sv_3m[18:71,k]=mfactor_3m
            sv_3m[18:71,3+k]=wfactor_3m
        
        return disab,prop,sv_3m

    def get_svrate(self):
        '''
        sairaspäivärahalla olevien 
        vuosi?
        '''
        age=np.array([18,22.5,27.5,32.5,37.5,42.5,47.5,52.5,57.5,62.5,67])
        
        #  3kk tasolla, laskettu sairaspoissaolojen htv-luvuista ja lisätty omavastuupäivät (=10*jaksot)
        # laskettu suhteessa väestöön
        #rate_men=np.array([0.002567698,0.009325702,0.010736583,0.011060345,0.011702349,0.012944926,0.015243392,0.019080672,0.025693238,0.022590949,0.002527385])
        #rate_women=np.array([0.00426013,0.014350251,0.01567143,0.016508131,0.018067472,0.019533182,0.022035272,0.025813377,0.029899956,0.026907464,0.002302255])
        
        # 3kk tasolla, laskettu sairaspoissaolojen htv-luvuista ja lisätty omavastuupäivät (=10*jaksot)
        # laskettu suhteessa työvoimaan

        if self.year==2018:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2019:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2020:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2021:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2022:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2023:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2024:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        else:
            print("Error: Unknown year in ['sv in']")

        
        # 1v tasolla
        #rate=1-(1-rate)**(1.0/self.timestep)
        
        x = np.linspace(18, 70, num=53, endpoint=True)
        f = interp1d(age, rate_men, fill_value='extrapolate')
        xmen = f(x)
        f = interp1d(age, rate_women, fill_value='extrapolate')
        xwomen = f(x)
        f = interp1d(age, ratio_3m_men, fill_value='extrapolate')
        threem = f(x)
        f = interp1d(age, ratio_3m_women, fill_value='extrapolate')
        threew = f(x)
        
        return xmen,xwomen,threem,threew
        
    def get_birth_rate_v1(self,debug=False,symmetric=False):
        '''
        Syntyvyysdata
        '''
        birth=np.zeros((self.max_age+1,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        elif symmetric:
            dfactor=np.array([0.8,1.0,1.25,0.8,1.0,1.25])
        else:
            dfactor=np.array([0.75,1.0,1.25,0.5,1.0,1.5])
            
        for g in range(self.n_groups):
            factor=dfactor[g] # tämä vaikeuttaa sovitetta
            birth[15,g]=0.000177167*factor
            birth[16,g]=0.001049171*factor
            birth[17,g]=0.002303504*factor
            birth[18,g]=0.00630474*factor
            birth[19,g]=0.014399394*factor
            birth[20,g]=0.023042239*factor
            birth[21,g]=0.03088312*factor
            birth[22,g]=0.039755923*factor
            birth[23,g]=0.047483352*factor
            birth[24,g]=0.055630287*factor
            birth[25,g]=0.067942889*factor
            birth[26,g]=0.077108925*factor
            birth[27,g]=0.085396679*factor
            birth[28,g]=0.096968809*factor
            birth[29,g]=0.10081728*factor
            birth[30,g]=0.105586061*factor
            birth[31,g]=0.1124004*factor
            birth[32,g]=0.102667839*factor
            birth[33,g]=0.098528489*factor
            birth[34,g]=0.084080311*factor
            birth[35,g]=0.072335459*factor
            birth[36,g]=0.065203338*factor
            birth[37,g]=0.053073374*factor
            birth[38,g]=0.044054569*factor
            birth[39,g]=0.032984136*factor
            birth[40,g]=0.024135797*factor
            birth[41,g]=0.0174215*factor
            birth[42,g]=0.011621238*factor
            birth[43,g]=0.006909705*factor
            birth[44,g]=0.003977037*factor
            birth[45,g]=0.002171444*factor
            birth[46,g]=0.00115119*factor
            birth[47,g]=0.000712692*factor
            birth[48,g]=9.16478E-05*factor
            birth[49,g]=0.000113167*factor

        # syntyvyys on lasten määrä suhteessa naisten määrään
        # ei siis tarvetta kertoa kahdella, vaikka isät pääsevät isyysvapaalle

        birth=1-(1-birth)**self.timestep

        return birth
        
    def get_birth_rate_v2(self,debug=False,symmetric=False):
        '''
        Syntyvyysdata
        Päivitetty 13.10.2021
        '''
        birth=np.zeros((self.max_age+1,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        elif symmetric:
            dfactor=np.array([0.8,1.0,1.25,0.8,1.0,1.25])
        else:
            #dfactor=np.array([0.75,1.0,1.375,0.6,1.0,1.6])
            dfactor=np.array([0.6,1.05,0.,0.75,1.05,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            
        #if debug:
        #    dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        #else:
        #    dfactor=np.array([0.835,1.0,1.25,0.8,1.0,1.3])
            
        if self.year==2018:
            bdata=np.array([0.00569959,0.011937244,0.020951263,0.028827696,0.034751037,0.043394825,0.051886089,0.064069418,0.072356108,0.08,0.090506401,0.096027745,0.100822746,0.103865916,0.098191371,0.088888239,0.082899639,0.072963407,0.061780343,0.051564837,0.042105888,0.033690476,0.024182459,0.016327851,0.011475651,0.006451613,0.003594199,0.001798997,0.000968863,0.000512246,0.000217216,0.000122298,8.5022E-05,5.54493E-05,5.50858E-05,2.74183E-05,0])
        elif self.year==2019:
            bdata=np.array([0.005106294,0.01251173,0.017809014,0.026994415,0.032204898,0.043130066,0.048894492,0.057542032,0.069026601,0.074917822,0.084601199,0.091066413,0.096168316,0.097412349,0.094562935,0.087455326,0.082835408,0.073790916,0.063865266,0.048179811,0.03848964,0.031461604,0.023676012,0.016556785,0.010069873,0.006201687,0.004392827,0.002779339,0.001313062,0.000600901,0.00032001,6.20636E-05,9.18189E-05,0,0,0,0])
        elif self.year==2020:
            bdata=np.array([0.005688202,0.010485019,0.018627077,0.023832221,0.033648899,0.039267615,0.047328391,0.060260487,0.066735234,0.079297218,0.084627153,0.094005372,0.099303578,0.102518399,0.096110234,0.090256969,0.083263698,0.075095719,0.063635595,0.052059117,0.040059723,0.033487533,0.024905683,0.016563637,0.010233222,0.006797141,0.003957784,0.002344314,0.001060346,0.000483592,0.00023331,0.000160041,0.000124066,3.06194E-05,0,2.78002E-05,5.52318E-05])
        elif self.year==2021:
            bdata=np.array([0.005688202,0.010485019,0.018627077,0.023832221,0.033648899,0.039267615,0.047328391,0.060260487,0.066735234,0.079297218,0.084627153,0.094005372,0.099303578,0.102518399,0.096110234,0.090256969,0.083263698,0.075095719,0.063635595,0.052059117,0.040059723,0.033487533,0.024905683,0.016563637,0.010233222,0.006797141,0.003957784,0.002344314,0.001060346,0.000483592,0.00023331,0.000160041,0.000124066,3.06194E-05,0,2.78002E-05,5.52318E-05])
        elif self.year==2022:
            bdata=np.array([0.005688202,0.010485019,0.018627077,0.023832221,0.033648899,0.039267615,0.047328391,0.060260487,0.066735234,0.079297218,0.084627153,0.094005372,0.099303578,0.102518399,0.096110234,0.090256969,0.083263698,0.075095719,0.063635595,0.052059117,0.040059723,0.033487533,0.024905683,0.016563637,0.010233222,0.006797141,0.003957784,0.002344314,0.001060346,0.000483592,0.00023331,0.000160041,0.000124066,3.06194E-05,0,2.78002E-05,5.52318E-05])
        elif self.year==2023:
            bdata=np.array([0.005688202,0.010485019,0.018627077,0.023832221,0.033648899,0.039267615,0.047328391,0.060260487,0.066735234,0.079297218,0.084627153,0.094005372,0.099303578,0.102518399,0.096110234,0.090256969,0.083263698,0.075095719,0.063635595,0.052059117,0.040059723,0.033487533,0.024905683,0.016563637,0.010233222,0.006797141,0.003957784,0.002344314,0.001060346,0.000483592,0.00023331,0.000160041,0.000124066,3.06194E-05,0,2.78002E-05,5.52318E-05])
        else:
            print('Unknown year',self.year)

        for g in range(self.n_groups):
            factor=dfactor[g] # tämä vaikeuttaa sovitetta
            birth[18:55,g]=bdata*factor

        # syntyvyys on lasten määrä suhteessa naisten määrään
        # ei siis tarvetta kertoa kahdella, vaikka isät pääsevät isyysvapaalle

        birth=1-(1-birth)**self.timestep

        return birth        
        
    def get_birth_rate_v4(self,debug=False,symmetric=False):
        '''
        Syntyvyysdata
        Päivitetty 13.10.2021
        '''
        birth=np.zeros((self.max_age+1,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        elif symmetric:
            dfactor=np.array([0.8,1.0,1.25,0.8,1.0,1.25])
        else:
            #dfactor=np.array([0.75,1.0,1.375,0.6,1.0,1.6])
            dfactor=np.array([0.6,1.05,0.,0.75,1.05,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            dfactor *= 1.1
            
        ### ['syntyneet in']
        if self.year==2018:
            naiset_in=np.array([0.005739483446489816,0.012047778045506179,0.02120820376646518,0.02927337500840223,0.03535270256900702,0.04428300694883133,0.052924536910302036,0.06543048769384845,0.07394656308851225,0.08182598655969685,0.09255092200239633,0.09812680544387861,0.10303030303030303,0.10645100620650742,0.10060636059893578,0.09108074087394354,0.08510948905109489,0.07493702770780857,0.06358821291663008,0.052996503074882434,0.04334668174731758,0.03475377624953948,0.02497915830425788,0.016887266088544045,0.011892781996157717,0.0066985945472188314,0.003744586630197649,0.0018800390469648216,0.0010159753363228699,0.000538521086466292,0.00022922260789835615,0.000129680661371373,9.041591320072333e-05,5.942653394740752e-05,5.931725835631877e-05,2.9667428130655354e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.005320184260040226,0.011150047785919083,0.01979261771227338,0.02749368686868687,0.03261134095887077,0.04113849765258216,0.0494332225347311,0.06088331638992432,0.06785473201026057,0.07551293609813403,0.08515730034955633,0.09053441406786647,0.09501109558642229,0.09718962852727377,0.09178921222727145,0.0833173406442769,0.07776443910897693,0.06873014622876795,0.057202274402442875,0.048762898036169976,0.03948101124846865,0.032086167800453515,0.02272599584246306,0.015551881637571104,0.01084206722081677,0.006070749765964086,0.003457398833503698,0.0017028522775649213,0.0009222158621128284,0.0005008922142566446,0.00021263023601956197,0.00011860285832888572,8.381527114240215e-05,5.4519681605059426e-05,5.446029844243546e-05,2.7221995372260786e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.005143097054089987,0.012640449438202247,0.018056660555536338,0.027443833023728575,0.03278853575863342,0.04397009639976392,0.04997328472200396,0.058764849913847825,0.07054492788606602,0.07672042853379388,0.08661277951501563,0.09319745666753768,0.0984096899339592,0.0996778864623659,0.09697650472713658,0.08971594060016021,0.08494485458947305,0.07588817705299941,0.06571158960281376,0.049673126313331775,0.03964359892838867,0.03244891735285148,0.024478527607361963,0.01713280237080941,0.010444261745988247,0.006440978051833084,0.004573504996397582,0.002902142368017739,0.0013756154068925571,0.0006319337171745541,0.0003373591525538088,6.565341561894757e-05,9.778994719342852e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.004875460183741832,0.011636175576960372,0.01657932348737494,0.025430334524196168,0.030651942021710486,0.04046713742531233,0.04623168178646197,0.0547112462006079,0.06549569991876068,0.07018530419880034,0.07939856130672292,0.08550651287925201,0.0903996300225795,0.091637687459248,0.08829043804329299,0.0816372301654051,0.07748936634311267,0.06922566077832382,0.06009257080097278,0.04465902232951117,0.036437583001328024,0.02957116255801673,0.022573618850951882,0.015584196782073961,0.009604883649295735,0.005865510243793956,0.004138321995464852,0.002676369760028869,0.001243943957051198,0.0005723006486074017,0.0003135877575339459,6.090319437254484e-05,8.911067545891998e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.005727417359024218,0.010591288489864627,0.018900464592425736,0.024267637372161553,0.03430309811874956,0.040053360013340006,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.10172428732345551,0.10497806823868822,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.025719068634910972,0.017164224851345552,0.010611061414602548,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.0011087920688755545,0.000507964152244113,0.0002458210422812193,0.00016914749661705008,0.00013168724279835392,3.270538984824699e-05,0.0,3.0070666065253345e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.022163822309470286,0.031651287345937924,0.03735730504836853,0.044326718745323394,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.031734215605183344,0.023418879219555457,0.015791996841600632,0.00964531052852937,0.006494233568469376,0.0037495833796244863,0.0022091310751104565,0.0010222182135233456,0.0004584452157967123,0.00022286605749944285,0.00015702531248037183,0.00012205541315757354,2.976899261728983e-05,0.0,2.7462719358470875e-05,5.4860653938994955e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.005503278187315283,0.010546533961934695,0.01858388704318937,0.02417460975272828,0.03313965272616715,0.04080176660438254,0.04789625173830083,0.062290626382655964,0.06869120716251777,0.0789619478058026,0.08662993039443155,0.09231200897867564,0.0997394653375623,0.09955888100954827,0.09557794969882098,0.08483641536273115,0.08384673178061608,0.07689566069678339,0.06522304027717626,0.05269940884767321,0.03921676778819636,0.03230333136875193,0.024492753623188406,0.016459453898833142,0.010147492625368732,0.006879373739769897,0.003948291998128217,0.0022826373240467063,0.0010202856799903972,0.00043591979075850045,0.0002414958945697923,0.00016649462222370216,0.00012809427738815767,3.102603083987466e-05,0.0,2.842201000454752e-05,5.562818123661447e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.022163822309470286,0.031651287345937924,0.03735730504836853,0.044326718745323394,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.031734215605183344,0.023418879219555457,0.015791996841600632,0.00964531052852937,0.006494233568469376,0.0037495833796244863,0.0022091310751104565,0.0010222182135233456,0.0004584452157967123,0.00022286605749944285,0.00015702531248037183,0.00012205541315757354,2.976899261728983e-05,0.0,2.7462719358470875e-05,5.4860653938994955e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.005727417359024218,0.010591288489864627,0.018900464592425736,0.024267637372161553,0.03430309811874956,0.040053360013340006,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.10172428732345551,0.10497806823868822,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.025719068634910972,0.017164224851345552,0.010611061414602548,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.0011087920688755545,0.000507964152244113,0.0002458210422812193,0.00016914749661705008,0.00013168724279835392,3.270538984824699e-05,0.0,3.0070666065253345e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.022163822309470286,0.031651287345937924,0.03735730504836853,0.044326718745323394,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.031734215605183344,0.023418879219555457,0.015791996841600632,0.00964531052852937,0.006494233568469376,0.0037495833796244863,0.0022091310751104565,0.0010222182135233456,0.0004584452157967123,0.00022286605749944285,0.00015702531248037183,0.00012205541315757354,2.976899261728983e-05,0.0,2.7462719358470875e-05,5.4860653938994955e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.005727417359024218,0.010591288489864627,0.018900464592425736,0.024267637372161553,0.03430309811874956,0.040053360013340006,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.10172428732345551,0.10497806823868822,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.025719068634910972,0.017164224851345552,0.010611061414602548,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.0011087920688755545,0.000507964152244113,0.0002458210422812193,0.00016914749661705008,0.00013168724279835392,3.270538984824699e-05,0.0,3.0070666065253345e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.022163822309470286,0.031651287345937924,0.03735730504836853,0.044326718745323394,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.031734215605183344,0.023418879219555457,0.015791996841600632,0.00964531052852937,0.006494233568469376,0.0037495833796244863,0.0022091310751104565,0.0010222182135233456,0.0004584452157967123,0.00022286605749944285,0.00015702531248037183,0.00012205541315757354,2.976899261728983e-05,0.0,2.7462719358470875e-05,5.4860653938994955e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        else:
            print('Unknown year',self.year)
            
        bdata=naiset_in[:55-18]

        for g in range(self.n_groups):
            factor=dfactor[g] # tämä vaikeuttaa sovitetta
            birth[18:55,g]=bdata*factor

        # syntyvyys on lasten määrä suhteessa naisten määrään
        # ei siis tarvetta kertoa kahdella, vaikka isät pääsevät isyysvapaalle

        birth=1-(1-birth)**self.timestep

        return birth                
        
    def get_birth_rate_v5(self,debug=False,symmetric=False):
        '''
        Syntyvyysdata
        Päivitetty 13.10.2021
        '''
        birth=np.zeros((self.max_age+1,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        elif symmetric:
            dfactor=np.array([0.8,1.0,1.25,0.8,1.0,1.25])
        else:
            #dfactor=np.array([0.75,1.0,1.375,0.6,1.0,1.6])
            dfactor=np.array([0.6,1.05,0.,0.75,1.05,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            dfactor *= 1.1
            
        ### ['syntyneet in']
        if self.year==2018:
            naiset_in=np.array([0.005739483446489816,0.01204777804550618,0.02120820376646518,0.02927337500840223,0.03535270256900702,0.04428300694883133,0.05292453691030204,0.06543048769384845,0.07394656308851225,0.08182598655969685,0.09255092200239633,0.09812680544387861,0.103030303030303,0.1064510062065074,0.1006063605989358,0.09108074087394354,0.08510948905109489,0.07493702770780857,0.06358821291663008,0.05299650307488243,0.04334668174731758,0.03475377624953948,0.02497915830425788,0.01688726608854405,0.01189278199615772,0.006698594547218831,0.003744586630197649,0.001880039046964822,0.00101597533632287,0.000538521086466292,0.0002292226078983561,0.000129680661371373,9.041591320072333e-05,5.942653394740752e-05,5.931725835631877e-05,2.966742813065535e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.005320184260040226,0.01115004778591908,0.01979261771227338,0.02749368686868687,0.03261134095887077,0.04113849765258216,0.0494332225347311,0.06088331638992432,0.06785473201026057,0.07551293609813403,0.08515730034955633,0.09053441406786647,0.09501109558642229,0.09718962852727377,0.09178921222727145,0.0833173406442769,0.07776443910897693,0.06873014622876795,0.05720227440244288,0.04876289803616998,0.03948101124846865,0.03208616780045351,0.02272599584246306,0.0155518816375711,0.01084206722081677,0.006070749765964086,0.003457398833503698,0.001702852277564921,0.0009222158621128284,0.0005008922142566446,0.000212630236019562,0.0001186028583288857,8.381527114240215e-05,5.451968160505943e-05,5.446029844243546e-05,2.722199537226079e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.005143097054089987,0.01264044943820225,0.01805666055553634,0.02744383302372858,0.03278853575863342,0.04397009639976392,0.04997328472200396,0.05876484991384782,0.07054492788606602,0.07672042853379388,0.08661277951501563,0.09319745666753768,0.0984096899339592,0.0996778864623659,0.09697650472713658,0.08971594060016021,0.08494485458947305,0.07588817705299941,0.06571158960281376,0.04967312631333178,0.03964359892838867,0.03244891735285148,0.02447852760736196,0.01713280237080941,0.01044426174598825,0.006440978051833084,0.004573504996397582,0.002902142368017739,0.001375615406892557,0.0006319337171745541,0.0003373591525538088,6.565341561894757e-05,9.778994719342852e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.004875460183741832,0.01163617557696037,0.01657932348737494,0.02543033452419617,0.03065194202171049,0.04046713742531233,0.04623168178646197,0.0547112462006079,0.06549569991876068,0.07018530419880034,0.07939856130672292,0.08550651287925201,0.0903996300225795,0.091637687459248,0.08829043804329299,0.0816372301654051,0.07748936634311267,0.06922566077832382,0.06009257080097278,0.04465902232951117,0.03643758300132802,0.02957116255801673,0.02257361885095188,0.01558419678207396,0.009604883649295735,0.005865510243793956,0.004138321995464852,0.002676369760028869,0.001243943957051198,0.0005723006486074017,0.0003135877575339459,6.090319437254484e-05,8.911067545891998e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.005539976745776623,0.010654060537642,0.01885599915727378,0.02462274438073798,0.03377401363354679,0.04165077163169759,0.04887304887304887,0.06379260122341975,0.07020309746823704,0.08075145370508424,0.088808943331153,0.09452936444086886,0.1021817337820587,0.1018769819729737,0.0978689818468824,0.08698696070709723,0.08612174342511421,0.07906792084045933,0.06722013926084627,0.05429198175835594,0.04047591938973016,0.03328032383981495,0.02527896610524426,0.01705237515225335,0.01051891263798428,0.007147258163894023,0.004109338853037867,0.002377758809901231,0.001065062807380259,0.0004556253457870928,0.0002549255253286718,0.0001763730643056192,0.0001362351418548414,3.316969616558312e-05,0.0,3.079955648638659e-05,6.049240820277055e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2024:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        else:
            print("Error: Unknown year in ['syntyneet in']")
            
        bdata=naiset_in[:55-18]

        for g in range(self.n_groups):
            factor=dfactor[g] # tämä vaikeuttaa sovitetta
            birth[18:55,g]=bdata*factor

        # syntyvyys on lasten määrä suhteessa naisten määrään
        # ei siis tarvetta kertoa kahdella, vaikka isät pääsevät isyysvapaalle

        birth=1-(1-birth)**self.timestep

        return birth                        
        
    def get_pinkslip_rate(self):
        pinkslip_intensity=np.zeros(6)
        if False:
            pinkslip_intensity[0:3]=0.05 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[3:6]=0.05 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
        else:
            pinkslip_intensity[0]=0.07 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[1]=0.04 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[2]=0.02 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[3]=0.05 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
            pinkslip_intensity[4]=0.04 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
            pinkslip_intensity[5]=0.02 # todennäköisyys tulla irtisanotuksi vuodessa, naiset

        return pinkslip_intensity
        
    def map_5year(self,mar):
        arr=np.zeros(self.max_age+2)
        mins=np.array([15,20,25,30,35,40,45,50,55,60,65,70])
        maxs=np.array([20,25,30,35,40,45,50,55,60,65,70,75])
        for i,mini in enumerate(mins):
            for age in range(mini,maxs[i]):
                if age>=self.min_age and age<self.max_age:
                    arr[age]=mar[i]
                    
        return arr
        
    def get_initial_marriage_ratio(self):
        return 0.0367

    def get_marriage_rate(self):
        '''
        Sisältää avoliitot ja avioliitot
        '''
        marriage_rate=np.zeros(105)
        marriage_rate[18:]=np.array([0.061535,0.081337,0.080677,0.073297,0.088120,0.094667,0.099613,0.094117,0.115097,0.107895,0.121581,0.121740,0.116324,0.127059,0.109727,0.119645,0.113208,0.119336,0.120546,0.110704,0.125037,0.105828,0.119247,0.107601,0.109261,0.106336,0.104943,0.104873,0.103252,0.101176,0.100522,0.097700,0.096217,0.094577,0.094306,0.094023,0.093713,0.096377,0.093411,0.091398,0.090822,0.093518,0.093685,0.091468,0.090411,0.092768,0.095283,0.091210,0.095431,0.096708,0.092017,0.092312,0.089747,0.086757,0.085602,0.084154,0.082202,0.078667,0.074467,0.071651,0.066600,0.062303,0.057827,0.054465,0.047675,0.044414,0.040251,0.035600,0.031737,0.028336,0.025519,0.022941,0.019428,0.016490,0.014366,0.012364,0.010709,0.007886,0.007179,0.007030,0.005709,0.004829,0.003198,0.002946,0.062049,0.003788,0.003333])
        
        marriage_rate=1-(1-marriage_rate)**self.timestep
        
        return marriage_rate

    def get_divorce_rate(self):

        divorce_rate=np.zeros(105)
        divorce_rate[18:]=np.array([0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.05,0.050000,0.050000])

        divorce_rate=1-(1-divorce_rate)**self.timestep

        return divorce_rate

    def setup_salaries_v3(self,min_retirementage):
        # TK:n aineisto vuodelta 2018
        # iät 18-70
        
        if self.year==2018:
            palkat_ika_miehet=12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2019:
            ind=1.019
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
#             palkat_ika_miehet=12.5*np.array([2039,2334,2461,2498,2612,2683,2725,2833,2915,3014,3115,3196,3325,3389,3477,3540,3601,3690,3724,3863,3917,4018,4073,4150,4189,4212,4301,4273,4261,4323,4273,4225,4239,4188,4213,4174,4159,4165,4131,4136,4167,4135,4117,4134,4126,4101,4257,4368,4417,3916,4369,4045,3165,3923])#,2521,2982,3238,2898,3489,3063,6388,6388])
#             palkat_ika_naiset=12.5*np.array([1926,2107,2188,2235,2283,2347,2417,2541,2639,2722,2796,2845,2907,2980,3032,3073,3109,3150,3225,3281,3333,3402,3467,3462,3492,3546,3593,3577,3603,3542,3525,3511,3515,3470,3484,3482,3477,3480,3408,3417,3428,3381,3361,3351,3292,3314,3461,3553,3583,3441,3039,2797,3320,2168])#,2360,3316,4525,4525,4525,2449,2449,1393])
#             palkat_ika_miehet[0:2]=max(palkat_ika_miehet[0:2])
#             palkat_ika_naiset[0:2]=max(palkat_ika_naiset[0:2])
        elif self.year==2020:
            ind=1.019*1.013
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2021:
            ind=1.019*1.013*1.019
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2022:
            ind=1.019*1.013*1.019*1.019 # arvio
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2023:
            ind=1.019*1.013*1.019*1.019*1.019 # arvio
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        else:
            print('Unknown year ',self.year)
            error(1001)
            
        def map_age18(x):
            return int(x-18)
            
        def ifunc(palkat,x1,x2):
            x = np.linspace(18, 72, num=54, endpoint=True)
            f = interp1d(x, palkat, fill_value='extrapolate')
            n_time = int(np.round((x2-x1)*self.inv_timestep))+2
            palkat_x = np.linspace(x1, x2, num=n_time, endpoint=True)
        
            return f(palkat_x)        

        def gfunc(palkat,x1,x2):
            x = np.linspace(18, 73, num=55, endpoint=True)
            n_time = int(np.round((x2-x1)*self.inv_timestep))+2
            palkat_x = np.linspace(x1, x2, num=n_time, endpoint=True)
            g=np.zeros((n_time,3))
            for k in range(3):
                f = interp1d(x, palkat[:,k],fill_value='extrapolate')
                g[:,k]=f(palkat_x)
        
            return g
        
        # filtteri
        m_age=int(min_retirementage-1)
        palkat_miehet_ve=palkat_ika_miehet[map_age18(m_age)]
        palkat_ika_miehet[map_age18(m_age):]=np.minimum(palkat_ika_miehet[map_age18(m_age):],palkat_miehet_ve)
        palkat_naiset_ve=palkat_ika_naiset[map_age18(m_age)]
        palkat_ika_naiset[map_age18(m_age):]=np.minimum(palkat_ika_naiset[map_age18(m_age):],palkat_naiset_ve)

        palkat_ika_miehet=ifunc(palkat_ika_miehet,self.min_age,self.max_age)
        palkat_ika_naiset=ifunc(palkat_ika_naiset,self.min_age,self.max_age)
        
        g_r=np.array([[0.81436,1.00992,1.2469],[0.81436,1.00992,1.2469],[0.81436,1.00992,1.2469],[0.8144725,1.011105,1.2677425],[0.814585,1.01229,1.288585],[0.8146975,1.013475,1.3094275],[0.81481,1.01466,1.33027],[0.81481,1.01466,1.33027],[0.798635,1.0116225,1.34756],[0.78246,1.008585,1.36485],[0.766285,1.0055475,1.38214],[0.75011,1.00251,1.39943],[0.75011,1.00251,1.39943],[0.74420478,0.99822499,1.40395702],[0.73829957,0.99393997,1.40848403],[0.73239435,0.98965496,1.41301105],[0.72648913,0.98536995,1.41753806],[0.72058391,0.98108493,1.42206508],[0.7146787,0.97679992,1.4265921],[0.70877348,0.9725149,1.43111911],[0.70286826,0.96822989,1.43564613],[0.69696304,0.96394488,1.44017314],[0.69105783,0.95965986,1.44470016],[0.68515261,0.95537485,1.44922718],[0.67924739,0.95108984,1.45375419],[0.67334218,0.94680482,1.45828121],[0.66743696,0.94251981,1.46280822],[0.66153174,0.93823479,1.46733524],[0.65562652,0.93394978,1.47186226],[0.64972131,0.92966477,1.47638927],[0.64381609,0.92537975,1.48091629],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433]])
        g_r=gfunc(g_r,self.min_age,self.max_age)
        
        return palkat_ika_miehet,palkat_ika_naiset,g_r
        
    def setup_salaries_v4(self,min_retirementage):
        # TK:n aineisto vuodelta 2018
        # iät 18-70
        # päivitetty 2022
        
        if self.year==2018:
            palkat_ika_miehet=12.5*np.array([2039.15,2256.56,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=12.5*np.array([2058.55,2166.68,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2019:
            ind=1.019
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2020:
            ind=1.019*1.013
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2021:
            ind=1.019*1.013*1.019
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2022:
            ind=1.019*1.013*1.019*1.019 # arvio
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2023:
            ind=1.019*1.013*1.019*1.019*1.019 # arvio
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2024:
            ind=1.019*1.013*1.019*1.019*1.019*1.02 # arvio
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        else:
            print('Unknown year ',self.year)
            error(1001)
            
        def map_age18(x):
            return int(x-18)
            
        def ifunc(palkat,x1,x2):
            x = np.linspace(18, 72, num=54, endpoint=True)
            f = interp1d(x, palkat, fill_value='extrapolate')
            n_time = int(np.round((x2-x1)*self.inv_timestep))+2
            palkat_x = np.linspace(x1, x2, num=n_time, endpoint=True)
        
            return f(palkat_x)        

        def gfunc(palkat,x1,x2):
            x = np.linspace(18, 73, num=55, endpoint=True)
            n_time = int(np.round((x2-x1)*self.inv_timestep))+2
            palkat_x = np.linspace(x1, x2, num=n_time, endpoint=True)
            g=np.zeros((n_time,3))
            for k in range(3):
                f = interp1d(x, palkat[:,k],fill_value='extrapolate')
                g[:,k]=f(palkat_x)
        
            return g
        
        # filtteri
        m_age=int(min_retirementage-1)
        palkat_miehet_ve=palkat_ika_miehet[map_age18(m_age)]
        palkat_ika_miehet[map_age18(m_age):]=np.minimum(palkat_ika_miehet[map_age18(m_age):],palkat_miehet_ve)
        palkat_naiset_ve=palkat_ika_naiset[map_age18(m_age)]
        palkat_ika_naiset[map_age18(m_age):]=np.minimum(palkat_ika_naiset[map_age18(m_age):],palkat_naiset_ve)

        palkat_ika_miehet=ifunc(palkat_ika_miehet,self.min_age,self.max_age)
        palkat_ika_naiset=ifunc(palkat_ika_naiset,self.min_age,self.max_age)
        
        g_r=np.array([[0.81436,1.00992,1.2469],[0.81436,1.00992,1.2469],[0.81436,1.00992,1.2469],[0.8144725,1.011105,1.2677425],[0.814585,1.01229,1.288585],[0.8146975,1.013475,1.3094275],[0.81481,1.01466,1.33027],[0.81481,1.01466,1.33027],[0.798635,1.0116225,1.34756],[0.78246,1.008585,1.36485],[0.766285,1.0055475,1.38214],[0.75011,1.00251,1.39943],[0.75011,1.00251,1.39943],[0.74420478,0.99822499,1.40395702],[0.73829957,0.99393997,1.40848403],[0.73239435,0.98965496,1.41301105],[0.72648913,0.98536995,1.41753806],[0.72058391,0.98108493,1.42206508],[0.7146787,0.97679992,1.4265921],[0.70877348,0.9725149,1.43111911],[0.70286826,0.96822989,1.43564613],[0.69696304,0.96394488,1.44017314],[0.69105783,0.95965986,1.44470016],[0.68515261,0.95537485,1.44922718],[0.67924739,0.95108984,1.45375419],[0.67334218,0.94680482,1.45828121],[0.66743696,0.94251981,1.46280822],[0.66153174,0.93823479,1.46733524],[0.65562652,0.93394978,1.47186226],[0.64972131,0.92966477,1.47638927],[0.64381609,0.92537975,1.48091629],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433]])
        g_r=gfunc(g_r,self.min_age,self.max_age)
        
        return palkat_ika_miehet,palkat_ika_naiset,g_r
        
        
    def get_kassanjasenyys_rate(self):
        rate_age=np.array([18,30,40,50,60,74])
        #rate_obs=np.array([0.429,0.836,0.917,0.946,0.933,0.933])
        #rate_obs=np.array([0.20,0.836,0.917,0.946,0.933,0.933])
        palkansaajista=np.array([0.20,0.836,0.917,0.933,0.933,0.933])
        yrittajista=np.array([0.121,0.121,0.121,0.121,0.121,0.121])
        suhde=0.104 # yrittäjiä/(yrittäjiä+palkansaajia)
        init_rate=(1.0-suhde)*palkansaajista+suhde*yrittajista
        
        already=0.02 # alussa tilassa 0 tai 4 olevat
        rate_obs=init_rate-already
        initial_kassanjasenia=rate_obs[0]
        
        x1=self.min_age
        x2=self.max_age+1
        f = interp1d(rate_age, rate_obs,fill_value='extrapolate')
        n_time = int(np.round((x2-x1)*self.inv_timestep))+1
        jasenyys_x = np.linspace(x1, x2, num=n_time, endpoint=True)
        rate=f(jasenyys_x)
        
        kassanjasenyys_joinrate=rate*0
        for k in range(0,rate.shape[0]-1):
            kassanjasenyys_joinrate[k+1]=(rate[k+1]-rate[k])/(1-rate[k]+already)
            
        kassanjasenyys_rate=rate
            
        return kassanjasenyys_joinrate,kassanjasenyys_rate
        
    def get_reemp_prob(self):
        '''
        reemployment probability in 3 months
        '''
        reemp=np.zeros(100)
        reemp[0:25]=0.50 # 0.35
        reemp[25:30]=0.50
        reemp[30:50]=0.50
        reemp[50:55]=0.45
        reemp[55:60]=0.35
        reemp[60:65]=0.30
        reemp[65:100]=0.20
        
        prob_3m_oa=0.2        
        
        return reemp,prob_3m_oa
        
    def get_tyelpremium(self):
        tyel_kokomaksu=np.zeros((2100,5))
        # data
        tyel_kokomaksu[1962:2022]=[5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.15,5.15,5.65,6.1,6.4,6.9,7.9,9.9,12.0,10.0,11.7,13.3,13.3,12.4,11.1,11.1,11.5,12.2,13.0,13.8,14.9,16.9,16.9,14.4,18.5,18.6,20.6,21.1,21.2,21.5,21.5,21.5,21.1,21.1,21.4,21.4,21.6,21.2,21.1,21.1,21.3,21.6,22.1,22.8,22.8,23.6,24.0,24.0,24.4,24.4,24.4,24.4,24.4,24.4]
        # ETK
        tyel_kokomaksu[2023:2085]=np.array([24.4,24.5,24.5,24.6,24.6,24.7,24.8,24.8,24.9,24.9,25.0,24.9,24.9,24.9,24.9,24.8,24.8,24.7,24.7,24.6,24.6,24.6,24.6,24.6,24.7,24.8,24.8,24.9,25.1,25.2,25.4,25.6,25.8,26.0,26.2,26.5,26.7,27.0,27.2,27.5,27.7,27.9,28.1,28.3,28.5,28.7,28.9,29.1,29.2,29.4,29.5,29.7,29.8,29.9,30.1,30.2,30.3,30.3,30.4,30.4,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5])/100
        ptel=0.5*(tyel_kokomaksu-tyel_kokomaksu[0])+0.0615 # vuonna 2017 ptel oli 6,15 %
        
        return tyel_kokomaksu
        
    def initial_wealth(self,g):
        # kotitalouksien varallisuus
        # / StatFin / Tulot ja kulutus / Kotitalouksien varallisuus / 136l -- Kotitalouksien varat, velat ja tulot viitehenkilön ikäryhmän mukaan, 1987-2019
        # vuodelta 2019
        varat=[-4_257,1_979,17_031,-4_257,1_979,17_031]/2
        std=[4_000,4_000,10_000,4_000,4_000,10_000]/2
        r=std*random.randn(1)+varat[g]
        
        return r
        
        return 