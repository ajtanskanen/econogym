'''

    rates.py

    rates for moving agents from state to another

'''

import numpy as np
from scipy.interpolate import interp1d

class Rates():
    def __init__(self,year=2018,silent=True,max_age=70,n_groups=6,timestep=0.25,min_age=18,inv_timestep=0,n_empl=14,max_retage=70):
        self.year=year
        self.max_age=max_age
        self.min_age=min_age
        self.n_groups=n_groups
        self.timestep=timestep
        self.inv_timestep=inv_timestep
        self.silent=silent
        self.n_empl=n_empl
        self.max_retage=max_retage
        
        if False:
            # ryhmäjako palkkadesiilien mukaan
            self.group_weights=np.array([[0.3,0.5,0.2],[0.3,0.5,0.2]])
        else:
            # ryhmäjako, data työssäkäyntitilastosta, Työntekijä, alempi toimihenkilö, ylempi toimihenkilö
            #self.group_weights=np.array([[0.45,0.25,0.3],[0.2,0.55,0.25]]) # miehet, naiset

            self.setup_group_weights()

    def setup_group_weights(self):
        # 15 vuotta täyttänyt väestö koulutusasteen, kunnan, sukupuolen ja ikäryhmän mukaan muuttujina Alue, Ikä, Sukupuoli, Koulutusaste, Tiedot ja Vuosi
        # miehet naiset
        # tasot 9,3,4-8 = 9 Ei perusasteen jälkeistä tutkintoa, 3 Toinen aste, 4-8 Toisen asteen jälkeinen tutkinto
        if self.year == 2018:
            self.group_weights=np.array([[0.2785,0.4359,0.2856],[0.2553,0.3785,0.3662]]) # miehet, naiset
        elif self.year == 2019:
            self.group_weights=np.array([[0.2746,0.4360,0.2894],[0.2496,0.3783,0.3721]]) # miehet, naiset
        elif self.year == 2020:
            self.group_weights=np.array([[0.2716,0.4352,0.2932],[0.2443,0.3775,0.3781]]) # miehet, naiset
        elif self.year == 2021:
            self.group_weights=np.array([[0.2695,0.4344,0.2961],[0.2397,0.3763,0.3840]]) # miehet, naiset
        elif self.year == 2022:
            self.group_weights=np.array([[0.2674,0.4336,0.2989],[0.2350,0.3751,0.3898]]) # miehet, naiset
        elif self.year == 2023:
            self.group_weights=np.array([[0.2653,0.4328,0.3018],[0.2304,0.3739,0.3957]]) # miehet, naiset
        elif self.year == 2024:
            self.group_weights=np.array([[0.2633,0.4320,0.3047],[0.2257,0.3727,0.4015]]) # miehet, naiset
        elif self.year == 2025:
            self.group_weights=np.array([[0.2633,0.4320,0.3047],[0.2257,0.3727,0.4015]]) # miehet, naiset
        elif self.year == 2026:
            self.group_weights=np.array([[0.2633,0.4320,0.3047],[0.2257,0.3727,0.4015]]) # miehet, naiset
        else:
            print('setup_group_weights: Unknown year ',self.year)

    def get_group_weights(self):
        return self.group_weights
        
    def get_wees(self,g,w0,w1,intensity=1.0):
        '''
        Säätää kolmannen ryhmän intensiteetin niin että kaikkien kolmen ryhmän painot ovat 1.0
        '''
        return w0*intensity,w1*intensity,self.get_w(g,w0,w1)*intensity

    def get_w(self,g,a0,a1,intensity=1.0):
        return (intensity-a0*self.group_weights[g,0]-a1*self.group_weights[g,1])/self.group_weights[g,2]
        
    def get_mort_rate_nogroups(self):
        # tilastokeskuksen kuolleisuusdata 2017 sukupuolittain
        mort=np.array([2.12,0.32,0.17,0.07,0.07,0.10,0.00,0.09,0.03,0.13,0.03,0.07,0.10,0.10,0.10,0.23,0.50,0.52,0.42,0.87,0.79,0.66,0.71,0.69,0.98,0.80,0.77,1.07,0.97,0.76,0.83,1.03,0.98,1.20,1.03,0.76,1.22,1.29,1.10,1.26,1.37,1.43,1.71,2.32,2.22,1.89,2.05,2.15,2.71,2.96,3.52,3.54,4.30,4.34,5.09,4.75,6.17,5.88,6.67,8.00,9.20,10.52,10.30,12.26,12.74,13.22,15.03,17.24,18.14,17.78,20.35,25.57,23.53,26.50,28.57,31.87,34.65,40.88,42.43,52.28,59.26,62.92,68.86,72.70,94.04,99.88,113.11,128.52,147.96,161.89,175.99,199.39,212.52,248.32,260.47,284.01,319.98,349.28,301.37,370.17,370.17])/1000.0
        
        return mort
                
    def get_mort_rate(self,debug=False):
        '''
        Kuolleisuus-intensiteetit eri ryhmille
        '''
        mort=np.zeros((101,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
            dfactor=np.array([1.3,1.0,0.78,1.15,1.0,0.8])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            
        # tilastokeskuksen kuolleisuusdata 2017 sukupuolittain
        mort[:,1]=np.array([2.12,0.32,0.17,0.07,0.07,0.10,0.00,0.09,0.03,0.13,0.03,0.07,0.10,0.10,0.10,0.23,0.50,0.52,0.42,0.87,0.79,0.66,0.71,0.69,0.98,0.80,0.77,1.07,0.97,0.76,0.83,1.03,0.98,1.20,1.03,0.76,1.22,1.29,1.10,1.26,1.37,1.43,1.71,2.32,2.22,1.89,2.05,2.15,2.71,2.96,3.52,3.54,4.30,4.34,5.09,4.75,6.17,5.88,6.67,8.00,9.20,10.52,10.30,12.26,12.74,13.22,15.03,17.24,18.14,17.78,20.35,25.57,23.53,26.50,28.57,31.87,34.65,40.88,42.43,52.28,59.26,62.92,68.86,72.70,94.04,99.88,113.11,128.52,147.96,161.89,175.99,199.39,212.52,248.32,260.47,284.01,319.98,349.28,301.37,370.17,370.17])/1000.0
        mort[:,0]=dfactor[0]*mort[:,1]
        mort[:,2]=dfactor[2]*mort[:,1]
        mort[:,4]=np.array([1.89,0.30,0.11,0.03,0.14,0.03,0.16,0.07,0.13,0.03,0.00,0.07,0.07,0.07,0.18,0.14,0.07,0.31,0.31,0.30,0.33,0.26,0.18,0.33,0.56,0.17,0.32,0.29,0.35,0.24,0.55,0.35,0.23,0.39,0.48,0.38,0.35,0.80,0.42,0.65,0.50,0.68,0.80,1.12,0.99,0.88,1.13,1.01,1.07,1.68,1.79,2.16,1.87,2.32,2.67,2.69,2.88,2.86,3.73,4.19,3.66,4.97,5.20,5.52,6.05,7.17,7.48,7.32,8.88,10.33,10.72,12.77,12.13,13.30,16.18,18.30,17.50,24.63,26.53,29.88,32.65,38.88,46.95,51.30,60.00,64.73,79.35,90.94,105.11,118.46,141.44,155.07,163.11,198.45,207.92,237.21,254.75,311.31,299.59,356.64,356.64])/1000.0
        mort[:,3]=dfactor[3]*mort[:,4]
        mort[:,5]=dfactor[5]*mort[:,4]
        
        #mort=1-(1-mort)**self.timestep
        mort = self.scale_rates(mort)

        return mort

    def get_mort_rate_v6(self,year,debug=False):
        '''
        Kuolleisuus-intensiteetit eri ryhmille
        '''
        mort=np.zeros((101,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
            dfactor=np.array([1.3,1.0,0.78,1.15,1.0,0.8])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])

            #print('mort rate v6, dfactor',dfactor)
        
        if year==2017:
            # tilastokeskuksen kuolleisuusdata 2017 sukupuolittain
            mort[:,1]=np.array([2.12,0.32,0.17,0.07,0.07,0.10,0.00,0.09,0.03,0.13,0.03,0.07,0.10,0.10,0.10,0.23,0.50,0.52,0.42,0.87,0.79,0.66,0.71,0.69,0.98,0.80,0.77,1.07,0.97,0.76,0.83,1.03,0.98,1.20,1.03,0.76,1.22,1.29,1.10,1.26,1.37,1.43,1.71,2.32,2.22,1.89,2.05,2.15,2.71,2.96,3.52,3.54,4.30,4.34,5.09,4.75,6.17,5.88,6.67,8.00,9.20,10.52,10.30,12.26,12.74,13.22,15.03,17.24,18.14,17.78,20.35,25.57,23.53,26.50,28.57,31.87,34.65,40.88,42.43,52.28,59.26,62.92,68.86,72.70,94.04,99.88,113.11,128.52,147.96,161.89,175.99,199.39,212.52,248.32,260.47,284.01,319.98,349.28,301.37,370.17,370.17])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.89,0.30,0.11,0.03,0.14,0.03,0.16,0.07,0.13,0.03,0.00,0.07,0.07,0.07,0.18,0.14,0.07,0.31,0.31,0.30,0.33,0.26,0.18,0.33,0.56,0.17,0.32,0.29,0.35,0.24,0.55,0.35,0.23,0.39,0.48,0.38,0.35,0.80,0.42,0.65,0.50,0.68,0.80,1.12,0.99,0.88,1.13,1.01,1.07,1.68,1.79,2.16,1.87,2.32,2.67,2.69,2.88,2.86,3.73,4.19,3.66,4.97,5.20,5.52,6.05,7.17,7.48,7.32,8.88,10.33,10.72,12.77,12.13,13.30,16.18,18.30,17.50,24.63,26.53,29.88,32.65,38.88,46.95,51.30,60.00,64.73,79.35,90.94,105.11,118.46,141.44,155.07,163.11,198.45,207.92,237.21,254.75,311.31,299.59,356.64,356.64])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2018:
            # tilastokeskuksen kuolleisuusdata 2018 sukupuolittain
            mort[:,1]=np.array([2.10,0.22,0.18,0.17,0.03,0.00,0.10,0.09,0.00,0.06,0.00,0.06,0.07,0.16,0.13,0.23,0.40,0.30,0.96,0.71,0.51,0.97,0.96,0.61,0.54,0.72,0.82,0.71,0.79,0.77,1.07,1.05,1.23,0.54,0.98,1.21,0.89,0.92,1.26,1.32,1.51,1.56,1.38,1.68,1.77,1.51,2.36,2.59,3.05,3.12,3.66,3.53,3.93,4.60,4.59,5.27,5.80,5.75,7.46,8.39,8.47,9.30,11.46,11.56,13.04,13.53,14.74,14.48,17.66,18.36,20.67,20.89,26.25,25.06,30.47,32.19,33.80,37.64,48.55,46.82,56.97,60.22,72.54,75.45,89.74,100.88,113.03,122.46,139.31,149.94,171.35,190.66,217.15,233.64,288.66,285.07,366.43,301.55,322.78,315.54,315.54])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([2.12,0.32,0.11,0.11,0.00,0.00,0.10,0.03,0.07,0.00,0.07,0.07,0.07,0.00,0.14,0.04,0.32,0.14,0.28,0.24,0.31,0.26,0.25,0.31,0.33,0.47,0.32,0.40,0.12,0.41,0.39,0.24,0.30,0.34,0.39,0.45,0.69,0.41,0.59,0.63,0.59,0.53,0.92,0.83,0.83,0.98,0.78,1.51,1.69,1.44,1.57,1.63,2.33,1.92,2.65,2.76,2.77,3.83,3.36,3.67,4.68,4.83,5.10,5.27,6.05,6.86,7.22,7.12,8.66,9.79,9.50,11.72,13.66,13.65,15.21,16.38,20.08,22.52,25.71,28.97,35.28,38.02,43.77,48.23,58.42,69.13,82.58,91.46,97.88,118.90,136.82,151.62,180.82,191.91,222.67,255.77,275.93,304.82,360.59,294.88,294.88])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2019:
            # tilastokeskuksen kuolleisuusdata 2019 sukupuolittain
            mort[:,1]=np.array([2.30,0.16,0.22,0.11,0.10,0.16,0.06,0.03,0.00,0.03,0.06,0.06,0.00,0.03,0.26,0.26,0.23,0.40,0.79,0.67,0.68,1.06,1.05,0.75,0.81,0.93,1.02,0.89,0.78,0.89,0.87,1.02,1.22,0.66,1.00,1.00,1.49,1.18,1.61,1.18,1.49,1.65,1.51,1.45,2.22,1.70,1.93,2.08,2.74,3.03,2.94,3.20,3.95,3.73,4.67,5.28,5.78,6.13,6.36,7.49,7.38,8.27,9.73,10.52,11.95,12.86,14.48,15.04,16.40,18.92,21.72,21.96,23.76,28.33,25.55,32.42,35.25,38.63,40.23,49.20,53.72,57.45,67.01,71.88,83.27,91.74,107.39,120.56,131.93,154.99,170.44,199.46,213.25,239.23,258.18,279.58,290.00,356.22,362.77,401.81,401.81])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.87,0.13,0.04,0.07,0.04,0.00,0.00,0.00,0.07,0.06,0.07,0.13,0.07,0.17,0.24,0.21,0.21,0.28,0.24,0.38,0.58,0.47,0.43,0.29,0.36,0.33,0.29,0.32,0.32,0.40,0.49,0.24,0.27,0.56,0.34,0.48,0.50,0.55,0.56,0.65,0.71,0.56,0.88,0.89,0.99,0.91,0.95,1.08,1.20,1.63,1.79,1.65,1.93,2.67,2.17,2.12,2.63,2.62,2.98,4.02,4.08,4.78,4.12,5.15,5.52,7.71,7.68,7.01,8.66,9.02,9.89,11.81,12.29,15.38,13.19,18.57,19.30,22.26,21.39,32.70,32.74,37.05,40.46,50.36,54.07,64.29,74.53,89.20,98.39,114.83,133.57,148.52,175.31,190.59,205.11,229.08,253.52,270.94,314.65,321.06,321.06])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2020:
            # tilastokeskuksen kuolleisuusdata 2020 sukupuolittain
            mort[:,1]=np.array([2.06,0.20,0.08,0.11,0.18,0.00,0.10,0.06,0.00,0.12,0.03,0.00,0.13,0.06,0.19,0.19,0.23,0.73,1.00,0.59,0.99,0.67,0.92,0.95,0.79,1.02,1.03,0.93,0.91,0.75,0.61,0.84,0.97,1.21,0.88,1.13,1.10,1.20,1.07,1.38,1.48,1.91,1.85,2.01,2.04,2.00,2.54,2.99,3.00,2.90,3.34,3.74,3.65,3.96,5.13,4.98,6.06,6.35,6.51,7.64,8.80,8.34,11.16,11.60,12.39,12.18,13.82,15.71,16.61,17.41,20.36,21.95,22.93,25.80,30.62,31.18,35.69,35.86,40.62,42.21,59.73,61.61,70.20,72.09,84.43,93.25,102.10,120.22,132.76,144.73,167.84,187.58,206.37,237.90,258.61,262.36,339.31,301.27,361.72,368.10,368.10])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.50,0.00,0.17,0.12,0.04,0.03,0.00,0.07,0.00,0.00,0.06,0.10,0.03,0.13,0.03,0.17,0.27,0.31,0.42,0.07,0.17,0.31,0.57,0.23,0.25,0.30,0.47,0.35,0.26,0.31,0.37,0.37,0.50,0.36,0.50,0.54,0.45,0.56,0.49,0.53,0.50,0.59,0.97,0.65,1.01,0.92,1.34,0.95,1.34,1.54,1.39,1.52,1.77,2.02,2.25,2.77,2.42,3.07,2.84,4.15,3.66,4.71,4.22,5.03,5.77,6.33,6.86,7.66,9.22,9.92,10.40,10.93,12.85,13.70,17.78,15.72,19.07,22.59,25.13,27.41,33.22,37.49,43.33,48.34,58.65,67.27,74.09,86.85,102.04,109.16,128.58,153.18,159.48,188.76,210.92,242.26,265.65,291.38,306.62,331.46,331.46])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2021:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2022:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2023:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2024:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2025:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2026:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        else:
            print('Unknown year',year)

        #mort=1-(1-mort)**self.timestep
        mort = self.scale_rates(mort)

        return mort


    def get_mort_rate_v7(self,year,debug=False):
        '''
        Kuolleisuus-intensiteetit eri ryhmille
        '''
        mort=np.zeros((101,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
            dfactor=np.array([1.3,1.0,0.78,1.09,1.0,0.8])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])

            #print('mort rate v6, dfactor',dfactor)
        
        if year==2017:
            # tilastokeskuksen kuolleisuusdata 2017 sukupuolittain
            mort[:,1]=np.array([2.12,0.32,0.17,0.07,0.07,0.10,0.00,0.09,0.03,0.13,0.03,0.07,0.10,0.10,0.10,0.23,0.50,0.52,0.42,0.87,0.79,0.66,0.71,0.69,0.98,0.80,0.77,1.07,0.97,0.76,0.83,1.03,0.98,1.20,1.03,0.76,1.22,1.29,1.10,1.26,1.37,1.43,1.71,2.32,2.22,1.89,2.05,2.15,2.71,2.96,3.52,3.54,4.30,4.34,5.09,4.75,6.17,5.88,6.67,8.00,9.20,10.52,10.30,12.26,12.74,13.22,15.03,17.24,18.14,17.78,20.35,25.57,23.53,26.50,28.57,31.87,34.65,40.88,42.43,52.28,59.26,62.92,68.86,72.70,94.04,99.88,113.11,128.52,147.96,161.89,175.99,199.39,212.52,248.32,260.47,284.01,319.98,349.28,301.37,370.17,370.17])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.89,0.30,0.11,0.03,0.14,0.03,0.16,0.07,0.13,0.03,0.00,0.07,0.07,0.07,0.18,0.14,0.07,0.31,0.31,0.30,0.33,0.26,0.18,0.33,0.56,0.17,0.32,0.29,0.35,0.24,0.55,0.35,0.23,0.39,0.48,0.38,0.35,0.80,0.42,0.65,0.50,0.68,0.80,1.12,0.99,0.88,1.13,1.01,1.07,1.68,1.79,2.16,1.87,2.32,2.67,2.69,2.88,2.86,3.73,4.19,3.66,4.97,5.20,5.52,6.05,7.17,7.48,7.32,8.88,10.33,10.72,12.77,12.13,13.30,16.18,18.30,17.50,24.63,26.53,29.88,32.65,38.88,46.95,51.30,60.00,64.73,79.35,90.94,105.11,118.46,141.44,155.07,163.11,198.45,207.92,237.21,254.75,311.31,299.59,356.64,356.64])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2018:
            # tilastokeskuksen kuolleisuusdata 2018 sukupuolittain
            mort[:,1]=np.array([2.10,0.22,0.18,0.17,0.03,0.00,0.10,0.09,0.00,0.06,0.00,0.06,0.07,0.16,0.13,0.23,0.40,0.30,0.96,0.71,0.51,0.97,0.96,0.61,0.54,0.72,0.82,0.71,0.79,0.77,1.07,1.05,1.23,0.54,0.98,1.21,0.89,0.92,1.26,1.32,1.51,1.56,1.38,1.68,1.77,1.51,2.36,2.59,3.05,3.12,3.66,3.53,3.93,4.60,4.59,5.27,5.80,5.75,7.46,8.39,8.47,9.30,11.46,11.56,13.04,13.53,14.74,14.48,17.66,18.36,20.67,20.89,26.25,25.06,30.47,32.19,33.80,37.64,48.55,46.82,56.97,60.22,72.54,75.45,89.74,100.88,113.03,122.46,139.31,149.94,171.35,190.66,217.15,233.64,288.66,285.07,366.43,301.55,322.78,315.54,315.54])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([2.12,0.32,0.11,0.11,0.00,0.00,0.10,0.03,0.07,0.00,0.07,0.07,0.07,0.00,0.14,0.04,0.32,0.14,0.28,0.24,0.31,0.26,0.25,0.31,0.33,0.47,0.32,0.40,0.12,0.41,0.39,0.24,0.30,0.34,0.39,0.45,0.69,0.41,0.59,0.63,0.59,0.53,0.92,0.83,0.83,0.98,0.78,1.51,1.69,1.44,1.57,1.63,2.33,1.92,2.65,2.76,2.77,3.83,3.36,3.67,4.68,4.83,5.10,5.27,6.05,6.86,7.22,7.12,8.66,9.79,9.50,11.72,13.66,13.65,15.21,16.38,20.08,22.52,25.71,28.97,35.28,38.02,43.77,48.23,58.42,69.13,82.58,91.46,97.88,118.90,136.82,151.62,180.82,191.91,222.67,255.77,275.93,304.82,360.59,294.88,294.88])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2019:
            # tilastokeskuksen kuolleisuusdata 2019 sukupuolittain
            mort[:,1]=np.array([2.30,0.16,0.22,0.11,0.10,0.16,0.06,0.03,0.00,0.03,0.06,0.06,0.00,0.03,0.26,0.26,0.23,0.40,0.79,0.67,0.68,1.06,1.05,0.75,0.81,0.93,1.02,0.89,0.78,0.89,0.87,1.02,1.22,0.66,1.00,1.00,1.49,1.18,1.61,1.18,1.49,1.65,1.51,1.45,2.22,1.70,1.93,2.08,2.74,3.03,2.94,3.20,3.95,3.73,4.67,5.28,5.78,6.13,6.36,7.49,7.38,8.27,9.73,10.52,11.95,12.86,14.48,15.04,16.40,18.92,21.72,21.96,23.76,28.33,25.55,32.42,35.25,38.63,40.23,49.20,53.72,57.45,67.01,71.88,83.27,91.74,107.39,120.56,131.93,154.99,170.44,199.46,213.25,239.23,258.18,279.58,290.00,356.22,362.77,401.81,401.81])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.87,0.13,0.04,0.07,0.04,0.00,0.00,0.00,0.07,0.06,0.07,0.13,0.07,0.17,0.24,0.21,0.21,0.28,0.24,0.38,0.58,0.47,0.43,0.29,0.36,0.33,0.29,0.32,0.32,0.40,0.49,0.24,0.27,0.56,0.34,0.48,0.50,0.55,0.56,0.65,0.71,0.56,0.88,0.89,0.99,0.91,0.95,1.08,1.20,1.63,1.79,1.65,1.93,2.67,2.17,2.12,2.63,2.62,2.98,4.02,4.08,4.78,4.12,5.15,5.52,7.71,7.68,7.01,8.66,9.02,9.89,11.81,12.29,15.38,13.19,18.57,19.30,22.26,21.39,32.70,32.74,37.05,40.46,50.36,54.07,64.29,74.53,89.20,98.39,114.83,133.57,148.52,175.31,190.59,205.11,229.08,253.52,270.94,314.65,321.06,321.06])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2020:
            # tilastokeskuksen kuolleisuusdata 2020 sukupuolittain
            mort[:,1]=np.array([2.06,0.20,0.08,0.11,0.18,0.00,0.10,0.06,0.00,0.12,0.03,0.00,0.13,0.06,0.19,0.19,0.23,0.73,1.00,0.59,0.99,0.67,0.92,0.95,0.79,1.02,1.03,0.93,0.91,0.75,0.61,0.84,0.97,1.21,0.88,1.13,1.10,1.20,1.07,1.38,1.48,1.91,1.85,2.01,2.04,2.00,2.54,2.99,3.00,2.90,3.34,3.74,3.65,3.96,5.13,4.98,6.06,6.35,6.51,7.64,8.80,8.34,11.16,11.60,12.39,12.18,13.82,15.71,16.61,17.41,20.36,21.95,22.93,25.80,30.62,31.18,35.69,35.86,40.62,42.21,59.73,61.61,70.20,72.09,84.43,93.25,102.10,120.22,132.76,144.73,167.84,187.58,206.37,237.90,258.61,262.36,339.31,301.27,361.72,368.10,368.10])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.50,0.00,0.17,0.12,0.04,0.03,0.00,0.07,0.00,0.00,0.06,0.10,0.03,0.13,0.03,0.17,0.27,0.31,0.42,0.07,0.17,0.31,0.57,0.23,0.25,0.30,0.47,0.35,0.26,0.31,0.37,0.37,0.50,0.36,0.50,0.54,0.45,0.56,0.49,0.53,0.50,0.59,0.97,0.65,1.01,0.92,1.34,0.95,1.34,1.54,1.39,1.52,1.77,2.02,2.25,2.77,2.42,3.07,2.84,4.15,3.66,4.71,4.22,5.03,5.77,6.33,6.86,7.66,9.22,9.92,10.40,10.93,12.85,13.70,17.78,15.72,19.07,22.59,25.13,27.41,33.22,37.49,43.33,48.34,58.65,67.27,74.09,86.85,102.04,109.16,128.58,153.18,159.48,188.76,210.92,242.26,265.65,291.38,306.62,331.46,331.46])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2021:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2022:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2023:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2024:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*0.99*0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2025:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*0.99*0.99*0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2026:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*0.99*0.99*0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        else:
            print('Unknown year',year)

        smort = np.zeros((121,self.n_groups,self.n_empl))

        for e in range(16):
            smort[:101,:,e] = mort[:,:]

        smort[:101,:,3] = 2.0 * mort[:,:] # pitäisikö olla korkeampi?
        smort[101:121,:,:] = smort[100,:,:]

        #smort=1-(1-smort)**self.timestep
        smort = self.scale_rates(smort)

        return smort

    def get_mort_rate_v8(self,year,debug=False):
        '''
        Kuolleisuus-intensiteetit eri ryhmille
        '''
        mort=np.zeros((101,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
            dfactor=np.array([1.3,1.0,0.78,1.09,1.0,0.8])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])

            #print('mort rate v6, dfactor',dfactor)
        
        if year==2017:
            # tilastokeskuksen kuolleisuusdata 2017 sukupuolittain
            mort[:,1]=np.array([2.12,0.32,0.17,0.07,0.07,0.10,0.00,0.09,0.03,0.13,0.03,0.07,0.10,0.10,0.10,0.23,0.50,0.52,0.42,0.87,0.79,0.66,0.71,0.69,0.98,0.80,0.77,1.07,0.97,0.76,0.83,1.03,0.98,1.20,1.03,0.76,1.22,1.29,1.10,1.26,1.37,1.43,1.71,2.32,2.22,1.89,2.05,2.15,2.71,2.96,3.52,3.54,4.30,4.34,5.09,4.75,6.17,5.88,6.67,8.00,9.20,10.52,10.30,12.26,12.74,13.22,15.03,17.24,18.14,17.78,20.35,25.57,23.53,26.50,28.57,31.87,34.65,40.88,42.43,52.28,59.26,62.92,68.86,72.70,94.04,99.88,113.11,128.52,147.96,161.89,175.99,199.39,212.52,248.32,260.47,284.01,319.98,349.28,301.37,370.17,370.17])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.89,0.30,0.11,0.03,0.14,0.03,0.16,0.07,0.13,0.03,0.00,0.07,0.07,0.07,0.18,0.14,0.07,0.31,0.31,0.30,0.33,0.26,0.18,0.33,0.56,0.17,0.32,0.29,0.35,0.24,0.55,0.35,0.23,0.39,0.48,0.38,0.35,0.80,0.42,0.65,0.50,0.68,0.80,1.12,0.99,0.88,1.13,1.01,1.07,1.68,1.79,2.16,1.87,2.32,2.67,2.69,2.88,2.86,3.73,4.19,3.66,4.97,5.20,5.52,6.05,7.17,7.48,7.32,8.88,10.33,10.72,12.77,12.13,13.30,16.18,18.30,17.50,24.63,26.53,29.88,32.65,38.88,46.95,51.30,60.00,64.73,79.35,90.94,105.11,118.46,141.44,155.07,163.11,198.45,207.92,237.21,254.75,311.31,299.59,356.64,356.64])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2018:
            # tilastokeskuksen kuolleisuusdata 2018 sukupuolittain
            mort[:,1]=np.array([2.10,0.22,0.18,0.17,0.03,0.00,0.10,0.09,0.00,0.06,0.00,0.06,0.07,0.16,0.13,0.23,0.40,0.30,0.96,0.71,0.51,0.97,0.96,0.61,0.54,0.72,0.82,0.71,0.79,0.77,1.07,1.05,1.23,0.54,0.98,1.21,0.89,0.92,1.26,1.32,1.51,1.56,1.38,1.68,1.77,1.51,2.36,2.59,3.05,3.12,3.66,3.53,3.93,4.60,4.59,5.27,5.80,5.75,7.46,8.39,8.47,9.30,11.46,11.56,13.04,13.53,14.74,14.48,17.66,18.36,20.67,20.89,26.25,25.06,30.47,32.19,33.80,37.64,48.55,46.82,56.97,60.22,72.54,75.45,89.74,100.88,113.03,122.46,139.31,149.94,171.35,190.66,217.15,233.64,288.66,285.07,366.43,301.55,322.78,315.54,315.54])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([2.12,0.32,0.11,0.11,0.00,0.00,0.10,0.03,0.07,0.00,0.07,0.07,0.07,0.00,0.14,0.04,0.32,0.14,0.28,0.24,0.31,0.26,0.25,0.31,0.33,0.47,0.32,0.40,0.12,0.41,0.39,0.24,0.30,0.34,0.39,0.45,0.69,0.41,0.59,0.63,0.59,0.53,0.92,0.83,0.83,0.98,0.78,1.51,1.69,1.44,1.57,1.63,2.33,1.92,2.65,2.76,2.77,3.83,3.36,3.67,4.68,4.83,5.10,5.27,6.05,6.86,7.22,7.12,8.66,9.79,9.50,11.72,13.66,13.65,15.21,16.38,20.08,22.52,25.71,28.97,35.28,38.02,43.77,48.23,58.42,69.13,82.58,91.46,97.88,118.90,136.82,151.62,180.82,191.91,222.67,255.77,275.93,304.82,360.59,294.88,294.88])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2019:
            # tilastokeskuksen kuolleisuusdata 2019 sukupuolittain
            mort[:,1]=np.array([2.30,0.16,0.22,0.11,0.10,0.16,0.06,0.03,0.00,0.03,0.06,0.06,0.00,0.03,0.26,0.26,0.23,0.40,0.79,0.67,0.68,1.06,1.05,0.75,0.81,0.93,1.02,0.89,0.78,0.89,0.87,1.02,1.22,0.66,1.00,1.00,1.49,1.18,1.61,1.18,1.49,1.65,1.51,1.45,2.22,1.70,1.93,2.08,2.74,3.03,2.94,3.20,3.95,3.73,4.67,5.28,5.78,6.13,6.36,7.49,7.38,8.27,9.73,10.52,11.95,12.86,14.48,15.04,16.40,18.92,21.72,21.96,23.76,28.33,25.55,32.42,35.25,38.63,40.23,49.20,53.72,57.45,67.01,71.88,83.27,91.74,107.39,120.56,131.93,154.99,170.44,199.46,213.25,239.23,258.18,279.58,290.00,356.22,362.77,401.81,401.81])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.87,0.13,0.04,0.07,0.04,0.00,0.00,0.00,0.07,0.06,0.07,0.13,0.07,0.17,0.24,0.21,0.21,0.28,0.24,0.38,0.58,0.47,0.43,0.29,0.36,0.33,0.29,0.32,0.32,0.40,0.49,0.24,0.27,0.56,0.34,0.48,0.50,0.55,0.56,0.65,0.71,0.56,0.88,0.89,0.99,0.91,0.95,1.08,1.20,1.63,1.79,1.65,1.93,2.67,2.17,2.12,2.63,2.62,2.98,4.02,4.08,4.78,4.12,5.15,5.52,7.71,7.68,7.01,8.66,9.02,9.89,11.81,12.29,15.38,13.19,18.57,19.30,22.26,21.39,32.70,32.74,37.05,40.46,50.36,54.07,64.29,74.53,89.20,98.39,114.83,133.57,148.52,175.31,190.59,205.11,229.08,253.52,270.94,314.65,321.06,321.06])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2020:
            # tilastokeskuksen kuolleisuusdata 2020 sukupuolittain
            mort[:,1]=np.array([2.06,0.20,0.08,0.11,0.18,0.00,0.10,0.06,0.00,0.12,0.03,0.00,0.13,0.06,0.19,0.19,0.23,0.73,1.00,0.59,0.99,0.67,0.92,0.95,0.79,1.02,1.03,0.93,0.91,0.75,0.61,0.84,0.97,1.21,0.88,1.13,1.10,1.20,1.07,1.38,1.48,1.91,1.85,2.01,2.04,2.00,2.54,2.99,3.00,2.90,3.34,3.74,3.65,3.96,5.13,4.98,6.06,6.35,6.51,7.64,8.80,8.34,11.16,11.60,12.39,12.18,13.82,15.71,16.61,17.41,20.36,21.95,22.93,25.80,30.62,31.18,35.69,35.86,40.62,42.21,59.73,61.61,70.20,72.09,84.43,93.25,102.10,120.22,132.76,144.73,167.84,187.58,206.37,237.90,258.61,262.36,339.31,301.27,361.72,368.10,368.10])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.50,0.00,0.17,0.12,0.04,0.03,0.00,0.07,0.00,0.00,0.06,0.10,0.03,0.13,0.03,0.17,0.27,0.31,0.42,0.07,0.17,0.31,0.57,0.23,0.25,0.30,0.47,0.35,0.26,0.31,0.37,0.37,0.50,0.36,0.50,0.54,0.45,0.56,0.49,0.53,0.50,0.59,0.97,0.65,1.01,0.92,1.34,0.95,1.34,1.54,1.39,1.52,1.77,2.02,2.25,2.77,2.42,3.07,2.84,4.15,3.66,4.71,4.22,5.03,5.77,6.33,6.86,7.66,9.22,9.92,10.40,10.93,12.85,13.70,17.78,15.72,19.07,22.59,25.13,27.41,33.22,37.49,43.33,48.34,58.65,67.27,74.09,86.85,102.04,109.16,128.58,153.18,159.48,188.76,210.92,242.26,265.65,291.38,306.62,331.46,331.46])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2021:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2022:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2023:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2024:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*0.99*0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2025:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*0.99*0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2026:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*0.99*0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        else:
            print('Unknown year',year)

        smort = np.zeros((121,self.n_groups,self.n_empl))

        for e in range(16):
            smort[:101,:,e] = mort[:,:]

        smort[:101,:,3] = 2.0 * mort[:,:] # pitäisikö olla korkeampi?
        smort[101:121,:,:] = smort[100,:,:]

        #smort=1-(1-smort)**self.timestep
        smort = self.scale_rates(smort)

        return smort        


    def get_mort_rate_v10(self,year,debug=False):
        '''
        Kuolleisuus-intensiteetit eri ryhmille
        '''
        mort=np.zeros((101,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
            dfactor=np.array([1.3,1.0,0.78,1.09,1.0,0.8])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])

            #print('mort rate v6, dfactor',dfactor)
        
        if year==2017:
            # tilastokeskuksen kuolleisuusdata 2017 sukupuolittain
            mort[:,1]=np.array([2.12,0.32,0.17,0.07,0.07,0.10,0.00,0.09,0.03,0.13,0.03,0.07,0.10,0.10,0.10,0.23,0.50,0.52,0.42,0.87,0.79,0.66,0.71,0.69,0.98,0.80,0.77,1.07,0.97,0.76,0.83,1.03,0.98,1.20,1.03,0.76,1.22,1.29,1.10,1.26,1.37,1.43,1.71,2.32,2.22,1.89,2.05,2.15,2.71,2.96,3.52,3.54,4.30,4.34,5.09,4.75,6.17,5.88,6.67,8.00,9.20,10.52,10.30,12.26,12.74,13.22,15.03,17.24,18.14,17.78,20.35,25.57,23.53,26.50,28.57,31.87,34.65,40.88,42.43,52.28,59.26,62.92,68.86,72.70,94.04,99.88,113.11,128.52,147.96,161.89,175.99,199.39,212.52,248.32,260.47,284.01,319.98,349.28,301.37,370.17,370.17])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.89,0.30,0.11,0.03,0.14,0.03,0.16,0.07,0.13,0.03,0.00,0.07,0.07,0.07,0.18,0.14,0.07,0.31,0.31,0.30,0.33,0.26,0.18,0.33,0.56,0.17,0.32,0.29,0.35,0.24,0.55,0.35,0.23,0.39,0.48,0.38,0.35,0.80,0.42,0.65,0.50,0.68,0.80,1.12,0.99,0.88,1.13,1.01,1.07,1.68,1.79,2.16,1.87,2.32,2.67,2.69,2.88,2.86,3.73,4.19,3.66,4.97,5.20,5.52,6.05,7.17,7.48,7.32,8.88,10.33,10.72,12.77,12.13,13.30,16.18,18.30,17.50,24.63,26.53,29.88,32.65,38.88,46.95,51.30,60.00,64.73,79.35,90.94,105.11,118.46,141.44,155.07,163.11,198.45,207.92,237.21,254.75,311.31,299.59,356.64,356.64])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2018:
            # tilastokeskuksen kuolleisuusdata 2018 sukupuolittain
            mort[:,1]=np.array([2.10,0.22,0.18,0.17,0.03,0.00,0.10,0.09,0.00,0.06,0.00,0.06,0.07,0.16,0.13,0.23,0.40,0.30,0.96,0.71,0.51,0.97,0.96,0.61,0.54,0.72,0.82,0.71,0.79,0.77,1.07,1.05,1.23,0.54,0.98,1.21,0.89,0.92,1.26,1.32,1.51,1.56,1.38,1.68,1.77,1.51,2.36,2.59,3.05,3.12,3.66,3.53,3.93,4.60,4.59,5.27,5.80,5.75,7.46,8.39,8.47,9.30,11.46,11.56,13.04,13.53,14.74,14.48,17.66,18.36,20.67,20.89,26.25,25.06,30.47,32.19,33.80,37.64,48.55,46.82,56.97,60.22,72.54,75.45,89.74,100.88,113.03,122.46,139.31,149.94,171.35,190.66,217.15,233.64,288.66,285.07,366.43,301.55,322.78,315.54,315.54])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([2.12,0.32,0.11,0.11,0.00,0.00,0.10,0.03,0.07,0.00,0.07,0.07,0.07,0.00,0.14,0.04,0.32,0.14,0.28,0.24,0.31,0.26,0.25,0.31,0.33,0.47,0.32,0.40,0.12,0.41,0.39,0.24,0.30,0.34,0.39,0.45,0.69,0.41,0.59,0.63,0.59,0.53,0.92,0.83,0.83,0.98,0.78,1.51,1.69,1.44,1.57,1.63,2.33,1.92,2.65,2.76,2.77,3.83,3.36,3.67,4.68,4.83,5.10,5.27,6.05,6.86,7.22,7.12,8.66,9.79,9.50,11.72,13.66,13.65,15.21,16.38,20.08,22.52,25.71,28.97,35.28,38.02,43.77,48.23,58.42,69.13,82.58,91.46,97.88,118.90,136.82,151.62,180.82,191.91,222.67,255.77,275.93,304.82,360.59,294.88,294.88])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2019:
            # tilastokeskuksen kuolleisuusdata 2019 sukupuolittain
            mort[:,1]=np.array([2.30,0.16,0.22,0.11,0.10,0.16,0.06,0.03,0.00,0.03,0.06,0.06,0.00,0.03,0.26,0.26,0.23,0.40,0.79,0.67,0.68,1.06,1.05,0.75,0.81,0.93,1.02,0.89,0.78,0.89,0.87,1.02,1.22,0.66,1.00,1.00,1.49,1.18,1.61,1.18,1.49,1.65,1.51,1.45,2.22,1.70,1.93,2.08,2.74,3.03,2.94,3.20,3.95,3.73,4.67,5.28,5.78,6.13,6.36,7.49,7.38,8.27,9.73,10.52,11.95,12.86,14.48,15.04,16.40,18.92,21.72,21.96,23.76,28.33,25.55,32.42,35.25,38.63,40.23,49.20,53.72,57.45,67.01,71.88,83.27,91.74,107.39,120.56,131.93,154.99,170.44,199.46,213.25,239.23,258.18,279.58,290.00,356.22,362.77,401.81,401.81])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.87,0.13,0.04,0.07,0.04,0.00,0.00,0.00,0.07,0.06,0.07,0.13,0.07,0.17,0.24,0.21,0.21,0.28,0.24,0.38,0.58,0.47,0.43,0.29,0.36,0.33,0.29,0.32,0.32,0.40,0.49,0.24,0.27,0.56,0.34,0.48,0.50,0.55,0.56,0.65,0.71,0.56,0.88,0.89,0.99,0.91,0.95,1.08,1.20,1.63,1.79,1.65,1.93,2.67,2.17,2.12,2.63,2.62,2.98,4.02,4.08,4.78,4.12,5.15,5.52,7.71,7.68,7.01,8.66,9.02,9.89,11.81,12.29,15.38,13.19,18.57,19.30,22.26,21.39,32.70,32.74,37.05,40.46,50.36,54.07,64.29,74.53,89.20,98.39,114.83,133.57,148.52,175.31,190.59,205.11,229.08,253.52,270.94,314.65,321.06,321.06])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2020:
            # tilastokeskuksen kuolleisuusdata 2020 sukupuolittain
            mort[:,1]=np.array([2.06,0.20,0.08,0.11,0.18,0.00,0.10,0.06,0.00,0.12,0.03,0.00,0.13,0.06,0.19,0.19,0.23,0.73,1.00,0.59,0.99,0.67,0.92,0.95,0.79,1.02,1.03,0.93,0.91,0.75,0.61,0.84,0.97,1.21,0.88,1.13,1.10,1.20,1.07,1.38,1.48,1.91,1.85,2.01,2.04,2.00,2.54,2.99,3.00,2.90,3.34,3.74,3.65,3.96,5.13,4.98,6.06,6.35,6.51,7.64,8.80,8.34,11.16,11.60,12.39,12.18,13.82,15.71,16.61,17.41,20.36,21.95,22.93,25.80,30.62,31.18,35.69,35.86,40.62,42.21,59.73,61.61,70.20,72.09,84.43,93.25,102.10,120.22,132.76,144.73,167.84,187.58,206.37,237.90,258.61,262.36,339.31,301.27,361.72,368.10,368.10])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.50,0.00,0.17,0.12,0.04,0.03,0.00,0.07,0.00,0.00,0.06,0.10,0.03,0.13,0.03,0.17,0.27,0.31,0.42,0.07,0.17,0.31,0.57,0.23,0.25,0.30,0.47,0.35,0.26,0.31,0.37,0.37,0.50,0.36,0.50,0.54,0.45,0.56,0.49,0.53,0.50,0.59,0.97,0.65,1.01,0.92,1.34,0.95,1.34,1.54,1.39,1.52,1.77,2.02,2.25,2.77,2.42,3.07,2.84,4.15,3.66,4.71,4.22,5.03,5.77,6.33,6.86,7.66,9.22,9.92,10.40,10.93,12.85,13.70,17.78,15.72,19.07,22.59,25.13,27.41,33.22,37.49,43.33,48.34,58.65,67.27,74.09,86.85,102.04,109.16,128.58,153.18,159.48,188.76,210.92,242.26,265.65,291.38,306.62,331.46,331.46])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2021:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2022:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2023:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2024:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*0.99*0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2025:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*0.99*0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2026:
            # tilastokeskuksen kuolleisuusdata 2021 sukupuolittain
            mort[:,1]=0.99*0.99*0.99*np.array([1.71,0.21,0.04,0.08,0.00,0.10,0.10,0.03,0.10,0.09,0.09,0.03,0.06,0.16,0.19,0.10,0.39,0.59,0.59,0.89,0.59,0.80,0.79,0.79,0.79,0.61,0.48,0.61,0.86,0.90,0.79,0.90,0.99,0.91,1.12,1.37,0.64,1.10,0.94,1.09,1.30,1.45,1.74,1.45,2.00,1.93,2.04,2.37,3.04,2.50,2.94,3.52,4.33,3.77,4.91,5.40,5.08,6.28,7.19,7.91,7.96,9.67,10.02,10.55,13.45,12.93,14.16,15.16,18.10,19.02,21.66,22.70,24.69,26.03,31.20,34.51,33.17,38.14,42.05,45.39,49.00,63.75,65.81,73.82,82.61,98.57,105.34,125.13,130.98,145.40,174.39,208.22,226.70,235.48,250.61,292.62,335.33,377.02,392.62,384.52,384.52])/1000.0
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([1.88,0.18,0.04,0.12,0.07,0.15,0.11,0.07,0.03,0.07,0.03,0.10,0.10,0.03,0.13,0.24,0.07,0.24,0.14,0.31,0.28,0.31,0.37,0.30,0.26,0.22,0.36,0.41,0.29,0.26,0.51,0.25,0.37,0.26,0.39,0.53,0.57,0.67,0.31,0.60,0.76,0.83,0.65,0.85,0.64,1.42,0.98,1.01,1.05,1.34,1.58,2.21,2.01,2.16,1.91,2.56,2.67,3.07,3.59,4.07,3.67,4.35,5.22,5.28,6.17,6.63,7.17,7.56,8.27,9.15,9.18,11.55,13.27,14.11,15.74,19.78,18.42,22.43,25.02,27.55,32.28,39.70,46.84,52.68,56.25,65.43,77.18,85.62,100.51,111.62,128.65,151.53,172.95,202.53,205.30,234.79,265.99,279.60,314.49,299.89,299.89])/1000.0
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        else:
            print('Unknown year',year)

        smort = np.zeros((121,self.n_groups,self.n_empl))

        for e in range(16):
            smort[:101,:,e] = mort[:,:]

        smort[:101,:,3] = 2.0 * mort[:,:] # pitäisikö olla korkeampi?
        smort[101:121,:,:] = smort[100,:,:]

        #smort=1-(1-smort)**self.timestep
        smort = self.scale_rates(smort)

        return smort        

    def get_mort_rate_1980(self,year=1980,debug=False):
        '''
        Kuolleisuus-intensiteetit eri ryhmille
        '''
        mort=np.zeros((111,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
            dfactor=np.array([1.3,1.0,0.8,1.15,1.0,0.85])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])

        if year==1980:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==1990:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2000:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2010:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==2020:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==1950:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        elif year==1960:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        
        elif year==1970:
            # ETK:sta saatu 1980-luvulla syntyneiden kuolleisuus
            mort[:,1]=np.array([0.00212,0.00032,0.00017,0.00007,0.00007,0.00087,0.000955,0.001285,0.001025,0.001145,0.001215,0.00121,0.00127,0.001195,0.001075,0.00087,0.000922918,0.001110727,0.001282406,0.001139091,0.001116819,0.001296377,0.001214769,0.001472221,0.001499108,0.001633651,0.001885631,0.001788105,0.001846841,0.002097677,0.002221515,0.002421873,0.0027286,0.002917021,0.002914952,0.003141551,0.003421786,0.003739702,0.003865086,0.004478511,0.004500349,0.005024217,0.005204155,0.005590178,0.006185707,0.006493172,0.006431219,0.006586458,0.006987948,0.007511778,0.007798334,0.007943255,0.008656053,0.009215786,0.010144656,0.011131939,0.011644146,0.012906354,0.014844232,0.01649505,0.018757944,0.0217792,0.024105325,0.028190449,0.034549837,0.039611964,0.047004774,0.058700039,0.070188116,0.084493879,0.099945389,0.123643555,0.142760694,0.164092641,0.197935225,0.216982235,0.265127613,0.280274881,0.275028974,0.287887892,0.35428496,0.392993994,0.432764875,0.465257645,0.492725928,0.537519397,0.628697246,0.722197558,0.818099442,0.913452665,1])
            mort[:,0]=dfactor[0]*mort[:,1]
            mort[:,2]=dfactor[2]*mort[:,1]
            mort[:,4]=np.array([0.00189,0.00030,0.00011,0.00003,0.00014,0.000325,0.00031,0.00039,0.000325,0.0004,0.00027,0.000415,0.00036,0.000345,0.00048,0.000495,0.000468017,0.00047721,0.000515887,0.00039946,0.000558615,0.000542183,0.000638361,0.000627876,0.000656854,0.000734585,0.000829,0.00091037,0.000973696,0.001008048,0.001298423,0.001476736,0.001516427,0.001625692,0.00156296,0.001933662,0.00204209,0.002342013,0.002163112,0.002589884,0.002667757,0.003058396,0.003213089,0.003280551,0.003629715,0.003708516,0.004042156,0.003728079,0.004124743,0.00426416,0.00430204,0.004666305,0.004781228,0.005068466,0.00538157,0.005867491,0.006224905,0.00672271,0.007854882,0.008882479,0.010215929,0.011324204,0.013350124,0.016087627,0.018268187,0.022744102,0.02795395,0.035096801,0.043252218,0.052214304,0.066612172,0.077688104,0.094474234,0.117901039,0.139713337,0.166605302,0.191522394,0.234507695,0.275085355,0.308817553,0.323885781,0.345976875,0.370988961,0.401858969,0.433311165,0.50664124,0.598530036,0.691476197,0.785491061,0.881467234,0.977861496])
            mort[:,3]=dfactor[3]*mort[:,4]
            mort[:,5]=dfactor[5]*mort[:,4]
        
        #mort=1-(1-mort)**self.timestep
        mort = self.scale_rates(mort)

        return mort

    def get_student_rate_v1(self,debug=False):
        '''
        opiskelijoiden intensiteetit eri ryhmille
        
        vanha rutiini, ei kurantti
        '''
        if not self.silent:
            print('student year',self.year)
        if self.year==2018:
            miehet_in=np.array([0.14161,0.17243,0.13722,0.09268,0.08827,0.07784,0.05886,0.04234,0.03108,0.02376,0.02297,0.01840,0.01626,0.01347,0.01075,0.01019,0.00896,0.00814,0.00742,0.00710,0.00648,0.00578,0.00542,0.00527,0.00451,0.00409,0.00397,0.00385,0.00359,0.00355,0.00346,0.00300,0.00284,0.00262,0.00243,0.00244,0.00211,0.00201,0.00194,0.00175,0.00133,0.00110,0.00094,0.00094,0.00107,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000])
            naiset_in=np.array([0.06791,0.09761,0.10086,0.09411,0.08530,0.06874,0.05102,0.04067,0.03265,0.02571,0.02824,0.02500,0.02147,0.01935,0.01808,0.01668,0.01558,0.01477,0.01286,0.01175,0.01105,0.00932,0.00859,0.00810,0.00741,0.00657,0.00617,0.00569,0.00562,0.00502,0.00459,0.00447,0.00414,0.00325,0.00301,0.00301,0.00291,0.00244,0.00238,0.00183,0.00154,0.00135,0.00094,0.00070,0.00071,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000])
            miehet_ulos=np.array([0.49960,0.36251,0.35144,0.22735,0.28455,0.39111,0.43548,0.43147,0.41566,0.40867,0.43562,0.36303,0.41632,0.44223,0.30343,0.36754,0.33380,0.33538,0.28808,0.33422,0.35189,0.31087,0.27147,0.39144,0.33943,0.28357,0.28192,0.31797,0.26326,0.27507,0.38591,0.30785,0.33354,0.32441,0.43705,0.25007,0.37159,0.25007,0.36427,0.50069,0.44014,0.47994,0.25003,0.63541,0.25002,1.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000,0.00000])
            naiset_ulos=np.array([0.56309,0.21796,0.20379,0.27074,0.35122,0.40776,0.37704,0.38145,0.39233,0.31660,0.35885,0.38048,0.34256,0.31260,0.31512,0.30657,0.28801,0.36577,0.33033,0.30241,0.39329,0.31962,0.29713,0.32875,0.35980,0.30874,0.32830,0.26172,0.35346,0.33895,0.27776,0.32496,0.46528,0.32964,0.25009,0.28992,0.41271,0.28992,0.48613,0.41931,0.38657,0.58156,0.52913,0.56370,0.25002,1.00000,0.00000,0.00000,0.00000,0.00000,0.25666,0.00000,1.00000])
        elif self.year==2019:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,1.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        elif self.year==2020:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,0.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        elif self.year==2021:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,0.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        elif self.year==2022:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,0.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        elif self.year==2023:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,0.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        elif self.year==2024:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,0.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        elif self.year==2025:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,0.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        elif self.year==2026:
            miehet_in=np.array([0.269709,0.115897,0.100621,0.087394,0.080160,0.067278,0.052751,0.039443,0.030027,0.023280,0.022410,0.018482,0.015504,0.014042,0.011996,0.009895,0.009591,0.009011,0.007855,0.006692,0.006976,0.006382,0.006373,0.005527,0.004992,0.004727,0.004177,0.004189,0.003907,0.003362,0.003654,0.003394,0.003120,0.002861,0.002873,0.002323,0.002363,0.002098,0.001818,0.001859,0.001611,0.001348,0.001129,0.001167,0.002069,0.003377,0.004348,0.005346,0.043282,0.130107,0.000000,0.000000,0.000000])
            naiset_in=np.array([0.31373,0.10342,0.10456,0.09527,0.08635,0.07221,0.05462,0.04097,0.03221,0.02819,0.05727,0.05133,0.04893,0.04294,0.04119,0.03559,0.03431,0.03207,0.02986,0.02547,0.02478,0.02315,0.02016,0.01879,0.01688,0.01592,0.01398,0.01337,0.01328,0.01178,0.01095,0.00986,0.00881,0.00803,0.00735,0.00676,0.00655,0.00614,0.00486,0.00458,0.00373,0.00302,0.00229,0.00191,0.00147,0.00197,0.00369,0.00622,0.00800,0.01322,0,0,0])
            miehet_ulos=np.array([0.66959,0.31098,0.29804,0.21910,0.30345,0.37986,0.43198,0.42020,0.41082,0.42450,0.41999,0.39704,0.34351,0.39286,0.41667,0.27857,0.30882,0.37500,0.39286,0.25000,0.33000,0.25000,0.38043,0.35000,0.30556,0.36765,0.25000,0.31667,0.39286,0.25000,0.32692,0.33333,0.34091,0.25000,0.45000,0.25000,0.37500,0.39286,0.25000,0.41667,0.45000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000,1.00000])
            naiset_ulos=np.array([0.724891,0.2,0.2,0.267584047,0.330199061,0.397874665,0.411892606,0.394239526,0.319643142,0.370672161,0.601628502,0.542579139,0.610861022,0.537332718,0.618460223,0.528486219,0.554784021,0.55942656,0.630835508,0.519547139,0.556471878,0.618060292,0.561205814,0.591992585,0.551545626,0.618498516,0.561291569,0.5,0.612180089,0.568581974,0.599439994,0.608381541,0.590793737,0.587158664,0.581558482,0.539230288,0.568325461,0.709754845,0.572104862,0.693709777,0.701485514,0.764725196,0.700235258,0.937531871,0.5,0.517646111,0.56778402,0.5,0.71104753,0.5,0,0,0])
        else:
            error(1)        
            
        inrate=np.zeros((101,self.n_groups))
        inrate[18:71,0] = miehet_in
        inrate[18:71,1] = miehet_in
        inrate[18:71,2] = miehet_in
        inrate[18:71,3] = naiset_in
        inrate[18:71,4] = naiset_in
        inrate[18:71,5] = naiset_in
        
        outrate=np.zeros((101,self.n_groups))
        outrate[18:71,0] = miehet_ulos
        outrate[18:71,1] = miehet_ulos
        outrate[18:71,2] = miehet_ulos
        outrate[18:71,3] = naiset_ulos
        outrate[18:71,4] = naiset_ulos
        outrate[18:71,5] = naiset_ulos
        
        #inrate=1-(1-inrate)**self.timestep
        #outrate=1-(1-outrate)**self.timestep

        inrate = self.scale_rates(inrate)
        outrate = self.scale_rates(outrate)

        return inrate,outrate
        
    def get_student_rate_v2(self,debug=False):
        '''
        opiskelijoiden intensiteetit eri ryhmille
        päivitetty 21.2.2022
        '''
        if not self.silent:
            print('student year',self.year)
            
        ### ['opiskelija in', 'opiskelija out']
        if self.year==2018:
            naiset_in=np.array([0.12273279965675322,0.11160450828860331,0.11731808442957334,0.11297465796993778,0.1036337012895957,0.08614210895078861,0.06595860746885851,0.05526268639402809,0.04518933967358721,0.03669596674957286,0.03904118933398032,0.03524312992209766,0.0308088572028457,0.028277093715385462,0.026154405568812586,0.023612404118019854,0.021286949002170447,0.019793881820456903,0.016790378266100563,0.014461977089580701,0.013149323005914872,0.011154074629404275,0.009679151345983497,0.008914111813389688,0.008356441962765422,0.007031121214976955,0.0067537277268230845,0.006027155021044004,0.005931176421999557,0.005308775114922137,0.004942562468518337,0.004736116932028795,0.004387121528739661,0.003441813518177192,0.0031956728322490298,0.003198154389539424,0.003165091636940377,0.002664034524897889,0.0026475727879515056,0.0020448401636525256,0.001760684954479292,0.001578802363656014,0.001095260576984527,0.0008840293841805821,0.000845775274135775,0.0018710735474410396,0.002786111898034722,0.006073111662636183,0.00863606133703361,0.010012998983984348,0.042129766116038414,0.11588565436677467,0.24507559569349688])
            naiset_out=np.array([0.5228111010820958,0.21239287000743168,0.2,0.268444411599006,0.3496437890042915,0.4069219402237887,0.37685254534074997,0.3814531842717387,0.3923321008025937,0.31659522010249896,0.3588454913474014,0.3804768519576042,0.3425557217376521,0.31259757912850183,0.315117942987157,0.3065745833243501,0.28800705718062014,0.3657724729975767,0.3303288477443407,0.3022656096496189,0.3930249150992685,0.31928303592324836,0.2969500843316849,0.3284890227512799,0.3594643130496862,0.30851432959732217,0.3280711318946801,0.26151237915554065,0.35328616384958683,0.3387699591704013,0.2776221665774053,0.32482110297848443,0.4651571127877313,0.32953338153558054,0.25,0.2898026793452976,0.412603275261479,0.28984209826474294,0.48604318444354144,0.4192466953703501,0.38650578989772577,0.581503542003106,0.5290910570428838,0.5636654908877131,0.25,1.0,0.0,0.0,0.0,0.0,0.2566558232149934,0.0,1.0])
            miehet_in=np.array([0.21782988924669733,0.21214885739343697,0.1621167362241827,0.10379486918687938,0.0991048965293504,0.08770050199668936,0.0678042572270642,0.04953656351292324,0.03672255446142088,0.028643379895209077,0.026915570738710815,0.021771720886351015,0.019491722875055715,0.01605328959126637,0.012715734674880718,0.011925848447666506,0.010374911195920586,0.009276414175165103,0.008397060365536025,0.007858634755485433,0.007158026349006284,0.006310097534706876,0.005846569152680486,0.005590293537828337,0.004786858192350428,0.004385512191567191,0.0042029040055697525,0.004072579326691882,0.0038160925494856654,0.0037581531207418893,0.0036811714533191895,0.003215385195096296,0.0030297329742298095,0.002807293915826274,0.002595621096410721,0.0026046269178138935,0.0022984372138415443,0.0022557352242213195,0.0021652826225823695,0.001960516964112717,0.0015276772153852832,0.0013036163077796768,0.0011094309417216772,0.0011998245426115383,0.00125651774787186,0.001701366485683156,0.0027132381439474193,0.0044309293605683635,0.005497353643468828,0.00657657294540393,0.02272677088090291,0.14431713166020116,0.188129628324588])
            miehet_out=np.array([0.44265906751087825,0.335480094305333,0.3400259997150715,0.22310101256254997,0.28108536579094867,0.38818687044500555,0.4332153962408911,0.4297560781058031,0.4143573845067755,0.4076486336494217,0.4348335082082421,0.36231987097941065,0.41565646758223485,0.44172571283482154,0.3030155612559544,0.36712608200081687,0.33348631574962295,0.33508362330282326,0.2878333428594163,0.3339336771049854,0.35166810966810963,0.31066460086348846,0.27128749843141015,0.3912505404505444,0.3392794366059181,0.28341562032615963,0.2817902144211211,0.3178420418831205,0.26314019036211694,0.2749511456719621,0.3857667891747411,0.30774872181711505,0.33342254735777793,0.3243231351500182,0.43695239424340937,0.25,0.37151397109465906,0.25,0.364191249087552,0.5006249839623089,0.4400929071830182,0.4799082562926422,0.25,0.6353814007837881,0.25,1.0,0.0,0.0,0.0,0.0,0.0,0.055666198834610714,1.0])
        elif self.year==2019:
            naiset_in=np.array([0.10523534828999995,0.11844760168675209,0.12003403430857121,0.11323833045182108,0.10389768556181984,0.09042663563792232,0.06951430338069839,0.05327347824718165,0.04392400131526796,0.03904888763863867,0.03843848001048897,0.03498221484706152,0.0342443822239913,0.03039639824621556,0.029106351176580177,0.02479021341417345,0.023412478607836656,0.02151877849661684,0.019255980537370848,0.015800666946495828,0.015090247422601899,0.013488524115611833,0.011662928695957064,0.010363981101177493,0.009130525858894177,0.008636183296121872,0.00741883161749936,0.007322421439782055,0.0070257868744936815,0.006186765019846357,0.005763276964039772,0.005280994326806069,0.0046652590532804605,0.004247025275716855,0.0038981133129516055,0.003609573792021186,0.003510466748501272,0.0033493082146649664,0.0026721884881477894,0.002573932083469642,0.0021195866762574503,0.0017753720514176942,0.0013698468051903737,0.0012445971275024702,0.0010890431303503792,0.0012500769438811567,0.0028955947520914217,0.005342564239509277,0.007397985864525227,0.013451657341740796,0.025025908596324756,0.043479971801815766,0.045890246040276084])
            naiset_out=np.array([0.5248914483851739,0.2,0.2,0.267584046799154,0.33019906131306076,0.39787466471120925,0.4118926057157116,0.3942395256577998,0.31964314205880395,0.37067216074996157,0.3516285023523088,0.29257913913619993,0.3608610215451164,0.28733271803025606,0.36846022345667784,0.27848621878733876,0.30478402056005227,0.309426559886036,0.38083550777888764,0.2695471386867477,0.3064718778301726,0.3680602919513841,0.31120581428822736,0.341992585251862,0.30154562625592274,0.368498515665744,0.3112915687370548,0.25,0.3621800887534872,0.318581974150732,0.3494399940652296,0.35838154094389985,0.3407937374653224,0.33715866350479057,0.33155848165529656,0.28923028821983987,0.31832546065936584,0.45975484511545917,0.32210486152471707,0.44370977737081124,0.45148551411938254,0.5147251957722068,0.45023525752592464,0.6875318714941356,0.25,1.0,0.0,0.0,0.0,0.0,0.2974496148091832,0.2984572098475967,1.0])
            miehet_in=np.array([0.20719876017186467,0.1903006922573759,0.15311565961773785,0.10738878856300604,0.10162451046488731,0.08828630663917773,0.06780938941065075,0.049722146272362204,0.037631655013861585,0.029169078387498014,0.027148096535251343,0.022221132040256823,0.01880357775290969,0.016984245959021115,0.01418690728741057,0.011926042845518577,0.011326679403597916,0.010547899913173125,0.009095138195318505,0.00909022112738829,0.007923332089534588,0.006977129404598227,0.006811472396708932,0.005896017315554813,0.005371397522274683,0.005010895674944528,0.004455251811322223,0.004337637001844833,0.00419706571760956,0.004634965030871847,0.003887734872833062,0.0034792656997109073,0.0033516301914347187,0.0029493282332823884,0.0029023921514525672,0.0026417854335887793,0.0024596233757094685,0.0022411607285372204,0.001948677287405627,0.0018475334466658624,0.0018677982235958512,0.0015627268296895046,0.0012091043099706645,0.0010384409636030843,0.0010692547989827866,0.001983033095093203,0.0039130327430301395,0,0,0,0,0,0])
            miehet_out=np.array([0.470017631413036,0.31084336225430076,0.29608834539961304,0.22185944325912393,0.303533120856546,0.3786308350823537,0.43055792678730065,0.42467150905252377,0.406364535982763,0.42180562278395045,0.42118135475615015,0.39594489855445325,0.3503479654387036,0.3967628156328855,0.4029506397196829,0.2843763146004393,0.30377671564435277,0.38468738387891466,0.3912755289914529,0.25,0.3559900350457295,0.257094787517675,0.37318598783288687,0.3207389625300073,0.32386790092569423,0.3569794584500467,0.28210386989692193,0.2816295947000035,0.3859154836927205,0.25,0.35965938405749676,0.3023622178123468,0.3705329153605014,0.2696432089307213,0.3656780426831494,0.31757504150228844,0.350211953392506,0.4054171351518295,0.3233909612064559,0.2783820372328495,0.4414376113832041,0.5238724404086632,0.5045191503782247,0.2849494264564616,0.460271302861321,1.0,0.0,0.0,0.0,0.0,0.15668368203802344,0.03551399230355665,1.0])
        elif self.year==2020:
            naiset_in=np.array([0.1485104671979425,0.13793386905874733,0.14357488180908656,0.13718483675034562,0.12987213514372423,0.10497729832125118,0.08087273688556554,0.060733532267360286,0.04670614770007605,0.040330165178329394,0.04435109430482806,0.038380034271074615,0.03551819291131552,0.033810570758919675,0.030649176831848635,0.027992941498853886,0.025166287729470074,0.022050420347387703,0.020409793203779815,0.017393252168580453,0.015293736812778649,0.013937092550361182,0.012812840846256602,0.010936511415721058,0.009741214782327529,0.008213657388869866,0.007733507728614818,0.007071105200944467,0.006702211468574501,0.006498609352974315,0.005657746350653562,0.005066339463435616,0.004826891640029522,0.0046838284476973585,0.0042214765764305145,0.003864311578883582,0.003535178104711032,0.0032480930611129394,0.002694189377798278,0.002587324883403604,0.0023053015207326415,0.0018214708301271957,0.0013700366521230561,0.0012452664521397688,0.0008334607034307489,0.001869292763165573,0.0033775081455934535,0.004408039826176579,0.006340569382428879,0.00901398905160636,0.022587383498804986,0.04697486789083566,0.06347987396464033])
            naiset_out=np.array([0.4968599434581046,0.22145732958455536,0.2,0.2500984450809274,0.3515846580081742,0.39997129267585785,0.43861354303984224,0.415044415097947,0.3570804220785046,0.2706295682117775,0.39529781590073304,0.33477623521425837,0.31334126654478967,0.3202220331882354,0.31040623290275493,0.3274318375906057,0.33618946114634274,0.2849937531548281,0.3429736300232481,0.3491301581421018,0.2799334902905959,0.3242390295010535,0.34797690380325974,0.3421099985825781,0.37680545269366605,0.2980121829449926,0.322775907670113,0.30031510395614563,0.2806647656802402,0.3857305987192692,0.3488573074707125,0.30043641443988106,0.2903743712966954,0.34905353929488336,0.4642664562626796,0.25,0.33296814999889485,0.4448622029800109,0.30602765815862143,0.39474352921124933,0.49593776007203566,0.5354119549124863,0.4507932496568584,0.6017117364021604,0.5805647247535026,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.25429564457676956,0.22588085908825167,0.16319822050339816,0.12204753992794395,0.11672902878634064,0.09935031667095802,0.07534724531473859,0.055343672831623315,0.04101419724321663,0.030837418932912114,0.031075997257730074,0.025254576380984904,0.020976889539311004,0.017852977633895956,0.016436413054250167,0.013554836517439066,0.012015433493510082,0.011662362021193147,0.010445343392600837,0.009097455677475243,0.007962444511826379,0.007523093959597622,0.007335840824050148,0.006708752531496065,0.0057285614804552,0.005094398854943061,0.004768005229740315,0.0044453489088635435,0.004356858330164833,0.004346618177246509,0.004744854229795004,0.0038918765380745292,0.0032147456338948214,0.0031416152998650043,0.002931402853771187,0.002521744235066671,0.0023330334675110307,0.0022498111761890464,0.00200422843055356,0.0018209829957033595,0.002075385639437433,0.001736664630683506,0.0011831972046808313,0.0009882516585847856,0.000796618300160854,0.0017442595347812993,0.003493341976600942,0,0,0,0,0,0])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.22653894983794862,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.35422920284762194,0.4319606430323576,0.4098603815584948,0.39090428851227366,0.3263666078373553,0.40466051757680177,0.354935844886245,0.26397593399976665,0.3368294343719255,0.36173965374677364,0.3528932425456602,0.2947969513399838,0.262779987716272,0.31708733692421825,0.3854086030025783,0.35006018363005276,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.42016962782442946,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.33331934747583236,0.30410074309687685,0.37212510868166776,0.36982066002876857,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.37831827529537276,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.12301918265221023,1.0])
        elif self.year==2021:
            naiset_in=np.array([0.15251093544945982,0.1398967185094771,0.15553120855295818,0.13964315829080687,0.1321693390379109,0.10781950795070083,0.08288467323866153,0.06246682968843306,0.04825678613150534,0.0415764678437453,0.0459397115307063,0.039752867667625084,0.03665239439755327,0.03417913566960126,0.0315902426307067,0.028707310055128478,0.025905758534010916,0.023157263367007887,0.021053491999596798,0.018350314494996002,0.01581962753805827,0.014489958801581677,0.01350108081884488,0.011447601703444197,0.010262689441690367,0.00869253333328537,0.008069267594324955,0.0075343305360571905,0.007092369998670866,0.007181027813796311,0.006011524051851076,0.00537639669686361,0.005191508383996944,0.0049321508531840665,0.004404332260001851,0.0035259201111810185,0.0036506162941635826,0.0034898676037654875,0.0028761978509944204,0.00271238487460538,0.002444478212794796,0.0019190800886052573,0.0014363792248516536,0.001242885450969854,0.0008979934252536269,0.0017840009040200173,0.0033950642577484855,0.00695004527495782,0.007688560779158271,0.011613397447783067,0.026498400947465653,0.05370996044021562,0.07734707408005627])
            naiset_out=np.array([0.4778280459857167,0.23020734653700103,0.2,0.274348380842367,0.3037482147859713,0.4178404740871059,0.4238268171328411,0.4139090260896656,0.3829372069765426,0.24878097978577185,0.42273119179452223,0.31308158635851735,0.34437642480072306,0.2941789300457664,0.3651983460499204,0.2598831519447992,0.3206263640122158,0.27989521058341854,0.354323170411218,0.3780097789051342,0.29791892570923273,0.298110559844993,0.34295360313789036,0.32610300566052774,0.3690920349447535,0.3077460456211444,0.33977039308241286,0.31802042422345544,0.3417546323881841,0.25,0.34600534731996435,0.2983178953042773,0.32364355009642565,0.29631337118414386,0.4903673161149987,0.2532245630299883,0.3099773167199287,0.42872026142054437,0.33019837342412184,0.4050937541929426,0.4922755475816699,0.5278790999384048,0.49266759542674965,0.5758476685657392,0.5242966890116438,1.0,0.0,0.0,0.0,0.0,0.0,0.1355118324227565,1.0])
            miehet_in=np.array([0.2593226766667572,0.22894442172545,0.1630075621846445,0.12208217430432015,0.11684466612508566,0.09950547473584158,0.0753281818709333,0.05527178941677515,0.04074583371106798,0.0311439074238384,0.03107999584196497,0.025256648090347427,0.020888747091378692,0.01794388163188276,0.016329040420070363,0.013560609192009264,0.012078274480339976,0.011669007014707735,0.010434642058839459,0.009044271791276369,0.007956512382079877,0.00858262726409275,0.007355814870570229,0.006712407569844331,0.0057362540446001765,0.005092104473763222,0.004728451539575374,0.004276915593185261,0.004376493035788588,0.004436383132129839,0.004563853263975466,0.003901873991843953,0.003228328106442919,0.003140201567150707,0.0029214580390850725,0.002506271969248166,0.0023326145702054074,0.0022519014768454418,0.0019990210095920647,0.0018121342641469302,0.002053664128967568,0.0017407450222581618,0.001176656492117002,0.000981760576953524,0.0007950262547229659,0.0016683757355041825,0.0034155818343578853,0,0,0,0,0,0])
            miehet_out=np.array([0.4180127713196594,0.3469104329624327,0.2829980284473801,0.2618081019673449,0.25833182111807285,0.3881319190665602,0.4230031544209656,0.44238590380533827,0.4504782664499435,0.3162921441222484,0.47840582998721726,0.3881811023109042,0.42178632190632515,0.3031452914725999,0.44406636741301964,0.3005448860615018,0.25,0.33453594230966427,0.3719240892587405,0.3676802365664384,0.34168714581207604,0.25,0.3266420561488364,0.36564800140547626,0.35302647009549337,0.32030296989570983,0.366008686492989,0.2800833848247918,0.2798823129038925,0.34428590338650883,0.25,0.4074653994640608,0.28003151228419526,0.28970346974391076,0.43082171296724325,0.35251541278903054,0.3029295226588249,0.3610236670017186,0.37614191407319764,0.464652044374537,0.25,0.6039795861453512,0.5026904723881953,0.5067513093982817,0.3120259358942991,1.0,0.0,0.0,0.0,0.0,0.13420804251976937,0.0640169037358073,1.0])
        elif self.year==2022:
            naiset_in=np.array([0.14508316998666182,0.13976562999909212,0.14583773650513904,0.13927340237585442,0.13247928165455078,0.10770366983059665,0.08268922458911628,0.0619492113150621,0.047858485191493286,0.041686993497395394,0.04596707386821721,0.03990052508741284,0.036606813078342744,0.034365040823565986,0.03158283777583493,0.028856329765616938,0.025716723773763016,0.022966053506910142,0.020915933587782452,0.01847520555151167,0.01592941273686207,0.014504898098064814,0.01347102590261455,0.011441298969085158,0.010223926332770514,0.008722752878836006,0.008092479393069348,0.007594092851287186,0.007061339859824428,0.006944824758093533,0.00596186580653943,0.005386993028574045,0.005181319912553125,0.004935146180855208,0.0044189602881005135,0.003711205141205939,0.0036516717453819103,0.003478828141481401,0.00288643219026182,0.002720853657184546,0.0024449180826398207,0.0019190193838563633,0.0014490135623537327,0.0012549677996123577,0.0008993745981639499,0.0018459646142574327,0.003472686792634839,0.007027167355859332,0.007830535849131664,0.011792344317052263,0.0275393665856176,0.055814777384515894,0.08036714812831067])
            naiset_out=np.array([0.497750581969366,0.22225055681866535,0.2,0.24662135115765288,0.3505013672751097,0.39691781337031046,0.44011414295012463,0.41056403323208324,0.35541863088453685,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.32581785754323855,0.33602537866689935,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.38691371118116674,0.2940538895511239,0.3174181620643195,0.306909227897189,0.28049469211609407,0.378611367938096,0.35055787940249294,0.29107929344623307,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.30810320135720287,0.44018670398661497,0.32359553780848765,0.38513634081472026,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.25429564457676956,0.22588085908825167,0.16319822050339816,0.12204753992794395,0.11672902878634064,0.09935031667095802,0.07534724531473859,0.055343672831623315,0.04101419724321663,0.030837418932912114,0.031075997257730074,0.025254576380984904,0.020976889539311004,0.017852977633895956,0.016436413054250167,0.013554836517439066,0.012015433493510082,0.011662362021193147,0.010445343392600837,0.009097455677475243,0.007962444511826379,0.007523093959597622,0.007335840824050148,0.006708752531496065,0.0057285614804552,0.005094398854943061,0.004768005229740315,0.0044453489088635435,0.004356858330164833,0.004346618177246509,0.004744854229795004,0.0038918765380745292,0.0032147456338948214,0.0031416152998650043,0.002931402853771187,0.002521744235066671,0.0023330334675110307,0.0022498111761890464,0.00200422843055356,0.0018209829957033595,0.002075385639437433,0.001736664630683506,0.0011831972046808313,0.0009882516585847856,0.000796618300160854,0.0017442595347812993,0.003493341976600942,0,0,0,0,0,0])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.22653894983794862,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.35422920284762194,0.4319606430323576,0.4098603815584948,0.39090428851227366,0.3263666078373553,0.40466051757680177,0.354935844886245,0.26397593399976665,0.3368294343719255,0.36173965374677364,0.3528932425456602,0.2947969513399838,0.262779987716272,0.31708733692421825,0.3854086030025783,0.35006018363005276,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.42016962782442946,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.33331934747583236,0.30410074309687685,0.37212510868166776,0.36982066002876857,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.37831827529537276,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.12301918265221023,1.0])
        elif self.year==2023:
            naiset_in=np.array([0.14508316998666182,0.13976562999909212,0.14583773650513904,0.13927340237585442,0.13247928165455078,0.10770366983059665,0.08268922458911628,0.0619492113150621,0.047858485191493286,0.041686993497395394,0.04596707386821721,0.03990052508741284,0.036606813078342744,0.034365040823565986,0.03158283777583493,0.028856329765616938,0.025716723773763016,0.022966053506910142,0.020915933587782452,0.01847520555151167,0.01592941273686207,0.014504898098064814,0.01347102590261455,0.011441298969085158,0.010223926332770514,0.008722752878836006,0.008092479393069348,0.007594092851287186,0.007061339859824428,0.006944824758093533,0.00596186580653943,0.005386993028574045,0.005181319912553125,0.004935146180855208,0.0044189602881005135,0.003711205141205939,0.0036516717453819103,0.003478828141481401,0.00288643219026182,0.002720853657184546,0.0024449180826398207,0.0019190193838563633,0.0014490135623537327,0.0012549677996123577,0.0008993745981639499,0.0018459646142574327,0.003472686792634839,0.007027167355859332,0.007830535849131664,0.011792344317052263,0.0275393665856176,0.055814777384515894,0.08036714812831067])
            naiset_out=np.array([0.497750581969366,0.22225055681866535,0.2,0.24662135115765288,0.3505013672751097,0.39691781337031046,0.44011414295012463,0.41056403323208324,0.35541863088453685,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.32581785754323855,0.33602537866689935,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.38691371118116674,0.2940538895511239,0.3174181620643195,0.306909227897189,0.28049469211609407,0.378611367938096,0.35055787940249294,0.29107929344623307,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.30810320135720287,0.44018670398661497,0.32359553780848765,0.38513634081472026,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.25429564457676956,0.22588085908825167,0.16319822050339816,0.12204753992794395,0.11672902878634064,0.09935031667095802,0.07534724531473859,0.055343672831623315,0.04101419724321663,0.030837418932912114,0.031075997257730074,0.025254576380984904,0.020976889539311004,0.017852977633895956,0.016436413054250167,0.013554836517439066,0.012015433493510082,0.011662362021193147,0.010445343392600837,0.009097455677475243,0.007962444511826379,0.007523093959597622,0.007335840824050148,0.006708752531496065,0.0057285614804552,0.005094398854943061,0.004768005229740315,0.0044453489088635435,0.004356858330164833,0.004346618177246509,0.004744854229795004,0.0038918765380745292,0.0032147456338948214,0.0031416152998650043,0.002931402853771187,0.002521744235066671,0.0023330334675110307,0.0022498111761890464,0.00200422843055356,0.0018209829957033595,0.002075385639437433,0.001736664630683506,0.0011831972046808313,0.0009882516585847856,0.000796618300160854,0.0017442595347812993,0.003493341976600942,0,0,0,0,0,0])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.22653894983794862,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.35422920284762194,0.4319606430323576,0.4098603815584948,0.39090428851227366,0.3263666078373553,0.40466051757680177,0.354935844886245,0.26397593399976665,0.3368294343719255,0.36173965374677364,0.3528932425456602,0.2947969513399838,0.262779987716272,0.31708733692421825,0.3854086030025783,0.35006018363005276,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.42016962782442946,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.33331934747583236,0.30410074309687685,0.37212510868166776,0.36982066002876857,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.37831827529537276,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.12301918265221023,1.0])
        elif self.year==2024:
            naiset_in=np.array([0.14508316998666182,0.13976562999909212,0.14583773650513904,0.13927340237585442,0.13247928165455078,0.10770366983059665,0.08268922458911628,0.0619492113150621,0.047858485191493286,0.041686993497395394,0.04596707386821721,0.03990052508741284,0.036606813078342744,0.034365040823565986,0.03158283777583493,0.028856329765616938,0.025716723773763016,0.022966053506910142,0.020915933587782452,0.01847520555151167,0.01592941273686207,0.014504898098064814,0.01347102590261455,0.011441298969085158,0.010223926332770514,0.008722752878836006,0.008092479393069348,0.007594092851287186,0.007061339859824428,0.006944824758093533,0.00596186580653943,0.005386993028574045,0.005181319912553125,0.004935146180855208,0.0044189602881005135,0.003711205141205939,0.0036516717453819103,0.003478828141481401,0.00288643219026182,0.002720853657184546,0.0024449180826398207,0.0019190193838563633,0.0014490135623537327,0.0012549677996123577,0.0008993745981639499,0.0018459646142574327,0.003472686792634839,0.007027167355859332,0.007830535849131664,0.011792344317052263,0.0275393665856176,0.055814777384515894,0.08036714812831067])
            naiset_out=np.array([0.497750581969366,0.22225055681866535,0.2,0.24662135115765288,0.3505013672751097,0.39691781337031046,0.44011414295012463,0.41056403323208324,0.35541863088453685,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.32581785754323855,0.33602537866689935,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.38691371118116674,0.2940538895511239,0.3174181620643195,0.306909227897189,0.28049469211609407,0.378611367938096,0.35055787940249294,0.29107929344623307,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.30810320135720287,0.44018670398661497,0.32359553780848765,0.38513634081472026,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.25429564457676956,0.22588085908825167,0.16319822050339816,0.12204753992794395,0.11672902878634064,0.09935031667095802,0.07534724531473859,0.055343672831623315,0.04101419724321663,0.030837418932912114,0.031075997257730074,0.025254576380984904,0.020976889539311004,0.017852977633895956,0.016436413054250167,0.013554836517439066,0.012015433493510082,0.011662362021193147,0.010445343392600837,0.009097455677475243,0.007962444511826379,0.007523093959597622,0.007335840824050148,0.006708752531496065,0.0057285614804552,0.005094398854943061,0.004768005229740315,0.0044453489088635435,0.004356858330164833,0.004346618177246509,0.004744854229795004,0.0038918765380745292,0.0032147456338948214,0.0031416152998650043,0.002931402853771187,0.002521744235066671,0.0023330334675110307,0.0022498111761890464,0.00200422843055356,0.0018209829957033595,0.002075385639437433,0.001736664630683506,0.0011831972046808313,0.0009882516585847856,0.000796618300160854,0.0017442595347812993,0.003493341976600942,0,0,0,0,0,0])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.22653894983794862,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.35422920284762194,0.4319606430323576,0.4098603815584948,0.39090428851227366,0.3263666078373553,0.40466051757680177,0.354935844886245,0.26397593399976665,0.3368294343719255,0.36173965374677364,0.3528932425456602,0.2947969513399838,0.262779987716272,0.31708733692421825,0.3854086030025783,0.35006018363005276,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.42016962782442946,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.33331934747583236,0.30410074309687685,0.37212510868166776,0.36982066002876857,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.37831827529537276,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.12301918265221023,1.0])
        elif self.year==2025:
            naiset_in=np.array([0.14508316998666182,0.13976562999909212,0.14583773650513904,0.13927340237585442,0.13247928165455078,0.10770366983059665,0.08268922458911628,0.0619492113150621,0.047858485191493286,0.041686993497395394,0.04596707386821721,0.03990052508741284,0.036606813078342744,0.034365040823565986,0.03158283777583493,0.028856329765616938,0.025716723773763016,0.022966053506910142,0.020915933587782452,0.01847520555151167,0.01592941273686207,0.014504898098064814,0.01347102590261455,0.011441298969085158,0.010223926332770514,0.008722752878836006,0.008092479393069348,0.007594092851287186,0.007061339859824428,0.006944824758093533,0.00596186580653943,0.005386993028574045,0.005181319912553125,0.004935146180855208,0.0044189602881005135,0.003711205141205939,0.0036516717453819103,0.003478828141481401,0.00288643219026182,0.002720853657184546,0.0024449180826398207,0.0019190193838563633,0.0014490135623537327,0.0012549677996123577,0.0008993745981639499,0.0018459646142574327,0.003472686792634839,0.007027167355859332,0.007830535849131664,0.011792344317052263,0.0275393665856176,0.055814777384515894,0.08036714812831067])
            naiset_out=np.array([0.497750581969366,0.22225055681866535,0.2,0.24662135115765288,0.3505013672751097,0.39691781337031046,0.44011414295012463,0.41056403323208324,0.35541863088453685,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.32581785754323855,0.33602537866689935,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.38691371118116674,0.2940538895511239,0.3174181620643195,0.306909227897189,0.28049469211609407,0.378611367938096,0.35055787940249294,0.29107929344623307,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.30810320135720287,0.44018670398661497,0.32359553780848765,0.38513634081472026,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.25429564457676956,0.22588085908825167,0.16319822050339816,0.12204753992794395,0.11672902878634064,0.09935031667095802,0.07534724531473859,0.055343672831623315,0.04101419724321663,0.030837418932912114,0.031075997257730074,0.025254576380984904,0.020976889539311004,0.017852977633895956,0.016436413054250167,0.013554836517439066,0.012015433493510082,0.011662362021193147,0.010445343392600837,0.009097455677475243,0.007962444511826379,0.007523093959597622,0.007335840824050148,0.006708752531496065,0.0057285614804552,0.005094398854943061,0.004768005229740315,0.0044453489088635435,0.004356858330164833,0.004346618177246509,0.004744854229795004,0.0038918765380745292,0.0032147456338948214,0.0031416152998650043,0.002931402853771187,0.002521744235066671,0.0023330334675110307,0.0022498111761890464,0.00200422843055356,0.0018209829957033595,0.002075385639437433,0.001736664630683506,0.0011831972046808313,0.0009882516585847856,0.000796618300160854,0.0017442595347812993,0.003493341976600942,0,0,0,0,0,0])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.22653894983794862,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.35422920284762194,0.4319606430323576,0.4098603815584948,0.39090428851227366,0.3263666078373553,0.40466051757680177,0.354935844886245,0.26397593399976665,0.3368294343719255,0.36173965374677364,0.3528932425456602,0.2947969513399838,0.262779987716272,0.31708733692421825,0.3854086030025783,0.35006018363005276,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.42016962782442946,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.33331934747583236,0.30410074309687685,0.37212510868166776,0.36982066002876857,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.37831827529537276,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.12301918265221023,1.0])
        elif self.year==2026:
            naiset_in=np.array([0.14508316998666182,0.13976562999909212,0.14583773650513904,0.13927340237585442,0.13247928165455078,0.10770366983059665,0.08268922458911628,0.0619492113150621,0.047858485191493286,0.041686993497395394,0.04596707386821721,0.03990052508741284,0.036606813078342744,0.034365040823565986,0.03158283777583493,0.028856329765616938,0.025716723773763016,0.022966053506910142,0.020915933587782452,0.01847520555151167,0.01592941273686207,0.014504898098064814,0.01347102590261455,0.011441298969085158,0.010223926332770514,0.008722752878836006,0.008092479393069348,0.007594092851287186,0.007061339859824428,0.006944824758093533,0.00596186580653943,0.005386993028574045,0.005181319912553125,0.004935146180855208,0.0044189602881005135,0.003711205141205939,0.0036516717453819103,0.003478828141481401,0.00288643219026182,0.002720853657184546,0.0024449180826398207,0.0019190193838563633,0.0014490135623537327,0.0012549677996123577,0.0008993745981639499,0.0018459646142574327,0.003472686792634839,0.007027167355859332,0.007830535849131664,0.011792344317052263,0.0275393665856176,0.055814777384515894,0.08036714812831067])
            naiset_out=np.array([0.497750581969366,0.22225055681866535,0.2,0.24662135115765288,0.3505013672751097,0.39691781337031046,0.44011414295012463,0.41056403323208324,0.35541863088453685,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.32581785754323855,0.33602537866689935,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.38691371118116674,0.2940538895511239,0.3174181620643195,0.306909227897189,0.28049469211609407,0.378611367938096,0.35055787940249294,0.29107929344623307,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.30810320135720287,0.44018670398661497,0.32359553780848765,0.38513634081472026,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.25429564457676956,0.22588085908825167,0.16319822050339816,0.12204753992794395,0.11672902878634064,0.09935031667095802,0.07534724531473859,0.055343672831623315,0.04101419724321663,0.030837418932912114,0.031075997257730074,0.025254576380984904,0.020976889539311004,0.017852977633895956,0.016436413054250167,0.013554836517439066,0.012015433493510082,0.011662362021193147,0.010445343392600837,0.009097455677475243,0.007962444511826379,0.007523093959597622,0.007335840824050148,0.006708752531496065,0.0057285614804552,0.005094398854943061,0.004768005229740315,0.0044453489088635435,0.004356858330164833,0.004346618177246509,0.004744854229795004,0.0038918765380745292,0.0032147456338948214,0.0031416152998650043,0.002931402853771187,0.002521744235066671,0.0023330334675110307,0.0022498111761890464,0.00200422843055356,0.0018209829957033595,0.002075385639437433,0.001736664630683506,0.0011831972046808313,0.0009882516585847856,0.000796618300160854,0.0017442595347812993,0.003493341976600942,0,0,0,0,0,0])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.22653894983794862,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.35422920284762194,0.4319606430323576,0.4098603815584948,0.39090428851227366,0.3263666078373553,0.40466051757680177,0.354935844886245,0.26397593399976665,0.3368294343719255,0.36173965374677364,0.3528932425456602,0.2947969513399838,0.262779987716272,0.31708733692421825,0.3854086030025783,0.35006018363005276,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.42016962782442946,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.33331934747583236,0.30410074309687685,0.37212510868166776,0.36982066002876857,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.37831827529537276,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.12301918265221023,1.0])
        else:
            error(1)        
            
        inrate=np.zeros((101,self.n_groups))
        inrate[18:71,0] =0.8*miehet_in
        inrate[18:71,1] =1.0*miehet_in
        inrate[18:71,2] =1.3*miehet_in
        inrate[18:71,3] =0.7*naiset_in
        inrate[18:71,4] =1.0*naiset_in
        inrate[18:71,5] =1.45*naiset_in
        
        outrate=np.zeros((101,self.n_groups))
        outrate[18:71,0]=miehet_out
        outrate[18:71,1]=miehet_out
        outrate[18:71,2]=miehet_out
        outrate[18:71,3]=naiset_out
        outrate[18:71,4]=naiset_out
        outrate[18:71,5]=naiset_out
        
        #inrate=1-(1-inrate)**self.timestep
        #outrate=1-(1-outrate)**self.timestep

        inrate = self.scale_rates(inrate)
        outrate = self.scale_rates(outrate)

        return inrate,outrate
        
    def get_student_rate_v5(self,debug=False):
        '''
        opiskelijoiden intensiteetit eri ryhmille
        päivitetty 21.2.2022
        '''
        if not self.silent:
            print('student year',self.year)
            
        ### ['opiskelija in', 'opiskelija out']
        if self.year==2018:
            naiset_in=np.array([0.1045112427539853,0.1119684824520239,0.1170866031710427,0.1105143198935405,0.1026447212152587,0.08607309363383248,0.06728041820426572,0.05657771382141256,0.0469450825880881,0.03845939622618336,0.04070868555120349,0.03732663583734386,0.03274977472882441,0.0300024801281191,0.02746449065807256,0.02500521554912527,0.0223345847573826,0.02072413093195478,0.01724137589159245,0.01492104240250213,0.01354637698549008,0.01095110594733395,0.009702589634732,0.00888685692332504,0.008240187071495531,0.007204445288236098,0.006547541529289192,0.006012155395452366,0.00598269968648697,0.005292966071132498,0.004896884074004315,0.004743283172138996,0.004391451560787413,0.003453416961437557,0.003194336589631344,0.003249208006963929,0.003152695019335669,0.002691055677085788,0.002642857952469582,0.00205290149338459,0.001781522827171722,0.00158952238571108,0.001100282146745875,0.0008336632844484473,0.0008273424969560867,0.001701574761311941,0.002219331585226861,0.004598152850673453,0.005614128004249144,0.006206650531951994,0.007950985470116715,0.0196919396809556,0.03803387469290102])
            naiset_out=np.array([0.5228111010820958,0.2123928700074317,0.2,0.268444411599006,0.3496437890042915,0.4069219402237887,0.37685254534075,0.3814531842717387,0.3923321008025937,0.316595220102499,0.3588454913474014,0.3804768519576042,0.3425557217376521,0.3125975791285018,0.315117942987157,0.3065745833243501,0.2880070571806201,0.3657724729975767,0.3303288477443407,0.3022656096496189,0.3930249150992685,0.3192830359232484,0.2969500843316849,0.3284890227512799,0.3594643130496862,0.3085143295973222,0.3280711318946801,0.2615123791555407,0.3532861638495868,0.3387699591704013,0.2776221665774053,0.3248211029784844,0.4651571127877313,0.3295333815355805,0.25,0.2898026793452976,0.412603275261479,0.2898420982647429,0.4860431844435414,0.4192466953703501,0.3865057898977258,0.581503542003106,0.5290910570428838,0.5636654908877131,0.25,1.0,0.0,0.0,0.0,0.0,0.2566558232149934,0.0,1.0])
            miehet_in=np.array([0.2041272492733309,0.2131609303690078,0.1628492631985396,0.1044653353920073,0.09906661914375138,0.08859074966316594,0.06835249963879152,0.04997710213351313,0.03711208479128458,0.02860709667282789,0.02713225047899674,0.02192476307768385,0.019674223529544,0.01611777862155633,0.01282367601964886,0.01197056110442768,0.01043469815108192,0.009349270194284278,0.008358982785732045,0.007931096451869395,0.007170839367295342,0.00636952628969095,0.00586130365133924,0.005622704591977144,0.004799489397280979,0.004340871884802496,0.004212517507712668,0.004081390290980359,0.00383776184523164,0.003758208247497428,0.003689690957429841,0.00319192107902176,0.003063357462466512,0.002809406635387147,0.00259951893240717,0.002610044290666629,0.002307520025530164,0.002219719838044223,0.002157815669020395,0.001968724092606032,0.001535448801470335,0.001312754482096303,0.001115470210793736,0.001146488592173442,0.00124846531742658,0.001598697485871337,0.002432715996787719,0.00377708487722775,0.004617186479907723,0.005128181532425734,0.009726117838616401,0.05866480335256738,0.0732571663182081])
            miehet_out=np.array([0.4426590675108782,0.335480094305333,0.3400259997150715,0.22310101256255,0.2810853657909487,0.3881868704450055,0.4332153962408911,0.4297560781058031,0.4143573845067755,0.4076486336494217,0.4348335082082421,0.3623198709794107,0.4156564675822348,0.4417257128348215,0.3030155612559544,0.3671260820008169,0.333486315749623,0.3350836233028233,0.2878333428594163,0.3339336771049854,0.3516681096681096,0.3106646008634885,0.2712874984314101,0.3912505404505444,0.3392794366059181,0.2834156203261596,0.2817902144211211,0.3178420418831205,0.2631401903621169,0.2749511456719621,0.3857667891747411,0.307748721817115,0.3334225473577779,0.3243231351500182,0.4369523942434094,0.25,0.3715139710946591,0.25,0.364191249087552,0.5006249839623089,0.4400929071830182,0.4799082562926422,0.25,0.6353814007837881,0.25,1.0,0.0,0.0,0.0,0.0,0.0,0.05566619883461071,1.0])
        elif self.year==2019:
            naiset_in=np.array([0.09713613116601327,0.1189346130598731,0.1199484169925703,0.110405441206044,0.1025580091805824,0.09001433107266507,0.07002893993495495,0.05459098392059213,0.04415989538396147,0.04014297458358559,0.04014148271009875,0.03683055969115845,0.03608329906543105,0.03210920661270102,0.03073919531335191,0.02581031691260426,0.0247094357634464,0.02252427997048582,0.01980057320187838,0.01596558151743735,0.01484537703851235,0.01356946826475834,0.01149825150837849,0.01051440412025771,0.009293319021799026,0.008741815738383599,0.007544800843362772,0.007246009781716905,0.007103925419000096,0.006217353602794611,0.005835176193078352,0.005218046558500679,0.00478909242901676,0.004296479001045584,0.003914581436516901,0.003606223729461301,0.003554892409532761,0.003366731522997489,0.002724814464345377,0.002583088334836045,0.002154764344582179,0.00179813865851627,0.001357056155194805,0.001195776913589821,0.001031093864397653,0.00115355253005991,0.002059071362879584,0.004243864200465291,0.005181405728772267,0.01036433203862871,0.006409804575781614,0.01026631679324439,0.01011058928567803])
            naiset_out=np.array([0.5248914483851739,0.2,0.2,0.267584046799154,0.3301990613130608,0.3978746647112092,0.4118926057157116,0.3942395256577998,0.319643142058804,0.3706721607499616,0.3516285023523088,0.2925791391361999,0.3608610215451164,0.2873327180302561,0.3684602234566778,0.2784862187873388,0.3047840205600523,0.309426559886036,0.3808355077788876,0.2695471386867477,0.3064718778301726,0.3680602919513841,0.3112058142882274,0.341992585251862,0.3015456262559227,0.368498515665744,0.3112915687370548,0.25,0.3621800887534872,0.318581974150732,0.3494399940652296,0.3583815409438998,0.3407937374653224,0.3371586635047906,0.3315584816552966,0.2892302882198399,0.3183254606593658,0.4597548451154592,0.3221048615247171,0.4437097773708112,0.4514855141193825,0.5147251957722068,0.4502352575259246,0.6875318714941356,0.25,1.0,0.0,0.0,0.0,0.0,0.2974496148091832,0.2984572098475967,1.0])
            miehet_in=np.array([0.1989222986823865,0.1931508750712299,0.1536572661473909,0.1078227412887751,0.1023207188783879,0.08926430838192541,0.0684964071832787,0.05039942013667412,0.03829471816047884,0.0295078088698377,0.0273366133682099,0.02259002740636936,0.01910712736541262,0.01728861530839747,0.01440674746039764,0.01213327786539289,0.01149466659393898,0.01070983747735921,0.009052322821377756,0.00918625484814354,0.007878379603842432,0.006985606997539627,0.006909908456827716,0.00592484577282102,0.005389445032817288,0.004971818953640295,0.004469783584804607,0.004338297425664534,0.004212387737634798,0.004644222047143876,0.003907452268491052,0.003488416990920622,0.003327042855467308,0.002958475493963872,0.002910880206591642,0.002673557221412427,0.00246859887275925,0.002322730100234389,0.001953562014585041,0.001863837380147519,0.001870896073917616,0.001577361821317526,0.001237104072180292,0.001000708299179997,0.001039344377186234,0.001858873767397505,0.003098925830483342,0.004605469055392128,0.004887652165738073,0.009053758959138136,0.004744654342474311,0.007669844248453244,0.01019723081000101])
            miehet_out=np.array([0.470017631413036,0.3108433622543008,0.296088345399613,0.2218594432591239,0.303533120856546,0.3786308350823537,0.4305579267873006,0.4246715090525238,0.406364535982763,0.4218056227839505,0.4211813547561502,0.3959448985544533,0.3503479654387036,0.3967628156328855,0.4029506397196829,0.2843763146004393,0.3037767156443528,0.3846873838789147,0.3912755289914529,0.25,0.3559900350457295,0.257094787517675,0.3731859878328869,0.3207389625300073,0.3238679009256942,0.3569794584500467,0.2821038698969219,0.2816295947000035,0.3859154836927205,0.25,0.3596593840574968,0.3023622178123468,0.3705329153605014,0.2696432089307213,0.3656780426831494,0.3175750415022884,0.350211953392506,0.4054171351518295,0.3233909612064559,0.2783820372328495,0.4414376113832041,0.5238724404086632,0.5045191503782247,0.2849494264564616,0.460271302861321,1.0,0.0,0.0,0.0,0.0,0.1566836820380234,0.03551399230355665,1.0])
        elif self.year==2020:
            naiset_in=np.array([0.135411442142319,0.1384941161992427,0.1441028461337157,0.1352642598301557,0.1286218228446922,0.104467953266226,0.08046436468878429,0.06078928448851911,0.04731093438821675,0.04119358894764926,0.04667018053090698,0.04072570039469984,0.03808984204187347,0.03596454971903797,0.03271236439081103,0.03033593642425451,0.02671526950612514,0.02324675402934826,0.0215877815886771,0.01796837908514269,0.01520020134330938,0.01413129913911048,0.01263839403659117,0.0109181376763186,0.009720897460910597,0.008206697284199607,0.007778051612284622,0.007180770905788991,0.006762414102538153,0.006531717850324525,0.005629917846146184,0.005096221530475046,0.004878701692402045,0.004708897821233759,0.004240797758775004,0.003889083346773443,0.003581952218721464,0.003261674495359932,0.002706919012834606,0.002596944452244608,0.002317365981519959,0.0018089472535536,0.001348976613143103,0.001141232837873608,0.0008125291824351184,0.001701947715252528,0.002279888194846345,0.003237166291044408,0.004221957169456673,0.005482854069588865,0.00548616478547358,0.0104814966862958,0.01318682607218423])
            naiset_out=np.array([0.4968599434581046,0.2214573295845554,0.2,0.2500984450809274,0.3515846580081742,0.3999712926758578,0.4386135430398422,0.415044415097947,0.3570804220785046,0.2706295682117775,0.395297815900733,0.3347762352142584,0.3133412665447897,0.3202220331882354,0.3104062329027549,0.3274318375906057,0.3361894611463427,0.2849937531548281,0.3429736300232481,0.3491301581421018,0.2799334902905959,0.3242390295010535,0.3479769038032597,0.3421099985825781,0.3768054526936661,0.2980121829449926,0.322775907670113,0.3003151039561456,0.2806647656802402,0.3857305987192692,0.3488573074707125,0.3004364144398811,0.2903743712966954,0.3490535392948834,0.4642664562626796,0.25,0.3329681499988948,0.4448622029800109,0.3060276581586214,0.3947435292112493,0.4959377600720357,0.5354119549124863,0.4507932496568584,0.6017117364021604,0.5805647247535026,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.2485809176349493,0.2296222749299612,0.1638119676677856,0.1225193552942026,0.1172111810756309,0.0998482352599164,0.0756593254566524,0.05590947263644241,0.04061730316040726,0.03077387655266727,0.03118228815523924,0.02531421466917504,0.0209447248655355,0.01789465905279873,0.01648000729944026,0.01356253218863301,0.01199145055018515,0.01185000071864886,0.01048134888631583,0.009073966679569887,0.007985476185513266,0.007592840606649173,0.007365608966331445,0.006734912214758595,0.005747335848149361,0.005113502043260957,0.004786830307431338,0.004505658209190297,0.004365513857415444,0.004361749209429513,0.004763119992101555,0.003887198105543985,0.003226174312122075,0.003152283100032988,0.002940532841110229,0.002527930844387606,0.00232731062815668,0.002257513442778808,0.002013692602809603,0.001827490167689765,0.002077977220836287,0.001742708203416403,0.001175025630720477,0.0009267780531911551,0.0007598173617063513,0.00160842523875304,0.002554595340136716,0.003885871761076502,0.004751325082786815,0.005434935048764543,0.003246654254467956,0.004636090741673568,0.005787975595713432])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.2265389498379486,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.3542292028476219,0.4319606430323576,0.4098603815584948,0.3909042885122737,0.3263666078373553,0.4046605175768018,0.354935844886245,0.2639759339997667,0.3368294343719255,0.3617396537467736,0.3528932425456602,0.2947969513399838,0.262779987716272,0.3170873369242183,0.3854086030025783,0.3500601836300528,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.4201696278244295,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.3333193474758324,0.3041007430968768,0.3721251086816678,0.3698206600287686,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.3783182752953728,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.1230191826522102,1.0])
        elif self.year==2021:
            naiset_in=np.array([0.071168616,0.131191651,0.147400017,0.136645928,0.128000474,0.112408426,0.084110823,0.063273336,0.048618604,0.039540883,0.043216774,0.042298072,0.039434918,0.034895304,0.034439311,0.030151454,0.028809369,0.025391961,0.022616678,0.02012215,0.017650643,0.014301288,0.013622756,0.01206717,0.01067288,0.009296154,0.008393686,0.007990103,0.007441166,0.006479396,0.006268179,0.005924842,0.006058477,0.005096838,0.004883115,0.003863878,0.003632852,0.003005923,0.003031872,0.002705236,0.002187421,0.002056032,0.001629513,0.001332584,0.001034556,0.000884166,0.002383295,0.003400837,0.006144378,0.006603095,0.005523473,0.006498029,0.010148896])
            naiset_out=np.array([0.433912267,0.211435878,0.2,0.253555113,0.314793899,0.404228774,0.442042799,0.423340526,0.396099472,0.287887308,0.291822257,0.334740682,0.358833924,0.256906391,0.334848122,0.289365228,0.333643767,0.31318825,0.309780087,0.327192078,0.402906416,0.275637418,0.313424849,0.343321867,0.347108831,0.384862959,0.25,0.321092729,0.37776751,0.288295512,0.298853725,0.458847939,0.25,0.308072384,0.443624782,0.332950246,0.421345466,0.278332415,0.362185065,0.490823313,0.327790095,0.470064083,0.515278085,0.503617062,0.450465831,1,0,0,0,0,0.332303566,0,1])
            miehet_in=np.array([0.19164,0.23321,0.15735,0.11842,0.11152,0.09818,0.07455,0.05462,0.03870,0.02954,0.02940,0.02404,0.02028,0.01801,0.01612,0.01438,0.01226,0.01130,0.01042,0.00943,0.00806,0.00781,0.00731,0.00644,0.00575,0.00536,0.00460,0.00448,0.00438,0.00411,0.00372,0.00358,0.00335,0.00323,0.00286,0.00282,0.00307,0.00250,0.00241,0.00214,0.00188,0.00126,0.00131,0.00100,0.00108,0.00171,0.00251,0.00497,0.00522,0.00500,0.00287,0.00427,0.00478 ])
            miehet_out=np.array([0.37733,0.39880,0.27676,0.23431,0.28554,0.39065,0.42556,0.45768,0.42301,0.37538,0.42164,0.39681,0.36932,0.33340,0.34308,0.38882,0.31364,0.30802,0.32799,0.37323,0.34116,0.25000,0.34958,0.34830,0.30641,0.38391,0.28207,0.37019,0.25000,0.34695,0.28255,0.32532,0.28544,0.36927,0.27749,0.46413,0.25000,0.30262,0.38389,0.40151,0.60879,0.25568,0.51873,0.26068,0.62582,1.00000,0.00000,0.00000,0.00000,0.00000,0.06052,0.07582,1.00000])
        elif self.year==2022:
            naiset_in=np.array([0.1428016694223775,0.140047593836668,0.1458895188813704,0.1384110270240242,0.1306008350187467,0.1063385563662234,0.08257038752445886,0.06173023618683171,0.04832005943876504,0.04213303197008492,0.0469361103544783,0.04083851922750453,0.03797700729491128,0.03651022833690683,0.03281475673650339,0.03024270485965709,0.02688578318865737,0.0236354486217584,0.02180241659667,0.01852560306097126,0.01567172768275305,0.01487289310522468,0.01325213987622109,0.01153362270627727,0.01041582316148645,0.008636531295339908,0.0082809460748972,0.007558663675415153,0.007252650896834137,0.006888615916163153,0.006043668604498033,0.005416993148929318,0.005211166186762171,0.00496070465455183,0.004433713389834425,0.003756991271002947,0.00373296650425094,0.003483923272752958,0.002901896645121344,0.002777526610357112,0.002470828712715786,0.001912766723440899,0.001444585627715646,0.001169062476020502,0.0008653774871467986,0.001693823730611293,0.002478806092433541,0.003787349671393262,0.005203236689834421,0.007164186901205432,0.006630824018780348,0.01233417254005097,0.0165194278731336])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.2549309672646262,0.2262419217474133,0.1642389086787548,0.1228727750021526,0.1176064954650435,0.1008728581150852,0.07593158397187931,0.05582175547076979,0.0410162646128991,0.03097612849508844,0.03156833940890369,0.02549642012091038,0.02110253175754812,0.01804671115046109,0.01666638591595256,0.01367849733532978,0.01212707688434808,0.01176482938713914,0.01054993110951507,0.009115271008841895,0.00800775402576943,0.007578960967193042,0.00738762583282038,0.006756445620483179,0.005785804787208581,0.00511591514601523,0.004762113034199772,0.004464306116702232,0.004369056861557743,0.004359370799811578,0.004773590984730828,0.003860197521309757,0.003226846359424872,0.00315385223855449,0.002938761262037,0.002529348437201889,0.002351954460584233,0.002258305498576694,0.002011164651860271,0.001838593237536789,0.002075280153870443,0.001745294029282238,0.00118135068564564,0.0009260855117493849,0.0007600976342892554,0.001606217992820975,0.00256228657147385,0.003889136075896537,0.004755925864618957,0.005440194822378399,0.003264597984626832,0.00466278959979697,0.005822487843677639])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.2265389498379486,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.3542292028476219,0.4319606430323576,0.4098603815584948,0.3909042885122737,0.3263666078373553,0.4046605175768018,0.354935844886245,0.2639759339997667,0.3368294343719255,0.3617396537467736,0.3528932425456602,0.2947969513399838,0.262779987716272,0.3170873369242183,0.3854086030025783,0.3500601836300528,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.4201696278244295,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.3333193474758324,0.3041007430968768,0.3721251086816678,0.3698206600287686,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.3783182752953728,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.1230191826522102,1.0])
        elif self.year==2023:
            naiset_in=np.array([0.143036152236401,0.1401663660436745,0.1453417272697744,0.1354226946451819,0.1308242950779087,0.1062367045664728,0.0823455650316775,0.06331580865276243,0.04927048855193434,0.04338474860115997,0.04843408297408732,0.0424199702322321,0.03956757921986297,0.03754721388102132,0.03447310665864044,0.03134776037939999,0.0278879117141325,0.02409879359735015,0.02251535211027556,0.01892181721704715,0.01604107739922351,0.0146805421223812,0.01323322538581995,0.01152636660141158,0.01029499847261552,0.008636014519067247,0.008168245698067325,0.00775042092853296,0.007093963991391437,0.006888477546733766,0.005996940359530651,0.005443966757991638,0.005194252823693264,0.004980711731926052,0.004433501793078249,0.003735378648548045,0.003719356323160302,0.00350539566636607,0.002902701900469199,0.002733700851527415,0.002490811879704305,0.001905146751562081,0.001450334323802379,0.001160680671216484,0.0008726425060889714,0.00168323603185555,0.002509028367634801,0.00378686285860357,0.005203084797379681,0.007164850646401757,0.006636961278549528,0.01235208282139869,0.01655191388656323])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.2476230719069289,0.2312112108990969,0.1637182272690905,0.1229037988906381,0.1175200784791921,0.1003783802561084,0.0758094512961006,0.0559143888838394,0.04099927787892375,0.03098925765487436,0.0313873062419715,0.02545939772537258,0.02122978327196421,0.01804218999865411,0.01654049704683339,0.01365286224441713,0.01215798800182145,0.01171669962600274,0.01052221498928155,0.00915037590978985,0.007998568982803076,0.00759131110339168,0.007365918626960859,0.0067439493586453,0.005740040446751515,0.005130629105305509,0.004767223346158775,0.004460744171610106,0.004368834959726306,0.004355952742889566,0.0047666006078812,0.003913385316043016,0.00322455189418306,0.003151187930699578,0.002940030556286335,0.002529012965065035,0.002374735478088446,0.002255111830973253,0.0020105543040612,0.00182592197354854,0.002080990398507435,0.001743019578460924,0.001187576336304106,0.000918431536543412,0.000760252928651986,0.001604110912741176,0.00261016227133907,0.00388808741440006,0.004754304320275916,0.005438219221362269,0.003257537602761943,0.004651905038605453,0.005808018814169436])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.2265389498379486,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.3542292028476219,0.4319606430323576,0.4098603815584948,0.3909042885122737,0.3263666078373553,0.4046605175768018,0.354935844886245,0.2639759339997667,0.3368294343719255,0.3617396537467736,0.3528932425456602,0.2947969513399838,0.262779987716272,0.3170873369242183,0.3854086030025783,0.3500601836300528,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.4201696278244295,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.3333193474758324,0.3041007430968768,0.3721251086816678,0.3698206600287686,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.3783182752953728,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.1230191826522102,1.0])
        elif self.year==2024:
            naiset_in=np.array([0.138029642436825,0.1402315953514695,0.1457450351484171,0.1361584264318642,0.1299647727654493,0.1066712085731226,0.08289719618365421,0.06319766496730447,0.04930604917184055,0.04357887231449166,0.04905813428814761,0.04298445862093447,0.04043573850359895,0.03797595377082061,0.03480808103277119,0.0316590838161579,0.02790543277764684,0.02438655935090167,0.02265080562642708,0.01894929067722408,0.01604727688206212,0.01473380124955053,0.0132113457636058,0.01134065489432104,0.01039189567592582,0.008652209497948272,0.008192989793952226,0.007609444126949838,0.007100871760429823,0.006981252817358847,0.006022945774229948,0.005412659376654938,0.0052043948145191,0.004958492196567486,0.004437071327062346,0.00375743568432756,0.003750946701388696,0.003483407300168469,0.002909449984231278,0.002731396661611528,0.002471763018637804,0.001923798134026258,0.001435501499531621,0.001169887951884721,0.0008650967141156491,0.001695195722028936,0.002494177227185837,0.003786375503081927,0.005202748142164794,0.007164972501163642,0.00663993253299884,0.01236224701883895,0.01657164359911649])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.2460364496346339,0.2276384128768441,0.1634271422900199,0.1222128317673607,0.1167011122506687,0.09920431444577034,0.07507659868782406,0.05519208798587215,0.04039115835533194,0.03103726588834959,0.03113376019891859,0.02523111175786676,0.02096675841958466,0.01784482104734037,0.01647778604047585,0.01353725736617759,0.01211941318451931,0.01176641940911961,0.01045410270589246,0.009163243747329066,0.007966769142453234,0.007505396837234798,0.007429326966943087,0.006722780878751384,0.005764280998879378,0.00512377701283729,0.004708533741494441,0.004472282405888584,0.00436860341821105,0.004372765234087675,0.004770191549815219,0.003857276465799268,0.003251722958356237,0.003150903800689907,0.002938766045808412,0.00256010107228205,0.002330031614418288,0.002256227653087276,0.002009479473171775,0.001826024083133353,0.002076966564717011,0.001743525806225692,0.001175141497653914,0.0009351921818995711,0.0007597417625428068,0.001605988076276308,0.002624762780474808,0.003887072997116498,0.004753019025985178,0.005436872387392923,0.003253265500738893,0.004645930134587875,0.005800696978852438])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.2265389498379486,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.3542292028476219,0.4319606430323576,0.4098603815584948,0.3909042885122737,0.3263666078373553,0.4046605175768018,0.354935844886245,0.2639759339997667,0.3368294343719255,0.3617396537467736,0.3528932425456602,0.2947969513399838,0.262779987716272,0.3170873369242183,0.3854086030025783,0.3500601836300528,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.4201696278244295,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.3333193474758324,0.3041007430968768,0.3721251086816678,0.3698206600287686,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.3783182752953728,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.1230191826522102,1.0])
        elif self.year==2025:
            naiset_in=np.array([0.138029642436825,0.1402315953514695,0.1457450351484171,0.1361584264318642,0.1299647727654493,0.1066712085731226,0.08289719618365421,0.06319766496730447,0.04930604917184055,0.04357887231449166,0.04905813428814761,0.04298445862093447,0.04043573850359895,0.03797595377082061,0.03480808103277119,0.0316590838161579,0.02790543277764684,0.02438655935090167,0.02265080562642708,0.01894929067722408,0.01604727688206212,0.01473380124955053,0.0132113457636058,0.01134065489432104,0.01039189567592582,0.008652209497948272,0.008192989793952226,0.007609444126949838,0.007100871760429823,0.006981252817358847,0.006022945774229948,0.005412659376654938,0.0052043948145191,0.004958492196567486,0.004437071327062346,0.00375743568432756,0.003750946701388696,0.003483407300168469,0.002909449984231278,0.002731396661611528,0.002471763018637804,0.001923798134026258,0.001435501499531621,0.001169887951884721,0.0008650967141156491,0.001695195722028936,0.002494177227185837,0.003786375503081927,0.005202748142164794,0.007164972501163642,0.00663993253299884,0.01236224701883895,0.01657164359911649])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.2460364496346339,0.2276384128768441,0.1634271422900199,0.1222128317673607,0.1167011122506687,0.09920431444577034,0.07507659868782406,0.05519208798587215,0.04039115835533194,0.03103726588834959,0.03113376019891859,0.02523111175786676,0.02096675841958466,0.01784482104734037,0.01647778604047585,0.01353725736617759,0.01211941318451931,0.01176641940911961,0.01045410270589246,0.009163243747329066,0.007966769142453234,0.007505396837234798,0.007429326966943087,0.006722780878751384,0.005764280998879378,0.00512377701283729,0.004708533741494441,0.004472282405888584,0.00436860341821105,0.004372765234087675,0.004770191549815219,0.003857276465799268,0.003251722958356237,0.003150903800689907,0.002938766045808412,0.00256010107228205,0.002330031614418288,0.002256227653087276,0.002009479473171775,0.001826024083133353,0.002076966564717011,0.001743525806225692,0.001175141497653914,0.0009351921818995711,0.0007597417625428068,0.001605988076276308,0.002624762780474808,0.003887072997116498,0.004753019025985178,0.005436872387392923,0.003253265500738893,0.004645930134587875,0.005800696978852438])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.2265389498379486,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.3542292028476219,0.4319606430323576,0.4098603815584948,0.3909042885122737,0.3263666078373553,0.4046605175768018,0.354935844886245,0.2639759339997667,0.3368294343719255,0.3617396537467736,0.3528932425456602,0.2947969513399838,0.262779987716272,0.3170873369242183,0.3854086030025783,0.3500601836300528,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.4201696278244295,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.3333193474758324,0.3041007430968768,0.3721251086816678,0.3698206600287686,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.3783182752953728,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.1230191826522102,1.0])
        elif self.year==2026:
            naiset_in=np.array([0.138029642436825,0.1402315953514695,0.1457450351484171,0.1361584264318642,0.1299647727654493,0.1066712085731226,0.08289719618365421,0.06319766496730447,0.04930604917184055,0.04357887231449166,0.04905813428814761,0.04298445862093447,0.04043573850359895,0.03797595377082061,0.03480808103277119,0.0316590838161579,0.02790543277764684,0.02438655935090167,0.02265080562642708,0.01894929067722408,0.01604727688206212,0.01473380124955053,0.0132113457636058,0.01134065489432104,0.01039189567592582,0.008652209497948272,0.008192989793952226,0.007609444126949838,0.007100871760429823,0.006981252817358847,0.006022945774229948,0.005412659376654938,0.0052043948145191,0.004958492196567486,0.004437071327062346,0.00375743568432756,0.003750946701388696,0.003483407300168469,0.002909449984231278,0.002731396661611528,0.002471763018637804,0.001923798134026258,0.001435501499531621,0.001169887951884721,0.0008650967141156491,0.001695195722028936,0.002494177227185837,0.003786375503081927,0.005202748142164794,0.007164972501163642,0.00663993253299884,0.01236224701883895,0.01657164359911649])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.2460364496346339,0.2276384128768441,0.1634271422900199,0.1222128317673607,0.1167011122506687,0.09920431444577034,0.07507659868782406,0.05519208798587215,0.04039115835533194,0.03103726588834959,0.03113376019891859,0.02523111175786676,0.02096675841958466,0.01784482104734037,0.01647778604047585,0.01353725736617759,0.01211941318451931,0.01176641940911961,0.01045410270589246,0.009163243747329066,0.007966769142453234,0.007505396837234798,0.007429326966943087,0.006722780878751384,0.005764280998879378,0.00512377701283729,0.004708533741494441,0.004472282405888584,0.00436860341821105,0.004372765234087675,0.004770191549815219,0.003857276465799268,0.003251722958356237,0.003150903800689907,0.002938766045808412,0.00256010107228205,0.002330031614418288,0.002256227653087276,0.002009479473171775,0.001826024083133353,0.002076966564717011,0.001743525806225692,0.001175141497653914,0.0009351921818995711,0.0007597417625428068,0.001605988076276308,0.002624762780474808,0.003887072997116498,0.004753019025985178,0.005436872387392923,0.003253265500738893,0.004645930134587875,0.005800696978852438])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.2265389498379486,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.3542292028476219,0.4319606430323576,0.4098603815584948,0.3909042885122737,0.3263666078373553,0.4046605175768018,0.354935844886245,0.2639759339997667,0.3368294343719255,0.3617396537467736,0.3528932425456602,0.2947969513399838,0.262779987716272,0.3170873369242183,0.3854086030025783,0.3500601836300528,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.4201696278244295,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.3333193474758324,0.3041007430968768,0.3721251086816678,0.3698206600287686,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.3783182752953728,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.1230191826522102,1.0])
        else:
            print("Error: Unknown year in ['opiskelija in', 'opiskelija out']")
            
        inrate=np.zeros((101,self.n_groups))
        inrate[18:71,0] =0.8*miehet_in
        inrate[18:71,1] =1.0*miehet_in
        inrate[18:71,2] =1.3*miehet_in
        inrate[18:71,3] =0.7*naiset_in
        inrate[18:71,4] =1.0*naiset_in
        inrate[18:71,5] =1.45*naiset_in
        
        outrate=np.zeros((101,self.n_groups))
        outrate[18:71,0]=miehet_out
        outrate[18:71,1]=miehet_out
        outrate[18:71,2]=miehet_out
        outrate[18:71,3]=naiset_out
        outrate[18:71,4]=naiset_out
        outrate[18:71,5]=naiset_out
        
        #inrate=1-(1-inrate)**self.timestep
        #outrate=1-(1-outrate)**self.timestep

        inrate = self.scale_rates(inrate)
        outrate = self.scale_rates(outrate)

        return inrate,outrate

    def get_student_rate_v6(self,debug=False):
        '''
        opiskelijoiden intensiteetit eri ryhmille
        päivitetty 21.2.2022
        '''
        if not self.silent:
            print('student year',self.year)
            
        ### ['opiskelija in', 'opiskelija out']
        if self.year==2018:
            naiset_in=np.array([0.1189622620674044,0.1130111469337334,0.1183003634111444,0.1138906564778244,0.1033587099769178,0.08646121365230616,0.06600735750251745,0.0554840653458027,0.04582032813926923,0.03707394184635084,0.03989405789670744,0.03571062724262496,0.03134192178471944,0.02905148032341019,0.02687453494679086,0.02392353107716901,0.02199103829734694,0.01987815208120245,0.01663008741992225,0.01457523105647668,0.01333897024256284,0.01092264981423945,0.00991589548898367,0.009111271095849527,0.00847651675714479,0.007142613003291366,0.006635784293518738,0.006059653709309863,0.005962632020221137,0.00545682237393167,0.004883936541314834,0.004842876539611489,0.004422653902500844,0.003470149758083657,0.00323769078623474,0.003273231482326978,0.003183243900440939,0.002708564774018914,0.002672136671454469,0.002071088003281602,0.001784679861190118,0.00159672811064774,0.001133435480270112,0.0008461375003112411,0.000829485796597552,0.001687551925015588,0.00222221908546296,0.004604615127031479,0.005626404114046996,0.006221511900872626,0.008081701475962386,0.02005617332178367,0.03881490584574494])
            naiset_out=np.array([0.5228111010820958,0.2123928700074317,0.2,0.268444411599006,0.3496437890042915,0.4069219402237887,0.37685254534075,0.3814531842717387,0.3923321008025937,0.316595220102499,0.3588454913474014,0.3804768519576042,0.3425557217376521,0.3125975791285018,0.315117942987157,0.3065745833243501,0.2880070571806201,0.3657724729975767,0.3303288477443407,0.3022656096496189,0.3930249150992685,0.3192830359232484,0.2969500843316849,0.3284890227512799,0.3594643130496862,0.3085143295973222,0.3280711318946801,0.2615123791555407,0.3532861638495868,0.3387699591704013,0.2776221665774053,0.3248211029784844,0.4651571127877313,0.3295333815355805,0.25,0.2898026793452976,0.412603275261479,0.2898420982647429,0.4860431844435414,0.4192466953703501,0.3865057898977258,0.581503542003106,0.5290910570428838,0.5636654908877131,0.25,1.0,0.0,0.0,0.0,0.0,0.2566558232149934,0.0,1.0])
            miehet_in=np.array([0.2087790659520636,0.2129789976001542,0.1629813066309915,0.1045779682983805,0.09928482146942923,0.08841219827087837,0.06926290725532012,0.05010363915538833,0.037189536602561,0.02866122387893108,0.02755005375981168,0.02191298033969929,0.01948306309128055,0.01611262056518743,0.01293252772684763,0.01192830245709139,0.01047373128499644,0.009419050935033646,0.008377367119436492,0.007979067844182229,0.007164393259434105,0.006316041814310266,0.005869118774639632,0.005610696814191389,0.004814800154897656,0.00437954974035624,0.004208676289858977,0.004090318237467841,0.00379348126035256,0.003757992363247477,0.003666296943452788,0.003226741953598719,0.003096443310951401,0.002807747742678734,0.002616155570436996,0.002611750944045816,0.002299604974806059,0.002258592823993104,0.0021564880597147,0.002005036909992347,0.001532794348406035,0.0013119372453563,0.001120636258830114,0.001146523808581313,0.001249910666214073,0.001601875535253235,0.00243344746398348,0.00377826461870493,0.004618430804973638,0.005129894693827949,0.009739511664263558,0.0587437702360852,0.07335378456435285])
            miehet_out=np.array([0.4426590675108782,0.335480094305333,0.3400259997150715,0.22310101256255,0.2810853657909487,0.3881868704450055,0.4332153962408911,0.4297560781058031,0.4143573845067755,0.4076486336494217,0.4348335082082421,0.3623198709794107,0.4156564675822348,0.4417257128348215,0.3030155612559544,0.3671260820008169,0.333486315749623,0.3350836233028233,0.2878333428594163,0.3339336771049854,0.3516681096681096,0.3106646008634885,0.2712874984314101,0.3912505404505444,0.3392794366059181,0.2834156203261596,0.2817902144211211,0.3178420418831205,0.2631401903621169,0.2749511456719621,0.3857667891747411,0.307748721817115,0.3334225473577779,0.3243231351500182,0.4369523942434094,0.25,0.3715139710946591,0.25,0.364191249087552,0.5006249839623089,0.4400929071830182,0.4799082562926422,0.25,0.6353814007837881,0.25,1.0,0.0,0.0,0.0,0.0,0.0,0.05566619883461071,1.0])
        elif self.year==2019:
            naiset_in=np.array([0.1025689858636138,0.1193547889994124,0.1203509083605012,0.1137929976651556,0.1045651534492033,0.09111000322103395,0.07102642409158991,0.05449349530099978,0.04470291409840713,0.04029073147532333,0.03945597942027212,0.0362418265723941,0.03507181207338541,0.03114026035022854,0.02982645583414378,0.025330168838731,0.02392789474649312,0.02242004943387613,0.01968321849135952,0.01638790251540123,0.0150597189195773,0.01394548244500694,0.01191470852705982,0.01057945547803282,0.009295023657649804,0.008719250757249376,0.007558938693039793,0.007313782782230309,0.007129465682678439,0.006270981129474294,0.005833459092027426,0.005268763655899244,0.00472432294327463,0.004300672319878163,0.003986740633873274,0.003656734288958222,0.003585606479689913,0.003395167193849567,0.002706475595983548,0.002618782862688735,0.002157981144092823,0.001819974159533889,0.001388362955501617,0.001190411889801782,0.001053113008591444,0.001095245492443791,0.002060956167720296,0.004248030459843325,0.005189447044474165,0.0103754664277368,0.006477752919223703,0.01039003519451353,0.01024709453361654])
            naiset_out=np.array([0.5248914483851739,0.2,0.2,0.267584046799154,0.3301990613130608,0.3978746647112092,0.4118926057157116,0.3942395256577998,0.319643142058804,0.3706721607499616,0.3516285023523088,0.2925791391361999,0.3608610215451164,0.2873327180302561,0.3684602234566778,0.2784862187873388,0.3047840205600523,0.309426559886036,0.3808355077788876,0.2695471386867477,0.3064718778301726,0.3680602919513841,0.3112058142882274,0.341992585251862,0.3015456262559227,0.368498515665744,0.3112915687370548,0.25,0.3621800887534872,0.318581974150732,0.3494399940652296,0.3583815409438998,0.3407937374653224,0.3371586635047906,0.3315584816552966,0.2892302882198399,0.3183254606593658,0.4597548451154592,0.3221048615247171,0.4437097773708112,0.4514855141193825,0.5147251957722068,0.4502352575259246,0.6875318714941356,0.25,1.0,0.0,0.0,0.0,0.0,0.2974496148091832,0.2984572098475967,1.0])
            miehet_in=np.array([0.2395297574450495,0.2048606674621096,0.1564577917509413,0.1112494926155343,0.1056138392115176,0.09212216474039778,0.07125689862416776,0.0517206270599667,0.03918604279342992,0.03031164517438502,0.02788031971584705,0.0228482457435426,0.01952332201404103,0.01736398198961019,0.01446171536559593,0.01239821599470651,0.01139680248912185,0.01077402226080841,0.009170969605311585,0.008556159810093193,0.007751319189539866,0.007061874905735257,0.006630525191719822,0.005811723036843289,0.00518812118930856,0.004914023329927768,0.004391206290647565,0.00434330512200736,0.004211375703801667,0.004604834789392333,0.003845488012057044,0.003425247626638015,0.003152432412612386,0.002958954010830702,0.002959005762416393,0.002515216473758852,0.002338663018258598,0.002234961489412342,0.001863167611357526,0.00177255912339848,0.001738796911226964,0.001433949955979109,0.001107765903809819,0.0008710871265426667,0.0009508437445343923,0.001814040985870881,0.003085588574644895,0.004657006546246774,0.004926934646898404,0.00859233337740236,0.003904093694517661,0.005678755672067101,0.007593770335443231])
            miehet_out=np.array([0.4559926849668035,0.3372834252866541,0.2974386421076541,0.2188290500990507,0.3017261574769077,0.3726432004252987,0.4361923753169692,0.4277270836458755,0.4027174163957941,0.4254337524979149,0.4271848334327279,0.3929723781790728,0.3553694528536954,0.3999657661075769,0.3976342405473475,0.3055427510497329,0.2922002047967489,0.3840051300968262,0.3856663552548156,0.25,0.3351798022642539,0.2950224086184328,0.359823252291887,0.3388382738406177,0.319816579407434,0.3417466986794718,0.267143064644798,0.2811399348279506,0.4009828932598903,0.25,0.3767347278120133,0.3213857304105032,0.3209111230699176,0.2752134179708876,0.3884258743826181,0.3391586578171212,0.3152735058622177,0.4337131683676927,0.3179513958398647,0.3058322498916559,0.4615061253903434,0.5162781859640233,0.5300056751516189,0.25,0.4102146531349924,1.0,0.0,0.0,0.0,0.0,0.1115466130365931,0.0359326060221748,1.0])
        elif self.year==2020:
            naiset_in=np.array([0.144447688003574,0.1387119378076733,0.1451371513826928,0.1385106658649326,0.1289945449520103,0.1095416825208082,0.08099589439226319,0.06161646367808226,0.04724535107656368,0.0406914999600581,0.04553808434213559,0.03918926533107096,0.03629128739326939,0.03413509238761219,0.03140908911907393,0.02861826335303495,0.02551739279603246,0.02248424282126952,0.02092693423294025,0.01777142283948037,0.01577457080579261,0.01424555892571903,0.01308405443274998,0.01114782787065815,0.009789396253046269,0.008278178390070182,0.007775289968997345,0.007175286036055894,0.006801603233225375,0.006698438082688666,0.005670450522603358,0.005189446732979783,0.004911840310473239,0.004741935751868404,0.004274565500399322,0.003984139582142967,0.003556499339494569,0.003346508609564138,0.002732674903253586,0.002622100721216001,0.002339120193317026,0.001825675593092334,0.001378601983468411,0.001173950286031241,0.0008076185246792922,0.001709305808224767,0.002288376983172281,0.003238807593432941,0.004224338200286109,0.005486202850516052,0.005500287967845904,0.0105083056560045,0.01322019745738881])
            naiset_out=np.array([0.4968599434581046,0.2214573295845554,0.2,0.2500984450809274,0.3515846580081742,0.3999712926758578,0.4386135430398422,0.415044415097947,0.3570804220785046,0.2706295682117775,0.395297815900733,0.3347762352142584,0.3133412665447897,0.3202220331882354,0.3104062329027549,0.3274318375906057,0.3361894611463427,0.2849937531548281,0.3429736300232481,0.3491301581421018,0.2799334902905959,0.3242390295010535,0.3479769038032597,0.3421099985825781,0.3768054526936661,0.2980121829449926,0.322775907670113,0.3003151039561456,0.2806647656802402,0.3857305987192692,0.3488573074707125,0.3004364144398811,0.2903743712966954,0.3490535392948834,0.4642664562626796,0.25,0.3329681499988948,0.4448622029800109,0.3060276581586214,0.3947435292112493,0.4959377600720357,0.5354119549124863,0.4507932496568584,0.6017117364021604,0.5805647247535026,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.2460401352433453,0.2311089721524066,0.1637391985394016,0.1225469306712244,0.1170644329772418,0.09957449720745276,0.07568084132404279,0.05554504892165495,0.04086221434685659,0.03121349811333848,0.03112822700701598,0.02527806752687466,0.02094113111301663,0.01789164120469582,0.01633186328683501,0.01355090334559439,0.01193560431300585,0.01181993647178326,0.01046453545870382,0.009145931685536148,0.007966714952853886,0.007518101899566792,0.007362678101028755,0.006733232571388189,0.005743389735680744,0.00510959188624889,0.004703103658784423,0.004490679897092653,0.004368390466624048,0.004356445844738487,0.004762951871304165,0.00390792194342681,0.003224794330466282,0.003151792415028362,0.002939350187059973,0.002568727589392196,0.002326638936765662,0.002257511098994203,0.002019261609169381,0.001867678472928125,0.002070193495097282,0.001744885706881835,0.001175081759468477,0.0009184611564833364,0.0007602963086795842,0.001609415755930658,0.002582317167954352,0.003887580809723736,0.004754017344319832,0.005438253482877712,0.003258608318050137,0.004654626508344899,0.005812724088929797])
            miehet_out=np.array([0.4261328690014479,0.365774133828772,0.2751746524432882,0.2265389498379486,0.3048317229848725,0.388916285784766,0.4220572574228149,0.4386772488990909,0.429488039510668,0.3542292028476219,0.4319606430323576,0.4098603815584948,0.3909042885122737,0.3263666078373553,0.4046605175768018,0.354935844886245,0.2639759339997667,0.3368294343719255,0.3617396537467736,0.3528932425456602,0.2947969513399838,0.262779987716272,0.3170873369242183,0.3854086030025783,0.3500601836300528,0.3285376726058435,0.3399155206005775,0.25,0.2550662215482956,0.4426311701393706,0.25,0.4201696278244295,0.2771433174365245,0.3229067541580099,0.4002727048032297,0.3333193474758324,0.3041007430968768,0.3721251086816678,0.3698206600287686,0.4512496044560773,0.25,0.6047187122487054,0.5085813662622936,0.4853499102794155,0.3783182752953728,1.0,0.0,0.0,0.0,0.0,0.07304928269587924,0.1230191826522102,1.0])
        elif self.year==2021:
            naiset_in=np.array([0.0761969306252637,0.1314590484663721,0.147488427301448,0.1378185944278513,0.1300559200772112,0.1130248259531331,0.08514773220423637,0.0637119170850079,0.04865253485904986,0.03986781816472555,0.04311333815599583,0.04233394480868369,0.03960982173561667,0.03506920497596029,0.03502304678322314,0.03060341789150655,0.02889617408083871,0.02549000655607324,0.02326748294687779,0.02033191526859356,0.01777675723831591,0.01473108494395825,0.01377149300484329,0.01219037417694326,0.01061675532563369,0.009386166539412228,0.008447595618052282,0.008050643147092546,0.007493530541624541,0.006515270863538593,0.006346334534375957,0.005985397658886404,0.006100006088536025,0.005139147749423203,0.00483418312429644,0.003940480111804915,0.003632109046735404,0.003034790337522098,0.003039856442006569,0.00275433211602094,0.002163358393955117,0.002083552734453807,0.001660781159726078,0.001306567486622791,0.00105498564588709,0.0008846151335125793,0.002389717424189254,0.003400139262697104,0.006143242141733854,0.00660066645697245,0.005511334532731415,0.006481508906533782,0.01011972745177427])
            naiset_out=np.array([0.4339122665935085,0.2114358777360992,0.2,0.2535551133800608,0.3147938987086143,0.4042287743453727,0.4420427988372257,0.4233405258946632,0.396099471818784,0.2878873084572042,0.2918222569211184,0.3347406823857764,0.3588339236040659,0.2569063914253862,0.3348481215978418,0.2893652275843502,0.3336437673177058,0.313188249589544,0.3097800871804321,0.3271920783481477,0.4029064163278991,0.2756374176548089,0.3134248490802386,0.3433218667505573,0.3471088306130001,0.3848629587539273,0.25,0.32109272949367,0.3777675098370531,0.2882955118976461,0.2988537249373059,0.4588479386838564,0.25,0.3080723844494213,0.4436247822766781,0.3329502460219667,0.4213454659438728,0.278332414553473,0.3621850646047252,0.4908233129504306,0.3277900954620531,0.4700640828220132,0.5152780851924501,0.5036170616263542,0.4504658310699005,1.0,0.0,0.0,0.0,0.0,0.3323035656476899,0.0,1.0])
            miehet_in=np.array([0.1861270611478132,0.2351121340369306,0.1570994788540432,0.1187129686572536,0.1110555147848439,0.09783226886465558,0.07383144241519865,0.05456616522140251,0.03865178663387393,0.02946745532744385,0.02916230913407083,0.02398470820697027,0.02029724049675151,0.01800240286411649,0.01616211463259394,0.01441212876392996,0.01223089035627785,0.01130791518901513,0.01043990548788992,0.009427068412154736,0.008030126164410728,0.007774082303705188,0.007321814032277019,0.006440948991867831,0.005748593657271562,0.005359682672670103,0.004602874968874928,0.004519423881788231,0.004375343101313559,0.004170938594448432,0.003721021516398222,0.003580561632657662,0.003364266693705922,0.003259727746640287,0.002861954822601525,0.002804434853048398,0.003073195243640584,0.002497376563066964,0.002412648497997981,0.002180502173290179,0.001876244744061277,0.001257613030851181,0.001300001367696814,0.001002079064260314,0.001082935955040173,0.001706360558464515,0.002499912320313502,0.004966053881460595,0.00521709801537277,0.004999335125980714,0.002866165644495991,0.004262849701886588,0.004770495502194722])
            miehet_out=np.array([0.377332777311347,0.3988043402988009,0.2767560217833823,0.2343105767271456,0.2855407418801911,0.3906512956769433,0.4255604172819298,0.4576768375419953,0.4230055986534804,0.3753816461017593,0.4216449539280469,0.3968115652155677,0.3693221676562831,0.3333975569415929,0.3430839099465988,0.3888171318064206,0.3136410092913715,0.3080187595197768,0.3279926743652453,0.3732281251581259,0.3411649733912884,0.25,0.3495826261824057,0.3482989303502461,0.3064107081992595,0.3839053427355313,0.2820743132171246,0.370186591003653,0.25,0.3469466532781604,0.2825547188765396,0.3253199550531766,0.2854352364497429,0.3692708965365583,0.2774860166344393,0.4641312449487505,0.25,0.3026222489143351,0.3838922174942714,0.4015120551688766,0.6087903773517462,0.2556793143778747,0.5187283651117922,0.2606793088391242,0.6258208955223881,1.0,0.0,0.0,0.0,0.0,0.06052362060655818,0.07581500999123829,1.0])
        elif self.year==2022:
            naiset_in=np.array([0.1428046610088682,0.1405467420514987,0.1467767506407297,0.1405276042507662,0.1334776824501001,0.1089986933182143,0.0834490647507872,0.06321465068079142,0.04866962273497848,0.04191896266626966,0.04713093337026819,0.04063341042849101,0.03753734194773627,0.03527576524649523,0.03237774449946842,0.02955802153253435,0.02626904710930003,0.02332394555969142,0.02180220737795296,0.01844839630946847,0.01606806532715281,0.01491422358432183,0.01364468929770658,0.01149558992399836,0.0104898622991237,0.008679916138237449,0.008160561988382888,0.007598769963243903,0.007111977457350045,0.007058440669292706,0.005988838718031812,0.00541685382148148,0.00527440378828329,0.004956118156271223,0.004434640355928114,0.003823294728905647,0.003651985422964226,0.003558920814132729,0.00290040085311434,0.002755563301188692,0.002470994691399364,0.001906796944913715,0.001437979983521272,0.001204813005951384,0.0008652591532474288,0.001688183691229555,0.002510155971826098,0.003791261402284335,0.00520961790418991,0.007174316807931234,0.006673327334587461,0.01241785686321658,0.01663728804646206])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.1883377713187432,0.2350241511446287,0.1570175168108909,0.1186136944692868,0.1111698458709202,0.0977928607222064,0.07433288094860685,0.05449606787910818,0.03862945851711583,0.02942090806353083,0.0296405647947194,0.02398736283635487,0.02028277722067908,0.01779757972361792,0.01632948357926723,0.01440948394626988,0.01225160923035327,0.01133654667207452,0.01044479308065568,0.009395082531577472,0.008033249842413794,0.007724802842472229,0.007320604812073332,0.006476268871162482,0.005753556652603197,0.005361087754628539,0.004599747152264987,0.004464993091712993,0.004375977534162388,0.004140105935386443,0.00372208041212306,0.003580787268410659,0.003366044624833907,0.003232202303590852,0.002862390532882496,0.002839580770224142,0.003054923554734419,0.002516136535063892,0.002411711335017427,0.002174321221450365,0.001875027835208574,0.001258507483189441,0.001310898869441039,0.00101082469391157,0.001068931275040304,0.001705712013793115,0.002491710111655462,0.004969563495777521,0.005223182088724834,0.005005774450741842,0.002886085606243784,0.004293426031042906,0.004805647869315892])
            miehet_out=np.array([0.377332777311347,0.3988043402988009,0.2767560217833823,0.2343105767271456,0.2855407418801911,0.3906512956769433,0.4255604172819298,0.4576768375419953,0.4230055986534804,0.3753816461017593,0.4216449539280469,0.3968115652155677,0.3693221676562831,0.3333975569415929,0.3430839099465988,0.3888171318064206,0.3136410092913715,0.3080187595197768,0.3279926743652453,0.3732281251581259,0.3411649733912884,0.25,0.3495826261824057,0.3482989303502461,0.3064107081992595,0.3839053427355313,0.2820743132171246,0.370186591003653,0.25,0.3469466532781604,0.2825547188765396,0.3253199550531766,0.2854352364497429,0.3692708965365583,0.2774860166344393,0.4641312449487505,0.25,0.3026222489143351,0.3838922174942714,0.4015120551688766,0.6087903773517462,0.2556793143778747,0.5187283651117922,0.2606793088391242,0.6258208955223881,1.0,0.0,0.0,0.0,0.0,0.06052362060655818,0.07581500999123829,1.0])
        elif self.year==2023:
            naiset_in=np.array([0.1459705561003973,0.1402474068870906,0.1465640181426445,0.1393880055221384,0.1325773441256396,0.1070411564011903,0.08261859470401639,0.06198982337971307,0.04806090349641165,0.04200303493895523,0.04627186671887104,0.04062680078827518,0.03771341267878456,0.03544424649412613,0.03231512577384997,0.02961360188881382,0.02647981076350182,0.02322430583617299,0.02156225557969842,0.018414746337437,0.01572889290507729,0.01502923671688917,0.01340527466638767,0.01158350565904876,0.01026088610938742,0.008816205447683377,0.008149723044166859,0.007619407043538137,0.007098397823745771,0.006890021529047731,0.006022693432812844,0.005415381857536938,0.005195648986903841,0.004958385368256494,0.004434467829210658,0.003735375899472874,0.003687221224534306,0.003518777592932785,0.002903295234930121,0.002750591626062841,0.002470822298633909,0.0019192913818319,0.001452921332307532,0.001161325297392224,0.0008765488060747389,0.001683057793142281,0.002477339252329916,0.003788958656532972,0.005206525023318366,0.007170356562809934,0.006660268712363968,0.01239838349147845,0.01661768870897954])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.1881689861030419,0.2354836265257595,0.1570606778533444,0.1186292886696726,0.1112258533171175,0.0978366593985137,0.07402324669325683,0.0545668270614624,0.03866756617291547,0.02949750808630291,0.02927964647468329,0.02391986302694767,0.02027965720198916,0.0178893196059901,0.01607656107286261,0.01432112389691845,0.01220928459749325,0.01121232777799186,0.01050987057927861,0.009392481296487998,0.00804422130915786,0.007724830624424703,0.007376648935960258,0.006430854335071944,0.005734731226996809,0.005353941952216714,0.004645707123779989,0.004481899524900086,0.004370874031112337,0.004094960258311379,0.003723084219924742,0.003580728915351956,0.003343432427441837,0.003233181002768708,0.002862743918570092,0.002803920471807352,0.003097433262062983,0.002497556136172444,0.002414386594276795,0.002155836082355663,0.001876180990466043,0.001258335712672657,0.00130031345395321,0.001002035937795917,0.001078161666848051,0.00170892602114236,0.002483443435110587,0.004966195031470598,0.005217278040574748,0.004999472850581848,0.002866461802393904,0.004263141978180097,0.004770676653937433])
            miehet_out=np.array([0.377332777311347,0.3988043402988009,0.2767560217833823,0.2343105767271456,0.2855407418801911,0.3906512956769433,0.4255604172819298,0.4576768375419953,0.4230055986534804,0.3753816461017593,0.4216449539280469,0.3968115652155677,0.3693221676562831,0.3333975569415929,0.3430839099465988,0.3888171318064206,0.3136410092913715,0.3080187595197768,0.3279926743652453,0.3732281251581259,0.3411649733912884,0.25,0.3495826261824057,0.3482989303502461,0.3064107081992595,0.3839053427355313,0.2820743132171246,0.370186591003653,0.25,0.3469466532781604,0.2825547188765396,0.3253199550531766,0.2854352364497429,0.3692708965365583,0.2774860166344393,0.4641312449487505,0.25,0.3026222489143351,0.3838922174942714,0.4015120551688766,0.6087903773517462,0.2556793143778747,0.5187283651117922,0.2606793088391242,0.6258208955223881,1.0,0.0,0.0,0.0,0.0,0.06052362060655818,0.07581500999123829,1.0])
        elif self.year==2024:
            naiset_in=np.array([0.1475480981141753,0.140733157696056,0.1471938295985389,0.1403243067602229,0.1338989773580968,0.1094500650182108,0.08355762662736574,0.06285678875085507,0.04850487285522195,0.04177309085190522,0.0464321348063203,0.04067258811148763,0.03778389368224435,0.03530200603920627,0.03227329243900059,0.02966800772487594,0.02645237272186436,0.02322768974121013,0.0219975924276136,0.01857617005704893,0.01617811508132982,0.01499801194658401,0.01371553900069181,0.01153928753642415,0.01036875709100365,0.008825463126212607,0.008294670731755887,0.007627187466544865,0.007186441192123857,0.006963543393209876,0.006046563548876202,0.005454002049462519,0.005304952500264519,0.005011052110725778,0.004498752023123486,0.003772189528476464,0.003711732208821754,0.003523593200000077,0.002974178272740484,0.002758911459366571,0.002497433332780523,0.001937009097716392,0.001457523751305408,0.001178240810259713,0.0008861744820298053,0.001686547386784601,0.002481530139267378,0.003789655100128966,0.005208478260909785,0.007174623236533072,0.006682530863619758,0.01244984726812024,0.01669973472534411])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.1881689861030419,0.2354836265257595,0.1570606778533444,0.1186292886696726,0.1112258533171175,0.0978366593985137,0.07402324669325683,0.0545668270614624,0.03866756617291547,0.02949750808630291,0.02927964647468329,0.02391986302694767,0.02027965720198916,0.0178893196059901,0.01607656107286261,0.01432112389691845,0.01220928459749325,0.01121232777799186,0.01050987057927861,0.009392481296487998,0.00804422130915786,0.007724830624424703,0.007376648935960258,0.006430854335071944,0.005734731226996809,0.005353941952216714,0.004645707123779989,0.004481899524900086,0.004370874031112337,0.004094960258311379,0.003723084219924742,0.003580728915351956,0.003343432427441837,0.003233181002768708,0.002862743918570092,0.002803920471807352,0.003097433262062983,0.002497556136172444,0.002414386594276795,0.002155836082355663,0.001876180990466043,0.001258335712672657,0.00130031345395321,0.001002035937795917,0.001078161666848051,0.00170892602114236,0.002483443435110587,0.004966195031470598,0.005217278040574748,0.004999472850581848,0.002866461802393904,0.004263141978180097,0.004770676653937433])
            miehet_out=np.array([0.377332777311347,0.3988043402988009,0.2767560217833823,0.2343105767271456,0.2855407418801911,0.3906512956769433,0.4255604172819298,0.4576768375419953,0.4230055986534804,0.3753816461017593,0.4216449539280469,0.3968115652155677,0.3693221676562831,0.3333975569415929,0.3430839099465988,0.3888171318064206,0.3136410092913715,0.3080187595197768,0.3279926743652453,0.3732281251581259,0.3411649733912884,0.25,0.3495826261824057,0.3482989303502461,0.3064107081992595,0.3839053427355313,0.2820743132171246,0.370186591003653,0.25,0.3469466532781604,0.2825547188765396,0.3253199550531766,0.2854352364497429,0.3692708965365583,0.2774860166344393,0.4641312449487505,0.25,0.3026222489143351,0.3838922174942714,0.4015120551688766,0.6087903773517462,0.2556793143778747,0.5187283651117922,0.2606793088391242,0.6258208955223881,1.0,0.0,0.0,0.0,0.0,0.06052362060655818,0.07581500999123829,1.0])
        elif self.year==2025:
            naiset_in=np.array([0.1475480981141753,0.140733157696056,0.1471938295985389,0.1403243067602229,0.1338989773580968,0.1094500650182108,0.08355762662736574,0.06285678875085507,0.04850487285522195,0.04177309085190522,0.0464321348063203,0.04067258811148763,0.03778389368224435,0.03530200603920627,0.03227329243900059,0.02966800772487594,0.02645237272186436,0.02322768974121013,0.0219975924276136,0.01857617005704893,0.01617811508132982,0.01499801194658401,0.01371553900069181,0.01153928753642415,0.01036875709100365,0.008825463126212607,0.008294670731755887,0.007627187466544865,0.007186441192123857,0.006963543393209876,0.006046563548876202,0.005454002049462519,0.005304952500264519,0.005011052110725778,0.004498752023123486,0.003772189528476464,0.003711732208821754,0.003523593200000077,0.002974178272740484,0.002758911459366571,0.002497433332780523,0.001937009097716392,0.001457523751305408,0.001178240810259713,0.0008861744820298053,0.001686547386784601,0.002481530139267378,0.003789655100128966,0.005208478260909785,0.007174623236533072,0.006682530863619758,0.01244984726812024,0.01669973472534411])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.1881689861030419,0.2354836265257595,0.1570606778533444,0.1186292886696726,0.1112258533171175,0.0978366593985137,0.07402324669325683,0.0545668270614624,0.03866756617291547,0.02949750808630291,0.02927964647468329,0.02391986302694767,0.02027965720198916,0.0178893196059901,0.01607656107286261,0.01432112389691845,0.01220928459749325,0.01121232777799186,0.01050987057927861,0.009392481296487998,0.00804422130915786,0.007724830624424703,0.007376648935960258,0.006430854335071944,0.005734731226996809,0.005353941952216714,0.004645707123779989,0.004481899524900086,0.004370874031112337,0.004094960258311379,0.003723084219924742,0.003580728915351956,0.003343432427441837,0.003233181002768708,0.002862743918570092,0.002803920471807352,0.003097433262062983,0.002497556136172444,0.002414386594276795,0.002155836082355663,0.001876180990466043,0.001258335712672657,0.00130031345395321,0.001002035937795917,0.001078161666848051,0.00170892602114236,0.002483443435110587,0.004966195031470598,0.005217278040574748,0.004999472850581848,0.002866461802393904,0.004263141978180097,0.004770676653937433])
            miehet_out=np.array([0.377332777311347,0.3988043402988009,0.2767560217833823,0.2343105767271456,0.2855407418801911,0.3906512956769433,0.4255604172819298,0.4576768375419953,0.4230055986534804,0.3753816461017593,0.4216449539280469,0.3968115652155677,0.3693221676562831,0.3333975569415929,0.3430839099465988,0.3888171318064206,0.3136410092913715,0.3080187595197768,0.3279926743652453,0.3732281251581259,0.3411649733912884,0.25,0.3495826261824057,0.3482989303502461,0.3064107081992595,0.3839053427355313,0.2820743132171246,0.370186591003653,0.25,0.3469466532781604,0.2825547188765396,0.3253199550531766,0.2854352364497429,0.3692708965365583,0.2774860166344393,0.4641312449487505,0.25,0.3026222489143351,0.3838922174942714,0.4015120551688766,0.6087903773517462,0.2556793143778747,0.5187283651117922,0.2606793088391242,0.6258208955223881,1.0,0.0,0.0,0.0,0.0,0.06052362060655818,0.07581500999123829,1.0])
        elif self.year==2026:
            naiset_in=np.array([0.1475480981141753,0.140733157696056,0.1471938295985389,0.1403243067602229,0.1338989773580968,0.1094500650182108,0.08355762662736574,0.06285678875085507,0.04850487285522195,0.04177309085190522,0.0464321348063203,0.04067258811148763,0.03778389368224435,0.03530200603920627,0.03227329243900059,0.02966800772487594,0.02645237272186436,0.02322768974121013,0.0219975924276136,0.01857617005704893,0.01617811508132982,0.01499801194658401,0.01371553900069181,0.01153928753642415,0.01036875709100365,0.008825463126212607,0.008294670731755887,0.007627187466544865,0.007186441192123857,0.006963543393209876,0.006046563548876202,0.005454002049462519,0.005304952500264519,0.005011052110725778,0.004498752023123486,0.003772189528476464,0.003711732208821754,0.003523593200000077,0.002974178272740484,0.002758911459366571,0.002497433332780523,0.001937009097716392,0.001457523751305408,0.001178240810259713,0.0008861744820298053,0.001686547386784601,0.002481530139267378,0.003789655100128966,0.005208478260909785,0.007174623236533072,0.006682530863619758,0.01244984726812024,0.01669973472534411])
            naiset_out=np.array([0.497750581969366,0.2222505568186653,0.2,0.2466213511576529,0.3505013672751097,0.3969178133703105,0.4401141429501246,0.4105640332320832,0.3554186308845368,0.2747007867530262,0.3876186577486662,0.3339795554710203,0.313362226508515,0.316602325420789,0.3138780325392212,0.3258178575432386,0.3360253786668994,0.2808201508798127,0.3431335876579265,0.3483111209426353,0.2837853314873987,0.3162910940927294,0.3523460493483269,0.3241578734201295,0.3869137111811667,0.2940538895511239,0.3174181620643195,0.306909227897189,0.2804946921160941,0.378611367938096,0.3505578794024929,0.2910792934462331,0.3060972150821648,0.3547367258066871,0.4479889165046663,0.25,0.3081032013572029,0.440186703986615,0.3235955378084877,0.3851363408147203,0.5015895086158744,0.5276249713487946,0.4874173808877964,0.560997980717272,0.5737799077746529,1.0,0.0,0.0,0.0,0.0,0.0,0.1940396792977816,1.0])
            miehet_in=np.array([0.1881689861030419,0.2354836265257595,0.1570606778533444,0.1186292886696726,0.1112258533171175,0.0978366593985137,0.07402324669325683,0.0545668270614624,0.03866756617291547,0.02949750808630291,0.02927964647468329,0.02391986302694767,0.02027965720198916,0.0178893196059901,0.01607656107286261,0.01432112389691845,0.01220928459749325,0.01121232777799186,0.01050987057927861,0.009392481296487998,0.00804422130915786,0.007724830624424703,0.007376648935960258,0.006430854335071944,0.005734731226996809,0.005353941952216714,0.004645707123779989,0.004481899524900086,0.004370874031112337,0.004094960258311379,0.003723084219924742,0.003580728915351956,0.003343432427441837,0.003233181002768708,0.002862743918570092,0.002803920471807352,0.003097433262062983,0.002497556136172444,0.002414386594276795,0.002155836082355663,0.001876180990466043,0.001258335712672657,0.00130031345395321,0.001002035937795917,0.001078161666848051,0.00170892602114236,0.002483443435110587,0.004966195031470598,0.005217278040574748,0.004999472850581848,0.002866461802393904,0.004263141978180097,0.004770676653937433])
            miehet_out=np.array([0.377332777311347,0.3988043402988009,0.2767560217833823,0.2343105767271456,0.2855407418801911,0.3906512956769433,0.4255604172819298,0.4576768375419953,0.4230055986534804,0.3753816461017593,0.4216449539280469,0.3968115652155677,0.3693221676562831,0.3333975569415929,0.3430839099465988,0.3888171318064206,0.3136410092913715,0.3080187595197768,0.3279926743652453,0.3732281251581259,0.3411649733912884,0.25,0.3495826261824057,0.3482989303502461,0.3064107081992595,0.3839053427355313,0.2820743132171246,0.370186591003653,0.25,0.3469466532781604,0.2825547188765396,0.3253199550531766,0.2854352364497429,0.3692708965365583,0.2774860166344393,0.4641312449487505,0.25,0.3026222489143351,0.3838922174942714,0.4015120551688766,0.6087903773517462,0.2556793143778747,0.5187283651117922,0.2606793088391242,0.6258208955223881,1.0,0.0,0.0,0.0,0.0,0.06052362060655818,0.07581500999123829,1.0])
        else:
            print("Error: Unknown year in ['opiskelija in', 'opiskelija out']")
            
        inrate=np.zeros((101,self.n_groups))
        inrate[18:71,0] =0.8*miehet_in
        inrate[18:71,1] =1.0*miehet_in
        inrate[18:71,2] =1.3*miehet_in
        inrate[18:71,3] =0.7*naiset_in
        inrate[18:71,4] =1.0*naiset_in
        inrate[18:71,5] =1.45*naiset_in
        
        outrate=np.zeros((101,self.n_groups))
        outrate[18:71,0]=miehet_out
        outrate[18:71,1]=miehet_out
        outrate[18:71,2]=miehet_out
        outrate[18:71,3]=naiset_out
        outrate[18:71,4]=naiset_out
        outrate[18:71,5]=naiset_out
        
        #inrate=1-(1-inrate)**self.timestep
        #outrate=1-(1-outrate)**self.timestep

        inrate = self.scale_rates(inrate)
        outrate = self.scale_rates(outrate)

        return inrate,outrate    


    def get_student_rate_v7(self,debug=False):
        '''
        opiskelijoiden intensiteetit eri ryhmille
        päivitetty 21.2.2022
        '''
        if not self.silent:
            print('student year',self.year)
                                                                            
        ### ['opiskelija in', 'opiskelija out']
        if self.year==2018:
            naiset_in=np.array([0.13467244,0.11335092,0.1212899,0.11896386,0.11213978,0.09444177,0.07474514,0.06321095,0.05232915,0.04306478,0.04508639,0.0406615,0.03552417,0.03238136,0.02989744,0.02656562,0.02375928,0.02159493,0.01832876,0.01612004,0.01443367,0.01166619,0.01031332,0.00941984,0.00851619,0.00724319,0.00678117,0.00616108,0.00604591,0.00542997,0.00492335,0.00483327,0.00449283,0.00353126,0.00326552,0.0033041,0.00324144,0.00275787,0.00272858,0.00212154,0.00183186,0.00165171,0.00115562,0.00088797,0.00087293,0.00169695,0.00253824,0.00484816,0.00598143,0.00660647,0.01116129,0.02796121,0.05459703])
            naiset_out=np.array([0.5228111,0.21239287,0.2,0.26844441,0.34964379,0.40692194,0.37685255,0.38145318,0.3923321,0.31659522,0.35884549,0.38047685,0.34255572,0.31259758,0.31511794,0.30657458,0.28800706,0.36577247,0.33032885,0.30226561,0.39302492,0.31928304,0.29695008,0.32848902,0.35946431,0.30851433,0.32807113,0.26151238,0.35328616,0.33876996,0.27762217,0.3248211,0.46515711,0.32953338,0.25,0.28980268,0.41260328,0.2898421,0.48604318,0.4192467,0.38650579,0.58150354,0.52909106,0.56366549,0.25,1.0,0.0,0.0,0.0,0.0,0.25665582,0.0,1.0])
            miehet_in=np.array([0.1243445,0.15318133,0.13149503,0.09220824,0.08808111,0.07794804,0.05923697,0.04254716,0.03131528,0.02385161,0.02313289,0.01853319,0.01632504,0.0134841,0.01075936,0.01021344,0.00895547,0.00814627,0.00740124,0.00711766,0.00650534,0.00580524,0.00547117,0.00531798,0.00455579,0.0041377,0.0040137,0.00390183,0.00364134,0.00360166,0.00352098,0.0030535,0.00288075,0.0026704,0.00248431,0.00249476,0.00216524,0.00206198,0.00198603,0.00179513,0.00136718,0.00112663,0.00096709,0.00096659,0.0011213,0.00125903,0.00214173,0.00296568,0.00368273,0.00379257,0.0,0.0,0.0])
            miehet_out=np.array([0.40461774,0.25696312,0.29189909,0.1949549,0.2542276,0.35930519,0.4007006,0.39348182,0.37593919,0.36663076,0.38843044,0.31484143,0.36356609,0.39152689,0.25328639,0.32288562,0.29152196,0.29630085,0.25416144,0.3019615,0.32446477,0.28648255,0.25078793,0.37391604,0.32402968,0.26644702,0.26740945,0.3040021,0.24947513,0.26138225,0.36914853,0.29318679,0.31533993,0.30753924,0.41812414,0.23150044,0.34902327,0.22326278,0.33599752,0.46965778,0.40056852,0.42936487,0.19498901,0.57338744,0.1804404,0.24135443,0.23447383,0.38321652,0.15319267,0.14541133,0.0,0.0,0.88272804])
        elif self.year==2019:
            naiset_in=np.array([0.11632861,0.12105989,0.12600206,0.12129966,0.11631868,0.10253334,0.08114253,0.06425356,0.05367121,0.04884841,0.04858653,0.04520786,0.04464177,0.03969702,0.03804441,0.03191548,0.0296307,0.02645424,0.02340031,0.01862824,0.01689564,0.01501265,0.01254389,0.01117381,0.00964234,0.00898523,0.00773759,0.00747879,0.0071937,0.00635401,0.00592467,0.00532164,0.00480882,0.00435767,0.00401196,0.0037487,0.00363225,0.00346855,0.00279141,0.00267637,0.00223207,0.00186256,0.00145389,0.00125431,0.00109498,0.00118391,0.00265028,0.00453626,0.0056028,0.01090083,0.0094605,0.01550068,0.01560361])
            naiset_out=np.array([0.52489145,0.2,0.2,0.26758405,0.33019906,0.39787466,0.41189261,0.39423953,0.31964314,0.37067216,0.3516285,0.29257914,0.36086102,0.28733272,0.36846022,0.27848622,0.30478402,0.30942656,0.38083551,0.26954714,0.30647188,0.36806029,0.31120581,0.34199259,0.30154563,0.36849852,0.31129157,0.25,0.36218009,0.31858197,0.34943999,0.35838154,0.34079374,0.33715866,0.33155848,0.28923029,0.31832546,0.45975485,0.32210486,0.44370978,0.45148551,0.5147252,0.45023526,0.68753187,0.25,1.0,0.0,0.0,0.0,0.0,0.29744961,0.29845721,1.0])
            miehet_in=np.array([0.24929736,0.20653852,0.1588001,0.11330082,0.10768663,0.09457441,0.07329626,0.05327275,0.04012144,0.031254,0.02866739,0.02352438,0.01996915,0.01792081,0.01496702,0.01270866,0.01174345,0.01104738,0.00944041,0.0087696,0.00799651,0.00720967,0.00674586,0.00591484,0.00527608,0.00492995,0.00445578,0.00441482,0.00426902,0.00465418,0.00390302,0.00344713,0.00320179,0.00300837,0.00297256,0.00259095,0.00238558,0.00228942,0.00191159,0.00182844,0.00181195,0.00149681,0.00117568,0.00092786,0.00103358,0.00190559,0.00425846,0.00506685,0.00527065,0.00893092,0.00525985,0.00767816,0.01029943])
            miehet_out=np.array([0.45599268,0.33728343,0.29743864,0.21882905,0.30172616,0.3726432,0.43619238,0.42772708,0.40271742,0.42543375,0.42718483,0.39297238,0.35536945,0.39996577,0.39763424,0.30554275,0.2922002,0.38400513,0.38566636,0.25,0.3351798,0.29502241,0.35982325,0.33883827,0.31981658,0.3417467,0.26714306,0.28113993,0.40098289,0.25,0.37673473,0.32138573,0.32091112,0.27521342,0.38842587,0.33915866,0.31527351,0.43371317,0.3179514,0.30583225,0.46150613,0.51627819,0.53000568,0.25,0.41021465,1.0,0.0,0.0,0.0,0.0,0.11154661,0.03593261,1.0])
        elif self.year==2020:
            naiset_in=np.array([0.16738028,0.14180853,0.15065338,0.14878026,0.14236665,0.12104609,0.0933957,0.07196865,0.05614978,0.0493216,0.05607978,0.04905642,0.04625118,0.04376512,0.03985275,0.03571199,0.03140936,0.02722725,0.02472133,0.02063303,0.0173006,0.01579137,0.01381025,0.01182237,0.01015892,0.00854867,0.00800823,0.00731621,0.00690911,0.00668187,0.00575287,0.00522941,0.00496326,0.00481082,0.00434047,0.0040019,0.00363462,0.00339317,0.00279605,0.00268267,0.00241243,0.00189378,0.00142134,0.00122463,0.0008563,0.0017715,0.00253302,0.00365979,0.00451674,0.00590779,0.00733164,0.01409942,0.01784589])
            naiset_out=np.array([0.49685994,0.22145733,0.2,0.25009845,0.35158466,0.39997129,0.43861354,0.41504442,0.35708042,0.27062957,0.39529782,0.33477624,0.31334127,0.32022203,0.31040623,0.32743184,0.33618946,0.28499375,0.34297363,0.34913016,0.27993349,0.32423903,0.3479769,0.34211,0.37680545,0.29801218,0.32277591,0.3003151,0.28066477,0.3857306,0.34885731,0.30043641,0.29037437,0.34905354,0.46426646,0.25,0.33296815,0.4448622,0.30602766,0.39474353,0.49593776,0.53541195,0.45079325,0.60171174,0.58056472,1.0,0.0,0.0,0.0,0.0,0.0,0.19403968,1.0])
            miehet_in=np.array([0.26373923,0.2310719,0.16582891,0.12459236,0.11913531,0.10215467,0.07752872,0.05703376,0.04186379,0.03180646,0.03194766,0.02599259,0.02152678,0.01834467,0.01681204,0.01386056,0.01234138,0.01193509,0.01065885,0.00932302,0.00809916,0.00767281,0.00745846,0.00682259,0.00583123,0.00518592,0.00482676,0.00452981,0.00442473,0.00442189,0.00481802,0.0039497,0.0032736,0.00320282,0.00299769,0.00258381,0.00239745,0.00230973,0.00206854,0.00188893,0.00213061,0.00182257,0.00123849,0.00098265,0.00081189,0.00167846,0.00290839,0.0045241,0.00503392,0.00574488,0.00426948,0.0061171,0.00765938])
            miehet_out=np.array([0.42613287,0.36577413,0.27517465,0.22653895,0.30483172,0.38891629,0.42205726,0.43867725,0.42948804,0.3542292,0.43196064,0.40986038,0.39090429,0.32636661,0.40466052,0.35493584,0.26397593,0.33682943,0.36173965,0.35289324,0.29479695,0.26277999,0.31708734,0.3854086,0.35006018,0.32853767,0.33991552,0.25,0.25506622,0.44263117,0.25,0.42016963,0.27714332,0.32290675,0.4002727,0.33331935,0.30410074,0.37212511,0.36982066,0.4512496,0.25,0.60471871,0.50858137,0.48534991,0.37831828,1.0,0.0,0.0,0.0,0.0,0.07304928,0.12301918,1.0])
        elif self.year==2021:
            naiset_in=np.array([0.08906806,0.13346779,0.15253401,0.1462777,0.13975957,0.1243825,0.09715509,0.07304517,0.05816417,0.04802516,0.05463311,0.05484426,0.05213694,0.0475933,0.0470904,0.04066662,0.03742728,0.03239984,0.02774445,0.02396402,0.02046231,0.016147,0.01484988,0.01309661,0.01126757,0.00969547,0.00871512,0.00827882,0.00759188,0.00662728,0.00634996,0.00604329,0.00618305,0.00517186,0.00495613,0.00398315,0.00369589,0.00310121,0.00306456,0.00279713,0.00222767,0.00215736,0.00176216,0.00141166,0.00112686,0.00099791,0.00273918,0.00433818,0.00659909,0.00741774,0.00906959,0.01081577,0.01710478])
            naiset_out=np.array([0.43391227,0.21143588,0.2,0.25355511,0.3147939,0.40422877,0.4420428,0.42334053,0.39609947,0.28788731,0.29182226,0.33474068,0.35883392,0.25690639,0.33484812,0.28936523,0.33364377,0.31318825,0.30978009,0.32719208,0.40290642,0.27563742,0.31342485,0.34332187,0.34710883,0.38486296,0.25,0.32109273,0.37776751,0.28829551,0.29885372,0.45884794,0.25,0.30807238,0.44362478,0.33295025,0.42134547,0.27833241,0.36218506,0.49082331,0.3277901,0.47006408,0.51527809,0.50361706,0.45046583,1.0,0.0,0.0,0.0,0.0,0.33230357,0.0,1.0])
            miehet_in=np.array([0.1992835,0.23662884,0.15924371,0.11985195,0.11286695,0.0996534,0.07569829,0.05586507,0.0393362,0.03031208,0.02988547,0.02461228,0.02080134,0.01825249,0.01651504,0.01480946,0.01243171,0.01152871,0.01068362,0.00963085,0.00817836,0.00791277,0.00736941,0.00655238,0.00581595,0.00545779,0.00466062,0.00455844,0.00440443,0.00414793,0.00375099,0.00363381,0.00338708,0.00330626,0.00291609,0.00285969,0.00314203,0.00254509,0.00247367,0.00218915,0.00196004,0.0013071,0.00138259,0.00107003,0.00114566,0.00179176,0.00277378,0.00597963,0.00566875,0.0054709,0.00430906,0.0064578,0.007275])
            miehet_out=np.array([0.37733278,0.39880434,0.27675602,0.23431058,0.28554074,0.3906513,0.42556042,0.45767684,0.4230056,0.37538165,0.42164495,0.39681157,0.36932217,0.33339756,0.34308391,0.38881713,0.31364101,0.30801876,0.32799267,0.37322813,0.34116497,0.25,0.34958263,0.34829893,0.30641071,0.38390534,0.28207431,0.37018659,0.25,0.34694665,0.28255472,0.32531996,0.28543524,0.3692709,0.27748602,0.46413124,0.25,0.30262225,0.38389222,0.40151206,0.60879038,0.25567931,0.51872837,0.26067931,0.6258209,1.0,0.0,0.0,0.0,0.0,0.06052362,0.07581501,1.0])
        elif self.year==2022:
            naiset_in=np.array([0.08789059,0.12457887,0.1440948,0.13306599,0.12717446,0.10772037,0.08943274,0.06904358,0.0528419,0.04361285,0.04568765,0.04336425,0.04180935,0.03914718,0.03513438,0.0327365,0.02952184,0.02740523,0.02405388,0.01921116,0.01780798,0.01561563,0.01309704,0.01194283,0.01037462,0.00931014,0.00809488,0.00717369,0.00678179,0.0065325,0.00559317,0.00533115,0.00509579,0.00430759,0.00389178,0.00401629,0.00362754,0.00313259,0.0027766,0.0025525,0.00237437,0.00185585,0.00181386,0.00132011,0.00121913,0.001478,0.00240108,0.00456101,0.00475772,0.00624888,0.00813183,0.01280788,0.01779886])
            naiset_out=np.array([0.46044892,0.2,0.2,0.24557315,0.33569296,0.36548467,0.42005807,0.44736124,0.38882288,0.32435306,0.34123184,0.29057782,0.32249532,0.33381288,0.2884561,0.30953205,0.30102233,0.3153493,0.39015106,0.28120552,0.3078357,0.385617,0.28270544,0.3374303,0.33633224,0.35344828,0.34945068,0.30740634,0.28164608,0.39264104,0.29840315,0.29595955,0.40756575,0.34933766,0.37249547,0.25,0.40015946,0.38122357,0.34486927,0.36489388,0.59595385,0.25,0.57134523,0.41559919,0.51393206,1.0,0.0,0.0,0.0,0.0,0.12870503,0.14513807,1.0])
            miehet_in=np.array([0.18913369,0.2339563,0.15496182,0.11435934,0.1056891,0.09207693,0.07226127,0.05158326,0.03764564,0.02877522,0.02782627,0.02415575,0.02012842,0.01720538,0.01510446,0.01295985,0.01189361,0.0103659,0.00939588,0.00866414,0.00796314,0.00702901,0.00638882,0.0059385,0.00582425,0.00507966,0.00460587,0.00422917,0.00398683,0.003679,0.0036916,0.00320226,0.00314587,0.00298309,0.00282307,0.00263469,0.00214198,0.00208253,0.0018805,0.00168343,0.00171254,0.00141734,0.00144929,0.00111588,0.00108735,0.00101039,0.00231922,0.00433122,0.00585659,0.0058864,0.00402313,0.00505903,0.00647901])
            miehet_out=np.array([0.36702452,0.40456872,0.29140007,0.2491416,0.30214987,0.36887336,0.4479122,0.4428206,0.42478191,0.38446705,0.38644035,0.41389851,0.38415784,0.35899479,0.37449099,0.32573067,0.35859656,0.33298082,0.3022702,0.31109791,0.36224891,0.31681758,0.3105734,0.25630064,0.3677496,0.34025451,0.40737616,0.25,0.33332154,0.25,0.38438529,0.26840842,0.3088869,0.32219007,0.31638265,0.44402637,0.29951459,0.35629415,0.38335121,0.26179522,0.47380451,0.27790359,0.53443358,0.33699774,0.38862731,1.0,0.0,0.0,0.0,0.0,0.20497407,0.06736034,1.0])
        elif self.year==2023:
            naiset_in=np.array([0.07008732,0.10847047,0.12507268,0.11134759,0.10433328,0.08591385,0.06840144,0.05039075,0.03642598,0.0293956,0.03191414,0.02930064,0.02852584,0.0262876,0.02426917,0.0230409,0.02141101,0.01994526,0.01814538,0.01515183,0.0143384,0.01329394,0.01118536,0.0107169,0.0095609,0.00859098,0.00765546,0.0068208,0.0064085,0.00622865,0.0053144,0.00506742,0.0048621,0.0040833,0.00367829,0.00378842,0.00341903,0.00291823,0.00254312,0.00232357,0.00206515,0.00161078,0.00147696,0.00103494,0.00090526,0.00121842,0.00175865,0.00394896,0.00308256,0.00419167,0.0,0.0,0.0])
            naiset_out=np.array([0.44771981,0.16889882,0.16347767,0.20535988,0.28838555,0.31131847,0.35447369,0.36900018,0.28858079,0.21974921,0.22377924,0.16334221,0.19305283,0.19757515,0.16177747,0.18725651,0.18537905,0.20862765,0.29817996,0.20626951,0.24226593,0.33730229,0.23850461,0.30514161,0.31230993,0.33445581,0.33508434,0.29452157,0.26782408,0.380398,0.28569183,0.28408419,0.39574329,0.3364824,0.35941189,0.23294788,0.38444862,0.36266522,0.32243374,0.34122552,0.56007298,0.20687067,0.51483858,0.34608574,0.42694278,0.15629232,0.41739372,0.13044312,0.33576282,0.08575096,-0.04522697,-0.05624908,0.7686049])
            miehet_in=np.array([0.18945556,0.23182279,0.1546446,0.11449623,0.10524907,0.09144792,0.07160752,0.0511215,0.03717709,0.02858981,0.02773385,0.02395179,0.02008584,0.01713306,0.01509929,0.01297116,0.01203456,0.01033623,0.00935392,0.00868574,0.00798784,0.0070109,0.00639063,0.00592483,0.00580849,0.00507104,0.00459663,0.00423752,0.00397986,0.00368325,0.00368451,0.00319969,0.00314637,0.00298052,0.00281364,0.00262785,0.00213733,0.00208358,0.00188341,0.00167742,0.00170836,0.00141303,0.00145037,0.00111363,0.00108542,0.00101353,0.00232112,0.00502688,0.00589581,0.00594202,0.00403168,0.00507025,0.0064939])
            miehet_out=np.array([0.36702452,0.40456872,0.29140007,0.2491416,0.30214987,0.36887336,0.4479122,0.4428206,0.42478191,0.38446705,0.38644035,0.41389851,0.38415784,0.35899479,0.37449099,0.32573067,0.35859656,0.33298082,0.3022702,0.31109791,0.36224891,0.31681758,0.3105734,0.25630064,0.3677496,0.34025451,0.40737616,0.25,0.33332154,0.25,0.38438529,0.26840842,0.3088869,0.32219007,0.31638265,0.44402637,0.29951459,0.35629415,0.38335121,0.26179522,0.47380451,0.27790359,0.53443358,0.33699774,0.38862731,1.0,0.0,0.0,0.0,0.0,0.20497407,0.06736034,1.0])
        elif self.year==2024:
            naiset_in=np.array([0.08787564,0.12427007,0.14636056,0.13665955,0.1321793,0.11388907,0.09513967,0.07493453,0.05829308,0.04878187,0.05175409,0.05073051,0.04932645,0.04710867,0.04212434,0.03887669,0.03525791,0.03166908,0.02748861,0.02120529,0.0192286,0.01670744,0.01357986,0.01248457,0.01069909,0.00936136,0.00812519,0.00720284,0.0067446,0.00652344,0.00557989,0.00533259,0.00508304,0.00429913,0.00388832,0.0039897,0.00362694,0.00313298,0.0027721,0.0025417,0.00235538,0.00184077,0.00179759,0.00130679,0.00120957,0.00148002,0.00261038,0.00714284,0.00468657,0.00616394,0.0077763,0.01225316,0.01703516])
            naiset_out=np.array([0.46044892,0.2,0.2,0.24557315,0.33569296,0.36548467,0.42005807,0.44736124,0.38882288,0.32435306,0.34123184,0.29057782,0.32249532,0.33381288,0.2884561,0.30953205,0.30102233,0.3153493,0.39015106,0.28120552,0.3078357,0.385617,0.28270544,0.3374303,0.33633224,0.35344828,0.34945068,0.30740634,0.28164608,0.39264104,0.29840315,0.29595955,0.40756575,0.34933766,0.37249547,0.25,0.40015946,0.38122357,0.34486927,0.36489388,0.59595385,0.25,0.57134523,0.41559919,0.51393206,1.0,0.0,0.0,0.0,0.0,0.12870503,0.14513807,1.0])
            miehet_in=np.array([0.18945556,0.23288127,0.15490198,0.11403055,0.10522759,0.09196639,0.07199479,0.05152266,0.03758114,0.02867826,0.02766609,0.02398586,0.02002777,0.01713829,0.01502825,0.01293932,0.01201319,0.01037932,0.00934755,0.00867589,0.00799074,0.0070163,0.00639125,0.00594988,0.00580952,0.00509254,0.00459871,0.00422043,0.00398853,0.00368943,0.00370053,0.00320632,0.00314439,0.00298637,0.00281594,0.00262899,0.00213198,0.00208133,0.00188131,0.00167933,0.00171418,0.0014116,0.00144555,0.00111258,0.00108916,0.00100871,0.0023104,0.00482086,0.00589022,0.00593303,0.00400738,0.00503871,0.00645241])
            miehet_out=np.array([0.36702452,0.40456872,0.29140007,0.2491416,0.30214987,0.36887336,0.4479122,0.4428206,0.42478191,0.38446705,0.38644035,0.41389851,0.38415784,0.35899479,0.37449099,0.32573067,0.35859656,0.33298082,0.3022702,0.31109791,0.36224891,0.31681758,0.3105734,0.25630064,0.3677496,0.34025451,0.40737616,0.25,0.33332154,0.25,0.38438529,0.26840842,0.3088869,0.32219007,0.31638265,0.44402637,0.29951459,0.35629415,0.38335121,0.26179522,0.47380451,0.27790359,0.53443358,0.33699774,0.38862731,1.0,0.0,0.0,0.0,0.0,0.20497407,0.06736034,1.0])
        elif self.year==2025:
            naiset_in=np.array([0.08787564,0.12427007,0.14636056,0.13665955,0.1321793,0.11388907,0.09513967,0.07493453,0.05829308,0.04878187,0.05175409,0.05073051,0.04932645,0.04710867,0.04212434,0.03887669,0.03525791,0.03166908,0.02748861,0.02120529,0.0192286,0.01670744,0.01357986,0.01248457,0.01069909,0.00936136,0.00812519,0.00720284,0.0067446,0.00652344,0.00557989,0.00533259,0.00508304,0.00429913,0.00388832,0.0039897,0.00362694,0.00313298,0.0027721,0.0025417,0.00235538,0.00184077,0.00179759,0.00130679,0.00120957,0.00148002,0.00261038,0.00714284,0.00468657,0.00616394,0.0077763,0.01225316,0.01703516])
            naiset_out=np.array([0.46044892,0.2,0.2,0.24557315,0.33569296,0.36548467,0.42005807,0.44736124,0.38882288,0.32435306,0.34123184,0.29057782,0.32249532,0.33381288,0.2884561,0.30953205,0.30102233,0.3153493,0.39015106,0.28120552,0.3078357,0.385617,0.28270544,0.3374303,0.33633224,0.35344828,0.34945068,0.30740634,0.28164608,0.39264104,0.29840315,0.29595955,0.40756575,0.34933766,0.37249547,0.25,0.40015946,0.38122357,0.34486927,0.36489388,0.59595385,0.25,0.57134523,0.41559919,0.51393206,1.0,0.0,0.0,0.0,0.0,0.12870503,0.14513807,1.0])
            miehet_in=np.array([0.18945556,0.23288127,0.15490198,0.11403055,0.10522759,0.09196639,0.07199479,0.05152266,0.03758114,0.02867826,0.02766609,0.02398586,0.02002777,0.01713829,0.01502825,0.01293932,0.01201319,0.01037932,0.00934755,0.00867589,0.00799074,0.0070163,0.00639125,0.00594988,0.00580952,0.00509254,0.00459871,0.00422043,0.00398853,0.00368943,0.00370053,0.00320632,0.00314439,0.00298637,0.00281594,0.00262899,0.00213198,0.00208133,0.00188131,0.00167933,0.00171418,0.0014116,0.00144555,0.00111258,0.00108916,0.00100871,0.0023104,0.00482086,0.00589022,0.00593303,0.00400738,0.00503871,0.00645241])
            miehet_out=np.array([0.36702452,0.40456872,0.29140007,0.2491416,0.30214987,0.36887336,0.4479122,0.4428206,0.42478191,0.38446705,0.38644035,0.41389851,0.38415784,0.35899479,0.37449099,0.32573067,0.35859656,0.33298082,0.3022702,0.31109791,0.36224891,0.31681758,0.3105734,0.25630064,0.3677496,0.34025451,0.40737616,0.25,0.33332154,0.25,0.38438529,0.26840842,0.3088869,0.32219007,0.31638265,0.44402637,0.29951459,0.35629415,0.38335121,0.26179522,0.47380451,0.27790359,0.53443358,0.33699774,0.38862731,1.0,0.0,0.0,0.0,0.0,0.20497407,0.06736034,1.0])
        elif self.year==2026:
            naiset_in=np.array([0.08787564,0.12427007,0.14636056,0.13665955,0.1321793,0.11388907,0.09513967,0.07493453,0.05829308,0.04878187,0.05175409,0.05073051,0.04932645,0.04710867,0.04212434,0.03887669,0.03525791,0.03166908,0.02748861,0.02120529,0.0192286,0.01670744,0.01357986,0.01248457,0.01069909,0.00936136,0.00812519,0.00720284,0.0067446,0.00652344,0.00557989,0.00533259,0.00508304,0.00429913,0.00388832,0.0039897,0.00362694,0.00313298,0.0027721,0.0025417,0.00235538,0.00184077,0.00179759,0.00130679,0.00120957,0.00148002,0.00261038,0.00714284,0.00468657,0.00616394,0.0077763,0.01225316,0.01703516])
            naiset_out=np.array([0.46044892,0.2,0.2,0.24557315,0.33569296,0.36548467,0.42005807,0.44736124,0.38882288,0.32435306,0.34123184,0.29057782,0.32249532,0.33381288,0.2884561,0.30953205,0.30102233,0.3153493,0.39015106,0.28120552,0.3078357,0.385617,0.28270544,0.3374303,0.33633224,0.35344828,0.34945068,0.30740634,0.28164608,0.39264104,0.29840315,0.29595955,0.40756575,0.34933766,0.37249547,0.25,0.40015946,0.38122357,0.34486927,0.36489388,0.59595385,0.25,0.57134523,0.41559919,0.51393206,1.0,0.0,0.0,0.0,0.0,0.12870503,0.14513807,1.0])
            miehet_in=np.array([0.18945556,0.23288127,0.15490198,0.11403055,0.10522759,0.09196639,0.07199479,0.05152266,0.03758114,0.02867826,0.02766609,0.02398586,0.02002777,0.01713829,0.01502825,0.01293932,0.01201319,0.01037932,0.00934755,0.00867589,0.00799074,0.0070163,0.00639125,0.00594988,0.00580952,0.00509254,0.00459871,0.00422043,0.00398853,0.00368943,0.00370053,0.00320632,0.00314439,0.00298637,0.00281594,0.00262899,0.00213198,0.00208133,0.00188131,0.00167933,0.00171418,0.0014116,0.00144555,0.00111258,0.00108916,0.00100871,0.0023104,0.00482086,0.00589022,0.00593303,0.00400738,0.00503871,0.00645241])
            miehet_out=np.array([0.36702452,0.40456872,0.29140007,0.2491416,0.30214987,0.36887336,0.4479122,0.4428206,0.42478191,0.38446705,0.38644035,0.41389851,0.38415784,0.35899479,0.37449099,0.32573067,0.35859656,0.33298082,0.3022702,0.31109791,0.36224891,0.31681758,0.3105734,0.25630064,0.3677496,0.34025451,0.40737616,0.25,0.33332154,0.25,0.38438529,0.26840842,0.3088869,0.32219007,0.31638265,0.44402637,0.29951459,0.35629415,0.38335121,0.26179522,0.47380451,0.27790359,0.53443358,0.33699774,0.38862731,1.0,0.0,0.0,0.0,0.0,0.20497407,0.06736034,1.0])
        else:
            print("Error: Unknown year in ['opiskelija in', 'opiskelija out']")
            
        inrate=np.zeros((101,self.n_groups))
        dfactor=np.array([0.4,1.0,1.5,0.5,1.0,1.5])
        m2=self.get_w(0,dfactor[0],dfactor[1])
        n2=self.get_w(1,dfactor[3],dfactor[4])
        efactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        em2=self.get_w(0,efactor[0],efactor[1])
        en2=self.get_w(1,efactor[3],efactor[4])

        inrate[18:71,0] = dfactor[0]*miehet_in
        inrate[18:71,1] = dfactor[1]*miehet_in
        inrate[18:71,2] = m2*miehet_in
        inrate[18:71,3] = dfactor[3]*naiset_in
        inrate[18:71,4] = dfactor[4]*naiset_in
        inrate[18:71,5] = n2*naiset_in
        
        # reducing outflux for higher income groups? Not currently
        outrate=np.zeros((101,self.n_groups))
        outrate[18:25,0] = efactor[0]*miehet_out[:25-18]
        outrate[18:25,1] = efactor[1]*miehet_out[:25-18]
        outrate[18:25,2] = em2*miehet_out[:25-18]
        outrate[18:25,3] = efactor[3]*naiset_out[:25-18]
        outrate[18:25,4] = efactor[4]*naiset_out[:25-18]
        outrate[18:25,5] = en2*naiset_out[:25-18]
        outrate[25:71,0] = miehet_out[25-18:71-18]
        outrate[25:71,1] = miehet_out[25-18:71-18]
        outrate[25:71,2] = miehet_out[25-18:71-18]
        outrate[25:71,3] = naiset_out[25-18:71-18]
        outrate[25:71,4] = naiset_out[25-18:71-18]
        outrate[25:71,5] = naiset_out[25-18:71-18]
        
        #inrate=1-(1-inrate)**self.timestep
        #outrate=1-(1-outrate)**self.timestep

        inrate = self.scale_rates(inrate)
        outrate = self.scale_rates(outrate)

        return inrate,outrate            

    def get_student_rate_v8(self,debug=False):
        '''
        opiskelijoiden intensiteetit eri ryhmille
        päivitetty 21.2.2022
        '''
        if not self.silent:
            print('student year',self.year)
                                                                            
        ### ['opiskelija in', 'opiskelija out']
        if self.year==2018:
            naiset_in=np.array([0.13251199,0.11428553,0.12241762,0.12156737,0.11500682,0.09818548,0.07750939,0.065367,0.05478939,0.04490508,0.04842085,0.04399706,0.03886616,0.03547787,0.03263366,0.02898399,0.02607495,0.02357805,0.01971789,0.01704852,0.01511964,0.01228749,0.01063995,0.00962776,0.00866214,0.00739506,0.00683895,0.00621499,0.00607462,0.00546123,0.00495643,0.0048483,0.00449036,0.00353875,0.00326956,0.00331469,0.00325676,0.00275267,0.00273429,0.00212315,0.00184004,0.0016626,0.00116575,0.00088942,0.00087549,0.00171273,0.00252481,0.00488015,0.00600268,0.00663068,0.01136378,0.02850224,0.05571687])
            naiset_out=np.array([0.5228111,0.21239287,0.2,0.26844441,0.34964379,0.40692194,0.37685255,0.38145318,0.3923321,0.31659522,0.35884549,0.38047685,0.34255572,0.31259758,0.31511794,0.30657458,0.28800706,0.36577247,0.33032885,0.30226561,0.39302492,0.31928304,0.29695008,0.32848902,0.35946431,0.30851433,0.32807113,0.26151238,0.35328616,0.33876996,0.27762217,0.3248211,0.46515711,0.32953338,0.25,0.28980268,0.41260328,0.2898421,0.48604318,0.4192467,0.38650579,0.58150354,0.52909106,0.56366549,0.25,1.0,0.0,0.0,0.0,0.0,0.25665582,0.0,1.0])
            miehet_in=np.array([0.1243445,0.15361263,0.13182103,0.09230717,0.08815077,0.07812801,0.05934491,0.04264752,0.03139588,0.02393704,0.02312851,0.018553,0.01634878,0.01351871,0.01080474,0.01018542,0.00897402,0.00814718,0.00743626,0.00713138,0.00651272,0.00581177,0.00547377,0.0053201,0.00455994,0.00413386,0.00401963,0.00391091,0.00364505,0.00360467,0.00351985,0.00305785,0.00289043,0.00267267,0.00248371,0.00248945,0.00216529,0.00205772,0.0019925,0.00179705,0.00136523,0.00113331,0.00096815,0.00096942,0.00112088,0.00125578,0.00213983,0.00294555,0.00368273,0.00379257,0.0,0.0,0.0])
            miehet_out=np.array([0.40517953,0.2568856,0.29195657,0.19535386,0.25454609,0.35997466,0.40152736,0.39446489,0.37715076,0.36802197,0.39133051,0.31688389,0.3664635,0.39345226,0.25422445,0.32317495,0.29274363,0.29837165,0.25668129,0.30254209,0.32552209,0.28670417,0.25189986,0.37368911,0.32411262,0.26712412,0.26757348,0.30367649,0.24941808,0.26141815,0.36914546,0.29317565,0.31534904,0.30753944,0.41810967,0.23154113,0.34902271,0.22332105,0.33589931,0.46962163,0.40063163,0.4290169,0.19491589,0.57329041,0.18037583,0.24130376,0.23439537,0.38318852,0.15308842,0.14529734,0.0,0.0,0.88259235])
        elif self.year==2019:
            naiset_in=np.array([0.11402607,0.12177403,0.12715906,0.12408076,0.12013217,0.10615646,0.08615788,0.06765976,0.05720048,0.05231771,0.05275107,0.04919103,0.04953651,0.04440244,0.04253578,0.03561693,0.03259644,0.02973635,0.02547074,0.02022186,0.01797265,0.01579837,0.01310048,0.01146662,0.00984003,0.00904962,0.00778767,0.00751074,0.0072295,0.00636637,0.00593721,0.00532969,0.00480976,0.0043601,0.00400335,0.0037529,0.00363083,0.00345961,0.00279385,0.00267278,0.00223296,0.00186589,0.001459,0.00125838,0.00109325,0.001185,0.00266461,0.00452636,0.00561171,0.01091215,0.00952445,0.01560957,0.01571691])
            naiset_out=np.array([0.52489145,0.2,0.2,0.26758405,0.33019906,0.39787466,0.41189261,0.39423953,0.31964314,0.37067216,0.3516285,0.29257914,0.36086102,0.28733272,0.36846022,0.27848622,0.30478402,0.30942656,0.38083551,0.26954714,0.30647188,0.36806029,0.31120581,0.34199259,0.30154563,0.36849852,0.31129157,0.25,0.36218009,0.31858197,0.34943999,0.35838154,0.34079374,0.33715866,0.33155848,0.28923029,0.31832546,0.45975485,0.32210486,0.44370978,0.45148551,0.5147252,0.45023526,0.68753187,0.25,1.0,0.0,0.0,0.0,0.0,0.29744961,0.29845721,1.0])
            miehet_in=np.array([0.24858008,0.20677887,0.15925788,0.11395302,0.10796611,0.09454515,0.07346874,0.05344108,0.04027195,0.03131468,0.02882892,0.0235474,0.02000144,0.01790401,0.01497094,0.01270303,0.01177861,0.01112194,0.00943027,0.00876733,0.00800257,0.00723276,0.00674283,0.00591914,0.00528655,0.00494207,0.00445829,0.00442063,0.00426824,0.00465502,0.00389812,0.00345472,0.00320424,0.00301022,0.00297057,0.00259336,0.00238705,0.00229062,0.00191952,0.00182797,0.00181046,0.00149846,0.00117574,0.00092922,0.00103229,0.00191515,0.00426834,0.00506333,0.0052698,0.00892999,0.00525579,0.00767177,0.01029031])
            miehet_out=np.array([0.45599268,0.33728343,0.29743864,0.21882905,0.30172616,0.3726432,0.43619238,0.42772708,0.40271742,0.42543375,0.42718483,0.39297238,0.35536945,0.39996577,0.39763424,0.30554275,0.2922002,0.38400513,0.38566636,0.25,0.3351798,0.29502241,0.35982325,0.33883827,0.31981658,0.3417467,0.26714306,0.28113993,0.40098289,0.25,0.37673473,0.32138573,0.32091112,0.27521342,0.38842587,0.33915866,0.31527351,0.43371317,0.3179514,0.30583225,0.46150613,0.51627819,0.53000568,0.25,0.41021465,1.0,0.0,0.0,0.0,0.0,0.11154661,0.03593261,1.0])
        elif self.year==2020:
            naiset_in=np.array([0.16483698,0.14231074,0.15206714,0.1506397,0.1471303,0.12776243,0.09748112,0.07576972,0.06011313,0.05319342,0.06078607,0.05391837,0.05182541,0.04965543,0.04547301,0.04076906,0.03579477,0.03030042,0.02707673,0.02220441,0.01821393,0.01657834,0.01428431,0.01206686,0.01033277,0.00862817,0.00803108,0.00735454,0.00691854,0.0066902,0.0057544,0.00522262,0.00497239,0.00481967,0.00433386,0.00400803,0.00363447,0.00338772,0.00279608,0.00268464,0.00241312,0.00189564,0.0014246,0.00122448,0.00085613,0.00176606,0.00254267,0.0037477,0.00452036,0.00591295,0.00735388,0.0141426,0.01790096])
            naiset_out=np.array([0.49685994,0.22145733,0.2,0.25009845,0.35158466,0.39997129,0.43861354,0.41504442,0.35708042,0.27062957,0.39529782,0.33477624,0.31334127,0.32022203,0.31040623,0.32743184,0.33618946,0.28499375,0.34297363,0.34913016,0.27993349,0.32423903,0.3479769,0.34211,0.37680545,0.29801218,0.32277591,0.3003151,0.28066477,0.3857306,0.34885731,0.30043641,0.29037437,0.34905354,0.46426646,0.25,0.33296815,0.4448622,0.30602766,0.39474353,0.49593776,0.53541195,0.45079325,0.60171174,0.58056472,1.0,0.0,0.0,0.0,0.0,0.0,0.19403968,1.0])
            miehet_in=np.array([0.26297658,0.23148828,0.16563263,0.12438567,0.1190458,0.10202272,0.07759695,0.05685751,0.04161959,0.03164349,0.03184772,0.0258394,0.02139322,0.01823467,0.01681299,0.01378015,0.01231968,0.01187849,0.01062599,0.00933055,0.00808531,0.00768491,0.00744658,0.00680329,0.00585004,0.00518118,0.00482545,0.00453191,0.00442188,0.00441368,0.00481408,0.00395373,0.00327754,0.00320896,0.00299474,0.00258452,0.00239715,0.00230962,0.00206959,0.00188833,0.0021337,0.00182577,0.0012391,0.00098265,0.00081191,0.00167793,0.0028771,0.00438613,0.00503427,0.0057452,0.00427037,0.00611817,0.00766052])
            miehet_out=np.array([0.42613287,0.36577413,0.27517465,0.22653895,0.30483172,0.38891629,0.42205726,0.43867725,0.42948804,0.3542292,0.43196064,0.40986038,0.39090429,0.32636661,0.40466052,0.35493584,0.26397593,0.33682943,0.36173965,0.35289324,0.29479695,0.26277999,0.31708734,0.3854086,0.35006018,0.32853767,0.33991552,0.25,0.25506622,0.44263117,0.25,0.42016963,0.27714332,0.32290675,0.4002727,0.33331935,0.30410074,0.37212511,0.36982066,0.4512496,0.25,0.60471871,0.50858137,0.48534991,0.37831828,1.0,0.0,0.0,0.0,0.0,0.07304928,0.12301918,1.0])
        elif self.year==2021:
            naiset_in=np.array([0.08721645,0.13432362,0.15370403,0.14922358,0.14431433,0.12973448,0.10075018,0.0774929,0.06194582,0.05191619,0.05946918,0.06114091,0.0584709,0.05500328,0.05406899,0.04679833,0.04224266,0.0366354,0.03092448,0.02642285,0.02200133,0.01693924,0.01538822,0.0135961,0.01141303,0.00984242,0.00873965,0.00826965,0.00762518,0.0066347,0.00636622,0.00604059,0.0061824,0.00518147,0.00495305,0.00398739,0.0037069,0.0031004,0.00306091,0.00279805,0.00222999,0.00215798,0.00176025,0.00141391,0.00112725,0.00099839,0.00270841,0.00436181,0.00659624,0.00741204,0.00904233,0.01077976,0.01704253])
            naiset_out=np.array([0.43391227,0.21143588,0.2,0.25355511,0.3147939,0.40422877,0.4420428,0.42334053,0.39609947,0.28788731,0.29182226,0.33474068,0.35883392,0.25690639,0.33484812,0.28936523,0.33364377,0.31318825,0.30978009,0.32719208,0.40290642,0.27563742,0.31342485,0.34332187,0.34710883,0.38486296,0.25,0.32109273,0.37776751,0.28829551,0.29885372,0.45884794,0.25,0.30807238,0.44362478,0.33295025,0.42134547,0.27833241,0.36218506,0.49082331,0.3277901,0.47006408,0.51527809,0.50361706,0.45046583,1.0,0.0,0.0,0.0,0.0,0.33230357,0.0,1.0])
            miehet_in=np.array([0.19841798,0.2369541,0.15926526,0.11969645,0.11278796,0.09957045,0.07539432,0.05575951,0.03914858,0.03009148,0.02945893,0.02450056,0.02065643,0.01816223,0.01640788,0.01467939,0.01230444,0.01153067,0.01067196,0.00958699,0.00821613,0.00790028,0.00736662,0.00656517,0.00581242,0.00544961,0.00466539,0.00456077,0.00441314,0.00414288,0.00375097,0.00363346,0.00338482,0.00330746,0.00291326,0.00285982,0.00314242,0.00254601,0.00247612,0.00219183,0.0019597,0.00130798,0.00138297,0.00107209,0.00114477,0.00179113,0.0027404,0.00588518,0.00566875,0.00547087,0.00430889,0.00645743,0.00727448])
            miehet_out=np.array([0.37733278,0.39880434,0.27675602,0.23431058,0.28554074,0.3906513,0.42556042,0.45767684,0.4230056,0.37538165,0.42164495,0.39681157,0.36932217,0.33339756,0.34308391,0.38881713,0.31364101,0.30801876,0.32799267,0.37322813,0.34116497,0.25,0.34958263,0.34829893,0.30641071,0.38390534,0.28207431,0.37018659,0.25,0.34694665,0.28255472,0.32531996,0.28543524,0.3692709,0.27748602,0.46413124,0.25,0.30262225,0.38389222,0.40151206,0.60879038,0.25567931,0.51872837,0.26067931,0.6258209,1.0,0.0,0.0,0.0,0.0,0.06052362,0.07581501,1.0])
        elif self.year==2022:
            naiset_in=np.array([0.08600523,0.12519095,0.14491321,0.13527103,0.13101765,0.11215624,0.09329499,0.07274337,0.05629837,0.04647992,0.04933938,0.04721272,0.04616326,0.04374683,0.03972033,0.03704397,0.03318051,0.03047406,0.02668912,0.02075845,0.01886737,0.01640205,0.01357439,0.01236544,0.01061436,0.00937788,0.00812811,0.00720364,0.00677715,0.00654855,0.00559585,0.00532745,0.0050959,0.00430347,0.00389638,0.00401209,0.00363082,0.00313702,0.00277751,0.00254948,0.00237904,0.00185173,0.00180926,0.00131976,0.00121168,0.00146931,0.00240305,0.00457678,0.00472735,0.00621356,0.00798748,0.01258748,0.01750133])
            naiset_out=np.array([0.46044892,0.2,0.2,0.24557315,0.33569296,0.36548467,0.42005807,0.44736124,0.38882288,0.32435306,0.34123184,0.29057782,0.32249532,0.33381288,0.2884561,0.30953205,0.30102233,0.3153493,0.39015106,0.28120552,0.3078357,0.385617,0.28270544,0.3374303,0.33633224,0.35344828,0.34945068,0.30740634,0.28164608,0.39264104,0.29840315,0.29595955,0.40756575,0.34933766,0.37249547,0.25,0.40015946,0.38122357,0.34486927,0.36489388,0.59595385,0.25,0.57134523,0.41559919,0.51393206,1.0,0.0,0.0,0.0,0.0,0.12870503,0.14513807,1.0])
            miehet_in=np.array([0.18888185,0.23439702,0.15484174,0.11402527,0.10556842,0.09199566,0.07220533,0.05143886,0.03757523,0.02874483,0.02782141,0.02403423,0.02004384,0.01720675,0.01511339,0.01296533,0.01196729,0.01036598,0.0094014,0.00867234,0.00797208,0.00701405,0.00639923,0.00592015,0.00582389,0.00507424,0.0046118,0.00422999,0.00398232,0.00367988,0.00369707,0.00320541,0.00315044,0.00298565,0.00281828,0.00263046,0.00214109,0.00208505,0.00187733,0.00167933,0.00171201,0.00141349,0.00144756,0.0011118,0.00108849,0.00100578,0.00227964,0.0043164,0.00584031,0.00586138,0.00395576,0.00497436,0.00637063])
            miehet_out=np.array([0.36702452,0.40456872,0.29140007,0.2491416,0.30214987,0.36887336,0.4479122,0.4428206,0.42478191,0.38446705,0.38644035,0.41389851,0.38415784,0.35899479,0.37449099,0.32573067,0.35859656,0.33298082,0.3022702,0.31109791,0.36224891,0.31681758,0.3105734,0.25630064,0.3677496,0.34025451,0.40737616,0.25,0.33332154,0.25,0.38438529,0.26840842,0.3088869,0.32219007,0.31638265,0.44402637,0.29951459,0.35629415,0.38335121,0.26179522,0.47380451,0.27790359,0.53443358,0.33699774,0.38862731,1.0,0.0,0.0,0.0,0.0,0.20497407,0.06736034,1.0])
        elif self.year==2023:
            naiset_in=np.array([0.07008732,0.10940714,0.12535532,0.11279902,0.10634862,0.08841291,0.07041379,0.05228024,0.03807943,0.03076221,0.03399294,0.03157079,0.03094111,0.0288862,0.02681149,0.02554331,0.0237105,0.02184466,0.01976557,0.0161867,0.01518813,0.01392511,0.01156793,0.01103047,0.0097779,0.0087322,0.00772128,0.00684937,0.0064429,0.0062533,0.00532834,0.00509283,0.00486997,0.00409904,0.00370385,0.00379337,0.0034181,0.00292455,0.00254899,0.0023333,0.00207889,0.00161921,0.00148027,0.00103502,0.0009046,0.00121262,0.0017129,0.00364056,0.00308256,0.00419167,0.0,0.0,0.0])
            naiset_out=np.array([0.44901299,0.16918413,0.16263321,0.20538955,0.29036982,0.31125249,0.35565829,0.36798765,0.29515297,0.22182399,0.22712326,0.1659727,0.19713733,0.2038172,0.16684564,0.19603109,0.19330071,0.21496639,0.30288159,0.21038562,0.24645202,0.33853029,0.24019113,0.30677913,0.31437931,0.33441567,0.33582996,0.29494076,0.26796469,0.38065729,0.28548997,0.28418445,0.39586172,0.33653141,0.35946304,0.23314474,0.38463503,0.36288834,0.32266799,0.34147163,0.56048571,0.20760282,0.51599348,0.34749807,0.42866784,0.15849671,0.42426738,0.13846817,0.34323591,0.09483871,-0.04008769,-0.05020671,0.77564085])
            miehet_in=np.array([0.1882838,0.2332194,0.15419966,0.11369444,0.10472368,0.09108193,0.07140687,0.05069517,0.03699849,0.02823496,0.02732644,0.02362214,0.01966731,0.01686041,0.01480594,0.01265831,0.01179391,0.01018861,0.00924838,0.0085801,0.00795302,0.00695482,0.00635557,0.00591038,0.00580487,0.0050679,0.00460647,0.00423054,0.00398365,0.0036868,0.00369338,0.00320225,0.00315084,0.00298455,0.00282218,0.00262934,0.00214284,0.00208249,0.00187887,0.00168119,0.00171237,0.00141455,0.00144859,0.0011145,0.00108623,0.00100628,0.00214419,0.00405685,0.00584105,0.00586254,0.00395895,0.00497845,0.00637593])
            miehet_out=np.array([0.36702452,0.40456872,0.29140007,0.2491416,0.30214987,0.36887336,0.4479122,0.4428206,0.42478191,0.38446705,0.38644035,0.41389851,0.38415784,0.35899479,0.37449099,0.32573067,0.35859656,0.33298082,0.3022702,0.31109791,0.36224891,0.31681758,0.3105734,0.25630064,0.3677496,0.34025451,0.40737616,0.25,0.33332154,0.25,0.38438529,0.26840842,0.3088869,0.32219007,0.31638265,0.44402637,0.29951459,0.35629415,0.38335121,0.26179522,0.47380451,0.27790359,0.53443358,0.33699774,0.38862731,1.0,0.0,0.0,0.0,0.0,0.20497407,0.06736034,1.0])
        elif self.year==2024:
            naiset_in=np.array([0.08717114,0.12519213,0.14733795,0.13894555,0.13685312,0.11763982,0.09932404,0.07816208,0.06056227,0.05149083,0.05627158,0.05430545,0.05495772,0.05236325,0.04811864,0.0445577,0.03979937,0.03537147,0.02985984,0.02303022,0.02047077,0.01755848,0.01444598,0.01276949,0.01089945,0.00957478,0.00820393,0.00724772,0.00681343,0.00655211,0.00558921,0.00532197,0.00509396,0.00429932,0.00388305,0.0039982,0.00361545,0.00311773,0.00276173,0.00253314,0.00235415,0.0018267,0.00176742,0.0012902,0.00118165,0.00143711,0.00240579,0.00565276,0.00450084,0.00593919,0.00682225,0.01074353,0.01492847])
            naiset_out=np.array([0.46044892,0.2,0.2,0.24557315,0.33569296,0.36548467,0.42005807,0.44736124,0.38882288,0.32435306,0.34123184,0.29057782,0.32249532,0.33381288,0.2884561,0.30953205,0.30102233,0.3153493,0.39015106,0.28120552,0.3078357,0.385617,0.28270544,0.3374303,0.33633224,0.35344828,0.34945068,0.30740634,0.28164608,0.39264104,0.29840315,0.29595955,0.40756575,0.34933766,0.37249547,0.25,0.40015946,0.38122357,0.34486927,0.36489388,0.59595385,0.25,0.57134523,0.41559919,0.51393206,1.0,0.0,0.0,0.0,0.0,0.12870503,0.14513807,1.0])
            miehet_in=np.array([0.18769789,0.2324483,0.15424625,0.11380862,0.1053543,0.0916856,0.07192215,0.05121441,0.03720358,0.02850522,0.02763094,0.02392172,0.01994472,0.0171157,0.01499773,0.01288323,0.01197636,0.01030748,0.00937606,0.00865127,0.00793267,0.00700466,0.00637928,0.00593072,0.00580027,0.00506897,0.00459706,0.00422173,0.0039865,0.00367745,0.00368237,0.0031928,0.00314125,0.00297315,0.00281273,0.00261946,0.00213265,0.00207404,0.00187162,0.00166974,0.0016949,0.00139349,0.00142658,0.00109036,0.00106129,0.00098288,0.00220596,0.00449893,0.00575362,0.00572391,0.00346381,0.00435596,0.0055789])
            miehet_out=np.array([0.36702452,0.40456872,0.29140007,0.2491416,0.30214987,0.36887336,0.4479122,0.4428206,0.42478191,0.38446705,0.38644035,0.41389851,0.38415784,0.35899479,0.37449099,0.32573067,0.35859656,0.33298082,0.3022702,0.31109791,0.36224891,0.31681758,0.3105734,0.25630064,0.3677496,0.34025451,0.40737616,0.25,0.33332154,0.25,0.38438529,0.26840842,0.3088869,0.32219007,0.31638265,0.44402637,0.29951459,0.35629415,0.38335121,0.26179522,0.47380451,0.27790359,0.53443358,0.33699774,0.38862731,1.0,0.0,0.0,0.0,0.0,0.20497407,0.06736034,1.0])
        elif self.year==2025:
            naiset_in=np.array([0.08717114,0.12519213,0.14733795,0.13894555,0.13685312,0.11763982,0.09932404,0.07816208,0.06056227,0.05149083,0.05627158,0.05430545,0.05495772,0.05236325,0.04811864,0.0445577,0.03979937,0.03537147,0.02985984,0.02303022,0.02047077,0.01755848,0.01444598,0.01276949,0.01089945,0.00957478,0.00820393,0.00724772,0.00681343,0.00655211,0.00558921,0.00532197,0.00509396,0.00429932,0.00388305,0.0039982,0.00361545,0.00311773,0.00276173,0.00253314,0.00235415,0.0018267,0.00176742,0.0012902,0.00118165,0.00143711,0.00240579,0.00565276,0.00450084,0.00593919,0.00682225,0.01074353,0.01492847])
            naiset_out=np.array([0.46044892,0.2,0.2,0.24557315,0.33569296,0.36548467,0.42005807,0.44736124,0.38882288,0.32435306,0.34123184,0.29057782,0.32249532,0.33381288,0.2884561,0.30953205,0.30102233,0.3153493,0.39015106,0.28120552,0.3078357,0.385617,0.28270544,0.3374303,0.33633224,0.35344828,0.34945068,0.30740634,0.28164608,0.39264104,0.29840315,0.29595955,0.40756575,0.34933766,0.37249547,0.25,0.40015946,0.38122357,0.34486927,0.36489388,0.59595385,0.25,0.57134523,0.41559919,0.51393206,1.0,0.0,0.0,0.0,0.0,0.12870503,0.14513807,1.0])
            miehet_in=np.array([0.18769789,0.2324483,0.15424625,0.11380862,0.1053543,0.0916856,0.07192215,0.05121441,0.03720358,0.02850522,0.02763094,0.02392172,0.01994472,0.0171157,0.01499773,0.01288323,0.01197636,0.01030748,0.00937606,0.00865127,0.00793267,0.00700466,0.00637928,0.00593072,0.00580027,0.00506897,0.00459706,0.00422173,0.0039865,0.00367745,0.00368237,0.0031928,0.00314125,0.00297315,0.00281273,0.00261946,0.00213265,0.00207404,0.00187162,0.00166974,0.0016949,0.00139349,0.00142658,0.00109036,0.00106129,0.00098288,0.00220596,0.00449893,0.00575362,0.00572391,0.00346381,0.00435596,0.0055789])
            miehet_out=np.array([0.36702452,0.40456872,0.29140007,0.2491416,0.30214987,0.36887336,0.4479122,0.4428206,0.42478191,0.38446705,0.38644035,0.41389851,0.38415784,0.35899479,0.37449099,0.32573067,0.35859656,0.33298082,0.3022702,0.31109791,0.36224891,0.31681758,0.3105734,0.25630064,0.3677496,0.34025451,0.40737616,0.25,0.33332154,0.25,0.38438529,0.26840842,0.3088869,0.32219007,0.31638265,0.44402637,0.29951459,0.35629415,0.38335121,0.26179522,0.47380451,0.27790359,0.53443358,0.33699774,0.38862731,1.0,0.0,0.0,0.0,0.0,0.20497407,0.06736034,1.0])
        elif self.year==2026:
            naiset_in=np.array([0.08717114,0.12519213,0.14733795,0.13894555,0.13685312,0.11763982,0.09932404,0.07816208,0.06056227,0.05149083,0.05627158,0.05430545,0.05495772,0.05236325,0.04811864,0.0445577,0.03979937,0.03537147,0.02985984,0.02303022,0.02047077,0.01755848,0.01444598,0.01276949,0.01089945,0.00957478,0.00820393,0.00724772,0.00681343,0.00655211,0.00558921,0.00532197,0.00509396,0.00429932,0.00388305,0.0039982,0.00361545,0.00311773,0.00276173,0.00253314,0.00235415,0.0018267,0.00176742,0.0012902,0.00118165,0.00143711,0.00240579,0.00565276,0.00450084,0.00593919,0.00682225,0.01074353,0.01492847])
            naiset_out=np.array([0.46044892,0.2,0.2,0.24557315,0.33569296,0.36548467,0.42005807,0.44736124,0.38882288,0.32435306,0.34123184,0.29057782,0.32249532,0.33381288,0.2884561,0.30953205,0.30102233,0.3153493,0.39015106,0.28120552,0.3078357,0.385617,0.28270544,0.3374303,0.33633224,0.35344828,0.34945068,0.30740634,0.28164608,0.39264104,0.29840315,0.29595955,0.40756575,0.34933766,0.37249547,0.25,0.40015946,0.38122357,0.34486927,0.36489388,0.59595385,0.25,0.57134523,0.41559919,0.51393206,1.0,0.0,0.0,0.0,0.0,0.12870503,0.14513807,1.0])
            miehet_in=np.array([0.18769789,0.2324483,0.15424625,0.11380862,0.1053543,0.0916856,0.07192215,0.05121441,0.03720358,0.02850522,0.02763094,0.02392172,0.01994472,0.0171157,0.01499773,0.01288323,0.01197636,0.01030748,0.00937606,0.00865127,0.00793267,0.00700466,0.00637928,0.00593072,0.00580027,0.00506897,0.00459706,0.00422173,0.0039865,0.00367745,0.00368237,0.0031928,0.00314125,0.00297315,0.00281273,0.00261946,0.00213265,0.00207404,0.00187162,0.00166974,0.0016949,0.00139349,0.00142658,0.00109036,0.00106129,0.00098288,0.00220596,0.00449893,0.00575362,0.00572391,0.00346381,0.00435596,0.0055789])
            miehet_out=np.array([0.36702452,0.40456872,0.29140007,0.2491416,0.30214987,0.36887336,0.4479122,0.4428206,0.42478191,0.38446705,0.38644035,0.41389851,0.38415784,0.35899479,0.37449099,0.32573067,0.35859656,0.33298082,0.3022702,0.31109791,0.36224891,0.31681758,0.3105734,0.25630064,0.3677496,0.34025451,0.40737616,0.25,0.33332154,0.25,0.38438529,0.26840842,0.3088869,0.32219007,0.31638265,0.44402637,0.29951459,0.35629415,0.38335121,0.26179522,0.47380451,0.27790359,0.53443358,0.33699774,0.38862731,1.0,0.0,0.0,0.0,0.0,0.20497407,0.06736034,1.0])
        else:
            print("Error: Unknown year in ['opiskelija in', 'opiskelija out']")
            
        inrate=np.zeros((101,self.n_groups))
        dfactor=np.array([0.4,1.0,1.5,0.5,1.0,1.5])
        m2=self.get_w(0,dfactor[0],dfactor[1])
        n2=self.get_w(1,dfactor[3],dfactor[4])
        efactor=np.array([1.1,1.0,1.1,1.0,1.0,1.0])
        em2=self.get_w(0,efactor[0],efactor[1])
        en2=self.get_w(1,efactor[3],efactor[4])

        inrate[18:71,0] = dfactor[0]*miehet_in
        inrate[18:71,1] = dfactor[1]*miehet_in
        inrate[18:71,2] = m2*miehet_in
        inrate[18:71,3] = dfactor[3]*naiset_in
        inrate[18:71,4] = dfactor[4]*naiset_in
        inrate[18:71,5] = n2*naiset_in
        
        # reducing outflux for higher income groups? Not currently
        outrate=np.zeros((101,self.n_groups))
        outrate[18:25,0] = efactor[0]*miehet_out[:25-18]
        outrate[18:25,1] = efactor[1]*miehet_out[:25-18]
        outrate[18:25,2] = em2*miehet_out[:25-18]
        outrate[18:25,3] = efactor[3]*naiset_out[:25-18]
        outrate[18:25,4] = efactor[4]*naiset_out[:25-18]
        outrate[18:25,5] = en2*naiset_out[:25-18]
        outrate[25:71,0] = miehet_out[25-18:71-18]
        outrate[25:71,1] = miehet_out[25-18:71-18]
        outrate[25:71,2] = miehet_out[25-18:71-18]
        outrate[25:71,3] = naiset_out[25-18:71-18]
        outrate[25:71,4] = naiset_out[25-18:71-18]
        outrate[25:71,5] = naiset_out[25-18:71-18]
        
        #inrate=1-(1-inrate)**self.timestep
        #outrate=1-(1-outrate)**self.timestep

        inrate = self.scale_rates(inrate)
        outrate = self.scale_rates(outrate)

        return inrate,outrate        

    def get_student_rate_v9(self,debug=False):
        '''
        opiskelijoiden intensiteetit eri ryhmille
        päivitetty 20.5.2025
        '''
        if not self.silent:
            print('student year',self.year)
                                                                                            
        ### ['opiskelija in', 'opiskelija out']
        if self.year==2018:
            naiset_in=np.array([0.08429605,0.09685925,0.10277381,0.09891224,0.09280337,0.07673143,0.05790105,0.04673023,0.03816717,0.0302753,0.03376987,0.03035602,0.02660345,0.02426941,0.02276301,0.02088567,0.01915721,0.01797945,0.01532382,0.01371146,0.01260742,0.01041675,0.00942141,0.00872932,0.00784705,0.00689017,0.00639576,0.00587522,0.00577611,0.00515686,0.00470467,0.00458721,0.00425004,0.00334427,0.00308971,0.00309328,0.00299484,0.00251983,0.00245231,0.00188764,0.00158927,0.00139868,0.00097249,0.00072973,0.0007386,0.00146164,0.00197353,0.00391819,0.00447604,0.00502832,0.0,0.0,0.0])
            naiset_out=np.array([0.49476741,0.17778361,0.16091986,0.22494571,0.30278861,0.35199113,0.31293546,0.29989739,0.30720836,0.22187274,0.25527844,0.27217675,0.23003112,0.19879765,0.20841924,0.21097275,0.19819828,0.28792975,0.26006323,0.24084835,0.33993551,0.27369956,0.26507918,0.30088966,0.33254005,0.2896483,0.3105682,0.24638487,0.34054165,0.3245306,0.26473373,0.31075991,0.45125784,0.31452514,0.23571118,0.27244166,0.39139157,0.26755865,0.45810363,0.38838582,0.34846882,0.53554656,0.481181,0.51109141,0.19152922,0.18725604,0.27159297,0.17465351,0.38859972,0.15990103,0.16706593,0.0,0.89309354])
            miehet_in=np.array([0.1243445,0.15377341,0.13220685,0.09285106,0.08895555,0.07890672,0.05990518,0.04323546,0.0317692,0.02425137,0.02346441,0.01886469,0.01663098,0.01374958,0.01095631,0.01038503,0.00913269,0.00829036,0.00754007,0.00723829,0.00659819,0.00587361,0.00551313,0.00535701,0.0045815,0.00415994,0.00402701,0.0039125,0.0036466,0.00360928,0.00352151,0.00305391,0.00289277,0.00267348,0.00248174,0.00249311,0.00216375,0.00205933,0.00199368,0.00179511,0.00136717,0.00113281,0.00096574,0.00096856,0.00111892,0.00125103,0.00214439,0.00295986,0.00368273,0.00379257,0.0,0.0,0.0])
            miehet_out=np.array([0.40502738,0.25695752,0.29365632,0.19577175,0.25474857,0.35993218,0.40159479,0.39439765,0.37688988,0.36779149,0.39158721,0.31703486,0.36672011,0.39371183,0.25669345,0.32272432,0.29282005,0.29739265,0.25650615,0.30350386,0.32552106,0.28747869,0.25198545,0.37442236,0.32446201,0.26684366,0.26785078,0.30402772,0.24973388,0.26158032,0.36932067,0.29342887,0.31558117,0.30784773,0.41844179,0.23191684,0.34955086,0.22403154,0.3366925,0.47069009,0.40200916,0.43104273,0.19725312,0.57597661,0.18339995,0.24412713,0.23694079,0.38630565,0.15638401,0.14951911,0.0,0.0,0.88307815])
        elif self.year==2019:
            naiset_in=np.array([0.07730224,0.10455761,0.10787272,0.0999763,0.09285291,0.07934572,0.0610852,0.04596457,0.03643675,0.03235566,0.03319918,0.03040872,0.02949799,0.0262375,0.02550975,0.02203339,0.02100039,0.01939228,0.01777937,0.01484527,0.01399622,0.01283234,0.01099264,0.01008043,0.00893315,0.00832107,0.00725694,0.00705342,0.00685002,0.00605315,0.0056226,0.00506595,0.00452701,0.00413284,0.00377843,0.00348068,0.00337969,0.00316409,0.00250826,0.00237056,0.00192879,0.00156484,0.00118248,0.00099463,0.00092375,0.00090644,0.00185568,0.00353964,0.00400046,0.00899225,0.0,0.0,0.0])
            naiset_out=np.array([0.50103312,0.16514993,0.16481322,0.22744105,0.28449262,0.34280219,0.35079745,0.32114422,0.2299657,0.28071044,0.25097577,0.18580798,0.24891581,0.17515151,0.25952731,0.17869651,0.21050975,0.22094843,0.30711147,0.20614723,0.25375704,0.32516656,0.27506027,0.31501077,0.28125659,0.34853985,0.29461881,0.23461262,0.34854994,0.30596752,0.33575824,0.34531834,0.32519441,0.32294562,0.31649603,0.26991518,0.29928576,0.4367687,0.29448322,0.41183648,0.41354276,0.46842656,0.3942987,0.62380842,0.18243748,0.19451005,0.23961875,0.16314282,0.3637058,0.14181779,0.18692829,0.17537595,0.86346934])
            miehet_in=np.array([0.13245813,0.1537712,0.12906361,0.09844338,0.09461912,0.0816198,0.0629512,0.04505698,0.03312666,0.0257341,0.02423279,0.01971471,0.01659368,0.01479375,0.01246612,0.01054679,0.00995735,0.00949207,0.00815586,0.00791078,0.0071937,0.0065503,0.0062281,0.00552739,0.00500074,0.00463815,0.00420589,0.0041453,0.00404282,0.00447448,0.00370651,0.00324324,0.00302002,0.0028242,0.00276722,0.00240317,0.00221267,0.00208236,0.00172124,0.00163003,0.00157311,0.00126694,0.00096268,0.00074851,0.00080527,0.00158844,0.00296614,0.0037676,0.00373904,0.00748663,0.0,0.0,0.0])
            miehet_out=np.array([0.41186867,0.26979958,0.25349279,0.19035706,0.27607814,0.3434094,0.40639658,0.39418149,0.36361688,0.38619919,0.38550169,0.34928295,0.30803636,0.35335672,0.35324715,0.26031145,0.25155791,0.34701164,0.35056713,0.22297327,0.30899438,0.27189714,0.34043516,0.32256697,0.30631357,0.32598282,0.25300578,0.26565277,0.38739954,0.23690447,0.36354043,0.30575877,0.30605316,0.25907779,0.37027194,0.3194819,0.29614111,0.40961106,0.29057166,0.27650038,0.42508436,0.47248917,0.47736927,0.19107254,0.34279556,0.17534964,0.17028489,0.39981506,0.44612456,0.14485661,0.00726157,0.0,0.87998654])
        elif self.year==2020:
            naiset_in=np.array([0.11208636,0.12107671,0.12804701,0.12334662,0.11410238,0.09260533,0.07021255,0.05063629,0.0391208,0.03250835,0.03862023,0.03258688,0.03042364,0.02881682,0.02718653,0.02501967,0.02250372,0.01995081,0.01869197,0.01626501,0.01416574,0.01328387,0.0121425,0.01059544,0.00941194,0.00800374,0.00756561,0.00695866,0.0065776,0.00638199,0.00552127,0.00494699,0.00471615,0.00455407,0.00410983,0.00379319,0.0034101,0.00314115,0.00253588,0.00241635,0.00210391,0.00160049,0.00118134,0.00098049,0.00066807,0.00160388,0.00177793,0.00264711,0.00322256,0.00401867,0.0,0.0,0.0])
            naiset_out=np.array([0.47405739,0.1890888,0.16324442,0.21244555,0.30626878,0.34609029,0.37774603,0.33910258,0.27571129,0.1759152,0.29355018,0.22592369,0.19962479,0.20372673,0.20253519,0.2237547,0.23638501,0.19814172,0.26120499,0.28761261,0.23045444,0.28029599,0.31132223,0.31573318,0.35741107,0.28216681,0.30795344,0.28648641,0.26878229,0.37435725,0.33759644,0.28729885,0.2778772,0.33479981,0.45061679,0.23317282,0.31630056,0.42439472,0.28200533,0.36763923,0.45891113,0.49097965,0.40068446,0.54194232,0.51530989,0.17524106,0.29615817,0.17097297,0.15566919,0.25626298,0.0,0.06389108,0.855759])
            miehet_in=np.array([0.15221084,0.17735031,0.13797559,0.10948846,0.10474575,0.08969248,0.06720748,0.04875902,0.03534915,0.02623126,0.02730988,0.02207386,0.01812544,0.01552316,0.01434093,0.01199354,0.01061981,0.01048078,0.0094632,0.00839204,0.00742972,0.00706099,0.0069769,0.00645479,0.00554267,0.00496408,0.00457924,0.00429851,0.00420624,0.00421522,0.00464736,0.00372439,0.00309988,0.0030177,0.00281017,0.00239904,0.00222737,0.00212461,0.0018934,0.00168198,0.0019364,0.0015479,0.00103399,0.00079321,0.00064316,0.0014846,0.0020328,0.00321518,0.00374251,0.00419029,0.0,0.0,0.0])
            miehet_out=np.array([0.38940157,0.306222,0.2351833,0.20026285,0.27805887,0.36166304,0.392119,0.40535718,0.39150783,0.31084772,0.38948689,0.36609385,0.34551361,0.28075013,0.36102093,0.31462339,0.22498929,0.29525685,0.32930539,0.32208358,0.27154642,0.2391995,0.29528401,0.36932966,0.33600871,0.31641598,0.32389703,0.23569585,0.24175411,0.42951277,0.23737908,0.40499221,0.26295599,0.30802406,0.38497654,0.31548717,0.28500006,0.35167148,0.34622364,0.42138603,0.21507808,0.56231809,0.46003584,0.42816322,0.31605748,0.17996589,0.19811486,0.22070401,0.38404086,0.14757418,0.0,0.02359233,0.89381543])
        elif self.year==2021:
            naiset_in=np.array([0.07796541,0.11502565,0.13096454,0.12021229,0.11238955,0.09661097,0.07197967,0.05163991,0.03958986,0.03125777,0.03617501,0.03527017,0.03260162,0.02966192,0.02997233,0.02713265,0.02568624,0.02277753,0.02022668,0.01857575,0.01636108,0.0134928,0.01264943,0.01159362,0.01034597,0.00916012,0.00823032,0.00779962,0.00721799,0.00628683,0.00605463,0.00576339,0.00591172,0.00491912,0.00463752,0.00375304,0.00345939,0.00288273,0.0028357,0.00253129,0.00193302,0.00181797,0.00144377,0.00111193,0.00086343,0.00075067,0.00202691,0.0029653,0.00530282,0.00514193,0.0,0.0,0.0])
            naiset_out=np.array([0.4285175,0.18165209,0.16456702,0.21565933,0.27235261,0.35101508,0.37842968,0.34874555,0.31133687,0.1912537,0.18069084,0.2173393,0.22794878,0.12746603,0.21067901,0.176276,0.22536629,0.2161921,0.22629838,0.25463926,0.34354995,0.22765403,0.27316019,0.31258273,0.32581302,0.36801802,0.23547701,0.30454653,0.3653769,0.27472182,0.28689425,0.44689611,0.23562938,0.29512069,0.42751442,0.31820714,0.40460262,0.25964276,0.34099648,0.46464322,0.29098809,0.42522002,0.46381413,0.43779797,0.37822489,0.31430454,0.16480293,0.33912493,0.14622429,0.13242164,0.20946956,0.0,0.84853545])
            miehet_in=np.array([0.12115068,0.18274845,0.131565,0.10568634,0.09955313,0.08735301,0.06576985,0.0472785,0.03335077,0.02507073,0.02533587,0.02084204,0.0175302,0.01542267,0.01406357,0.01268805,0.01078536,0.01007894,0.00939602,0.00869101,0.00746363,0.00729402,0.00689438,0.00615024,0.00552965,0.00521194,0.00446614,0.00431454,0.00419642,0.00393036,0.0035505,0.00345693,0.00318299,0.00310456,0.002749,0.0026773,0.00296967,0.00235462,0.00226288,0.00197389,0.0017065,0.00111694,0.00115343,0.00086971,0.00090222,0.00160158,0.00195456,0.00472424,0.00414984,0.00390182,0.0,0.0,0.0])
            miehet_out=np.array([0.33831093,0.33614638,0.2436362,0.2096599,0.25878739,0.36325483,0.39590245,0.42437182,0.38823849,0.3358982,0.37720258,0.35255931,0.32434177,0.28760681,0.30017926,0.34777377,0.27614302,0.26341233,0.29622344,0.33964007,0.31720933,0.22608799,0.33097929,0.32994797,0.29236173,0.37131364,0.27013708,0.35523272,0.2371935,0.33196927,0.26936132,0.31210815,0.27073376,0.35253352,0.26230409,0.44828191,0.22877852,0.28299164,0.36147394,0.37487232,0.57348487,0.21519033,0.47037183,0.20598114,0.55909217,0.18273971,0.3521662,0.16683027,0.40213785,0.17146432,0.0,0.0,0.88868908])
        elif self.year==2022:
            naiset_in=np.array([0.07008732,0.10934883,0.12512112,0.11254189,0.10620107,0.08794234,0.06995267,0.05191221,0.03755517,0.03041372,0.03343588,0.03078614,0.03025939,0.02788286,0.02585839,0.02457479,0.02276883,0.02106867,0.0192526,0.01594812,0.01500761,0.01374432,0.01149967,0.01094135,0.009717,0.00870239,0.0077039,0.00685942,0.00644424,0.00625055,0.00532544,0.00508501,0.00487296,0.00410146,0.00369745,0.0037889,0.00341849,0.00292062,0.0025492,0.00232844,0.00208208,0.0016146,0.00148134,0.00103632,0.00090442,0.00121376,0.00170924,0.00338953,0.00308256,0.00419167,0.0,0.0,0.0])
            naiset_out=np.array([0.44963013,0.17079751,0.1647413,0.20773989,0.29379627,0.31908225,0.36352514,0.38074749,0.30766576,0.23442392,0.24476871,0.17933146,0.21378569,0.21884387,0.18127041,0.20420615,0.204261,0.22434055,0.31202758,0.21534495,0.25140036,0.34151113,0.24098969,0.30799109,0.31454947,0.33662011,0.33518163,0.29475198,0.2680578,0.38055802,0.28536349,0.28429884,0.39606515,0.33672647,0.35969738,0.23343413,0.38499619,0.36326886,0.32313653,0.34206435,0.56148145,0.20900946,0.51787307,0.34981283,0.43184696,0.16330413,0.42410386,0.13874127,0.34290816,0.09441423,0.0,0.0,0.77482896])
            miehet_in=np.array([0.10995984,0.18016061,0.12811765,0.10076337,0.09293215,0.08004979,0.06244888,0.04384621,0.03160334,0.02365351,0.02367135,0.02025551,0.01681071,0.01442627,0.01278923,0.0110989,0.01020502,0.00905739,0.00824524,0.00778577,0.00727798,0.00641867,0.0059543,0.00557074,0.00551742,0.00483517,0.00439643,0.00407993,0.00378239,0.00350007,0.00349299,0.00303803,0.00298289,0.00282058,0.00263351,0.00246791,0.00200456,0.00192702,0.00173394,0.00152282,0.00152037,0.00120564,0.00121201,0.00090418,0.00085518,0.00077797,0.00166893,0.00292154,0.00479256,0.00427294,0.0,0.0,0.0])
            miehet_out=np.array([0.3312466,0.34563031,0.25153067,0.2231482,0.27525545,0.3397766,0.41770492,0.40858321,0.38805825,0.34316252,0.34420691,0.36858293,0.33755603,0.31208467,0.33026393,0.28420071,0.31634334,0.29681084,0.26785279,0.28191951,0.33677067,0.29282846,0.29133918,0.23936175,0.35346911,0.32734243,0.39512989,0.23972185,0.31921058,0.23714592,0.37014119,0.25504355,0.29525745,0.3082691,0.29878651,0.42803842,0.28269425,0.33623464,0.36288151,0.23685832,0.44349336,0.23644568,0.48790264,0.28136628,0.3248,0.19592903,0.30291687,0.26175154,0.16371877,0.22639726,0.11194902,0.0,0.89254361])
        elif self.year==2023:
            naiset_in=np.array([0.07597442,0.10185883,0.1170111,0.10550838,0.10672948,0.09060505,0.06761578,0.05171368,0.04074439,0.03080399,0.03451679,0.0320605,0.02931792,0.02924745,0.02633544,0.0242402,0.02364802,0.02160477,0.01953614,0.01800882,0.01555717,0.01422546,0.01247039,0.01103493,0.00976983,0.00937353,0.00839224,0.00763054,0.00653874,0.00645028,0.00605012,0.00518612,0.00502112,0.00491686,0.00369349,0.00353774,0.00321112,0.0032057,0.00284177,0.00224981,0.00195126,0.0016735,0.00147398,0.00122046,0.00101511,0.00077772,0.00125036,0.0026402,0.00299896,0.00390489,0.0,0.0,0.0])
            naiset_out=np.array([0.45936692,0.19368784,0.16583199,0.16608564,0.28620389,0.36131287,0.34116565,0.32893755,0.35299909,0.2372011,0.23195658,0.2501863,0.16923656,0.23284675,0.2279019,0.14848512,0.22364235,0.2429474,0.22470486,0.28604857,0.25873805,0.30327643,0.31419441,0.30881683,0.25226462,0.33057902,0.31398772,0.37119433,0.24922297,0.30174678,0.3804698,0.27237949,0.25670198,0.48625457,0.27733162,0.32899927,0.24431553,0.35558486,0.44292136,0.3630153,0.37215311,0.35374627,0.39159449,0.38652497,0.45301867,0.16677071,0.24942758,0.19122823,0.13409608,0.10778866,0.0,0.0,0.79901969])
            miehet_in=np.array([0.11335952,0.15260265,0.11988106,0.0980306,0.09363036,0.0817473,0.06358961,0.04717242,0.03361677,0.025081,0.02440251,0.02041863,0.0177453,0.0156342,0.01348395,0.01225656,0.01095489,0.00978605,0.00884767,0.00787037,0.00756545,0.00727602,0.00626526,0.00591923,0.00561206,0.00528123,0.00499655,0.00468829,0.00427039,0.0038966,0.00374144,0.0035154,0.00312917,0.00287003,0.00283706,0.00260059,0.00254586,0.00232946,0.00193696,0.00179829,0.00164,0.00129419,0.00119855,0.00120676,0.00103033,0.00089135,0.0017651,0.0031758,0.00339118,0.01042778,0.0,0.0,0.0])
            miehet_out=np.array([0.37743615,0.30242719,0.21667177,0.19716737,0.26543353,0.34338734,0.38604833,0.42144727,0.39510434,0.36640105,0.36761447,0.33438576,0.31805476,0.33433388,0.29667254,0.30568144,0.2967108,0.30831224,0.31899226,0.25398345,0.25846861,0.41441606,0.22955717,0.2807695,0.2824173,0.28984652,0.29613421,0.42952696,0.23769312,0.36306893,0.23425059,0.35101654,0.33134232,0.23522179,0.35212249,0.23298659,0.33078443,0.40500647,0.31308952,0.32296723,0.43709691,0.31536806,0.47199041,0.19846283,0.59080256,0.18355431,0.17881934,0.26695599,0.35452246,0.16050415,0.2120055,0.10464312,0.89992211])
        elif self.year==2024:
            naiset_in=np.array([0.07597442,0.10254155,0.11728367,0.10594708,0.10793342,0.09118925,0.06782555,0.05200874,0.04097919,0.03116398,0.03466314,0.03256647,0.02993709,0.02973098,0.02723455,0.02491089,0.02454179,0.02237709,0.02004042,0.01842449,0.01587071,0.01446116,0.0126441,0.01106854,0.00982618,0.00942143,0.00837054,0.00764792,0.00653647,0.0064662,0.00607067,0.00517848,0.00501871,0.00491945,0.00368954,0.00353758,0.00322677,0.00321232,0.00283947,0.00224288,0.00195999,0.00167853,0.00147178,0.00122438,0.00101614,0.00077901,0.00123129,0.00266078,0.00299896,0.00390489,0.0,0.0,0.0])
            naiset_out=np.array([0.46002736,0.19386361,0.16691097,0.16890273,0.2854261,0.362386,0.34856455,0.33249719,0.35835083,0.2444788,0.23466928,0.25251182,0.17452404,0.23595815,0.2331415,0.15864581,0.22048552,0.24437524,0.22553488,0.29103848,0.25650225,0.2995728,0.3136577,0.30801237,0.25414669,0.33165378,0.31320026,0.37144573,0.24871201,0.30184459,0.38130496,0.27265693,0.25741042,0.4866726,0.27788275,0.32981574,0.24502267,0.35639723,0.44420579,0.36467479,0.37457789,0.35772692,0.39731838,0.39329669,0.4611104,0.17646796,0.26124937,0.20502652,0.15051881,0.12707231,0.0,0.01061082,0.82876507])
            miehet_in=np.array([0.11335952,0.15342375,0.12029983,0.09840597,0.09352133,0.08173667,0.06396994,0.04728003,0.03363505,0.02496663,0.02437532,0.02042407,0.01766074,0.01561591,0.0135132,0.01222374,0.01094254,0.00985969,0.00884266,0.00789035,0.00756535,0.00727629,0.00625875,0.00591268,0.00560115,0.00529093,0.00498174,0.00468368,0.004277,0.00390092,0.00374699,0.00351466,0.00312122,0.00287138,0.00283851,0.00259261,0.00255343,0.00232498,0.00194501,0.00179327,0.00164328,0.00129861,0.00120172,0.00120521,0.00102555,0.00089399,0.00174391,0.00315346,0.00339118,0.01042778,0.0,0.0,0.0])
            miehet_out=np.array([0.37839997,0.30304045,0.21741602,0.19835807,0.26472248,0.34374295,0.38720895,0.42238876,0.39612052,0.36822481,0.36813514,0.3332674,0.32205948,0.33421278,0.2966765,0.30446108,0.29994774,0.30548991,0.31749696,0.25356919,0.2574613,0.41477507,0.22766095,0.2821964,0.28353946,0.29036034,0.29619675,0.43016423,0.23837676,0.36297822,0.23505384,0.35164551,0.33234304,0.23583844,0.3529178,0.23388032,0.33163866,0.40620079,0.31426178,0.32502163,0.43957252,0.31901514,0.4762123,0.20349166,0.59664528,0.19009454,0.18634745,0.27524281,0.36355084,0.17034907,0.22266695,0.11612111,0.91221664])
        elif self.year==2025:
            naiset_in=np.array([0.07597442,0.10275278,0.11766695,0.10585817,0.10828932,0.09108368,0.06773498,0.05205621,0.0409935,0.03109617,0.03449349,0.03250814,0.02985958,0.02968631,0.02715135,0.02488609,0.02434263,0.02211022,0.01986971,0.01829257,0.01572357,0.01438037,0.01258162,0.0110418,0.00981695,0.00939799,0.00834749,0.00762744,0.00655598,0.00646975,0.0060663,0.00517938,0.00501673,0.00491605,0.0036924,0.00353355,0.00322685,0.00321569,0.0028361,0.00224529,0.00195971,0.00167777,0.00147076,0.00122433,0.0010181,0.00078034,0.00123282,0.00265981,0.00299896,0.00390489,0.0,0.0,0.0])
            naiset_out=np.array([0.45864882,0.19408197,0.1646207,0.16681873,0.28248887,0.35775901,0.33857506,0.31866753,0.34061744,0.22349728,0.21519997,0.23510485,0.15737809,0.2217605,0.22180816,0.15380856,0.2169123,0.24035824,0.21678139,0.28081251,0.25260896,0.29921769,0.31272925,0.31035854,0.25326632,0.33049726,0.31369562,0.37164178,0.24981794,0.30186872,0.38105378,0.27276857,0.25748261,0.48681724,0.27803324,0.32986678,0.24495589,0.35638149,0.44422941,0.36465104,0.37458254,0.35774441,0.39735528,0.39333084,0.46112023,0.17650249,0.26130138,0.20510524,0.15060123,0.12716081,0.0,0.01070781,0.82886447])
            miehet_in=np.array([0.11335952,0.15324351,0.12030425,0.09838291,0.09344412,0.08159622,0.06381041,0.04714037,0.03350457,0.02490792,0.02427058,0.02030924,0.01759922,0.01550712,0.01344316,0.01217087,0.01087026,0.00981576,0.00881421,0.00786882,0.0075561,0.007278,0.00625991,0.00592056,0.00560276,0.00529309,0.00497973,0.00468781,0.00427791,0.00389906,0.00374397,0.00352038,0.0031217,0.00286998,0.00283668,0.00259796,0.0025516,0.00232263,0.0019425,0.00179048,0.00164354,0.00129489,0.00119923,0.00120572,0.00102629,0.00089442,0.00174519,0.0031485,0.00339118,0.01042778,0.0,0.0,0.0])
            miehet_out=np.array([0.37736796,0.30296089,0.21581695,0.19716328,0.26212476,0.3404724,0.38277596,0.41614878,0.38950227,0.36034926,0.36331496,0.32893855,0.31689331,0.33214638,0.29616708,0.30643462,0.302161,0.3053247,0.31802941,0.25305127,0.25906292,0.4156807,0.22958689,0.28350637,0.28354872,0.29055945,0.29636886,0.43016558,0.23882748,0.36326774,0.23506203,0.35166985,0.33232119,0.23588216,0.3530205,0.23384707,0.33162878,0.40621917,0.31428772,0.32506076,0.43956789,0.31912636,0.47631058,0.20357404,0.59673593,0.19021787,0.18649561,0.27544213,0.36376006,0.17058482,0.22292923,0.11640992,0.91253198])
        elif self.year==2026:
            naiset_in=np.array([0.07597442,0.10263165,0.11776609,0.10651177,0.10898251,0.09189935,0.06859534,0.05253569,0.04125699,0.03137269,0.0348467,0.03269079,0.0300223,0.02978992,0.02717813,0.02471287,0.02408547,0.02207956,0.01976133,0.01823975,0.01574469,0.01436033,0.01258179,0.01103421,0.00980081,0.0093708,0.00835228,0.00762421,0.00653852,0.00646184,0.00607464,0.00517386,0.00501345,0.00491648,0.00369263,0.00353823,0.00323044,0.00321132,0.00284318,0.00224185,0.00195888,0.0016777,0.001471,0.00122487,0.00101766,0.00078093,0.00123104,0.00264034,0.00299896,0.00390489,0.0,0.0,0.0])
            naiset_out=np.array([0.46462666,0.19411615,0.16480917,0.16737731,0.28337592,0.35905808,0.34033819,0.32051946,0.34139695,0.22402855,0.2162489,0.23548591,0.15813206,0.22200868,0.21786745,0.14988237,0.22161498,0.23893165,0.21677015,0.28290333,0.25187088,0.30075887,0.31290963,0.30732,0.25257424,0.33115966,0.3135628,0.37152437,0.25027038,0.30189209,0.38113417,0.27305702,0.25749641,0.48682085,0.2780324,0.32984617,0.24493935,0.3564019,0.44417971,0.36468493,0.37459586,0.35774596,0.39734664,0.39332305,0.46112051,0.17648634,0.26132086,0.20519648,0.15064335,0.1272337,0.0,0.01086423,0.82907365])
            miehet_in=np.array([0.11335952,0.15308942,0.12010497,0.09825407,0.09335011,0.081446,0.06374116,0.04698746,0.03353131,0.02484616,0.02423046,0.02029996,0.01761854,0.01555576,0.01346427,0.01219834,0.01086994,0.00982763,0.00883555,0.00787373,0.0075677,0.00727529,0.00625365,0.00591289,0.00559136,0.00528318,0.00497541,0.00468087,0.00427979,0.00390325,0.00374587,0.00352141,0.00312282,0.00287101,0.00283695,0.00259506,0.00255203,0.00232654,0.00194049,0.00179453,0.00164278,0.00129713,0.00119874,0.00120844,0.00102647,0.00089328,0.00174431,0.00318053,0.00339118,0.01042778,0.0,0.0,0.0])
            miehet_out=np.array([0.37730493,0.30242412,0.21572769,0.19692539,0.26196013,0.34052864,0.38259276,0.41596611,0.38948091,0.36019827,0.36312795,0.32910986,0.31817434,0.33261331,0.29662743,0.30690281,0.30289299,0.30541642,0.31791357,0.25327643,0.25826426,0.41567106,0.2300632,0.28323038,0.28369319,0.29051652,0.29632935,0.43015302,0.23880205,0.3632193,0.23507759,0.35160103,0.33230571,0.23587709,0.35301895,0.23386511,0.33162605,0.40618856,0.31430844,0.32500399,0.43958129,0.31905938,0.47632968,0.20356448,0.59676011,0.19026623,0.18653751,0.27537566,0.36380568,0.17063505,0.22298408,0.11646938,0.91259605])
        else:
            print("Error: Unknown year in ['opiskelija in', 'opiskelija out']")
            
        inrate=np.zeros((101,self.n_groups))
        dfactor=np.array([0.4,1.0,1.5,0.5,1.0,1.5])
        m2=self.get_w(0,dfactor[0],dfactor[1])
        n2=self.get_w(1,dfactor[3],dfactor[4])
        efactor=np.array([1.1,1.0,1.1,1.0,1.0,1.0])
        em2=self.get_w(0,efactor[0],efactor[1])
        en2=self.get_w(1,efactor[3],efactor[4])

        inrate[18:71,0] = dfactor[0]*miehet_in
        inrate[18:71,1] = dfactor[1]*miehet_in
        inrate[18:71,2] = m2*miehet_in
        inrate[18:71,3] = dfactor[3]*naiset_in
        inrate[18:71,4] = dfactor[4]*naiset_in
        inrate[18:71,5] = n2*naiset_in
        
        # reducing outflux for higher income groups? Not currently
        outrate=np.zeros((101,self.n_groups))
        outrate[18:25,0] = efactor[0]*miehet_out[:25-18]
        outrate[18:25,1] = efactor[1]*miehet_out[:25-18]
        outrate[18:25,2] = em2*miehet_out[:25-18]
        outrate[18:25,3] = efactor[3]*naiset_out[:25-18]
        outrate[18:25,4] = efactor[4]*naiset_out[:25-18]
        outrate[18:25,5] = en2*naiset_out[:25-18]
        outrate[25:71,0] = miehet_out[25-18:71-18]
        outrate[25:71,1] = miehet_out[25-18:71-18]
        outrate[25:71,2] = miehet_out[25-18:71-18]
        outrate[25:71,3] = naiset_out[25-18:71-18]
        outrate[25:71,4] = naiset_out[25-18:71-18]
        outrate[25:71,5] = naiset_out[25-18:71-18]
        
        #inrate=1-(1-inrate)**self.timestep
        #outrate=1-(1-outrate)**self.timestep

        inrate = self.scale_rates(inrate)
        outrate = self.scale_rates(outrate)

        return inrate,outrate   
    
    def get_student_rate_v10(self,debug=False):
        '''
        opiskelijoiden intensiteetit eri ryhmille
        päivitetty 20.5.2025
        '''
        if not self.silent:
            print('student year',self.year)
                                                                                            
        ### ['opiskelija in', 'opiskelija out']
        if self.year==2018:
            naiset_in=np.array([0.08429605,0.09685925,0.10277381,0.09891224,0.09280337,0.07673143,0.05790105,0.04673023,0.03816717,0.0302753,0.03376987,0.03035602,0.02660345,0.02426941,0.02276301,0.02088567,0.01915721,0.01797945,0.01532382,0.01371146,0.01260742,0.01041675,0.00942141,0.00872932,0.00784705,0.00689017,0.00639576,0.00587522,0.00577611,0.00515686,0.00470467,0.00458721,0.00425004,0.00334427,0.00308971,0.00309328,0.00299484,0.00251983,0.00245231,0.00188764,0.00158927,0.00139868,0.00097249,0.00072973,0.0007386,0.00146164,0.00197353,0.00391819,0.00447604,0.00502832,0.0,0.0,0.0])
            naiset_out=np.array([0.49476741,0.17778361,0.16091986,0.22494571,0.30278861,0.35199113,0.31293546,0.29989739,0.30720836,0.22187274,0.25527844,0.27217675,0.23003112,0.19879765,0.20841924,0.21097275,0.19819828,0.28792975,0.26006323,0.24084835,0.33993551,0.27369956,0.26507918,0.30088966,0.33254005,0.2896483,0.3105682,0.24638487,0.34054165,0.3245306,0.26473373,0.31075991,0.45125784,0.31452514,0.23571118,0.27244166,0.39139157,0.26755865,0.45810363,0.38838582,0.34846882,0.53554656,0.481181,0.51109141,0.19152922,0.18725604,0.27159297,0.17465351,0.38859972,0.15990103,0.16706593,0.0,0.89309354])
            miehet_in=np.array([0.1243445,0.15377341,0.13220685,0.09285106,0.08895555,0.07890672,0.05990518,0.04323546,0.0317692,0.02425137,0.02346441,0.01886469,0.01663098,0.01374958,0.01095631,0.01038503,0.00913269,0.00829036,0.00754007,0.00723829,0.00659819,0.00587361,0.00551313,0.00535701,0.0045815,0.00415994,0.00402701,0.0039125,0.0036466,0.00360928,0.00352151,0.00305391,0.00289277,0.00267348,0.00248174,0.00249311,0.00216375,0.00205933,0.00199368,0.00179511,0.00136717,0.00113281,0.00096574,0.00096856,0.00111892,0.00125103,0.00214439,0.00295986,0.00368273,0.00379257,0.0,0.0,0.0])
            miehet_out=np.array([0.40502738,0.25695752,0.29365632,0.19577175,0.25474857,0.35993218,0.40159479,0.39439765,0.37688988,0.36779149,0.39158721,0.31703486,0.36672011,0.39371183,0.25669345,0.32272432,0.29282005,0.29739265,0.25650615,0.30350386,0.32552106,0.28747869,0.25198545,0.37442236,0.32446201,0.26684366,0.26785078,0.30402772,0.24973388,0.26158032,0.36932067,0.29342887,0.31558117,0.30784773,0.41844179,0.23191684,0.34955086,0.22403154,0.3366925,0.47069009,0.40200916,0.43104273,0.19725312,0.57597661,0.18339995,0.24412713,0.23694079,0.38630565,0.15638401,0.14951911,0.0,0.0,0.88307815])
        elif self.year==2019:
            naiset_in=np.array([0.07730224,0.10455761,0.10787272,0.0999763,0.09285291,0.07934572,0.0610852,0.04596457,0.03643675,0.03235566,0.03319918,0.03040872,0.02949799,0.0262375,0.02550975,0.02203339,0.02100039,0.01939228,0.01777937,0.01484527,0.01399622,0.01283234,0.01099264,0.01008043,0.00893315,0.00832107,0.00725694,0.00705342,0.00685002,0.00605315,0.0056226,0.00506595,0.00452701,0.00413284,0.00377843,0.00348068,0.00337969,0.00316409,0.00250826,0.00237056,0.00192879,0.00156484,0.00118248,0.00099463,0.00092375,0.00090644,0.00185568,0.00353964,0.00400046,0.00899225,0.0,0.0,0.0])
            naiset_out=np.array([0.50103312,0.16514993,0.16481322,0.22744105,0.28449262,0.34280219,0.35079745,0.32114422,0.2299657,0.28071044,0.25097577,0.18580798,0.24891581,0.17515151,0.25952731,0.17869651,0.21050975,0.22094843,0.30711147,0.20614723,0.25375704,0.32516656,0.27506027,0.31501077,0.28125659,0.34853985,0.29461881,0.23461262,0.34854994,0.30596752,0.33575824,0.34531834,0.32519441,0.32294562,0.31649603,0.26991518,0.29928576,0.4367687,0.29448322,0.41183648,0.41354276,0.46842656,0.3942987,0.62380842,0.18243748,0.19451005,0.23961875,0.16314282,0.3637058,0.14181779,0.18692829,0.17537595,0.86346934])
            miehet_in=np.array([0.13245813,0.1537712,0.12906361,0.09844338,0.09461912,0.0816198,0.0629512,0.04505698,0.03312666,0.0257341,0.02423279,0.01971471,0.01659368,0.01479375,0.01246612,0.01054679,0.00995735,0.00949207,0.00815586,0.00791078,0.0071937,0.0065503,0.0062281,0.00552739,0.00500074,0.00463815,0.00420589,0.0041453,0.00404282,0.00447448,0.00370651,0.00324324,0.00302002,0.0028242,0.00276722,0.00240317,0.00221267,0.00208236,0.00172124,0.00163003,0.00157311,0.00126694,0.00096268,0.00074851,0.00080527,0.00158844,0.00296614,0.0037676,0.00373904,0.00748663,0.0,0.0,0.0])
            miehet_out=np.array([0.41186867,0.26979958,0.25349279,0.19035706,0.27607814,0.3434094,0.40639658,0.39418149,0.36361688,0.38619919,0.38550169,0.34928295,0.30803636,0.35335672,0.35324715,0.26031145,0.25155791,0.34701164,0.35056713,0.22297327,0.30899438,0.27189714,0.34043516,0.32256697,0.30631357,0.32598282,0.25300578,0.26565277,0.38739954,0.23690447,0.36354043,0.30575877,0.30605316,0.25907779,0.37027194,0.3194819,0.29614111,0.40961106,0.29057166,0.27650038,0.42508436,0.47248917,0.47736927,0.19107254,0.34279556,0.17534964,0.17028489,0.39981506,0.44612456,0.14485661,0.00726157,0.0,0.87998654])
        elif self.year==2020:
            naiset_in=np.array([0.11208636,0.12107671,0.12804701,0.12334662,0.11410238,0.09260533,0.07021255,0.05063629,0.0391208,0.03250835,0.03862023,0.03258688,0.03042364,0.02881682,0.02718653,0.02501967,0.02250372,0.01995081,0.01869197,0.01626501,0.01416574,0.01328387,0.0121425,0.01059544,0.00941194,0.00800374,0.00756561,0.00695866,0.0065776,0.00638199,0.00552127,0.00494699,0.00471615,0.00455407,0.00410983,0.00379319,0.0034101,0.00314115,0.00253588,0.00241635,0.00210391,0.00160049,0.00118134,0.00098049,0.00066807,0.00160388,0.00177793,0.00264711,0.00322256,0.00401867,0.0,0.0,0.0])
            naiset_out=np.array([0.47405739,0.1890888,0.16324442,0.21244555,0.30626878,0.34609029,0.37774603,0.33910258,0.27571129,0.1759152,0.29355018,0.22592369,0.19962479,0.20372673,0.20253519,0.2237547,0.23638501,0.19814172,0.26120499,0.28761261,0.23045444,0.28029599,0.31132223,0.31573318,0.35741107,0.28216681,0.30795344,0.28648641,0.26878229,0.37435725,0.33759644,0.28729885,0.2778772,0.33479981,0.45061679,0.23317282,0.31630056,0.42439472,0.28200533,0.36763923,0.45891113,0.49097965,0.40068446,0.54194232,0.51530989,0.17524106,0.29615817,0.17097297,0.15566919,0.25626298,0.0,0.06389108,0.855759])
            miehet_in=np.array([0.15221084,0.17735031,0.13797559,0.10948846,0.10474575,0.08969248,0.06720748,0.04875902,0.03534915,0.02623126,0.02730988,0.02207386,0.01812544,0.01552316,0.01434093,0.01199354,0.01061981,0.01048078,0.0094632,0.00839204,0.00742972,0.00706099,0.0069769,0.00645479,0.00554267,0.00496408,0.00457924,0.00429851,0.00420624,0.00421522,0.00464736,0.00372439,0.00309988,0.0030177,0.00281017,0.00239904,0.00222737,0.00212461,0.0018934,0.00168198,0.0019364,0.0015479,0.00103399,0.00079321,0.00064316,0.0014846,0.0020328,0.00321518,0.00374251,0.00419029,0.0,0.0,0.0])
            miehet_out=np.array([0.38940157,0.306222,0.2351833,0.20026285,0.27805887,0.36166304,0.392119,0.40535718,0.39150783,0.31084772,0.38948689,0.36609385,0.34551361,0.28075013,0.36102093,0.31462339,0.22498929,0.29525685,0.32930539,0.32208358,0.27154642,0.2391995,0.29528401,0.36932966,0.33600871,0.31641598,0.32389703,0.23569585,0.24175411,0.42951277,0.23737908,0.40499221,0.26295599,0.30802406,0.38497654,0.31548717,0.28500006,0.35167148,0.34622364,0.42138603,0.21507808,0.56231809,0.46003584,0.42816322,0.31605748,0.17996589,0.19811486,0.22070401,0.38404086,0.14757418,0.0,0.02359233,0.89381543])
        elif self.year==2021:
            naiset_in=np.array([0.07796541,0.11502565,0.13096454,0.12021229,0.11238955,0.09661097,0.07197967,0.05163991,0.03958986,0.03125777,0.03617501,0.03527017,0.03260162,0.02966192,0.02997233,0.02713265,0.02568624,0.02277753,0.02022668,0.01857575,0.01636108,0.0134928,0.01264943,0.01159362,0.01034597,0.00916012,0.00823032,0.00779962,0.00721799,0.00628683,0.00605463,0.00576339,0.00591172,0.00491912,0.00463752,0.00375304,0.00345939,0.00288273,0.0028357,0.00253129,0.00193302,0.00181797,0.00144377,0.00111193,0.00086343,0.00075067,0.00202691,0.0029653,0.00530282,0.00514193,0.0,0.0,0.0])
            naiset_out=np.array([0.4285175,0.18165209,0.16456702,0.21565933,0.27235261,0.35101508,0.37842968,0.34874555,0.31133687,0.1912537,0.18069084,0.2173393,0.22794878,0.12746603,0.21067901,0.176276,0.22536629,0.2161921,0.22629838,0.25463926,0.34354995,0.22765403,0.27316019,0.31258273,0.32581302,0.36801802,0.23547701,0.30454653,0.3653769,0.27472182,0.28689425,0.44689611,0.23562938,0.29512069,0.42751442,0.31820714,0.40460262,0.25964276,0.34099648,0.46464322,0.29098809,0.42522002,0.46381413,0.43779797,0.37822489,0.31430454,0.16480293,0.33912493,0.14622429,0.13242164,0.20946956,0.0,0.84853545])
            miehet_in=np.array([0.12115068,0.18274845,0.131565,0.10568634,0.09955313,0.08735301,0.06576985,0.0472785,0.03335077,0.02507073,0.02533587,0.02084204,0.0175302,0.01542267,0.01406357,0.01268805,0.01078536,0.01007894,0.00939602,0.00869101,0.00746363,0.00729402,0.00689438,0.00615024,0.00552965,0.00521194,0.00446614,0.00431454,0.00419642,0.00393036,0.0035505,0.00345693,0.00318299,0.00310456,0.002749,0.0026773,0.00296967,0.00235462,0.00226288,0.00197389,0.0017065,0.00111694,0.00115343,0.00086971,0.00090222,0.00160158,0.00195456,0.00472424,0.00414984,0.00390182,0.0,0.0,0.0])
            miehet_out=np.array([0.33831093,0.33614638,0.2436362,0.2096599,0.25878739,0.36325483,0.39590245,0.42437182,0.38823849,0.3358982,0.37720258,0.35255931,0.32434177,0.28760681,0.30017926,0.34777377,0.27614302,0.26341233,0.29622344,0.33964007,0.31720933,0.22608799,0.33097929,0.32994797,0.29236173,0.37131364,0.27013708,0.35523272,0.2371935,0.33196927,0.26936132,0.31210815,0.27073376,0.35253352,0.26230409,0.44828191,0.22877852,0.28299164,0.36147394,0.37487232,0.57348487,0.21519033,0.47037183,0.20598114,0.55909217,0.18273971,0.3521662,0.16683027,0.40213785,0.17146432,0.0,0.0,0.88868908])
        elif self.year==2022:
            naiset_in=np.array([0.07008732,0.10934883,0.12512112,0.11254189,0.10620107,0.08794234,0.06995267,0.05191221,0.03755517,0.03041372,0.03343588,0.03078614,0.03025939,0.02788286,0.02585839,0.02457479,0.02276883,0.02106867,0.0192526,0.01594812,0.01500761,0.01374432,0.01149967,0.01094135,0.009717,0.00870239,0.0077039,0.00685942,0.00644424,0.00625055,0.00532544,0.00508501,0.00487296,0.00410146,0.00369745,0.0037889,0.00341849,0.00292062,0.0025492,0.00232844,0.00208208,0.0016146,0.00148134,0.00103632,0.00090442,0.00121376,0.00170924,0.00338953,0.00308256,0.00419167,0.0,0.0,0.0])
            naiset_out=np.array([0.44963013,0.17079751,0.1647413,0.20773989,0.29379627,0.31908225,0.36352514,0.38074749,0.30766576,0.23442392,0.24476871,0.17933146,0.21378569,0.21884387,0.18127041,0.20420615,0.204261,0.22434055,0.31202758,0.21534495,0.25140036,0.34151113,0.24098969,0.30799109,0.31454947,0.33662011,0.33518163,0.29475198,0.2680578,0.38055802,0.28536349,0.28429884,0.39606515,0.33672647,0.35969738,0.23343413,0.38499619,0.36326886,0.32313653,0.34206435,0.56148145,0.20900946,0.51787307,0.34981283,0.43184696,0.16330413,0.42410386,0.13874127,0.34290816,0.09441423,0.0,0.0,0.77482896])
            miehet_in=np.array([0.10995984,0.18016061,0.12811765,0.10076337,0.09293215,0.08004979,0.06244888,0.04384621,0.03160334,0.02365351,0.02367135,0.02025551,0.01681071,0.01442627,0.01278923,0.0110989,0.01020502,0.00905739,0.00824524,0.00778577,0.00727798,0.00641867,0.0059543,0.00557074,0.00551742,0.00483517,0.00439643,0.00407993,0.00378239,0.00350007,0.00349299,0.00303803,0.00298289,0.00282058,0.00263351,0.00246791,0.00200456,0.00192702,0.00173394,0.00152282,0.00152037,0.00120564,0.00121201,0.00090418,0.00085518,0.00077797,0.00166893,0.00292154,0.00479256,0.00427294,0.0,0.0,0.0])
            miehet_out=np.array([0.3312466,0.34563031,0.25153067,0.2231482,0.27525545,0.3397766,0.41770492,0.40858321,0.38805825,0.34316252,0.34420691,0.36858293,0.33755603,0.31208467,0.33026393,0.28420071,0.31634334,0.29681084,0.26785279,0.28191951,0.33677067,0.29282846,0.29133918,0.23936175,0.35346911,0.32734243,0.39512989,0.23972185,0.31921058,0.23714592,0.37014119,0.25504355,0.29525745,0.3082691,0.29878651,0.42803842,0.28269425,0.33623464,0.36288151,0.23685832,0.44349336,0.23644568,0.48790264,0.28136628,0.3248,0.19592903,0.30291687,0.26175154,0.16371877,0.22639726,0.11194902,0.0,0.89254361])
        elif self.year==2023:
            naiset_in=np.array([0.07597442,0.10185883,0.1170111,0.10550838,0.10672948,0.09060505,0.06761578,0.05171368,0.04074439,0.03080399,0.03451679,0.0320605,0.02931792,0.02924745,0.02633544,0.0242402,0.02364802,0.02160477,0.01953614,0.01800882,0.01555717,0.01422546,0.01247039,0.01103493,0.00976983,0.00937353,0.00839224,0.00763054,0.00653874,0.00645028,0.00605012,0.00518612,0.00502112,0.00491686,0.00369349,0.00353774,0.00321112,0.0032057,0.00284177,0.00224981,0.00195126,0.0016735,0.00147398,0.00122046,0.00101511,0.00077772,0.00125036,0.0026402,0.00299896,0.00390489,0.0,0.0,0.0])
            naiset_out=np.array([0.45936692,0.19368784,0.16583199,0.16608564,0.28620389,0.36131287,0.34116565,0.32893755,0.35299909,0.2372011,0.23195658,0.2501863,0.16923656,0.23284675,0.2279019,0.14848512,0.22364235,0.2429474,0.22470486,0.28604857,0.25873805,0.30327643,0.31419441,0.30881683,0.25226462,0.33057902,0.31398772,0.37119433,0.24922297,0.30174678,0.3804698,0.27237949,0.25670198,0.48625457,0.27733162,0.32899927,0.24431553,0.35558486,0.44292136,0.3630153,0.37215311,0.35374627,0.39159449,0.38652497,0.45301867,0.16677071,0.24942758,0.19122823,0.13409608,0.10778866,0.0,0.0,0.79901969])
            miehet_in=np.array([0.11335952,0.15260265,0.11988106,0.0980306,0.09363036,0.0817473,0.06358961,0.04717242,0.03361677,0.025081,0.02440251,0.02041863,0.0177453,0.0156342,0.01348395,0.01225656,0.01095489,0.00978605,0.00884767,0.00787037,0.00756545,0.00727602,0.00626526,0.00591923,0.00561206,0.00528123,0.00499655,0.00468829,0.00427039,0.0038966,0.00374144,0.0035154,0.00312917,0.00287003,0.00283706,0.00260059,0.00254586,0.00232946,0.00193696,0.00179829,0.00164,0.00129419,0.00119855,0.00120676,0.00103033,0.00089135,0.0017651,0.0031758,0.00339118,0.01042778,0.0,0.0,0.0])
            miehet_out=np.array([0.37743615,0.30242719,0.21667177,0.19716737,0.26543353,0.34338734,0.38604833,0.42144727,0.39510434,0.36640105,0.36761447,0.33438576,0.31805476,0.33433388,0.29667254,0.30568144,0.2967108,0.30831224,0.31899226,0.25398345,0.25846861,0.41441606,0.22955717,0.2807695,0.2824173,0.28984652,0.29613421,0.42952696,0.23769312,0.36306893,0.23425059,0.35101654,0.33134232,0.23522179,0.35212249,0.23298659,0.33078443,0.40500647,0.31308952,0.32296723,0.43709691,0.31536806,0.47199041,0.19846283,0.59080256,0.18355431,0.17881934,0.26695599,0.35452246,0.16050415,0.2120055,0.10464312,0.89992211])
        elif self.year==2024:
            naiset_in=np.array([0.07597442,0.10254155,0.11728367,0.10594708,0.10793342,0.09118925,0.06782555,0.05200874,0.04097919,0.03116398,0.03466314,0.03256647,0.02993709,0.02973098,0.02723455,0.02491089,0.02454179,0.02237709,0.02004042,0.01842449,0.01587071,0.01446116,0.0126441,0.01106854,0.00982618,0.00942143,0.00837054,0.00764792,0.00653647,0.0064662,0.00607067,0.00517848,0.00501871,0.00491945,0.00368954,0.00353758,0.00322677,0.00321232,0.00283947,0.00224288,0.00195999,0.00167853,0.00147178,0.00122438,0.00101614,0.00077901,0.00123129,0.00266078,0.00299896,0.00390489,0.0,0.0,0.0])
            naiset_out=np.array([0.46002736,0.19386361,0.16691097,0.16890273,0.2854261,0.362386,0.34856455,0.33249719,0.35835083,0.2444788,0.23466928,0.25251182,0.17452404,0.23595815,0.2331415,0.15864581,0.22048552,0.24437524,0.22553488,0.29103848,0.25650225,0.2995728,0.3136577,0.30801237,0.25414669,0.33165378,0.31320026,0.37144573,0.24871201,0.30184459,0.38130496,0.27265693,0.25741042,0.4866726,0.27788275,0.32981574,0.24502267,0.35639723,0.44420579,0.36467479,0.37457789,0.35772692,0.39731838,0.39329669,0.4611104,0.17646796,0.26124937,0.20502652,0.15051881,0.12707231,0.0,0.01061082,0.82876507])
            miehet_in=np.array([0.11335952,0.15342375,0.12029983,0.09840597,0.09352133,0.08173667,0.06396994,0.04728003,0.03363505,0.02496663,0.02437532,0.02042407,0.01766074,0.01561591,0.0135132,0.01222374,0.01094254,0.00985969,0.00884266,0.00789035,0.00756535,0.00727629,0.00625875,0.00591268,0.00560115,0.00529093,0.00498174,0.00468368,0.004277,0.00390092,0.00374699,0.00351466,0.00312122,0.00287138,0.00283851,0.00259261,0.00255343,0.00232498,0.00194501,0.00179327,0.00164328,0.00129861,0.00120172,0.00120521,0.00102555,0.00089399,0.00174391,0.00315346,0.00339118,0.01042778,0.0,0.0,0.0])
            miehet_out=np.array([0.37839997,0.30304045,0.21741602,0.19835807,0.26472248,0.34374295,0.38720895,0.42238876,0.39612052,0.36822481,0.36813514,0.3332674,0.32205948,0.33421278,0.2966765,0.30446108,0.29994774,0.30548991,0.31749696,0.25356919,0.2574613,0.41477507,0.22766095,0.2821964,0.28353946,0.29036034,0.29619675,0.43016423,0.23837676,0.36297822,0.23505384,0.35164551,0.33234304,0.23583844,0.3529178,0.23388032,0.33163866,0.40620079,0.31426178,0.32502163,0.43957252,0.31901514,0.4762123,0.20349166,0.59664528,0.19009454,0.18634745,0.27524281,0.36355084,0.17034907,0.22266695,0.11612111,0.91221664])
        elif self.year==2025:
            naiset_in=np.array([0.07597442,0.10275278,0.11766695,0.10585817,0.10828932,0.09108368,0.06773498,0.05205621,0.0409935,0.03109617,0.03449349,0.03250814,0.02985958,0.02968631,0.02715135,0.02488609,0.02434263,0.02211022,0.01986971,0.01829257,0.01572357,0.01438037,0.01258162,0.0110418,0.00981695,0.00939799,0.00834749,0.00762744,0.00655598,0.00646975,0.0060663,0.00517938,0.00501673,0.00491605,0.0036924,0.00353355,0.00322685,0.00321569,0.0028361,0.00224529,0.00195971,0.00167777,0.00147076,0.00122433,0.0010181,0.00078034,0.00123282,0.00265981,0.00299896,0.00390489,0.0,0.0,0.0])
            naiset_out=np.array([0.45864882,0.19408197,0.1646207,0.16681873,0.28248887,0.35775901,0.33857506,0.31866753,0.34061744,0.22349728,0.21519997,0.23510485,0.15737809,0.2217605,0.22180816,0.15380856,0.2169123,0.24035824,0.21678139,0.28081251,0.25260896,0.29921769,0.31272925,0.31035854,0.25326632,0.33049726,0.31369562,0.37164178,0.24981794,0.30186872,0.38105378,0.27276857,0.25748261,0.48681724,0.27803324,0.32986678,0.24495589,0.35638149,0.44422941,0.36465104,0.37458254,0.35774441,0.39735528,0.39333084,0.46112023,0.17650249,0.26130138,0.20510524,0.15060123,0.12716081,0.0,0.01070781,0.82886447])
            miehet_in=np.array([0.11335952,0.15324351,0.12030425,0.09838291,0.09344412,0.08159622,0.06381041,0.04714037,0.03350457,0.02490792,0.02427058,0.02030924,0.01759922,0.01550712,0.01344316,0.01217087,0.01087026,0.00981576,0.00881421,0.00786882,0.0075561,0.007278,0.00625991,0.00592056,0.00560276,0.00529309,0.00497973,0.00468781,0.00427791,0.00389906,0.00374397,0.00352038,0.0031217,0.00286998,0.00283668,0.00259796,0.0025516,0.00232263,0.0019425,0.00179048,0.00164354,0.00129489,0.00119923,0.00120572,0.00102629,0.00089442,0.00174519,0.0031485,0.00339118,0.01042778,0.0,0.0,0.0])
            miehet_out=np.array([0.37736796,0.30296089,0.21581695,0.19716328,0.26212476,0.3404724,0.38277596,0.41614878,0.38950227,0.36034926,0.36331496,0.32893855,0.31689331,0.33214638,0.29616708,0.30643462,0.302161,0.3053247,0.31802941,0.25305127,0.25906292,0.4156807,0.22958689,0.28350637,0.28354872,0.29055945,0.29636886,0.43016558,0.23882748,0.36326774,0.23506203,0.35166985,0.33232119,0.23588216,0.3530205,0.23384707,0.33162878,0.40621917,0.31428772,0.32506076,0.43956789,0.31912636,0.47631058,0.20357404,0.59673593,0.19021787,0.18649561,0.27544213,0.36376006,0.17058482,0.22292923,0.11640992,0.91253198])
        elif self.year==2026:
            naiset_in=np.array([0.07597442,0.10263165,0.11776609,0.10651177,0.10898251,0.09189935,0.06859534,0.05253569,0.04125699,0.03137269,0.0348467,0.03269079,0.0300223,0.02978992,0.02717813,0.02471287,0.02408547,0.02207956,0.01976133,0.01823975,0.01574469,0.01436033,0.01258179,0.01103421,0.00980081,0.0093708,0.00835228,0.00762421,0.00653852,0.00646184,0.00607464,0.00517386,0.00501345,0.00491648,0.00369263,0.00353823,0.00323044,0.00321132,0.00284318,0.00224185,0.00195888,0.0016777,0.001471,0.00122487,0.00101766,0.00078093,0.00123104,0.00264034,0.00299896,0.00390489,0.0,0.0,0.0])
            naiset_out=np.array([0.46462666,0.19411615,0.16480917,0.16737731,0.28337592,0.35905808,0.34033819,0.32051946,0.34139695,0.22402855,0.2162489,0.23548591,0.15813206,0.22200868,0.21786745,0.14988237,0.22161498,0.23893165,0.21677015,0.28290333,0.25187088,0.30075887,0.31290963,0.30732,0.25257424,0.33115966,0.3135628,0.37152437,0.25027038,0.30189209,0.38113417,0.27305702,0.25749641,0.48682085,0.2780324,0.32984617,0.24493935,0.3564019,0.44417971,0.36468493,0.37459586,0.35774596,0.39734664,0.39332305,0.46112051,0.17648634,0.26132086,0.20519648,0.15064335,0.1272337,0.0,0.01086423,0.82907365])
            miehet_in=np.array([0.11335952,0.15308942,0.12010497,0.09825407,0.09335011,0.081446,0.06374116,0.04698746,0.03353131,0.02484616,0.02423046,0.02029996,0.01761854,0.01555576,0.01346427,0.01219834,0.01086994,0.00982763,0.00883555,0.00787373,0.0075677,0.00727529,0.00625365,0.00591289,0.00559136,0.00528318,0.00497541,0.00468087,0.00427979,0.00390325,0.00374587,0.00352141,0.00312282,0.00287101,0.00283695,0.00259506,0.00255203,0.00232654,0.00194049,0.00179453,0.00164278,0.00129713,0.00119874,0.00120844,0.00102647,0.00089328,0.00174431,0.00318053,0.00339118,0.01042778,0.0,0.0,0.0])
            miehet_out=np.array([0.37730493,0.30242412,0.21572769,0.19692539,0.26196013,0.34052864,0.38259276,0.41596611,0.38948091,0.36019827,0.36312795,0.32910986,0.31817434,0.33261331,0.29662743,0.30690281,0.30289299,0.30541642,0.31791357,0.25327643,0.25826426,0.41567106,0.2300632,0.28323038,0.28369319,0.29051652,0.29632935,0.43015302,0.23880205,0.3632193,0.23507759,0.35160103,0.33230571,0.23587709,0.35301895,0.23386511,0.33162605,0.40618856,0.31430844,0.32500399,0.43958129,0.31905938,0.47632968,0.20356448,0.59676011,0.19026623,0.18653751,0.27537566,0.36380568,0.17063505,0.22298408,0.11646938,0.91259605])
        else:
            print("Error: Unknown year in ['opiskelija in', 'opiskelija out']")
            
        inrate=np.zeros((101,self.n_groups))
        dfactor=np.array([0.4,1.0,1.5,0.5,1.0,1.5])
        m2=self.get_w(0,dfactor[0],dfactor[1])
        n2=self.get_w(1,dfactor[3],dfactor[4])
        efactor=np.array([1.1,1.0,1.1,1.0,1.0,1.0])
        em2=self.get_w(0,efactor[0],efactor[1])
        en2=self.get_w(1,efactor[3],efactor[4])

        inrate[18:71,0] = dfactor[0]*miehet_in
        inrate[18:71,1] = dfactor[1]*miehet_in
        inrate[18:71,2] = m2*miehet_in
        inrate[18:71,3] = dfactor[3]*naiset_in
        inrate[18:71,4] = dfactor[4]*naiset_in
        inrate[18:71,5] = n2*naiset_in
        
        # reducing outflux for higher income groups? Not currently
        outrate=np.zeros((101,self.n_groups))
        outrate[18:25,0] = efactor[0]*miehet_out[:25-18]
        outrate[18:25,1] = efactor[1]*miehet_out[:25-18]
        outrate[18:25,2] = em2*miehet_out[:25-18]
        outrate[18:25,3] = efactor[3]*naiset_out[:25-18]
        outrate[18:25,4] = efactor[4]*naiset_out[:25-18]
        outrate[18:25,5] = en2*naiset_out[:25-18]
        outrate[25:71,0] = miehet_out[25-18:71-18]
        outrate[25:71,1] = miehet_out[25-18:71-18]
        outrate[25:71,2] = miehet_out[25-18:71-18]
        outrate[25:71,3] = naiset_out[25-18:71-18]
        outrate[25:71,4] = naiset_out[25-18:71-18]
        outrate[25:71,5] = naiset_out[25-18:71-18]
        
        #inrate=1-(1-inrate)**self.timestep
        #outrate=1-(1-outrate)**self.timestep

        inrate = self.scale_rates(inrate)
        outrate = self.scale_rates(outrate)

        return inrate,outrate                              
            
    def get_outsider_rate(self,debug=False):
        '''
        työelämän ulkopuolelle jäävien osuudet
        '''
        inrate=np.zeros((101,self.n_groups))
        outrate=np.zeros((101,self.n_groups))
        
        ### ['outsider in', 'outsider out']
        if self.year==2018:
            naiset_in=np.array([0.07188478,0.02144271,0.01632247,0.01422842,0.01775547,0.01584224,0.02049331,0.02432299,0.02009024,0.02266559,0.02261959,0.02243353,0.0217887,0.01988434,0.0177356,0.01675511,0.01295835,0.01465148,0.01382857,0.01151216,0.01104938,0.0141663,0.01063493,0.00886429,0.01177478,0.00874573,0.01106523,0.00897289,0.00882248,0.00977852,0.00866754,0.00869473,0.00856401,0.00878489,0.00837723,0.01048662,0.01004334,0.00934891,0.01006639,0.01003415,0.01105608,0.0110662,0.01158757,0.01156946,0.01256269,0.01090657,0.0111726,0.01125381,0.01106277,0.01197219,0.07452729,0.23772338,0.2901515])
            naiset_out=np.array([0.2,0.46836584,0.36187538,0.2369423,0.2,0.30825657,0.2,0.2,0.2016256,0.2,0.24281339,0.24529263,0.30591436,0.29026242,0.2190546,0.40112751,0.27915595,0.2,0.2,0.21678225,0.2,0.2,0.31861852,0.24680854,0.2,0.2084253,0.2,0.20944519,0.2575351,0.2,0.20382953,0.22077724,0.25083779,0.2,0.2129408,0.2,0.2,0.20027967,0.2,0.22347764,0.2,0.2,0.26003816,0.25187677,0.65729193,0.65481952,0.6289137,0.48738026,0.340803,0.25416495,1.0,0.0,0.0])
            miehet_in=np.array([0.08410714,0.07237519,0.03706491,0.01619751,0.01322211,0.01253586,0.01216909,0.01291042,0.01234497,0.01241459,0.01217029,0.01228302,0.01213079,0.01202257,0.01393537,0.01151813,0.01125366,0.01390094,0.01056912,0.01132803,0.01011162,0.01031902,0.00974711,0.01031691,0.0094521,0.01052286,0.00940912,0.00948352,0.0095808,0.00945358,0.0119701,0.00955708,0.01201355,0.01004612,0.01239322,0.01043285,0.01155897,0.01185186,0.01253429,0.01180178,0.01183465,0.01236593,0.01237448,0.01267769,0.01269982,0.01048702,0.00856717,0.00992793,0.00971524,0.01194266,0.07564949,0.25342185,0.31701501])
            miehet_out=np.array([0.2,0.2,0.7297429,0.38198808,0.26498368,0.2500681,0.23092201,0.2,0.20975017,0.235969,0.2,0.22378438,0.20835925,0.28611848,0.2,0.21152192,0.30329574,0.2,0.24535825,0.2,0.21578175,0.2,0.28546756,0.2,0.2,0.2,0.20626534,0.2,0.2,0.26840237,0.2,0.22867006,0.2,0.24061216,0.2,0.26866224,0.2,0.2,0.2,0.25034397,0.22438638,0.26118488,0.24923082,0.34060973,0.69688675,0.75980392,0.4331033,0.45554139,0.21519358,0.3249068,1.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.06705144,0.02048038,0.01571529,0.01441408,0.01937543,0.01671552,0.01714545,0.02190865,0.02576963,0.02249245,0.02645603,0.02519903,0.02568635,0.02371578,0.02304098,0.02109403,0.0181295,0.01751088,0.01563526,0.02032408,0.01333503,0.01254094,0.01175344,0.0103047,0.00911237,0.00953923,0.00942654,0.00889842,0.00879551,0.00860789,0.00856372,0.00839838,0.00901099,0.00854343,0.00833717,0.01217155,0.01036625,0.00978473,0.01176769,0.01041598,0.01075706,0.01256233,0.01629171,0.0183416,0.01676039,0.01494809,0.01081246,0.0120061,0.01212062,0.01400229,0.04777852,0.10099024,0.15138849])
            naiset_out=np.array([0.2,0.44852797,0.31095586,0.26088557,0.2,0.2,0.2,0.2,0.2,0.2054108,0.2,0.21523677,0.30233337,0.2,0.26401556,0.3151395,0.27571195,0.2,0.36619237,0.2,0.21428642,0.22160971,0.28070119,0.27933293,0.2262207,0.2,0.2,0.2,0.21724011,0.23501096,0.2,0.20942272,0.2,0.23340577,0.20682369,0.2,0.2,0.24700656,0.2,0.20558638,0.21294878,0.2,0.2,0.2,0.53613775,0.84135509,0.58639534,0.65728608,0.2,0.31241412,1.0,0.0,0.0])
            miehet_in=np.array([0.09152415,0.0598415,0.03545439,0.01639579,0.01350357,0.01293256,0.01201391,0.01124326,0.0139357,0.01157067,0.0109714,0.01109199,0.01258118,0.01156069,0.01085539,0.01479345,0.01066199,0.00999655,0.01202703,0.00946208,0.01499608,0.01002211,0.00967132,0.00913483,0.00868919,0.01158042,0.00928034,0.01152995,0.00953656,0.00932348,0.0093091,0.01070794,0.00958509,0.00955212,0.01107241,0.0126099,0.01055071,0.01270616,0.01108399,0.01135038,0.01175653,0.01199733,0.01168821,0.01178986,0.01318875,0.01289099,0.00815574,0.00866981,0.01353898,0.01295853,0.03469345,0.04745508,0.05538052])
            miehet_out=np.array([0.2,0.2,0.70965808,0.3739108,0.26372489,0.2802661,0.28635611,0.27097222,0.2,0.26793246,0.20026661,0.28385986,0.2,0.2,0.32178068,0.2,0.24666689,0.26652812,0.2,0.24090834,0.2,0.22150537,0.2431564,0.23551715,0.2,0.2,0.23484475,0.2,0.21813976,0.20567705,0.22147644,0.2,0.21300436,0.23988076,0.2,0.2,0.25824637,0.2,0.20371107,0.25739312,0.2,0.30184499,0.27298111,0.20075144,0.50832058,0.871563,0.57830212,0.47546539,0.2,0.26608888,1.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.06570641,0.01951366,0.0153288,0.01501413,0.01472058,0.02033356,0.01712825,0.02377124,0.02085368,0.02358696,0.02447857,0.02511436,0.0248409,0.02593973,0.02431979,0.02264995,0.0196645,0.01736866,0.01597636,0.01427845,0.01267168,0.01253908,0.01110417,0.00970584,0.00895817,0.00790076,0.00781322,0.00772523,0.00756776,0.00750401,0.00747703,0.00825309,0.00773677,0.00769226,0.00767203,0.00927186,0.00854178,0.01078888,0.00898916,0.00909455,0.00950597,0.01039755,0.01040956,0.01392771,0.0128772,0.01493431,0.01128767,0.01045889,0.00782964,0.01343185,0.04676259,0.06558456,0.09902208])
            naiset_out=np.array([0.2,0.44758395,0.25049767,0.30583796,0.2,0.2,0.22185715,0.2,0.21833391,0.2,0.2,0.24673683,0.24337494,0.2,0.2556019,0.29260787,0.25335762,0.23190028,0.22456465,0.24136479,0.23957279,0.2,0.27630482,0.22672591,0.29525784,0.21198754,0.2,0.2,0.21044822,0.20327255,0.22832408,0.2,0.2,0.20460874,0.25243151,0.2,0.2,0.2,0.20617746,0.21666079,0.23408196,0.2,0.20125248,0.2,0.2414138,0.88988365,0.6107553,0.64318916,0.28692831,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.08145464,0.05294688,0.03168159,0.01554986,0.01351777,0.01270465,0.01263061,0.01104826,0.01216585,0.01130559,0.01138514,0.01108722,0.00942318,0.00933668,0.01210744,0.00959059,0.01188281,0.01138411,0.0094644,0.01276346,0.00896174,0.01304674,0.00918886,0.00888943,0.00867462,0.00828493,0.01165767,0.00959663,0.00918427,0.00886265,0.00870497,0.01089745,0.00924622,0.00915481,0.00901285,0.00963408,0.01125468,0.00992902,0.01059148,0.01105724,0.01104606,0.0109238,0.0111208,0.01366387,0.01284031,0.01441849,0.01039389,0.01110589,0.00741004,0.01932321,0.03660877,0.04409236,0.05364846])
            miehet_out=np.array([0.2,0.2,0.68397388,0.33570659,0.27067774,0.2232129,0.3409314,0.24076033,0.2,0.20821993,0.23870465,0.35419144,0.21658513,0.23184724,0.2,0.3084947,0.2,0.2,0.31696922,0.2,0.26166665,0.2,0.21137401,0.26017915,0.2,0.20090875,0.2,0.2,0.23636641,0.21846382,0.20437889,0.2,0.2200282,0.22522116,0.20807812,0.2,0.2,0.22723685,0.2,0.2,0.27054598,0.23996746,0.25942154,0.2,0.27414314,0.91839063,0.47298839,0.69150977,0.22747198,0.2,1.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.04937621,0.01728217,0.01543866,0.01413621,0.0156616,0.01636857,0.01606458,0.02342344,0.02028191,0.02140837,0.02327159,0.02369237,0.03393851,0.02897917,0.02973262,0.02733313,0.02354373,0.02271389,0.01858535,0.01690873,0.01486867,0.0128668,0.01237655,0.01140807,0.00940972,0.00891057,0.00849418,0.00838206,0.00795341,0.00922795,0.00808436,0.0078606,0.0096071,0.00794859,0.00898019,0.00781648,0.00813246,0.0095479,0.00911106,0.00896166,0.01304344,0.01083703,0.011118,0.01844997,0.0179315,0.01686504,0.01393023,0.01484822,0.00917997,0.01208408,0.04151317,0.06974569,0.09630539])
            naiset_out=np.array([0.2,0.35369786,0.31104472,0.2758274,0.2,0.2,0.20443354,0.2,0.20152036,0.21473868,0.23859429,0.2,0.2,0.23967292,0.2,0.28035972,0.21081697,0.31384817,0.20082682,0.2437751,0.27340516,0.21753452,0.2,0.33781365,0.2,0.29546852,0.2,0.2,0.21883806,0.2,0.23304766,0.25788193,0.2,0.27064916,0.2,0.20809721,0.2,0.2,0.2,0.21039319,0.2,0.30636541,0.2,0.2,0.2,0.87110779,0.6041478,0.71851563,0.21116192,0.29270386,1.0,0.0,0.0])
            miehet_in=np.array([0.07720599,0.05250024,0.03183734,0.01631397,0.01373075,0.01301766,0.01270508,0.01291307,0.01382713,0.01305097,0.01510113,0.01321245,0.01171994,0.01278681,0.01181262,0.01171692,0.01122993,0.01059181,0.01372886,0.01086111,0.01110415,0.01033964,0.00963954,0.00964318,0.00922076,0.00897605,0.0085574,0.01081603,0.00901405,0.01029068,0.0091836,0.00905482,0.01026214,0.01103725,0.00960516,0.00916704,0.01123405,0.01088346,0.01021337,0.0118132,0.01121317,0.01138459,0.01158203,0.01203575,0.01663428,0.01534717,0.01178743,0.01680687,0.00987511,0.01154636,0.02894633,0.05825932,0.05095929])
            miehet_out=np.array([0.2,0.2,0.65653074,0.36877479,0.2563341,0.24083294,0.20920709,0.24630448,0.2,0.26891719,0.2,0.31759693,0.20846224,0.2,0.20676332,0.2188429,0.24975732,0.20523757,0.2,0.30216785,0.2,0.2,0.22408471,0.2,0.22560638,0.23188248,0.21557932,0.2,0.22643203,0.2,0.21568151,0.24297222,0.2,0.2,0.25549925,0.22705244,0.2,0.2,0.22669837,0.2,0.2288134,0.28511592,0.2,0.2,0.2,0.90793963,0.39398423,0.70330214,0.46045549,0.2,1.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.06588483,0.01972602,0.01636218,0.01459564,0.0141936,0.02260798,0.01753634,0.02333347,0.02123548,0.02162292,0.02210242,0.02295283,0.02349912,0.02098782,0.02063563,0.01953455,0.01841636,0.01713504,0.0195748,0.01492177,0.01252422,0.01371376,0.01145089,0.01020162,0.00959991,0.00904972,0.00918268,0.00878372,0.00854549,0.0083518,0.00830487,0.00830584,0.0084513,0.00848987,0.00851517,0.01098037,0.01039119,0.01104193,0.00978524,0.01110744,0.01083431,0.01270858,0.01245427,0.01725357,0.01584545,0.0183352,0.01556553,0.01650517,0.01323529,0.02158103,0.07810871,0.11180448,0.17950771])
            naiset_out=np.array([0.2,0.40050296,0.33249465,0.26038037,0.20138348,0.2,0.27406583,0.2,0.2,0.23445778,0.21843492,0.21161442,0.32324724,0.20226711,0.23951408,0.20336436,0.22188397,0.29619453,0.2,0.34659889,0.2,0.2,0.25714012,0.21687452,0.22749954,0.21855327,0.2,0.21617495,0.20987209,0.20147781,0.20804935,0.20443607,0.2,0.2074662,0.26542472,0.2,0.2,0.2,0.20855264,0.2,0.24376046,0.2,0.20525912,0.2,0.27040544,0.85865967,0.6070954,0.66056589,0.33684934,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07719162,0.05191978,0.03161209,0.01613399,0.01312968,0.01267133,0.01185712,0.01164589,0.01342938,0.01129216,0.01124972,0.01028866,0.0089712,0.00938985,0.00842217,0.00786983,0.01041068,0.00861805,0.01392668,0.00918817,0.00921506,0.01112536,0.00888957,0.00892107,0.00868284,0.00850955,0.01007491,0.01055993,0.00911864,0.01025487,0.00915219,0.0089705,0.01021497,0.01100884,0.00961462,0.00919548,0.01129842,0.01101663,0.01012865,0.01188244,0.01113018,0.01159364,0.01165654,0.0120883,0.01669264,0.01536689,0.01099382,0.01451704,0.0098726,0.01154288,0.02893212,0.0582243,0.05092331])
            miehet_out=np.array([0.2,0.2,0.66140517,0.39021804,0.24607341,0.27610865,0.24275913,0.32199144,0.2,0.34613272,0.2,0.34318558,0.28437045,0.2,0.25184543,0.22184697,0.2,0.2,0.2,0.26352818,0.2,0.2,0.22373018,0.2,0.2,0.22818645,0.2,0.2,0.22890863,0.2,0.21568151,0.24035711,0.2,0.2,0.25549925,0.22705244,0.2,0.2,0.22669837,0.2,0.2288134,0.28511592,0.2,0.2,0.2,0.90793963,0.39398423,0.70330214,0.46045549,0.2,1.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.06331029,0.01677744,0.01276475,0.01181365,0.01134145,0.01706646,0.01580464,0.0188286,0.01673477,0.01939437,0.01909679,0.01968393,0.02012024,0.01676957,0.01645151,0.01449882,0.01287767,0.01209083,0.01129453,0.01024537,0.00871053,0.01093239,0.0081504,0.00737433,0.00677994,0.0063356,0.00677864,0.00608475,0.00590215,0.00585497,0.00622027,0.00575861,0.00582077,0.00644666,0.00603535,0.00866992,0.00805576,0.00886102,0.00738835,0.00850154,0.00820428,0.00989513,0.00937551,0.01344445,0.0120063,0.0104188,0.00148382,0.0,0.0,0.0,0.0,0.0,0.0])
            naiset_out=np.array([0.2,0.46413103,0.30339235,0.27449546,0.2441644,0.2,0.2,0.2,0.21981233,0.2,0.22683499,0.20912616,0.38871783,0.2,0.3050101,0.28479199,0.2,0.2503126,0.2,0.31063827,0.237971,0.2,0.34748662,0.2,0.2,0.27567158,0.2,0.2,0.24916031,0.2,0.2,0.20436166,0.2,0.2,0.27181501,0.2,0.2,0.2,0.20811158,0.2,0.25831133,0.2,0.21020003,0.2,0.28073765,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0])
            miehet_in=np.array([0.07365009,0.04778592,0.02808267,0.01331752,0.01035968,0.00953639,0.00891359,0.00894888,0.00784541,0.00720384,0.01012229,0.00738436,0.00610108,0.00555603,0.00533661,0.00690227,0.00543594,0.00833502,0.00777418,0.00620303,0.00702798,0.00970162,0.00648147,0.00771384,0.00678947,0.00628057,0.00640277,0.00900108,0.0067109,0.00674815,0.00638336,0.00629313,0.00785198,0.00864827,0.00702301,0.00670471,0.00877889,0.00849763,0.00757515,0.00932239,0.00837834,0.00861883,0.008287,0.00857011,0.01231241,0.00421741,0.00027965,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_out=np.array([0.2,0.2,0.70162672,0.42418646,0.29278151,0.27978028,0.21773957,0.33511212,0.3071274,0.32331871,0.2,0.3801337,0.29323013,0.22839848,0.24014805,0.2,0.20541973,0.2,0.2,0.29295897,0.2,0.2,0.27119802,0.2,0.2,0.2490591,0.2,0.2,0.26655661,0.2,0.21086491,0.24772969,0.2,0.2,0.25501601,0.22880018,0.2,0.2,0.23118713,0.2,0.24186612,0.31886296,0.2,0.20378852,0.2,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0])
        elif self.year==2024:
            naiset_in=np.array([0.06249525,0.01653666,0.01243835,0.01173599,0.01003443,0.01614431,0.01253088,0.01595201,0.01485126,0.01551417,0.0163761,0.01665109,0.01580899,0.01509985,0.01570487,0.01350062,0.01002726,0.01266612,0.0102564,0.00900295,0.00729847,0.01190975,0.00745441,0.00915655,0.00669676,0.00630391,0.00656053,0.00596653,0.00580548,0.00609376,0.0061154,0.00575269,0.00587889,0.00650541,0.00602485,0.00854528,0.00793072,0.00875738,0.00726292,0.00835119,0.00810061,0.00979312,0.00920224,0.01323002,0.01169883,0.01007451,0.0015683,0.0,0.0,0.0,0.0,0.0,0.0])
            naiset_out=np.array([0.2,0.47966481,0.28795817,0.37831525,0.21317315,0.2,0.2284766,0.2,0.2256576,0.22371821,0.23630204,0.30206829,0.45126141,0.2,0.2,0.40704051,0.20724145,0.2,0.2,0.33802684,0.20855867,0.2,0.31324162,0.2,0.2,0.25309608,0.2,0.21594743,0.26137626,0.2,0.2,0.2,0.2,0.2,0.28265063,0.2,0.2,0.2,0.20811158,0.2,0.25831133,0.2,0.21020003,0.2,0.28073765,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0])
            miehet_in=np.array([0.07365009,0.0475326,0.02801633,0.01327382,0.01032866,0.0093917,0.00903513,0.00899109,0.00760236,0.00772638,0.01111774,0.008048,0.0074746,0.00649382,0.00768385,0.00849924,0.00667783,0.00971252,0.00815894,0.00720309,0.00776783,0.00832775,0.0067873,0.00858201,0.00656923,0.006507,0.00716379,0.00811456,0.00670864,0.00702131,0.00639569,0.00629981,0.00783119,0.00865503,0.00701909,0.00672637,0.00878215,0.00848508,0.00754256,0.00930439,0.00837315,0.00864077,0.00817892,0.00856444,0.01224859,0.00418447,0.00028051,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_out=np.array([0.2,0.2,0.70118204,0.42798245,0.30237237,0.28867045,0.2,0.35970118,0.20865245,0.32080047,0.2,0.43799755,0.2,0.28552681,0.2,0.2,0.21575819,0.2,0.2,0.30733786,0.2,0.2,0.28180766,0.2,0.2,0.26828017,0.2,0.2,0.27342837,0.2,0.21081233,0.2512317,0.2,0.2,0.25501601,0.22880018,0.2,0.2,0.23118713,0.2,0.24186612,0.31886296,0.2,0.20378852,0.2,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0])
        elif self.year==2025:
            naiset_in=np.array([0.06249525,0.01653666,0.01243835,0.01173599,0.01003443,0.01614431,0.01253088,0.01595201,0.01485126,0.01551417,0.0163761,0.01665109,0.01580899,0.01509985,0.01570487,0.01350062,0.01002726,0.01266612,0.0102564,0.00900295,0.00729847,0.01190975,0.00745441,0.00915655,0.00669676,0.00630391,0.00656053,0.00596653,0.00580548,0.00609376,0.0061154,0.00575269,0.00587889,0.00650541,0.00602485,0.00854528,0.00793072,0.00875738,0.00726292,0.00835119,0.00810061,0.00979312,0.00920224,0.01323002,0.01169883,0.01007451,0.0015683,0.0,0.0,0.0,0.0,0.0,0.0])
            naiset_out=np.array([0.2,0.47966481,0.28795817,0.37831525,0.21317315,0.2,0.2284766,0.2,0.2256576,0.22371821,0.23630204,0.30206829,0.45126141,0.2,0.2,0.40704051,0.20724145,0.2,0.2,0.33802684,0.20855867,0.2,0.31324162,0.2,0.2,0.25309608,0.2,0.21594743,0.26137626,0.2,0.2,0.2,0.2,0.2,0.28265063,0.2,0.2,0.2,0.20811158,0.2,0.25831133,0.2,0.21020003,0.2,0.28073765,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0])
            miehet_in=np.array([0.07365009,0.0475326,0.02801633,0.01327382,0.01032866,0.0093917,0.00903513,0.00899109,0.00760236,0.00772638,0.01111774,0.008048,0.0074746,0.00649382,0.00768385,0.00849924,0.00667783,0.00971252,0.00815894,0.00720309,0.00776783,0.00832775,0.0067873,0.00858201,0.00656923,0.006507,0.00716379,0.00811456,0.00670864,0.00702131,0.00639569,0.00629981,0.00783119,0.00865503,0.00701909,0.00672637,0.00878215,0.00848508,0.00754256,0.00930439,0.00837315,0.00864077,0.00817892,0.00856444,0.01224859,0.00418447,0.00028051,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_out=np.array([0.2,0.2,0.70118204,0.42798245,0.30237237,0.28867045,0.2,0.35970118,0.20865245,0.32080047,0.2,0.43799755,0.2,0.28552681,0.2,0.2,0.21575819,0.2,0.2,0.30733786,0.2,0.2,0.28180766,0.2,0.2,0.26828017,0.2,0.2,0.27342837,0.2,0.21081233,0.2512317,0.2,0.2,0.25501601,0.22880018,0.2,0.2,0.23118713,0.2,0.24186612,0.31886296,0.2,0.20378852,0.2,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0])
        elif self.year==2026:
            naiset_in=np.array([0.06249525,0.01653666,0.01243835,0.01173599,0.01003443,0.01614431,0.01253088,0.01595201,0.01485126,0.01551417,0.0163761,0.01665109,0.01580899,0.01509985,0.01570487,0.01350062,0.01002726,0.01266612,0.0102564,0.00900295,0.00729847,0.01190975,0.00745441,0.00915655,0.00669676,0.00630391,0.00656053,0.00596653,0.00580548,0.00609376,0.0061154,0.00575269,0.00587889,0.00650541,0.00602485,0.00854528,0.00793072,0.00875738,0.00726292,0.00835119,0.00810061,0.00979312,0.00920224,0.01323002,0.01169883,0.01007451,0.0015683,0.0,0.0,0.0,0.0,0.0,0.0])
            naiset_out=np.array([0.2,0.47966481,0.28795817,0.37831525,0.21317315,0.2,0.2284766,0.2,0.2256576,0.22371821,0.23630204,0.30206829,0.45126141,0.2,0.2,0.40704051,0.20724145,0.2,0.2,0.33802684,0.20855867,0.2,0.31324162,0.2,0.2,0.25309608,0.2,0.21594743,0.26137626,0.2,0.2,0.2,0.2,0.2,0.28265063,0.2,0.2,0.2,0.20811158,0.2,0.25831133,0.2,0.21020003,0.2,0.28073765,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0])
            miehet_in=np.array([0.07365009,0.0475326,0.02801633,0.01327382,0.01032866,0.0093917,0.00903513,0.00899109,0.00760236,0.00772638,0.01111774,0.008048,0.0074746,0.00649382,0.00768385,0.00849924,0.00667783,0.00971252,0.00815894,0.00720309,0.00776783,0.00832775,0.0067873,0.00858201,0.00656923,0.006507,0.00716379,0.00811456,0.00670864,0.00702131,0.00639569,0.00629981,0.00783119,0.00865503,0.00701909,0.00672637,0.00878215,0.00848508,0.00754256,0.00930439,0.00837315,0.00864077,0.00817892,0.00856444,0.01224859,0.00418447,0.00028051,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_out=np.array([0.2,0.2,0.70118204,0.42798245,0.30237237,0.28867045,0.2,0.35970118,0.20865245,0.32080047,0.2,0.43799755,0.2,0.28552681,0.2,0.2,0.21575819,0.2,0.2,0.30733786,0.2,0.2,0.28180766,0.2,0.2,0.26828017,0.2,0.2,0.27342837,0.2,0.21081233,0.2512317,0.2,0.2,0.25501601,0.22880018,0.2,0.2,0.23118713,0.2,0.24186612,0.31886296,0.2,0.20378852,0.2,1.0,1.0,1.0,1.0,1.0,1.0,0.0,0.0])
        else:
            print("Error: Unknown year in ['outsider in', 'outsider out']")
        
        min_age=18
        max_spv=71
        in_m=self.get_w(0,1.5,1.0) # 
        out_m=self.get_w(0,0.8,1.0)
        in_n=self.get_w(0,1.25,1.0)
        out_n=self.get_w(0,0.85,1.0)
        
        inrate[min_age:max_spv,0]=1.5*miehet_in
        inrate[min_age:max_spv,1]=1.0*miehet_in
        inrate[min_age:max_spv,2]=in_m*miehet_in
        inrate[min_age:max_spv,3]=1.25*naiset_in
        inrate[min_age:max_spv,4]=1.0*naiset_in
        inrate[min_age:max_spv,5]=in_n*naiset_in
        outrate[min_age:max_spv,0]=0.8*miehet_out
        outrate[min_age:max_spv,1]=1.0*miehet_out
        outrate[min_age:max_spv,2]=out_m*miehet_out
        outrate[min_age:max_spv,3]=0.85*naiset_out
        outrate[min_age:max_spv,4]=1.0*naiset_out
        outrate[min_age:max_spv,5]=out_n*naiset_out
        
        #inrate=1-(1-inrate)**self.timestep
        #outrate=1-(1-outrate)**self.timestep

        inrate = self.scale_rates(inrate)
        outrate = self.scale_rates(outrate)

        return inrate,outrate
        
    def get_outsider_rate_v5(self,retirementage,debug=False):
        '''
        työelämän ulkopuolelle jäävien osuudet
        '''
        inrate=np.zeros((101,self.n_groups))
        outrate=np.zeros((101,self.n_groups))
        
        ### ['outsider in', 'outsider out']
        if self.year==2018:
            naiset_in=np.array([0.05401054326282176,0.0173241032890052,0.01072292949754045,0.0004300044331818436,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.007632901701180244,0.008165252913106312,0.00292810332683687,0.002670575708985898,0.004677604127592532,0.003011703160049825,0.005512600246236029,0.003419779211485782,0.003212977145695244,0.002575628683177381,0.002306464666349857,0.005495216515600334,0.002761113014097683,0.003552151543881269,0.002200128381705288,0.001571896381724317,0.004428447433551711,0.003549306308595138,0.002493876972941864,0.001673878572514058,5.807588672082819e-05,0.02348091843015714,0.009690836243000843,0.01032033734165617,0.01022283131373609,0.0109626467994329,0.06759901720286074,0.213527420016176,0.2580239174536444])
            naiset_out=np.array([0.2,0.5998654245449502,0.9185537569663276,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2848894073368187,0.2244735449455874,0.2,0.2578462214532817,0.2,0.2630489134668098,0.5139346417793633,0.2,0.3552270467222216,0.2,0.5791191074428335,0.2,0.5020551404160338,0.4311510174420075,0.2,0.2,0.4719093074968662,1.0,1.0,1.0,0.6289136959016923,0.4873802623978203,0.3408030005410743,0.2541649485679841,1.0,0.0,0.0])
            miehet_in=np.array([0.07797822428892312,0.06919283586362095,0.03525855021258842,0.01391424069785006,0.01163398483012618,0.01092758099568472,0.0106856573843108,0.0104239037263576,0.01050994309402446,0.01063164138825623,0.01111143500820448,0.01106513392864042,0.01393913110062003,0.0117860088030897,0.01083236546571702,0.01044851701212098,0.01010389027322929,0.009304308688726323,0.008483745545157692,0.0087963562663044,0.008153351885253478,0.01024838176246072,0.008211936704409813,0.007599464034031824,0.00703002078475636,0.006668284638156438,0.006543190259401123,0.006366825694583069,0.008056493510959578,0.005994655651563515,0.007216285311906141,0.005824143771750817,0.008391371831787772,0.006142491442635651,0.005050921355141488,0.005027361566384212,0.005014384077524572,0.005612598629200489,0.005002469561435839,0.005015913788344858,0.004365950444531298,0.003647378130194813,0.003255240929958595,0.003106705081597089,0.0002726568102318189,0.01731458393435711,0.007389421132573445,0.00935514870980195,0.009174987907653472,0.01122787224271342,0.07081677514475893,0.2362604994260513,0.2943890412176912])
            miehet_out=np.array([0.2,0.2,0.7744110463567411,0.3610231784705644,0.2718812488489531,0.2966637182964396,0.2,0.202569487211786,0.2020067041288036,0.2033577435800376,0.2,0.2,0.2,0.3422078568557927,0.2,0.2,0.3434364843223114,0.2,0.2301645672293335,0.2,0.2227746391624372,0.2,0.4081732467791591,0.2,0.2,0.2576149400630209,0.2,0.3444784900226587,0.2,0.3014234111864003,0.2,0.269422480998376,0.2,0.3810301087617984,0.2265152719825816,0.3295266834648358,0.2,0.2,0.2299159963364698,0.3726936857118316,0.4171496315458501,0.351719233725802,0.3081350889863415,0.8027217386326337,1.0,1.0,0.4331032950301738,0.4555413859598034,0.2151935794087646,0.3249067955673258,1.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.05463893091203475,0.01779850148935087,0.01032777898139256,0.0005890695040922366,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0004324192622634695,0.002770580955960588,0.005099229917494318,0.009049630328165966,0.005573519940344046,0.003593243534187152,0.005890529794234846,0.00380952420833299,0.004589310351797695,0.0030777540545367,0.00664434354590245,0.004393451960845341,0.003026982857931142,0.002664648808496251,0.004501161080798869,0.003096288004586513,0.00599340981423004,0.002885958996499083,0.003324256024593557,0.006886114753895132,0.003481539668510469,0.0117290699456604,0.001793563990748891,0.0209484132300187,0.01007161098319277,0.01104856835859177,0.01127009097212668,0.01252947889871055,0.04209498191971375,0.08754032034011656,0.1290296923965818])
            naiset_out=np.array([0.2,0.6282371769339501,0.7676692657337922,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2,0.2808525141383508,0.2,0.4998564168904247,0.2,0.6806793438688872,0.2,0.2,0.3248250167150586,0.2350737182916874,0.2,0.5969723620711264,0.2,0.5752126178083168,0.2,0.2,0.2544842962611307,0.2,1.0,0.2,0.586395343796859,0.6572860803954661,0.2,0.3124141200640719,1.0,0.0,0.0])
            miehet_in=np.array([0.0798047929967415,0.07058223580114945,0.03579998876377083,0.01523550965297285,0.01232302130482902,0.01199323869313076,0.01110905395991721,0.01081463113364006,0.01360568710890338,0.01148091978461454,0.01145741832823293,0.01150208409737095,0.01189277952804249,0.01273963882669913,0.01119452092767996,0.01323431848638921,0.0103484782619612,0.0100729942639624,0.008745309488597282,0.008819998081218578,0.008206730889413202,0.007961646702742704,0.00952196608655427,0.0073873549239749,0.007513175320734063,0.006912180067127769,0.006642587253236878,0.007305296146359007,0.006591046048562831,0.006432444830772894,0.006465946129168336,0.006046722103705241,0.006036313152889195,0.005865514425874917,0.004965239856462489,0.01230901821664153,0.006150187056116208,0.01273228745355098,0.006265562726498437,0.00598469718464366,0.004962283824821312,0.005039072327013097,0.01256222968674977,0.01604778478810568,0.007004615467524662,0.01459711343394251,0.009488044521209757,0.009811975850434553,0.01171428774920401,0.0202023754897997,0.04762824239880806,0.07391534470141134,0.07824449586346233])
            miehet_out=np.array([0.2,0.2,0.7450549761115128,0.387587613221331,0.2463394333411911,0.2778067166998418,0.2488089697003376,0.2275671845914699,0.2,0.2300874346897578,0.2,0.2948510646051326,0.2,0.2,0.3552879692770894,0.2,0.2,0.316984343720598,0.2300799490139553,0.2,0.2237097806564398,0.3162861344695552,0.2,0.2629881566511104,0.2,0.2491100201867715,0.2423432957251154,0.2,0.2230064621920492,0.2873839565176849,0.2,0.2092239161139183,0.2421551769582494,0.3599774351375303,0.3186617832000352,0.2,0.5110269295730282,0.2,0.516190592329362,0.2,0.2319245204638691,0.3742787978802984,0.2,0.2,1.0,0.2,0.580262282650854,0.5680058257122451,0.2,0.2,1.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.05146789556887754,0.01622888033431267,0.01080827746960511,0.003447130679571763,9.785536316196967e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.000201589407474846,0.004389070978742025,0.001676008315408169,0.00368086871291068,0.003953699123141601,0.003329071604343281,0.00233838202067462,0.002087153457662651,0.001516018776901086,0.002707801419581888,0.001682832131924001,0.001541022052594466,0.001385613983382054,0.005360186569241017,0.002067085724150747,0.001431177015077178,0.0009859284799991457,0.000956893848328764,0.00125878183774777,0.001544218709298616,0.00157044072597444,0.006961701322881674,0.0005957322733020679,0.02241722158733988,0.00971148755777091,0.007203026112517006,0.01260801817112304,0.04219823024786577,0.05860360581616014,0.08761339997752904])
            naiset_out=np.array([0.2,0.5538584343203246,0.6806107261728884,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2,0.2,0.3086177485189108,0.4807307221103618,0.284803601818401,0.2,0.4107032137544614,0.2,0.3563945237991813,0.2,0.5345831450946013,0.5251478221100618,0.2773408949893899,0.8790104576391995,0.2,0.2,0.2,0.2,1.0,1.0,0.6431891629921518,0.28692831285006,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07623715166948675,0.0515579784557333,0.03025044378558161,0.01408869647785932,0.01169496825736346,0.01065569998744973,0.01064309089383879,0.01143127213465454,0.01046167324268493,0.01054373013654359,0.01047840727302902,0.01040221585743383,0.01007768500102061,0.009803169350844989,0.01137987625257573,0.009395759216049696,0.0086349051119059,0.01187557354118108,0.008645371341841183,0.007250867012065367,0.006977327109234206,0.008212496687467857,0.006427752841966932,0.006166928875103722,0.005167461538841866,0.005007736810616318,0.009145146960842463,0.008273277436442277,0.006223235238817624,0.00544531228720524,0.005270159286547354,0.006541776614303543,0.00510845347771817,0.004916325234442143,0.004442194956333877,0.004493107712874155,0.004305945426629025,0.004252987822151582,0.003342951476603015,0.003315829726026736,0.003337657286428155,0.003389565205560247,0.002414634783298013,0.004722869809431554,0.002993045595890626,0.0004029832445330607,0.02553176582613995,0.01042307665630211,0.006915220229228257,0.01865161579892124,0.03380332456832016,0.04051084214965284,0.04905511472825767])
            miehet_out=np.array([0.2,0.2,0.7077716969581023,0.3782002178576744,0.2954373939026645,0.2139719494719622,0.2765006878529509,0.2,0.2140313127809815,0.2184771165005894,0.2214398275949535,0.2326876609721009,0.2333770920612203,0.2815161365033828,0.2,0.3616304127017515,0.2,0.2,0.3441590910307364,0.2188079299479698,0.3240549224979692,0.2,0.2208963481788296,0.3550848144139662,0.2205499288285843,0.2494667232467607,0.2,0.2,0.3630112568780237,0.2,0.3200669479977006,0.2,0.2435243592268,0.3048399623274184,0.20350148263579,0.2466933509127301,0.2398000184961318,0.4739195095702139,0.2,0.2329582394304048,0.2323000656178881,0.5241020368666356,0.3575260018243699,0.2,0.602280383349719,1.0,1.0,0.6915097713557066,0.2274719816354198,0.2,1.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.036609337,0.014477452,0.011645055,0.005683476,0.000397554,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0.003261297,0.002146251,0.006285894,0.002135745,0.004983504,0.002123518,0.004111283,0.003932141,0.002616973,0.003425192,0.002791381,0.002016796,0.001748867,0.001574034,0.005982227,0.001813435,0.003368109,0.001385349,0.00400894,0.001571111,0.007299615,0.002226348,0.000129127,0.013113129,0.00895685,0.000927004,0.026905926,0.011928098,0.008070004,0.010465637,0.035413074,0.058597038,0.079687038])
            naiset_out=np.array([0.2,0.423756613,0.721695217,0.741992409,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0.2,0.2,0.509810507,0.2,0.362637139,0.2,0.2,0.2,0.2,0.474730511,0.339489675,0.309240491,0.734696671,0.2,0.74271898,0.2,0.58822958,0.2,0.812035077,0.2,0.771577265,1,1,0.2,1,1,0.71851563,0.211161915,0.292703856,1,0,0])
            miehet_in=np.array([0.07355,0.04930,0.03025,0.01485,0.01176,0.01087,0.01124,0.01083,0.00994,0.01011,0.01438,0.01096,0.00988,0.01295,0.01023,0.00885,0.00881,0.00963,0.00819,0.00755,0.00756,0.01015,0.00756,0.00699,0.00640,0.00576,0.00524,0.00611,0.00551,0.00690,0.00572,0.00511,0.00631,0.00535,0.00528,0.00488,0.00555,0.00460,0.00428,0.00366,0.00457,0.00398,0.00494,0.00341,0.01233,0.00094,0.03102,0.01330,0.00896,0.01062,0.02583,0.05156,0.04476])
            miehet_out=np.array([0.20000,0.20000,0.68234,0.41539,0.28173,0.25106,0.20000,0.29815,0.20000,0.25007,0.20000,0.30357,0.24233,0.20000,0.32685,0.20117,0.27830,0.20000,0.26170,0.26358,0.20000,0.20000,0.25638,0.27698,0.28861,0.28675,0.20048,0.20000,0.23226,0.20000,0.30184,0.21813,0.20000,0.21968,0.45346,0.20000,0.20000,0.28977,0.37153,0.26341,0.20000,0.54755,0.20000,0.47130,0.20000,1.00000,1.00000,0.70330,0.46046,0.20000,1.00000,0.00000,0.00000])
        elif self.year==2022:
            naiset_in=np.array([0.05310127350999575,0.01684768709423729,0.01167814531561993,0.005986182090150107,0.000292790323713977,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.003010708206966538,0.001297024385384775,0.004418994577313796,0.006031421408904919,0.00242410988678002,0.006142196144703608,0.002862569003290208,0.007573947437479017,0.003257438476320247,0.004355110104422668,0.00285529545365156,0.002944592987814117,0.002579620995123378,0.002383248748703231,0.00276303786766996,0.006924650971695153,0.002738063697396531,0.002782488744293778,0.005804862042192414,0.002577250499266833,0.002911302542625466,0.003925704626692597,0.004749484992856276,0.003617486064467696,0.0006418398198149513,0.02903879526134008,0.01356191586973553,0.01043102313992333,0.01760068731233328,0.0562125493994462,0.07674812961528188,0.1175088782860567])
            naiset_out=np.array([0.2,0.5275444253242525,0.696531939388332,0.8841351987590482,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.3493974934171736,0.2,0.4446421783753511,0.2,0.4516413011851629,0.2,0.3467394539210029,0.2,0.2765532926813544,0.6673042126932787,0.2,0.2,0.2188585255388669,0.6636710223485824,0.2,0.4323201640041822,0.2,0.2,0.2,0.4548133836570288,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07832309041444079,0.04874308061298706,0.03010975149407363,0.01431541703855486,0.0118105260279127,0.01195397205726497,0.0112277987575574,0.01048229041868233,0.01117106311718194,0.01090908331384324,0.012518114259532,0.0115103507006257,0.01070572899991124,0.01033847823469156,0.0135329659663157,0.01058353618895036,0.01157844841570303,0.009718980916602967,0.009334085274711528,0.007933470996090559,0.007613287828318336,0.007877889098650157,0.007073306529305892,0.006006804487115826,0.006644711463444242,0.005374436152789969,0.008223356364338859,0.005949061980949444,0.005896805041835759,0.005442158105991309,0.005105592108306847,0.004985096300789922,0.004949477705105274,0.004958283955133008,0.004905467313521751,0.00405856935102227,0.005827071408505716,0.003981668659773833,0.003596580269170987,0.005090614206091688,0.003921150201014106,0.002280060460911727,0.003170234224174759,0.004564214791564799,0.003058428979108765,0.0004856818659653553,0.02558731347485996,0.01043347817086306,0.006923168476462405,0.01866285791052415,0.03385186387331192,0.04057450925237028,0.04913863426264357])
            miehet_out=np.array([0.2,0.2,0.6971675843750751,0.383768976325035,0.2867047946664151,0.2,0.3028185586372126,0.2,0.2,0.2,0.2,0.2730805999125393,0.2415957261172229,0.2386887046871977,0.2,0.3115770387017478,0.2,0.223148550481196,0.3310109370713439,0.2199496043273557,0.2752677297550671,0.2,0.3360863648892666,0.3362160515416672,0.2,0.2325397894308603,0.2,0.2,0.2813508549110283,0.3222918491801747,0.2,0.2,0.225465750656464,0.2,0.3886075104885236,0.3748818138323901,0.2,0.31351959389708,0.287081801094337,0.2,0.6505816999423302,0.4257785159252285,0.2,0.2,0.496147480060092,1.0,1.0,0.6915097713557066,0.2274719816354198,0.2,1.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.05320313520189991,0.0168786983369444,0.01143621481125364,0.0005312309779865008,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.003958027358952101,0.003859902373605771,0.002533876593641903,0.00318401586163183,0.00887774857841332,0.003354568721876791,0.002912640957583723,0.00283296938670857,0.00391383641453896,0.002918982555253357,0.003332661487497961,0.002520446055285603,0.001526417745288557,0.005511979393904576,0.003634640093600211,0.00256502736663748,0.002226838538758691,0.004323713950875586,0.002782655718125295,0.005595094857020023,0.003612237884700363,0.005970831991592278,0.0009584325374245239,0.02936692903670322,0.01355985680389,0.01043066431845817,0.01760203207244957,0.05622824934438775,0.07678415608385275,0.1175885240224136])
            naiset_out=np.array([0.2,0.5412240197162488,0.8050992909091164,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2,0.3347833031662564,0.2296711320409229,0.267470137524868,0.2,0.4207435922300871,0.2,0.602296759788388,0.3769103195739519,0.2,0.2,0.4099125718069119,0.2,0.2,0.2620668642876585,0.2,0.3233414894515309,0.2,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07355,0.04930,0.03025,0.01485,0.01176,0.01087,0.01124,0.01083,0.00994,0.01011,0.01438,0.01096,0.00988,0.01295,0.01023,0.00885,0.00881,0.00963,0.00819,0.00755,0.00756,0.01015,0.00756,0.00699,0.00640,0.00576,0.00524,0.00611,0.00551,0.00690,0.00572,0.00511,0.00631,0.00535,0.00528,0.00488,0.00555,0.00460,0.00428,0.00366,0.00457,0.00398,0.00494,0.00341,0.01233,0.00094,0.03102,0.01330,0.00896,0.01062,0.02583,0.05156,0.04476])
            miehet_out=np.array([0.20000,0.20000,0.68234,0.41539,0.28173,0.25106,0.20000,0.29815,0.20000,0.25007,0.20000,0.30357,0.24233,0.20000,0.32685,0.20117,0.27830,0.20000,0.26170,0.26358,0.20000,0.20000,0.25638,0.27698,0.28861,0.28675,0.20048,0.20000,0.23226,0.20000,0.30184,0.21813,0.20000,0.21968,0.45346,0.20000,0.20000,0.28977,0.37153,0.26341,0.20000,0.54755,0.20000,0.47130,0.20000,1.00000,1.00000,0.70330,0.46046,0.20000,1.00000,0.00000,0.00000])
        elif self.year==2024:
            naiset_in=np.array([0.05102825700946879,0.01640208389163639,0.01049493210491511,0.001193134297542657,2.635700597823275e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.005351067290571127,0.002772139516799534,0.004082401270367765,0.004059969942685491,0.002395241669049179,0.005561262795613215,0.004166991924545351,0.003201713554301075,0.003006673155346265,0.002834553951870844,0.001763884401090477,0.002548820362685858,0.007893840949358404,0.002755692639736415,0.002602675320889047,0.002270875557561567,0.002290550008385015,0.004823854527628102,0.002975880557915788,0.004814805813157197,0.003461750504780902,0.0005889610170700427,0.02921231157205575,0.01355779544245806,0.01042986902472443,0.01760227895246418,0.05623585021725544,0.0768046013316141,0.1176368952233865])
            naiset_out=np.array([0.2,0.5794741566749106,0.8457974492658307,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2581513739168588,0.2,0.2,0.3461368704922949,0.2,0.5808243675866984,0.60655545394669,0.2,0.2,0.4562651669142593,0.2,0.2437559477524545,0.248568278579747,0.2,0.3532096630552465,0.2,0.4842237683582652,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07540131499155772,0.04921475781997333,0.02959077147099571,0.01298488790383987,0.0101035776199542,0.008619440865510959,0.008407712437165017,0.007759230556818882,0.007805002568300306,0.0108992167276191,0.008649364264432623,0.008069481501882808,0.00748298911884484,0.007318517619947429,0.009965196768776125,0.007651850570789808,0.01022318084054195,0.009723298142425646,0.007151673203194995,0.009331536261954133,0.006273582483326842,0.006169681215901438,0.008674604002562864,0.006270053958537147,0.005904743190458033,0.005999599875106022,0.00593003593781859,0.006134283415316856,0.005707488009267883,0.005827143658180019,0.005636839206564321,0.005312245267777031,0.006792376425569099,0.005248595531973121,0.004904224803475559,0.006945373333155391,0.004855766592843877,0.004688984963578818,0.0042440232906252,0.003927170644748863,0.00355677560820175,0.003042045106296659,0.002340426290851226,0.006955177717169283,0.003304823288364261,0.0004829431157936899,0.02617046609523242,0.01042690431228813,0.006918146662133016,0.01865575661916786,0.03382120854764215,0.04053430553660584,0.04908590043649715])
            miehet_out=np.array([0.2,0.2,0.7368321091318872,0.4298496859038839,0.3530527077212718,0.2368375454229087,0.2940969054853145,0.2099625449529801,0.2161447343484078,0.2,0.2803734722801821,0.3080139882760346,0.2,0.2261572099728457,0.2,0.4646182656196687,0.2,0.2,0.4029301933555532,0.2,0.2027849947860008,0.2496594776035194,0.2,0.3672915413201083,0.2,0.2,0.2,0.2,0.3212256173079712,0.2,0.2,0.3024294893819597,0.2,0.2736882785007378,0.4335589573572109,0.2,0.2,0.3120138684223359,0.3099350705075117,0.3316169803172053,0.3873222607659655,0.4690366055668436,0.4539080858338205,0.2,0.551718117303488,1.0,1.0,0.6915097713557066,0.2274719816354198,0.2,1.0,0.0,0.0])
        elif self.year==2025:
            naiset_in=np.array([0.05102825700946879,0.01640208389163639,0.01049493210491511,0.001193134297542657,2.635700597823275e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.005351067290571127,0.002772139516799534,0.004082401270367765,0.004059969942685491,0.002395241669049179,0.005561262795613215,0.004166991924545351,0.003201713554301075,0.003006673155346265,0.002834553951870844,0.001763884401090477,0.002548820362685858,0.007893840949358404,0.002755692639736415,0.002602675320889047,0.002270875557561567,0.002290550008385015,0.004823854527628102,0.002975880557915788,0.004814805813157197,0.003461750504780902,0.0005889610170700427,0.02921231157205575,0.01355779544245806,0.01042986902472443,0.01760227895246418,0.05623585021725544,0.0768046013316141,0.1176368952233865])
            naiset_out=np.array([0.2,0.5794741566749106,0.8457974492658307,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2581513739168588,0.2,0.2,0.3461368704922949,0.2,0.5808243675866984,0.60655545394669,0.2,0.2,0.4562651669142593,0.2,0.2437559477524545,0.248568278579747,0.2,0.3532096630552465,0.2,0.4842237683582652,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07540131499155772,0.04921475781997333,0.02959077147099571,0.01298488790383987,0.0101035776199542,0.008619440865510959,0.008407712437165017,0.007759230556818882,0.007805002568300306,0.0108992167276191,0.008649364264432623,0.008069481501882808,0.00748298911884484,0.007318517619947429,0.009965196768776125,0.007651850570789808,0.01022318084054195,0.009723298142425646,0.007151673203194995,0.009331536261954133,0.006273582483326842,0.006169681215901438,0.008674604002562864,0.006270053958537147,0.005904743190458033,0.005999599875106022,0.00593003593781859,0.006134283415316856,0.005707488009267883,0.005827143658180019,0.005636839206564321,0.005312245267777031,0.006792376425569099,0.005248595531973121,0.004904224803475559,0.006945373333155391,0.004855766592843877,0.004688984963578818,0.0042440232906252,0.003927170644748863,0.00355677560820175,0.003042045106296659,0.002340426290851226,0.006955177717169283,0.003304823288364261,0.0004829431157936899,0.02617046609523242,0.01042690431228813,0.006918146662133016,0.01865575661916786,0.03382120854764215,0.04053430553660584,0.04908590043649715])
            miehet_out=np.array([0.2,0.2,0.7368321091318872,0.4298496859038839,0.3530527077212718,0.2368375454229087,0.2940969054853145,0.2099625449529801,0.2161447343484078,0.2,0.2803734722801821,0.3080139882760346,0.2,0.2261572099728457,0.2,0.4646182656196687,0.2,0.2,0.4029301933555532,0.2,0.2027849947860008,0.2496594776035194,0.2,0.3672915413201083,0.2,0.2,0.2,0.2,0.3212256173079712,0.2,0.2,0.3024294893819597,0.2,0.2736882785007378,0.4335589573572109,0.2,0.2,0.3120138684223359,0.3099350705075117,0.3316169803172053,0.3873222607659655,0.4690366055668436,0.4539080858338205,0.2,0.551718117303488,1.0,1.0,0.6915097713557066,0.2274719816354198,0.2,1.0,0.0,0.0])
        elif self.year==2026:
            naiset_in=np.array([0.05102825700946879,0.01640208389163639,0.01049493210491511,0.001193134297542657,2.635700597823275e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.005351067290571127,0.002772139516799534,0.004082401270367765,0.004059969942685491,0.002395241669049179,0.005561262795613215,0.004166991924545351,0.003201713554301075,0.003006673155346265,0.002834553951870844,0.001763884401090477,0.002548820362685858,0.007893840949358404,0.002755692639736415,0.002602675320889047,0.002270875557561567,0.002290550008385015,0.004823854527628102,0.002975880557915788,0.004814805813157197,0.003461750504780902,0.0005889610170700427,0.02921231157205575,0.01355779544245806,0.01042986902472443,0.01760227895246418,0.05623585021725544,0.0768046013316141,0.1176368952233865])
            naiset_out=np.array([0.2,0.5794741566749106,0.8457974492658307,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2581513739168588,0.2,0.2,0.3461368704922949,0.2,0.5808243675866984,0.60655545394669,0.2,0.2,0.4562651669142593,0.2,0.2437559477524545,0.248568278579747,0.2,0.3532096630552465,0.2,0.4842237683582652,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07540131499155772,0.04921475781997333,0.02959077147099571,0.01298488790383987,0.0101035776199542,0.008619440865510959,0.008407712437165017,0.007759230556818882,0.007805002568300306,0.0108992167276191,0.008649364264432623,0.008069481501882808,0.00748298911884484,0.007318517619947429,0.009965196768776125,0.007651850570789808,0.01022318084054195,0.009723298142425646,0.007151673203194995,0.009331536261954133,0.006273582483326842,0.006169681215901438,0.008674604002562864,0.006270053958537147,0.005904743190458033,0.005999599875106022,0.00593003593781859,0.006134283415316856,0.005707488009267883,0.005827143658180019,0.005636839206564321,0.005312245267777031,0.006792376425569099,0.005248595531973121,0.004904224803475559,0.006945373333155391,0.004855766592843877,0.004688984963578818,0.0042440232906252,0.003927170644748863,0.00355677560820175,0.003042045106296659,0.002340426290851226,0.006955177717169283,0.003304823288364261,0.0004829431157936899,0.02617046609523242,0.01042690431228813,0.006918146662133016,0.01865575661916786,0.03382120854764215,0.04053430553660584,0.04908590043649715])
            miehet_out=np.array([0.2,0.2,0.7368321091318872,0.4298496859038839,0.3530527077212718,0.2368375454229087,0.2940969054853145,0.2099625449529801,0.2161447343484078,0.2,0.2803734722801821,0.3080139882760346,0.2,0.2261572099728457,0.2,0.4646182656196687,0.2,0.2,0.4029301933555532,0.2,0.2027849947860008,0.2496594776035194,0.2,0.3672915413201083,0.2,0.2,0.2,0.2,0.3212256173079712,0.2,0.2,0.3024294893819597,0.2,0.2736882785007378,0.4335589573572109,0.2,0.2,0.3120138684223359,0.3099350705075117,0.3316169803172053,0.3873222607659655,0.4690366055668436,0.4539080858338205,0.2,0.551718117303488,1.0,1.0,0.6915097713557066,0.2274719816354198,0.2,1.0,0.0,0.0])
        else:
            print("Error: Unknown year in ['outsider in', 'outsider out']")
    
        min_age=18
        max_spv=71
        in_m=self.get_w(0,1.5,1.0)
        out_m=self.get_w(0,0.8,1.0)
        in_n=self.get_w(0,1.25,1.0)
        out_n=self.get_w(0,0.85,1.0)
        
        inrate[min_age:max_spv,0]=1.5*miehet_in
        inrate[min_age:max_spv,1]=1.0*miehet_in
        inrate[min_age:max_spv,2]=in_m*miehet_in
        inrate[min_age:max_spv,3]=1.25*naiset_in
        inrate[min_age:max_spv,4]=1.0*naiset_in
        inrate[min_age:max_spv,5]=in_n*naiset_in
        outrate[min_age:max_spv,0]=0.8*miehet_out
        outrate[min_age:max_spv,1]=1.0*miehet_out
        outrate[min_age:max_spv,2]=out_m*miehet_out
        outrate[min_age:max_spv,3]=0.85*naiset_out
        outrate[min_age:max_spv,4]=1.0*naiset_out
        outrate[min_age:max_spv,5]=out_n*naiset_out

        #inrate=1-(1-inrate)**self.timestep
        #outrate=1-(1-outrate)**self.timestep

        inrate = self.scale_rates(inrate)
        outrate = self.scale_rates(outrate)

        ra=int(retirementage)

        outrate[ra:max_spv,0]=1.0
        outrate[ra:max_spv,1]=1.0
        outrate[ra:max_spv,2]=1.0
        outrate[ra:max_spv,3]=1.0
        outrate[ra:max_spv,4]=1.0
        outrate[ra:max_spv,5]=1.0

        inrate[ra:max_spv,0]=0.0
        inrate[ra:max_spv,1]=0.0
        inrate[ra:max_spv,2]=0.0
        inrate[ra:max_spv,3]=0.0
        inrate[ra:max_spv,4]=0.0
        inrate[ra:max_spv,5]=0.0

        return inrate,outrate        

    def get_outsider_rate_v6(self,retirementage,debug=False):
        '''
        työelämän ulkopuolelle jäävien osuudet
        '''
        inrate=np.zeros((101,self.n_groups))
        outrate=np.zeros((101,self.n_groups))
        
        ### ['outsider in', 'outsider out']
        if self.year==2018:
            naiset_in=np.array([0.06258213110702214,0.01933300932587857,0.01323719248543898,0.007610845637183235,0.002181398214096116,7.547813878541152e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.003853375959782343,0.006367135259840657,0.01453073515787403,0.006304386016707859,0.00592181247888277,0.00504938844273995,0.004962149234582552,0.0108674958513754,0.005904050942084859,0.008281133724061765,0.005814983968347075,0.004782256684107526,0.004546305389249844,0.007100626744212803,0.004834429322863308,0.006377526688180029,0.005304634993020993,0.005152759003575003,0.006251787933640715,0.005726977538984099,0.009723809618281298,0.006078939301743387,0.003053915251890712,0.02087432046604755,0.00970592308398376,0.01034139721258206,0.01024942566152147,0.0109980994712628,0.06786486300176246,0.214529363969587,0.2594450325224893])
            naiset_out=np.array([0.2,0.5360052471650552,0.6431197587708839,0.7486558297455228,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2,0.2127669524296118,0.2709102658583563,0.2,0.3308553637490329,0.2,0.38408158957796,0.4321081740728669,0.2,0.2,0.2,0.2,0.2681844437976629,0.2,0.2,0.435358721358542,0.2,0.3531039472188094,1.0,0.2,0.6289136959016923,0.4873802623978203,0.3408030005410743,0.2541649485679841,1.0,0.0,0.0])
            miehet_in=np.array([0.07984876000130654,0.06873844892047863,0.03550802132322756,0.01460327289887078,0.01162742090334375,0.0113717799544459,0.01238954863726112,0.01127220550281455,0.01093987961902055,0.01099006208599874,0.01450884814411686,0.011468087507042,0.01199723136122642,0.01118521387422772,0.012896227402776,0.01056865001505249,0.01025858367076708,0.01183372235825772,0.009513714431882156,0.01082404332192527,0.008661898606808893,0.008002752664296222,0.007575156611922036,0.006488343655271563,0.007111788531321608,0.008395788405011788,0.006671226904825202,0.006873681257077153,0.006344201251265172,0.005856436750028031,0.004870321876421094,0.007283535496765014,0.01106561137880054,0.006573514997925336,0.006461096244340587,0.005664900237282601,0.00544166314614837,0.009832344321339207,0.005453052857888792,0.009106671144821167,0.005602234013724677,0.00409428911978129,0.004123590537982654,0.003391391388370277,0.0002216153733411696,0.01734262884780152,0.007392059635576853,0.00935860304879634,0.009178482640125184,0.01123227421538357,0.07084529694400546,0.2363580791889648,0.2945135301117623])
            miehet_out=np.array([0.2,0.2,0.7559307010598979,0.4033726425256046,0.2293381652518716,0.3639649822694979,0.2,0.2,0.2,0.2662701768258612,0.2,0.2621900099684583,0.2,0.2928078004527191,0.2,0.2275633993407311,0.2908809932621875,0.2,0.3241789278545638,0.2,0.2605184126561318,0.2427179015710997,0.4014102294581038,0.2,0.2,0.2,0.2693893287020591,0.2,0.2822810827558703,0.3727091016134848,0.2249430505272109,0.2,0.2,0.4666579197538454,0.2,0.2,0.4649377685336517,0.2,0.4353059305590653,0.2,0.5178923382784718,0.5329643369299621,0.2,0.905285841164666,1.0,1.0,0.4331032950301738,0.4555413859598034,0.2151935794087646,0.3249067955673258,1.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.05815296534467772,0.01862218841199608,0.01263187214333369,0.006859154615396736,0.004280100366228126,0.004037752774957618,0.003502204951517756,0.002135510818292118,0.002384372177277233,0.003543757311977284,0.002166761629511895,0.003248475394203759,0.0005875776148621882,0.002070749637413207,0.003050687784090478,0.002732927058230015,0.0005056726150247566,0.009136542494226317,0.002774225683410526,0.01049983056716944,0.004167688878998991,0.007711763044028137,0.01012464498955331,0.005483123559946576,0.005347893376459973,0.008090684361214578,0.00570699913360691,0.005665629218420182,0.006701260854044311,0.005737372858002645,0.005414117094334443,0.005433884888017923,0.005310862192299873,0.005254058755321523,0.006358717553463875,0.006398008048004673,0.006633902497871487,0.005727189186200198,0.005526323251452539,0.006094843381453843,0.00595512608360784,0.009815897681481446,0.00912152448477589,0.01156200313661887,0.009592493256842981,0.006535652148759217,0.01008259289966298,0.01106443472796373,0.01128565243077191,0.0125588071004664,0.04221653376874264,0.08784578577802418,0.1295639490471673])
            naiset_out=np.array([0.2,0.5288668377863244,0.6774181977683227,0.6774821815853913,0.2,0.8244069056888061,0.2,0.6948638931280209,0.2,0.2,0.7095623963338105,0.2,1.0,1.0,0.2,0.2,1.0,1.0,0.2,0.2,0.3478712889268402,0.2,0.2,0.2,0.2,0.2,0.2,0.2229404956858942,0.2,0.2585717294637724,0.2417290151187285,0.2,0.2128641474786151,0.3538581802301617,0.2,0.2,0.2,0.2486905296479487,0.2134388484420554,0.2,0.3268118243016186,0.2,0.2,0.2,0.6915526049861171,0.3860509877919345,0.586395343796859,0.6572860803954661,0.2,0.3124141200640719,1.0,0.0,0.0])
            miehet_in=np.array([0.0876381193553161,0.05978829118484676,0.03440016547420234,0.01525484336267398,0.01173777267151442,0.01180582541388066,0.01051435066426277,0.01058738635055901,0.01367523449160937,0.01130580721014838,0.01095408250837013,0.01065230919776348,0.01300664169054304,0.01126544187770656,0.01109422195608982,0.01563965850588838,0.01088154143865024,0.00956980306539371,0.0106411114526436,0.008960454494821453,0.008338787477479754,0.00879102500629204,0.00807091973067851,0.006954407796200088,0.006174519754718493,0.01063391958883527,0.006481794082733748,0.007457079298845553,0.006251410431876899,0.006111374925984459,0.005674314801987079,0.008752259472572448,0.005839105102144792,0.005306327961590829,0.009208810143014228,0.005086684048842421,0.004938133197585941,0.006940017265110428,0.005199705695473297,0.004647910006498673,0.004353489990950973,0.002541111865605455,0.002662832785724307,0.002433933045291948,0.0003902587869051906,0.0157614634183548,0.007623043455528579,0.008046185633283513,0.01286118770345313,0.0118687157694221,0.03158114526960413,0.04294531846236196,0.04983738157107734])
            miehet_out=np.array([0.2,0.2,0.7297078502429923,0.4265857135417748,0.2121590363722021,0.3149604598836001,0.2132777426792338,0.2313427526684959,0.2,0.2448655492501375,0.2554821407349581,0.2,0.2,0.2,0.3329031591168927,0.2,0.3117583458095662,0.2588631381884939,0.2,0.2497247216693617,0.2304204448560765,0.2,0.3285780111388913,0.2950795071838961,0.3276810411063294,0.2,0.2919817536733593,0.2,0.2195164748809576,0.2762425843257321,0.3172782756000135,0.2,0.3041065313804399,0.456829912473537,0.2,0.2516230000633106,0.3009495967680705,0.2,0.3274303928982464,0.3040653344096234,0.6490264807023196,0.2103609624042036,0.3524907435313052,0.408140150419729,1.0,1.0,0.5783021211832237,0.4754653879782296,0.2,0.2660888778833884,1.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.05549882559555341,0.01713539062026396,0.01256044428679895,0.007266343783951044,0.001593154124645036,0.01054585974964139,0.001043653938183496,0.002990728777458708,0.0009095897678357209,0.0001145391992359925,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.002396179553102281,0.0005053659317531135,0.01276333768222807,0.003031254586810133,0.009916870572889562,0.005637796231299248,0.006107911480020418,0.004671623140968936,0.004125991390350262,0.004289872272384395,0.004097851390228825,0.008275883291920213,0.004615195687641586,0.006329099818569289,0.005356751725174361,0.004621153325669198,0.003820833119012396,0.007350605566426788,0.003856397866048731,0.007977657973115969,0.004851638974534818,0.003945458202237135,0.003983558162140015,0.003375875952599383,0.007326360243442564,0.00873624081830684,0.005861772802620991,0.001347039256161392,0.02248620121372446,0.009717315086154265,0.007207820211215473,0.01261415756269466,0.04223121082192345,0.05865237869739408,0.08769034774084894])
            naiset_out=np.array([0.2,0.489973343796835,0.6328352067074117,0.566224497305208,1.0,0.2,1.0,0.2,0.7890886571898574,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2019122896350763,0.2,0.2,0.2,0.3057866725116904,0.2137756563604651,0.2,0.29788149026682,0.2,0.3748619879678422,0.2,0.2,0.3770926113330359,0.4483708264439024,0.2,0.2204762309995493,0.2,0.4454615596663521,0.2,0.3882839165913086,0.3030516083530078,0.2,0.2,0.2333139719589354,1.0,1.0,0.6431891629921518,0.28692831285006,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07540252568351416,0.05278193660073052,0.03033461465513122,0.01402431073958955,0.012096791385683,0.01169049362299356,0.01050554059337587,0.01028652728682579,0.01148777874538756,0.01413490632320501,0.01155739018112148,0.01137560290734345,0.0102040382751563,0.01031541777710915,0.01034190410715802,0.01007163775471863,0.00937877254950837,0.01294420733712999,0.009878842729340075,0.01102308930149167,0.008777257402492368,0.007547296688226183,0.006741493639368749,0.006363796191945719,0.005699800736018876,0.005600762724341413,0.005410744126817996,0.006979850812935057,0.005743625843832351,0.005583367678578826,0.005285349312739765,0.007989362670540751,0.005432582794320276,0.005034900412578505,0.004752162066038563,0.007662002590502418,0.004530036152232629,0.004253787546324755,0.004151935071248984,0.009574976882807971,0.005010887927911568,0.002457312543763802,0.002378703169986758,0.002375351278836006,0.002242435568965603,0.0003773134692973849,0.02577999097591462,0.01042852242221919,0.006919871343118056,0.01865870853891082,0.03383566131954016,0.04055504323702353,0.04911500600605351])
            miehet_out=np.array([0.2,0.2,0.7117754958544524,0.3440656258083566,0.2375977370138257,0.3179523064840266,0.23619800297931,0.228627398206853,0.2,0.2,0.2303140012242862,0.307758272162625,0.2046117801581462,0.2,0.2,0.2595472907968265,0.2045853314913411,0.2,0.3324420449508065,0.2,0.3329610791342901,0.2999726519773441,0.2371992009522188,0.2953349755951836,0.206545177673684,0.2351558731247485,0.2100142499945372,0.2,0.2307999116674635,0.2519209435539281,0.3146268477922067,0.2,0.2798698790138033,0.2640170279445488,0.4357875824328282,0.2,0.2881659054892104,0.4610264665953533,0.2,0.2,0.7387772686463396,0.2774493145283682,0.2572394779340047,0.3320337642154834,0.4518912194352963,1.0,1.0,0.6915097713557066,0.2274719816354198,0.2,1.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.03983404575856107,0.01519739237318095,0.01262883055491265,0.007277991012854566,0.005178949776902999,0.003257108383559648,0.003023674885070108,0.001359104198636782,0.0002747498927805953,0.002428529366189087,0.0002177340203538302,0.000800828213456186,0.003046659006143522,0.001101892982219388,0.004354253649819039,0.003919850940801667,0.00292591337103962,0.002102057804050289,0.007508666690513419,0.004460049562108663,0.005843524938123881,0.009347828892389188,0.01012770554151432,0.005505798198270436,0.004749926566958843,0.004413381322971473,0.005856531409845213,0.006014707534404862,0.004793694851111464,0.004238969781798694,0.005226302809572841,0.004340703566819789,0.004344154523316328,0.003842745977508085,0.003653764373436306,0.006076979554237339,0.004022478159725459,0.003729065134810153,0.004301632767887371,0.005725400027398324,0.00527902117321657,0.00485622521942267,0.005441754188962605,0.009745900875298925,0.01365496901658766,0.001608765863400216,0.02697600504156712,0.01192519211912747,0.008067168869866866,0.01046068513894128,0.03539156692928672,0.0585529506188382,0.07961477936916807])
            naiset_out=np.array([0.2,0.3969979234809582,0.6369674173012004,0.5138053548267045,0.5996156433410722,0.301829627805434,0.7809208015101954,0.4527230509682394,1.0,1.0,1.0,1.0,0.2,0.8783754025676747,0.2,0.2,0.2,1.0,0.2,0.2,0.2,0.2,0.2,0.3626213634733892,0.2,0.2518007054440883,0.2,0.2,0.317844688329022,0.2331483218470621,0.2,0.2048274272932784,0.324920082112761,0.2490572383442249,0.2714737074415934,0.2,0.2852060526214187,0.2659352228013214,0.2,0.2,0.2,0.366098439253772,0.2,0.2,0.2,1.0,1.0,0.7185156297929427,0.2111619150080689,0.2927038560462253,1.0,0.0,0.0])
            miehet_in=np.array([0.07127101089794029,0.05043862730984212,0.03003994937808944,0.01418407374504633,0.01119816754382554,0.01099185310701795,0.01020083029789702,0.01021484005534342,0.009495640994043757,0.009602849517367075,0.0122074104336342,0.01032272222064817,0.009994248355194565,0.01205777814224869,0.009704686951648448,0.008962901897039088,0.008642628328619638,0.01016130409421724,0.008660999919266828,0.008056494037168255,0.00776493989043454,0.00815799563376193,0.007146327343093811,0.006700391117280402,0.006579521030287729,0.006187638651574069,0.00508448949428824,0.008230553435295516,0.005758874154989329,0.009933805194914434,0.005920819484511231,0.00512643500915743,0.006477721243430928,0.006718409241712834,0.005196887835241855,0.004516753418116465,0.005166429964863893,0.004115377446679602,0.004024501451283002,0.008105414227252975,0.004119534198494904,0.00337964889773028,0.003053640224428005,0.002481543008250638,0.01243551776625136,0.0009221544087466365,0.03091572825005563,0.01329204137610993,0.008958194384452566,0.01061111212060004,0.02581103363513972,0.05153127658950044,0.04472615814210483])
            miehet_out=np.array([0.2,0.2,0.7039817375444724,0.4141262660127852,0.223714341713406,0.2836460773140965,0.2219533111358266,0.2847051592972142,0.2058657977486425,0.2165739019240364,0.2,0.2381608624998947,0.2993921539441066,0.2,0.2650503887017052,0.2288047250413345,0.2089401176470578,0.2,0.2508573270799143,0.2094358440208692,0.2988247996399193,0.2,0.2409816129947187,0.2085440931920921,0.2481554288165937,0.3767025459286287,0.2112350494877626,0.2,0.3645721867491835,0.2,0.3311908933349903,0.3699216365788494,0.2,0.2,0.3406507242906747,0.3878060438744773,0.2,0.2429160421438119,0.5157178557959196,0.2,0.4239214389191499,0.3329032924211541,0.4341441998707779,0.2521819029794387,0.2,1.0,1.0,0.7033021380913533,0.4604554904954681,0.2,1.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.05310257308524474,0.01688376165684216,0.01329599149846759,0.008950604709906189,0.005969649413766616,0.005904962298433502,0.003583020937178218,0.00534408140070991,0.002923691947215984,0.0002162138067419456,0.006091829908305144,0.00181290659375536,0.0001524009656406715,0.0,0.0,0.0,0.0,0.0,0.002991516459210279,0.0001601026326703625,0.006266329264361976,0.004268547838418258,0.009283857395964257,0.003524586975392974,0.007911100438545395,0.003923717364513575,0.003328376543609644,0.003910474184404727,0.003221089239198236,0.008872644665206353,0.003978084478670799,0.003254723747920039,0.006300196954319188,0.003401867363244652,0.002411042703979414,0.008003519249714739,0.002946801243173337,0.007359539792654522,0.003182922424514321,0.004167811922828105,0.002526471895156833,0.002134596462014745,0.001685781290720108,0.01200752096518342,0.004441562321632722,0.0008322418539793193,0.0293534145409169,0.01357846126797743,0.01044609773127423,0.0176212106918199,0.0563212786602404,0.0769164603399572,0.1177978352647955])
            naiset_out=np.array([0.2,0.4342292450072329,0.5399805801389803,0.5578428588008228,0.7719164064068145,0.2,0.6925696297911834,0.2,0.959823575084721,1.0,1.0,0.957254294175534,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.3267524421226682,0.2,0.3386470352251258,0.2781908933104331,0.2,0.348998200466046,0.2,0.3912963592742897,0.3998030084897278,0.2,0.4945176598441147,0.5422983757279614,0.2,0.546941093678283,0.2,0.6133172350621926,0.2,0.3870192176524088,0.4480058912226964,0.2694919943822267,0.2,0.4154431250582814,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.07218339130707307,0.05034650074660785,0.03017038522373914,0.0144140323707476,0.01116485430875257,0.01054716660075776,0.0101984648645327,0.009766009329550771,0.009748709633851592,0.009241544981588022,0.01613167907450358,0.01086074883398768,0.009499811281052855,0.009429136674979521,0.01286573669091614,0.009811061108876891,0.009034964947964337,0.01021836347495704,0.00875915484773989,0.008158324023970048,0.00746193685167079,0.007196655288309412,0.007084881532723952,0.007149870804273457,0.006604569272543307,0.006198418568372221,0.005783446061701741,0.005624506904798143,0.005485556556041683,0.008213272976306772,0.005743023948294763,0.005047747319417353,0.007581849203874201,0.005570613804831228,0.005145066723673697,0.006971756503846798,0.004573891732161401,0.005734760080646447,0.004321486488654138,0.008124938104995295,0.00459769894135107,0.002847963250985683,0.004192220435050296,0.005206984511557906,0.009700371547338023,0.0009573540665814187,0.03080121674613226,0.01330837874338915,0.008970617613066174,0.01062395654031109,0.02585456434070877,0.05162552982970096,0.04481413510462667])
            miehet_out=np.array([0.2,0.2,0.6978324366024494,0.4305136414408534,0.2606999416122422,0.3225341277263525,0.2,0.2152122080776268,0.2693714837844353,0.2276945372162136,0.2,0.3331864541081275,0.2131549987619094,0.2329557816373812,0.2,0.2755137055763618,0.2383622315804643,0.2,0.2460530262074579,0.2647529490845686,0.2264491686888231,0.2086748095197662,0.3311949371300001,0.2,0.2,0.2618287287203832,0.2796273325397509,0.2,0.2833390514425433,0.2,0.3175187052093629,0.2136189281467351,0.2,0.2842050028375359,0.450237892600135,0.2,0.3837146671999105,0.2,0.4313785477234637,0.2,0.6169861791836972,0.4709279108762983,0.2,0.2,0.2,1.0,1.0,0.7033021380913533,0.4604554904954681,0.2,1.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.05447786974294317,0.01716608484081268,0.01207078597304705,0.007294155374034457,0.003811421580462839,0.002143706807791779,0.000968920756932893,0.0001061607901341103,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.005446262244007835,0.004922758427105454,0.006027418737675088,0.002764295435373423,0.007581195519152947,0.003477038756647353,0.004700620442351658,0.003412165570654829,0.003260912415517281,0.003952634767798126,0.00309096492514721,0.003083749583778724,0.00301339616111666,0.002442500614018066,0.00152695964703258,0.0034190888350523,0.004176912103248057,0.002403931094944866,0.003873311110477125,0.002579211466773895,0.003540593296826862,0.005516996982487707,0.003246970031087557,0.006935666071994089,0.0009739484434259106,0.02901697622250412,0.01356872137365262,0.01043879129826035,0.01761318716152643,0.05628787292907828,0.0768772897205084,0.1177497837034894])
            naiset_out=np.array([0.2,0.5191323598055089,0.6058523763710763,0.6979558325671649,0.6561955802861421,0.767401893361606,0.7688383658965483,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2858013670676423,0.2,0.3054324378162772,0.2,0.2462540657072065,0.3302726116273687,0.2,0.2036955390010844,0.2363040827866537,0.3914925331837027,0.5826850161696038,0.2983283247236572,0.2,0.2,0.3608426729993024,0.2,0.5243727748365177,0.2,0.2,0.2885088648916867,0.2,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.0721137320970228,0.05099883856865509,0.03029759766598315,0.01428794123144505,0.01123014978716207,0.01067585993224454,0.01028749143334553,0.01020428999026311,0.01029129166253232,0.009814314309014385,0.01286897340347833,0.01014883723190752,0.009080232018913018,0.01008763220015613,0.008702419294484362,0.008015365590394185,0.007889221777160066,0.007394210395597557,0.01091405246787421,0.007840936417405266,0.007872955406425582,0.006750927234810041,0.008493616114921162,0.006680404283965358,0.006600348582243521,0.005500301790732046,0.008052289514278907,0.007333835265072289,0.006262666894197524,0.005730933999308091,0.005452186206348832,0.005153143180892225,0.005958030949851595,0.005343682027778079,0.005050998057369431,0.004658163123668385,0.007022455078279467,0.004059981244315797,0.003466981163854867,0.00586381545160661,0.004144731819691072,0.002950615628326382,0.00287461399282119,0.002616154818422756,0.01105963366315748,0.0008577486014593303,0.03072959345174545,0.01329269843393642,0.008958561982624213,0.01061138683769339,0.02581168082324276,0.05153217754747862,0.04472661151641173])
            miehet_out=np.array([0.2,0.2,0.7046176278167495,0.418936699565884,0.2545526157020639,0.2491404640336857,0.2296158548182341,0.2880434713636716,0.2,0.2771207186996193,0.2,0.3147331650950304,0.2821420240415432,0.2,0.2665493447263813,0.2123558731161944,0.2587703452368865,0.2,0.2,0.3502104935271568,0.2,0.2430260607835268,0.2,0.201448637234048,0.3599221573217142,0.2264656129864053,0.2,0.2,0.3579710917411175,0.2,0.2493358869365471,0.2096157243583557,0.2,0.262128593541004,0.2867314744380834,0.5294663811511597,0.2,0.3663757004196637,0.2228899970881133,0.2,0.5280830685488396,0.2638839680222494,0.3411280144717836,0.3110765434587788,0.2,1.0,1.0,0.7033021380913533,0.4604554904954681,0.2,1.0,0.0,0.0])
        elif self.year==2024:
            naiset_in=np.array([0.05516316985435012,0.01735317469910702,0.01311735120047224,0.00866142243460379,0.006044671187663312,0.005928557740592458,0.004488138558932245,0.004201903280376967,0.001736552188501156,0.000350501777320131,0.0,0.0009454767087501111,9.740403622341563e-05,0.0,0.0,0.0,0.001276682843950257,9.928637722334076e-05,0.006966118776292568,0.00180952458434874,0.008893968087820085,0.005997702051321959,0.01003976752291507,0.004961777339805885,0.005595590861909007,0.007550754962761692,0.007373409090383619,0.00549430507620378,0.006031974591903717,0.005875339495155191,0.00549136791320355,0.005251354352222399,0.007676520339241529,0.005325329868909813,0.004942405790121636,0.004654827073617272,0.005780731073457433,0.004744841449320253,0.008208652897042059,0.005474609536575754,0.005698446941765355,0.006329317099796525,0.006683214983889818,0.006198298946969308,0.01087752851626358,0.001806930451484305,0.02906104360064957,0.01357166711224498,0.01044340550754115,0.01762183152186812,0.05634482253886203,0.07698080892803665,0.1179509353591907])
            naiset_out=np.array([0.2,0.4669255989448389,0.5510592222127015,0.5293810297241087,0.7412596760846579,0.2,0.2,0.8002316587869602,0.5416677551051001,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2,0.3003193361740543,0.2,0.2,0.2,0.2480735717271521,0.2,0.2,0.2504759239194953,0.322000436891802,0.2,0.4450508455782761,0.2,0.2,0.2,0.2588294352684725,0.2,0.2131165120213271,0.3574780942458664,0.2,0.2,0.2168721214971999,0.2,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.0721137320970228,0.05099883856865509,0.03029759766598315,0.01428794123144505,0.01123014978716207,0.01067585993224454,0.01028749143334553,0.01020428999026311,0.01029129166253232,0.009814314309014385,0.01286897340347833,0.01014883723190752,0.009080232018913018,0.01008763220015613,0.008702419294484362,0.008015365590394185,0.007889221777160066,0.007394210395597557,0.01091405246787421,0.007840936417405266,0.007872955406425582,0.006750927234810041,0.008493616114921162,0.006680404283965358,0.006600348582243521,0.005500301790732046,0.008052289514278907,0.007333835265072289,0.006262666894197524,0.005730933999308091,0.005452186206348832,0.005153143180892225,0.005958030949851595,0.005343682027778079,0.005050998057369431,0.004658163123668385,0.007022455078279467,0.004059981244315797,0.003466981163854867,0.00586381545160661,0.004144731819691072,0.002950615628326382,0.00287461399282119,0.002616154818422756,0.01105963366315748,0.0008577486014593303,0.03072959345174545,0.01329269843393642,0.008958561982624213,0.01061138683769339,0.02581168082324276,0.05153217754747862,0.04472661151641173])
            miehet_out=np.array([0.2,0.2,0.7046176278167495,0.418936699565884,0.2545526157020639,0.2491404640336857,0.2296158548182341,0.2880434713636716,0.2,0.2771207186996193,0.2,0.3147331650950304,0.2821420240415432,0.2,0.2665493447263813,0.2123558731161944,0.2587703452368865,0.2,0.2,0.3502104935271568,0.2,0.2430260607835268,0.2,0.201448637234048,0.3599221573217142,0.2264656129864053,0.2,0.2,0.3579710917411175,0.2,0.2493358869365471,0.2096157243583557,0.2,0.262128593541004,0.2867314744380834,0.5294663811511597,0.2,0.3663757004196637,0.2228899970881133,0.2,0.5280830685488396,0.2638839680222494,0.3411280144717836,0.3110765434587788,0.2,1.0,1.0,0.7033021380913533,0.4604554904954681,0.2,1.0,0.0,0.0])
        elif self.year==2025:
            naiset_in=np.array([0.05516316985435012,0.01735317469910702,0.01311735120047224,0.00866142243460379,0.006044671187663312,0.005928557740592458,0.004488138558932245,0.004201903280376967,0.001736552188501156,0.000350501777320131,0.0,0.0009454767087501111,9.740403622341563e-05,0.0,0.0,0.0,0.001276682843950257,9.928637722334076e-05,0.006966118776292568,0.00180952458434874,0.008893968087820085,0.005997702051321959,0.01003976752291507,0.004961777339805885,0.005595590861909007,0.007550754962761692,0.007373409090383619,0.00549430507620378,0.006031974591903717,0.005875339495155191,0.00549136791320355,0.005251354352222399,0.007676520339241529,0.005325329868909813,0.004942405790121636,0.004654827073617272,0.005780731073457433,0.004744841449320253,0.008208652897042059,0.005474609536575754,0.005698446941765355,0.006329317099796525,0.006683214983889818,0.006198298946969308,0.01087752851626358,0.001806930451484305,0.02906104360064957,0.01357166711224498,0.01044340550754115,0.01762183152186812,0.05634482253886203,0.07698080892803665,0.1179509353591907])
            naiset_out=np.array([0.2,0.4669255989448389,0.5510592222127015,0.5293810297241087,0.7412596760846579,0.2,0.2,0.8002316587869602,0.5416677551051001,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2,0.3003193361740543,0.2,0.2,0.2,0.2480735717271521,0.2,0.2,0.2504759239194953,0.322000436891802,0.2,0.4450508455782761,0.2,0.2,0.2,0.2588294352684725,0.2,0.2131165120213271,0.3574780942458664,0.2,0.2,0.2168721214971999,0.2,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.0721137320970228,0.05099883856865509,0.03029759766598315,0.01428794123144505,0.01123014978716207,0.01067585993224454,0.01028749143334553,0.01020428999026311,0.01029129166253232,0.009814314309014385,0.01286897340347833,0.01014883723190752,0.009080232018913018,0.01008763220015613,0.008702419294484362,0.008015365590394185,0.007889221777160066,0.007394210395597557,0.01091405246787421,0.007840936417405266,0.007872955406425582,0.006750927234810041,0.008493616114921162,0.006680404283965358,0.006600348582243521,0.005500301790732046,0.008052289514278907,0.007333835265072289,0.006262666894197524,0.005730933999308091,0.005452186206348832,0.005153143180892225,0.005958030949851595,0.005343682027778079,0.005050998057369431,0.004658163123668385,0.007022455078279467,0.004059981244315797,0.003466981163854867,0.00586381545160661,0.004144731819691072,0.002950615628326382,0.00287461399282119,0.002616154818422756,0.01105963366315748,0.0008577486014593303,0.03072959345174545,0.01329269843393642,0.008958561982624213,0.01061138683769339,0.02581168082324276,0.05153217754747862,0.04472661151641173])
            miehet_out=np.array([0.2,0.2,0.7046176278167495,0.418936699565884,0.2545526157020639,0.2491404640336857,0.2296158548182341,0.2880434713636716,0.2,0.2771207186996193,0.2,0.3147331650950304,0.2821420240415432,0.2,0.2665493447263813,0.2123558731161944,0.2587703452368865,0.2,0.2,0.3502104935271568,0.2,0.2430260607835268,0.2,0.201448637234048,0.3599221573217142,0.2264656129864053,0.2,0.2,0.3579710917411175,0.2,0.2493358869365471,0.2096157243583557,0.2,0.262128593541004,0.2867314744380834,0.5294663811511597,0.2,0.3663757004196637,0.2228899970881133,0.2,0.5280830685488396,0.2638839680222494,0.3411280144717836,0.3110765434587788,0.2,1.0,1.0,0.7033021380913533,0.4604554904954681,0.2,1.0,0.0,0.0])
        elif self.year==2026:
            naiset_in=np.array([0.05516316985435012,0.01735317469910702,0.01311735120047224,0.00866142243460379,0.006044671187663312,0.005928557740592458,0.004488138558932245,0.004201903280376967,0.001736552188501156,0.000350501777320131,0.0,0.0009454767087501111,9.740403622341563e-05,0.0,0.0,0.0,0.001276682843950257,9.928637722334076e-05,0.006966118776292568,0.00180952458434874,0.008893968087820085,0.005997702051321959,0.01003976752291507,0.004961777339805885,0.005595590861909007,0.007550754962761692,0.007373409090383619,0.00549430507620378,0.006031974591903717,0.005875339495155191,0.00549136791320355,0.005251354352222399,0.007676520339241529,0.005325329868909813,0.004942405790121636,0.004654827073617272,0.005780731073457433,0.004744841449320253,0.008208652897042059,0.005474609536575754,0.005698446941765355,0.006329317099796525,0.006683214983889818,0.006198298946969308,0.01087752851626358,0.001806930451484305,0.02906104360064957,0.01357166711224498,0.01044340550754115,0.01762183152186812,0.05634482253886203,0.07698080892803665,0.1179509353591907])
            naiset_out=np.array([0.2,0.4669255989448389,0.5510592222127015,0.5293810297241087,0.7412596760846579,0.2,0.2,0.8002316587869602,0.5416677551051001,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.2,0.2,0.2,0.2,0.3003193361740543,0.2,0.2,0.2,0.2480735717271521,0.2,0.2,0.2504759239194953,0.322000436891802,0.2,0.4450508455782761,0.2,0.2,0.2,0.2588294352684725,0.2,0.2131165120213271,0.3574780942458664,0.2,0.2,0.2168721214971999,0.2,1.0,1.0,0.660565891962546,0.3368493398370939,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.0721137320970228,0.05099883856865509,0.03029759766598315,0.01428794123144505,0.01123014978716207,0.01067585993224454,0.01028749143334553,0.01020428999026311,0.01029129166253232,0.009814314309014385,0.01286897340347833,0.01014883723190752,0.009080232018913018,0.01008763220015613,0.008702419294484362,0.008015365590394185,0.007889221777160066,0.007394210395597557,0.01091405246787421,0.007840936417405266,0.007872955406425582,0.006750927234810041,0.008493616114921162,0.006680404283965358,0.006600348582243521,0.005500301790732046,0.008052289514278907,0.007333835265072289,0.006262666894197524,0.005730933999308091,0.005452186206348832,0.005153143180892225,0.005958030949851595,0.005343682027778079,0.005050998057369431,0.004658163123668385,0.007022455078279467,0.004059981244315797,0.003466981163854867,0.00586381545160661,0.004144731819691072,0.002950615628326382,0.00287461399282119,0.002616154818422756,0.01105963366315748,0.0008577486014593303,0.03072959345174545,0.01329269843393642,0.008958561982624213,0.01061138683769339,0.02581168082324276,0.05153217754747862,0.04472661151641173])
            miehet_out=np.array([0.2,0.2,0.7046176278167495,0.418936699565884,0.2545526157020639,0.2491404640336857,0.2296158548182341,0.2880434713636716,0.2,0.2771207186996193,0.2,0.3147331650950304,0.2821420240415432,0.2,0.2665493447263813,0.2123558731161944,0.2587703452368865,0.2,0.2,0.3502104935271568,0.2,0.2430260607835268,0.2,0.201448637234048,0.3599221573217142,0.2264656129864053,0.2,0.2,0.3579710917411175,0.2,0.2493358869365471,0.2096157243583557,0.2,0.262128593541004,0.2867314744380834,0.5294663811511597,0.2,0.3663757004196637,0.2228899970881133,0.2,0.5280830685488396,0.2638839680222494,0.3411280144717836,0.3110765434587788,0.2,1.0,1.0,0.7033021380913533,0.4604554904954681,0.2,1.0,0.0,0.0])
        else:
            print("Error: Unknown year in ['outsider in', 'outsider out']")
    
        min_age=18
        max_spv=71
        in_m=self.get_w(0,1.5,1.0)
        out_m=self.get_w(0,0.8,1.0)
        in_n=self.get_w(0,1.25,1.0)
        out_n=self.get_w(0,0.85,1.0)
        
        inrate[min_age:max_spv,0]=1.5*miehet_in
        inrate[min_age:max_spv,1]=1.0*miehet_in
        inrate[min_age:max_spv,2]=in_m*miehet_in
        inrate[min_age:max_spv,3]=1.25*naiset_in
        inrate[min_age:max_spv,4]=1.0*naiset_in
        inrate[min_age:max_spv,5]=in_n*naiset_in
        outrate[min_age:max_spv,0]=0.8*miehet_out
        outrate[min_age:max_spv,1]=1.0*miehet_out
        outrate[min_age:max_spv,2]=out_m*miehet_out
        outrate[min_age:max_spv,3]=0.85*naiset_out
        outrate[min_age:max_spv,4]=1.0*naiset_out
        outrate[min_age:max_spv,5]=out_n*naiset_out

        #inrate=1-(1-inrate)**self.timestep
        #outrate=1-(1-outrate)**self.timestep

        inrate = self.scale_rates(inrate)
        outrate = self.scale_rates(outrate)

        ra=int(retirementage)

        outrate[ra:max_spv,0]=1.0
        outrate[ra:max_spv,1]=1.0
        outrate[ra:max_spv,2]=1.0
        outrate[ra:max_spv,3]=1.0
        outrate[ra:max_spv,4]=1.0
        outrate[ra:max_spv,5]=1.0

        inrate[ra:max_spv,0]=0.0
        inrate[ra:max_spv,1]=0.0
        inrate[ra:max_spv,2]=0.0
        inrate[ra:max_spv,3]=0.0
        inrate[ra:max_spv,4]=0.0
        inrate[ra:max_spv,5]=0.0

        return inrate,outrate                

    def get_outsider_rate_v7(self,retirementage,debug=False):
        '''
        työelämän ulkopuolelle jäävien osuudet
        '''
        inrate=np.zeros((101,self.n_groups))
        outrate=np.zeros((101,self.n_groups))
                                                        
        ### ['outsider in', 'outsider out']
        if self.year==2018:
            naiset_in=np.array([0.07188478,0.02142087,0.01660705,0.01432337,0.01498118,0.01532511,0.02144115,0.02283268,0.02034861,0.0271405,0.02328068,0.02154329,0.02141406,0.0197512,0.01850495,0.01654219,0.01352277,0.01218682,0.01559147,0.01519061,0.01215199,0.0113479,0.01016465,0.01014863,0.01307033,0.00905002,0.01084178,0.00902863,0.00885853,0.00943692,0.00873472,0.00869541,0.00856961,0.00870071,0.0083249,0.01046674,0.01003238,0.00941772,0.01004153,0.01002706,0.01100938,0.01103314,0.0114927,0.0115691,0.01252836,0.01088292,0.01115169,0.01110221,0.01101854,0.01191644,0.07412803,0.23627475,0.28816119])
            naiset_out=np.array([0.2,0.45711664,0.36695804,0.22743449,0.2,0.25615828,0.2,0.2,0.24275501,0.2,0.30436412,0.22765063,0.29508077,0.25274669,0.26494879,0.34714944,0.26165985,0.2,0.2,0.2,0.28426403,0.2,0.35744072,0.2,0.2,0.23159934,0.2,0.21198744,0.26000927,0.2,0.2,0.22077724,0.25083779,0.2,0.21012111,0.2,0.2,0.20027967,0.2,0.22347764,0.2,0.2,0.26003816,0.25187677,0.65729193,0.65481952,0.6289137,0.48738026,0.340803,0.25416495,1.0,0.0,0.0])
            miehet_in=np.array([0.08410714,0.07045074,0.03664972,0.0157195,0.01265578,0.01181101,0.01145548,0.01114632,0.01117072,0.01126783,0.01289172,0.01187002,0.01413108,0.01199487,0.01224177,0.01060313,0.01045956,0.01101119,0.01054992,0.01221824,0.01021231,0.01022996,0.00987719,0.01073245,0.00917336,0.01136655,0.00952586,0.00935278,0.00956426,0.00942073,0.01195674,0.00953149,0.01197374,0.01004077,0.01245839,0.01044882,0.01159611,0.01187086,0.01250234,0.01179923,0.01185019,0.01231997,0.01238966,0.01264015,0.01265932,0.01050756,0.00863716,0.01005015,0.00972122,0.01195064,0.0757038,0.2536158,0.31727196])
            miehet_out=np.array([0.2,0.2,0.73840303,0.39500203,0.27738161,0.25110084,0.24568274,0.20909824,0.20408525,0.20544418,0.2,0.25780925,0.2,0.34004328,0.2,0.20243872,0.24906542,0.2,0.2,0.2,0.21086606,0.2,0.28701495,0.2,0.21067773,0.2,0.22080203,0.20032425,0.2,0.26858138,0.2,0.22623303,0.2,0.24061216,0.2,0.26866224,0.2,0.2,0.2,0.25034397,0.22438638,0.26118488,0.24923082,0.34060973,0.69688675,0.75980392,0.4331033,0.45554139,0.21519358,0.3249068,1.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.06703075,0.02057369,0.01614103,0.01280825,0.01478944,0.01307995,0.01331482,0.01728592,0.01961697,0.01744949,0.01973998,0.0190002,0.01933973,0.01781006,0.01744937,0.01456251,0.01280271,0.01070467,0.01006485,0.01156352,0.01144124,0.00908739,0.00867768,0.00811628,0.00782276,0.01135616,0.00941646,0.00936315,0.00848917,0.00845169,0.00866833,0.00830667,0.00914241,0.00851499,0.0083314,0.01217041,0.0103649,0.00978357,0.01176525,0.01041449,0.01075984,0.01254998,0.0162738,0.01831698,0.01672532,0.01491103,0.01155529,0.01196605,0.01208557,0.01394263,0.04755232,0.10046416,0.15052836])
            naiset_out=np.array([0.2,0.42758633,0.43378624,0.32429183,0.2,0.22166754,0.21160295,0.2,0.2,0.23069432,0.2,0.21077438,0.30972582,0.2,0.33849135,0.29500663,0.32842689,0.20943962,0.33202935,0.2,0.2,0.2,0.2,0.23647255,0.2,0.2,0.2,0.2,0.20139355,0.23305715,0.2,0.20681434,0.2,0.23081182,0.20626884,0.2,0.2,0.24700656,0.2,0.20558638,0.21294878,0.2,0.2,0.2,0.53613775,0.84135509,0.58639534,0.65728608,0.2,0.31241412,1.0,0.0,0.0])
            miehet_in=np.array([0.09131593,0.06139999,0.03565394,0.01680353,0.01354801,0.01341406,0.01239328,0.01229813,0.01371269,0.01285259,0.01252777,0.0123816,0.01228013,0.01200991,0.01177357,0.01448977,0.01115714,0.01044945,0.01243107,0.00990539,0.01135057,0.0109118,0.00957304,0.00904495,0.00903905,0.01135235,0.00916477,0.01117206,0.00945565,0.00929348,0.00926624,0.01078353,0.00954336,0.00955608,0.01104269,0.01258442,0.01051791,0.01266841,0.01104889,0.01131123,0.01176931,0.01199836,0.01166013,0.01172156,0.01321116,0.01303409,0.01063423,0.00884542,0.01353011,0.01294376,0.03465008,0.0473908,0.0553])
            miehet_out=np.array([0.2,0.2,0.70105538,0.3895571,0.23333492,0.28327509,0.23048665,0.2127538,0.2,0.23818861,0.22794283,0.25527556,0.2,0.21028539,0.32006695,0.2,0.24769393,0.26557258,0.2,0.26648867,0.2,0.2,0.24268498,0.24594236,0.2,0.2,0.22256494,0.2,0.21430338,0.20773528,0.22108882,0.2,0.21201618,0.23938883,0.2,0.2,0.25824637,0.2,0.20371107,0.25739312,0.2,0.30184499,0.27298111,0.20075144,0.50832058,0.871563,0.57830212,0.47546539,0.2,0.26608888,1.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.06570641,0.01963157,0.01629269,0.01320962,0.01079824,0.01480027,0.01207605,0.01466668,0.01368227,0.01463924,0.01523508,0.01583514,0.01429435,0.01275094,0.01198399,0.0107327,0.00973168,0.00877634,0.0079076,0.00690811,0.01138639,0.01007972,0.00771385,0.00918722,0.00709921,0.00778639,0.00897693,0.00769143,0.00769576,0.00744244,0.00728724,0.00840249,0.00772557,0.00762889,0.00763163,0.0092434,0.00855573,0.01074554,0.00896553,0.00908358,0.00947714,0.01033433,0.01031693,0.01393563,0.0128205,0.01492528,0.01131177,0.01106858,0.00779656,0.01338705,0.04650779,0.0651856,0.09835627])
            naiset_out=np.array([0.2,0.40187491,0.41660598,0.41906523,0.2968732,0.2,0.24762279,0.2,0.21948361,0.2,0.2094166,0.33719799,0.38644284,0.2,0.26929702,0.25607202,0.25577148,0.31237303,0.2,0.23615326,0.2,0.2,0.2,0.2,0.25020278,0.2,0.2,0.2,0.2,0.2,0.21767471,0.2,0.2,0.20215059,0.25184355,0.2,0.2,0.2,0.20617746,0.21666079,0.23408196,0.2,0.20125248,0.2,0.2414138,0.88988365,0.6107553,0.64318916,0.28692831,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.08118329,0.05328122,0.03167379,0.01545272,0.01352363,0.01289152,0.01263552,0.01196854,0.0125197,0.01370003,0.01257269,0.01243496,0.01113771,0.01092326,0.01103316,0.01031359,0.01248576,0.01006643,0.00960384,0.0113106,0.00903343,0.01031152,0.00885639,0.00848804,0.00859286,0.00887955,0.0116668,0.00960666,0.00915013,0.00891609,0.00868677,0.01101738,0.009258,0.00914426,0.00899322,0.00960654,0.01124023,0.0099131,0.01060423,0.01099837,0.0110413,0.01090014,0.01109337,0.01361506,0.01280498,0.014418,0.01060867,0.0121975,0.00740343,0.01931409,0.03657016,0.04404251,0.05358392])
            miehet_out=np.array([0.2,0.2,0.68602239,0.33221675,0.256964,0.23512566,0.27170287,0.24672958,0.2,0.2,0.22755196,0.30947924,0.22311931,0.25098997,0.2,0.31296347,0.2,0.2,0.27642902,0.2,0.23464203,0.2,0.2225958,0.240638,0.2,0.2,0.2,0.2,0.23079216,0.22417251,0.20492956,0.2,0.21946016,0.22781249,0.20807812,0.2,0.2,0.22723685,0.2,0.2,0.27054598,0.23996746,0.25942154,0.2,0.27414314,0.91839063,0.47298839,0.69150977,0.22747198,0.2,1.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.04937621,0.01740417,0.01599082,0.01258699,0.01099724,0.01209898,0.01296388,0.01327477,0.01452994,0.01486499,0.01572993,0.01514654,0.02017318,0.01629374,0.01469283,0.0136056,0.01225435,0.01055201,0.00819501,0.00736025,0.00973323,0.00953206,0.00959841,0.00721166,0.00804334,0.0065434,0.00945677,0.00998967,0.00777305,0.00955332,0.00790158,0.00772632,0.00963319,0.00789144,0.00893913,0.00783915,0.00814166,0.00958846,0.00913023,0.00896502,0.01306991,0.01081579,0.01114929,0.01845105,0.01795323,0.01684076,0.01390254,0.01537231,0.00920492,0.01212666,0.04169634,0.07011989,0.09691866])
            naiset_out=np.array([0.2,0.32002532,0.43896401,0.36068327,0.24440896,0.2,0.2,0.2364519,0.2,0.22563507,0.28708643,0.34468945,0.2,0.29667976,0.22766006,0.26790158,0.29625142,0.3841454,0.2,0.23839532,0.2,0.2,0.2,0.2458474,0.2,0.2339927,0.2,0.2,0.2,0.2,0.22462824,0.24757814,0.2,0.26391223,0.2,0.20809721,0.2,0.2,0.2,0.21039319,0.2,0.30636541,0.2,0.2,0.2,0.87110779,0.6041478,0.71851563,0.21116192,0.29270386,1.0,0.0,0.0])
            miehet_in=np.array([0.07714297,0.05282469,0.03181883,0.01643997,0.01373145,0.01307279,0.01271631,0.01287311,0.01207696,0.0122526,0.01475844,0.01264862,0.01181678,0.01163187,0.01139656,0.01081294,0.01057067,0.01061292,0.0116974,0.01024429,0.00920434,0.01127345,0.00932991,0.00997387,0.00900651,0.00882419,0.00872729,0.01065742,0.008971,0.01017372,0.00913668,0.00906488,0.01019893,0.01103246,0.00960654,0.00918137,0.01129597,0.01088505,0.01022433,0.01182311,0.01123503,0.01142542,0.0116009,0.01202285,0.01667701,0.01536676,0.01132475,0.0165122,0.00988043,0.01155174,0.02896417,0.05829732,0.05099427])
            miehet_out=np.array([0.2,0.2,0.6536275,0.37302221,0.25622337,0.24292807,0.21114115,0.27158468,0.21330432,0.25295518,0.2,0.27196099,0.23616689,0.2,0.24586512,0.20227681,0.22716658,0.2,0.2,0.27587301,0.20598406,0.2,0.23318425,0.2,0.21558273,0.24087323,0.2,0.2,0.2250506,0.2,0.21011823,0.24037946,0.2,0.2,0.25501875,0.22705244,0.2,0.2,0.22669837,0.2,0.2288134,0.28511592,0.2,0.2,0.2,0.90793963,0.39398423,0.70330214,0.46045549,0.2,1.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.05418903,0.01772347,0.01634539,0.01297188,0.01057922,0.01087498,0.01091194,0.01114717,0.01549405,0.01336887,0.01170757,0.01187252,0.00890393,0.00700137,0.006175,0.00633789,0.00465389,0.00507379,0.00470476,0.00543,0.00860256,0.0064422,0.01165863,0.00628949,0.00642445,0.00908839,0.00800257,0.00753697,0.00934322,0.00728301,0.0087732,0.0075228,0.00752233,0.00743153,0.00756036,0.00917177,0.00793314,0.00839034,0.01055491,0.00881805,0.01191554,0.01016276,0.01156605,0.01626007,0.0241618,0.01865802,0.01313019,0.01087093,0.00995263,0.01518633,0.04480342,0.06391241,0.10211527])
            naiset_out=np.array([0.2,0.31519493,0.42763863,0.41184648,0.28577825,0.2,0.23859519,0.22512456,0.2,0.3693046,0.24210395,0.46368256,0.43308477,0.30497972,0.5014767,0.2,0.21815581,0.2,0.2,0.2,0.2,0.2,0.2,0.23841625,0.2,0.2,0.2,0.2,0.2,0.21695018,0.2,0.20284315,0.23128597,0.2,0.2,0.2,0.23213148,0.2,0.2,0.23656626,0.2,0.20734843,0.2,0.2,0.2,0.87084035,0.81061779,0.43785401,0.40418594,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.08117318,0.05191921,0.03185824,0.01597178,0.01450195,0.01409228,0.01333975,0.0131463,0.01324052,0.01309331,0.01252312,0.01320883,0.01270489,0.0117263,0.01132998,0.01069446,0.01179632,0.01031574,0.01175994,0.0105214,0.00982546,0.01126686,0.00948612,0.0101224,0.00949612,0.00915359,0.00898292,0.00871343,0.01083482,0.00901904,0.01007374,0.00920339,0.00903795,0.00908838,0.01208954,0.00980739,0.00941231,0.00981141,0.01084935,0.01037308,0.0104427,0.01118056,0.01205937,0.01504501,0.01696583,0.01616313,0.00993205,0.00884319,0.00768754,0.00703206,0.01574586,0.024846,0.04193139])
            miehet_out=np.array([0.2,0.2,0.6719506,0.29755235,0.24469269,0.26365225,0.23762253,0.20767876,0.2331046,0.25158451,0.23238663,0.2,0.30736381,0.2,0.24316034,0.24781397,0.2,0.24506822,0.2,0.2,0.24777254,0.2,0.23006659,0.2,0.2,0.2170514,0.2192638,0.23367798,0.2,0.21935464,0.2,0.22346292,0.2,0.20905035,0.2,0.25642111,0.2,0.2,0.2,0.22727799,0.20901531,0.2,0.2,0.2,0.2,0.85745888,0.77297705,0.34981865,0.45291958,0.34046096,1.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.05420997,0.01768388,0.01581951,0.01415813,0.01496535,0.01609334,0.01624466,0.01668431,0.02735329,0.02152394,0.02179649,0.02212834,0.02140261,0.02254454,0.02107763,0.02335173,0.02620887,0.0206656,0.01747372,0.01528397,0.01423762,0.01264005,0.01397057,0.01094912,0.01019831,0.00881027,0.00827878,0.00777257,0.00912843,0.00772931,0.00850153,0.0076122,0.00756635,0.00738178,0.00748609,0.00915955,0.00794651,0.00839606,0.01053589,0.00878766,0.01185442,0.01011897,0.01154785,0.01628986,0.02417996,0.01875985,0.0135707,0.01267372,0.00997628,0.01521944,0.04496467,0.06418245,0.10260989])
            naiset_out=np.array([0.2,0.34539711,0.32748123,0.29963725,0.2,0.2,0.2,0.20749748,0.2,0.23894802,0.23525864,0.25853214,0.24941791,0.2,0.29971824,0.2,0.2,0.30077579,0.25844687,0.21778555,0.24170143,0.31429884,0.2,0.21812016,0.3096923,0.23928641,0.24962961,0.25281387,0.2,0.24607698,0.2,0.21242126,0.23534748,0.2,0.2,0.2,0.23213148,0.2,0.2,0.23656626,0.2,0.20734843,0.2,0.2,0.2,0.87084035,0.81061779,0.43785401,0.40418594,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.08131954,0.04991168,0.0314503,0.01545744,0.01335082,0.01301787,0.01201878,0.01178312,0.01168106,0.01118909,0.01210999,0.01124989,0.0108492,0.01105264,0.01009869,0.01035862,0.0140878,0.01064197,0.01167335,0.0104065,0.01005125,0.01221152,0.0098703,0.00972498,0.00943196,0.00918554,0.00902068,0.00883687,0.01081463,0.00909657,0.01001263,0.00922366,0.0090233,0.00908083,0.0120513,0.00978288,0.00939259,0.00981621,0.01086546,0.01033701,0.01041775,0.01114701,0.0120682,0.01501626,0.01693755,0.01621169,0.01306313,0.01376416,0.01076918,0.01011013,0.02321848,0.03755309,0.06492202])
            miehet_out=np.array([0.2,0.2,0.68363482,0.34008095,0.23936239,0.28582286,0.2425552,0.22079391,0.26939065,0.24688449,0.2,0.25293479,0.28710875,0.2,0.20380684,0.2,0.2,0.23813376,0.2,0.2,0.24322185,0.2,0.20015611,0.21643712,0.21797899,0.21602354,0.2131335,0.23586973,0.2,0.22177064,0.2,0.22492106,0.20087788,0.20905035,0.2,0.25642111,0.2,0.2,0.2,0.22727799,0.20901531,0.2,0.2,0.2,0.2,0.85745888,0.77297705,0.34981865,0.45291958,0.34046096,1.0,0.0,0.0])
        elif self.year==2024:
            naiset_in=np.array([0.05420883,0.01769951,0.01591883,0.01451978,0.01558815,0.01652187,0.01902981,0.01916331,0.0261695,0.02312292,0.02414796,0.02497194,0.02352865,0.02526344,0.02385688,0.02234055,0.0242403,0.02035455,0.01892718,0.01676264,0.01658607,0.0136222,0.01408725,0.01150079,0.01011068,0.00905484,0.00828572,0.00758158,0.00826587,0.00756255,0.00875247,0.0076455,0.00755349,0.00739141,0.00751818,0.00911305,0.00793111,0.00839075,0.01053867,0.00877977,0.01182564,0.01006438,0.0114543,0.01611338,0.02403163,0.01857825,0.01418665,0.01663068,0.00978163,0.01497774,0.04389606,0.06252941,0.09977492])
            naiset_out=np.array([0.2,0.34808929,0.31383085,0.32136796,0.2,0.2,0.2,0.2,0.2,0.29030714,0.2,0.27896773,0.22385199,0.2,0.22962571,0.27136635,0.2,0.20271494,0.22193612,0.29615153,0.2,0.30688385,0.2,0.26602532,0.26878794,0.25711034,0.27495664,0.22117704,0.2,0.23500442,0.2,0.21242271,0.23535167,0.2,0.2,0.2,0.23213148,0.2,0.2,0.23656626,0.2,0.20734843,0.2,0.2,0.2,0.87084035,0.81061779,0.43785401,0.40418594,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.08131954,0.05125846,0.03175483,0.0153712,0.01396124,0.01362215,0.01274284,0.01283749,0.01277987,0.01201179,0.01136911,0.01132306,0.01141355,0.01111548,0.01080726,0.01037891,0.01409413,0.01062535,0.01108226,0.01051383,0.01127979,0.01143939,0.01009507,0.01030193,0.00958734,0.0094651,0.00908945,0.00880202,0.01066311,0.00911098,0.01022986,0.00924199,0.00899493,0.00907482,0.01206062,0.00978699,0.00936984,0.00980593,0.01085386,0.01034844,0.01045246,0.01113588,0.01202881,0.01500232,0.01699214,0.01613535,0.01300251,0.01322522,0.01075212,0.01009226,0.02317342,0.03747403,0.06477514])
            miehet_out=np.array([0.2,0.2,0.69006169,0.29615991,0.24268714,0.2733363,0.21714916,0.21923779,0.28171252,0.25896245,0.22909151,0.2,0.22547368,0.25458706,0.2,0.24623567,0.2,0.25793051,0.2,0.2,0.2,0.2,0.23750953,0.2,0.20798016,0.23499005,0.22049832,0.23063954,0.2,0.22685825,0.2,0.22748175,0.20088621,0.20643285,0.2,0.25642111,0.2,0.2,0.2,0.22727799,0.20901531,0.2,0.2,0.2,0.2,0.85745888,0.77297705,0.34981865,0.45291958,0.34046096,1.0,0.0,0.0])
        elif self.year==2025:
            naiset_in=np.array([0.05420883,0.01769951,0.01591883,0.01451978,0.01558815,0.01652187,0.01902981,0.01916331,0.0261695,0.02312292,0.02414796,0.02497194,0.02352865,0.02526344,0.02385688,0.02234055,0.0242403,0.02035455,0.01892718,0.01676264,0.01658607,0.0136222,0.01408725,0.01150079,0.01011068,0.00905484,0.00828572,0.00758158,0.00826587,0.00756255,0.00875247,0.0076455,0.00755349,0.00739141,0.00751818,0.00911305,0.00793111,0.00839075,0.01053867,0.00877977,0.01182564,0.01006438,0.0114543,0.01611338,0.02403163,0.01857825,0.01418665,0.01663068,0.00978163,0.01497774,0.04389606,0.06252941,0.09977492])
            naiset_out=np.array([0.2,0.34808929,0.31383085,0.32136796,0.2,0.2,0.2,0.2,0.2,0.29030714,0.2,0.27896773,0.22385199,0.2,0.22962571,0.27136635,0.2,0.20271494,0.22193612,0.29615153,0.2,0.30688385,0.2,0.26602532,0.26878794,0.25711034,0.27495664,0.22117704,0.2,0.23500442,0.2,0.21242271,0.23535167,0.2,0.2,0.2,0.23213148,0.2,0.2,0.23656626,0.2,0.20734843,0.2,0.2,0.2,0.87084035,0.81061779,0.43785401,0.40418594,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.08131954,0.05125846,0.03175483,0.0153712,0.01396124,0.01362215,0.01274284,0.01283749,0.01277987,0.01201179,0.01136911,0.01132306,0.01141355,0.01111548,0.01080726,0.01037891,0.01409413,0.01062535,0.01108226,0.01051383,0.01127979,0.01143939,0.01009507,0.01030193,0.00958734,0.0094651,0.00908945,0.00880202,0.01066311,0.00911098,0.01022986,0.00924199,0.00899493,0.00907482,0.01206062,0.00978699,0.00936984,0.00980593,0.01085386,0.01034844,0.01045246,0.01113588,0.01202881,0.01500232,0.01699214,0.01613535,0.01300251,0.01322522,0.01075212,0.01009226,0.02317342,0.03747403,0.06477514])
            miehet_out=np.array([0.2,0.2,0.69006169,0.29615991,0.24268714,0.2733363,0.21714916,0.21923779,0.28171252,0.25896245,0.22909151,0.2,0.22547368,0.25458706,0.2,0.24623567,0.2,0.25793051,0.2,0.2,0.2,0.2,0.23750953,0.2,0.20798016,0.23499005,0.22049832,0.23063954,0.2,0.22685825,0.2,0.22748175,0.20088621,0.20643285,0.2,0.25642111,0.2,0.2,0.2,0.22727799,0.20901531,0.2,0.2,0.2,0.2,0.85745888,0.77297705,0.34981865,0.45291958,0.34046096,1.0,0.0,0.0])
        elif self.year==2026:
            naiset_in=np.array([0.05420883,0.01769951,0.01591883,0.01451978,0.01558815,0.01652187,0.01902981,0.01916331,0.0261695,0.02312292,0.02414796,0.02497194,0.02352865,0.02526344,0.02385688,0.02234055,0.0242403,0.02035455,0.01892718,0.01676264,0.01658607,0.0136222,0.01408725,0.01150079,0.01011068,0.00905484,0.00828572,0.00758158,0.00826587,0.00756255,0.00875247,0.0076455,0.00755349,0.00739141,0.00751818,0.00911305,0.00793111,0.00839075,0.01053867,0.00877977,0.01182564,0.01006438,0.0114543,0.01611338,0.02403163,0.01857825,0.01418665,0.01663068,0.00978163,0.01497774,0.04389606,0.06252941,0.09977492])
            naiset_out=np.array([0.2,0.34808929,0.31383085,0.32136796,0.2,0.2,0.2,0.2,0.2,0.29030714,0.2,0.27896773,0.22385199,0.2,0.22962571,0.27136635,0.2,0.20271494,0.22193612,0.29615153,0.2,0.30688385,0.2,0.26602532,0.26878794,0.25711034,0.27495664,0.22117704,0.2,0.23500442,0.2,0.21242271,0.23535167,0.2,0.2,0.2,0.23213148,0.2,0.2,0.23656626,0.2,0.20734843,0.2,0.2,0.2,0.87084035,0.81061779,0.43785401,0.40418594,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.08131954,0.05125846,0.03175483,0.0153712,0.01396124,0.01362215,0.01274284,0.01283749,0.01277987,0.01201179,0.01136911,0.01132306,0.01141355,0.01111548,0.01080726,0.01037891,0.01409413,0.01062535,0.01108226,0.01051383,0.01127979,0.01143939,0.01009507,0.01030193,0.00958734,0.0094651,0.00908945,0.00880202,0.01066311,0.00911098,0.01022986,0.00924199,0.00899493,0.00907482,0.01206062,0.00978699,0.00936984,0.00980593,0.01085386,0.01034844,0.01045246,0.01113588,0.01202881,0.01500232,0.01699214,0.01613535,0.01300251,0.01322522,0.01075212,0.01009226,0.02317342,0.03747403,0.06477514])
            miehet_out=np.array([0.2,0.2,0.69006169,0.29615991,0.24268714,0.2733363,0.21714916,0.21923779,0.28171252,0.25896245,0.22909151,0.2,0.22547368,0.25458706,0.2,0.24623567,0.2,0.25793051,0.2,0.2,0.2,0.2,0.23750953,0.2,0.20798016,0.23499005,0.22049832,0.23063954,0.2,0.22685825,0.2,0.22748175,0.20088621,0.20643285,0.2,0.25642111,0.2,0.2,0.2,0.22727799,0.20901531,0.2,0.2,0.2,0.2,0.85745888,0.77297705,0.34981865,0.45291958,0.34046096,1.0,0.0,0.0])
        else:
            print("Error: Unknown year in ['outsider in', 'outsider out']")
    
        min_age=18
        max_spv=71
        in_m=self.get_w(0,1.5,1.0)
        out_m=self.get_w(0,0.8,1.0)
        in_n=self.get_w(0,1.25,1.0)
        out_n=self.get_w(0,0.85,1.0)
        
        inrate[min_age:max_spv,0]=1.5*miehet_in
        inrate[min_age:max_spv,1]=1.0*miehet_in
        inrate[min_age:max_spv,2]=in_m*miehet_in
        inrate[min_age:max_spv,3]=1.25*naiset_in
        inrate[min_age:max_spv,4]=1.0*naiset_in
        inrate[min_age:max_spv,5]=in_n*naiset_in
        outrate[min_age:max_spv,0]=0.8*miehet_out
        outrate[min_age:max_spv,1]=1.0*miehet_out
        outrate[min_age:max_spv,2]=out_m*miehet_out
        outrate[min_age:max_spv,3]=0.85*naiset_out
        outrate[min_age:max_spv,4]=1.0*naiset_out
        outrate[min_age:max_spv,5]=out_n*naiset_out

        #inrate=1-(1-inrate)**self.timestep
        #outrate=1-(1-outrate)**self.timestep

        inrate = self.scale_rates(inrate)
        outrate = self.scale_rates(outrate)

        ra=int(retirementage)

        outrate[ra:max_spv,0]=1.0
        outrate[ra:max_spv,1]=1.0
        outrate[ra:max_spv,2]=1.0
        outrate[ra:max_spv,3]=1.0
        outrate[ra:max_spv,4]=1.0
        outrate[ra:max_spv,5]=1.0

        inrate[ra:max_spv,0]=0.0
        inrate[ra:max_spv,1]=0.0
        inrate[ra:max_spv,2]=0.0
        inrate[ra:max_spv,3]=0.0
        inrate[ra:max_spv,4]=0.0
        inrate[ra:max_spv,5]=0.0

        return inrate,outrate                        

    def scale_rates(self,rate,debug=False):
        '''
        Scale rates to the timestep
        '''
        if debug:
            print("Scaling rates")

        rate0 = rate[0]
        if self.timestep<1.0:
            ts0 = self.timestep # 1.0/(1.0/self.timestep-1.0) # convert 0.25 to 0.33 for the first time step, since there is one step less between years 18->19
        else:
            ts0 = self.timestep

        rate=1-(1-rate)**self.timestep
        rate[0]=1-(1-rate0)**ts0
        return rate

    def get_outsider_rate_v8(self,retirementage,debug=False):
        '''
        työelämän ulkopuolelle jäävien osuudet
        '''
        inrate=np.zeros((101,self.n_groups))
        outrate=np.zeros((101,self.n_groups))
                                                        
        ### ['outsider in', 'outsider out']
        if self.year==2018:
            naiset_in=np.array([0.07060332,0.02125044,0.01717036,0.01366658,0.01320203,0.01363108,0.01873254,0.01860475,0.01782238,0.0178624,0.01895312,0.01778682,0.01648252,0.01469871,0.01239617,0.00914606,0.00721077,0.00652873,0.01100113,0.01154104,0.00855735,0.01062035,0.00752195,0.00950688,0.012646,0.00907972,0.01047272,0.00960003,0.00857221,0.01007306,0.00861526,0.00864875,0.00852864,0.00886502,0.00835792,0.01049867,0.01007789,0.00940046,0.01006194,0.01003449,0.01105724,0.01110503,0.01159264,0.01159111,0.01257302,0.01099291,0.01110136,0.01118547,0.01106458,0.01197419,0.07453983,0.23776304,0.29019878])
            naiset_out=np.array([0.2,0.42479776,0.44006621,0.27377062,0.22895474,0.24608334,0.2,0.2,0.25045054,0.2,0.29721594,0.30604777,0.32710706,0.34727409,0.43140044,0.38044534,0.23643363,0.28199478,0.2,0.2,0.2,0.2,0.2728885,0.2,0.2,0.2,0.2,0.2,0.24192128,0.2,0.20388252,0.21663331,0.24775786,0.2,0.2129408,0.2,0.2,0.20027967,0.2,0.22347764,0.2,0.2,0.26003816,0.25187677,0.65729193,0.65481952,0.6289137,0.48738026,0.340803,0.25416495,1.0,0.0,0.0])
            miehet_in=np.array([0.08354535,0.07052558,0.03658802,0.01531974,0.01233661,0.01113973,0.01062737,0.01016075,0.00995699,0.00987662,0.00999165,0.00982756,0.01123397,0.0100695,0.01130155,0.01031492,0.00923755,0.00894067,0.00802763,0.01163768,0.0091534,0.01000754,0.00876388,0.01095874,0.00908957,0.01069376,0.00935667,0.00967057,0.00961831,0.00938164,0.01196161,0.00953562,0.01194394,0.01003475,0.01247442,0.01042586,0.01159639,0.01184497,0.01254561,0.01181297,0.0118311,0.01240628,0.01240599,0.01267992,0.01265792,0.01048354,0.00863221,0.00998603,0.00972463,0.01195508,0.07573343,0.25371978,0.31740765])
            miehet_out=np.array([0.2,0.2,0.74903357,0.39467847,0.30830063,0.26640844,0.26278641,0.23135975,0.22158079,0.23820173,0.2,0.22666809,0.2,0.35374185,0.2,0.2,0.3174529,0.2,0.20134033,0.2,0.2,0.2,0.25704432,0.2,0.2,0.2,0.2,0.2,0.2,0.2654243,0.2,0.22525771,0.2,0.23969305,0.2,0.26866224,0.2,0.2,0.2,0.25034397,0.22438638,0.26118488,0.24923082,0.34060973,0.69688675,0.75980392,0.4331033,0.45554139,0.21519358,0.3249068,1.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.06554144,0.02022829,0.01578537,0.0124253,0.01320663,0.01219263,0.01459438,0.01665908,0.02062225,0.01747083,0.01887922,0.01830131,0.01841448,0.01683187,0.01612628,0.0131791,0.01151203,0.01281719,0.01020873,0.01474779,0.01094118,0.00926027,0.01116106,0.00876278,0.00806133,0.01051406,0.00932435,0.00927985,0.00875445,0.0085345,0.00879312,0.0083611,0.00915594,0.0085289,0.00833546,0.01217073,0.01036475,0.00978198,0.01176587,0.01041311,0.01076037,0.01255296,0.01628126,0.01832737,0.01674083,0.01492803,0.01159229,0.0119854,0.01210282,0.01397243,0.04766672,0.10073301,0.1509718])
            naiset_out=np.array([0.2,0.43149406,0.4405694,0.34249606,0.2,0.22639154,0.2,0.2,0.2,0.2625426,0.2,0.22590235,0.29498681,0.23635811,0.35676082,0.29799329,0.29679778,0.2,0.33011704,0.2,0.2,0.22530082,0.2,0.24102008,0.2188802,0.2,0.2,0.2,0.2,0.23802097,0.2,0.21164574,0.2,0.23184036,0.20682369,0.2,0.2,0.24700656,0.2,0.20558638,0.21294878,0.2,0.2,0.2,0.53613775,0.84135509,0.58639534,0.65728608,0.2,0.31241412,1.0,0.0,0.0])
            miehet_in=np.array([0.09104517,0.06066854,0.03548861,0.01650444,0.01297121,0.01270852,0.01161393,0.01136246,0.01366604,0.01198781,0.01147531,0.0114546,0.01112266,0.01086575,0.01066588,0.01310812,0.01037202,0.0096718,0.01067327,0.00879221,0.0110392,0.0104356,0.00908626,0.00889422,0.00930497,0.01141929,0.00907013,0.01134821,0.00947654,0.00931329,0.00925958,0.01073477,0.00955035,0.00956645,0.01103568,0.0125955,0.01052417,0.0126747,0.01109343,0.01130837,0.01175987,0.01201135,0.01166068,0.01173802,0.01319514,0.01309723,0.01065768,0.00883928,0.01352846,0.0129408,0.0346409,0.04737659,0.05528159])
            miehet_out=np.array([0.2,0.2,0.70890719,0.40902242,0.24199004,0.29539752,0.24554785,0.22509474,0.2,0.2587269,0.21374122,0.27472249,0.2,0.21005415,0.2886745,0.2,0.25526913,0.28702562,0.2,0.20990066,0.2,0.2,0.20815214,0.25637406,0.2,0.2,0.21304956,0.2,0.21475443,0.20922795,0.21954075,0.2,0.21150713,0.23988076,0.2,0.2,0.25824637,0.2,0.20371107,0.25739312,0.2,0.30184499,0.27298111,0.20075144,0.50832058,0.871563,0.57830212,0.47546539,0.2,0.26608888,1.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.06457189,0.01942162,0.01678004,0.01463567,0.01411594,0.02105091,0.01716527,0.02195972,0.02067704,0.02173146,0.02348618,0.02459553,0.02490551,0.02637878,0.02345667,0.02130395,0.02073443,0.0177439,0.01513755,0.01357115,0.01198983,0.01273559,0.01043959,0.00926002,0.00860059,0.00796324,0.00757287,0.0076933,0.00743989,0.00753681,0.00739179,0.00817568,0.00774438,0.00766537,0.00762504,0.00925705,0.0085554,0.01072917,0.00896563,0.00909009,0.00947981,0.01034427,0.01034048,0.01393399,0.01281942,0.01488689,0.0113547,0.01132499,0.00780384,0.01339653,0.04655972,0.06526415,0.09848325])
            naiset_out=np.array([0.2,0.37069856,0.35665989,0.28622488,0.22178824,0.2,0.20947259,0.2,0.22598662,0.2014238,0.2,0.24501521,0.32836412,0.2,0.2589587,0.31137091,0.2,0.28384865,0.21388528,0.29644965,0.2,0.2,0.25488452,0.21570468,0.23643194,0.22805988,0.20495877,0.2,0.20759577,0.2,0.21926964,0.2,0.2,0.20460874,0.25243151,0.2,0.2,0.2,0.20617746,0.21666079,0.23408196,0.2,0.20125248,0.2,0.2414138,0.88988365,0.6107553,0.64318916,0.28692831,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.08093277,0.05327557,0.03159799,0.0152928,0.01322007,0.012279,0.0118906,0.01094251,0.01075301,0.01172623,0.01122059,0.01034773,0.00914118,0.00885251,0.01082303,0.0085011,0.0113181,0.00884027,0.00803366,0.01138004,0.00832432,0.00993181,0.00825267,0.00794059,0.00966746,0.00858239,0.01164856,0.00980651,0.00913105,0.00887306,0.0086753,0.01094295,0.00925473,0.00916112,0.0089847,0.00960907,0.01123888,0.00991262,0.01060939,0.01099494,0.01105753,0.01091901,0.01109883,0.01361504,0.01280562,0.01441446,0.01049923,0.01184292,0.00740403,0.01931477,0.03657255,0.04404508,0.05358667])
            miehet_out=np.array([0.2,0.2,0.69007141,0.34367897,0.2816787,0.24872873,0.29626805,0.24122673,0.2,0.2,0.29301207,0.36238446,0.2,0.29486645,0.2,0.35348658,0.2,0.2,0.27524471,0.2,0.2,0.2,0.21738577,0.21526104,0.2,0.2,0.2,0.2,0.23238111,0.2216095,0.20384756,0.2,0.21792889,0.22781249,0.20807812,0.2,0.2,0.22723685,0.2,0.2,0.27054598,0.23996746,0.25942154,0.2,0.27414314,0.91839063,0.47298839,0.69150977,0.22747198,0.2,1.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.04818875,0.01721354,0.01649487,0.01385045,0.01493752,0.01702715,0.01635749,0.02190145,0.02080873,0.02211461,0.02361613,0.02488794,0.02721413,0.02766436,0.02576921,0.02412186,0.02199857,0.02047536,0.01790183,0.01544959,0.01337713,0.01189145,0.01107199,0.01025718,0.00881945,0.00828057,0.00870505,0.00897908,0.00788944,0.0095808,0.00807762,0.00779928,0.00966859,0.00794189,0.00891622,0.00784721,0.00816508,0.00958605,0.00911973,0.0089679,0.01308273,0.01081888,0.01113747,0.01847932,0.01795916,0.01684726,0.01374971,0.01544986,0.00919781,0.01211505,0.04164803,0.07002378,0.09676445])
            naiset_out=np.array([0.2,0.28135689,0.39255717,0.26212437,0.2,0.2,0.20198348,0.2,0.2,0.22526086,0.21740413,0.23200249,0.2,0.26180573,0.22077236,0.24182494,0.22434558,0.31256803,0.2,0.28556869,0.2,0.22445836,0.2,0.27421002,0.21943738,0.26600319,0.2,0.2,0.22493338,0.2,0.23440602,0.25241813,0.2,0.267738,0.2,0.20809721,0.2,0.2,0.2,0.21039319,0.2,0.30636541,0.2,0.2,0.2,0.87110779,0.6041478,0.71851563,0.21116192,0.29270386,1.0,0.0,0.0])
            miehet_in=np.array([0.07678577,0.05214779,0.03160045,0.0159957,0.01326339,0.01251093,0.01191086,0.01209149,0.01088118,0.01075423,0.01016659,0.01036586,0.00956675,0.00938264,0.00881081,0.0083204,0.00803985,0.01091361,0.01120901,0.00874294,0.01058849,0.01123761,0.00883424,0.01031018,0.00871845,0.00854765,0.00901468,0.01092376,0.00904192,0.01024094,0.00914571,0.00903659,0.01022807,0.01105892,0.0096023,0.00918178,0.01129733,0.0108888,0.01023415,0.01183697,0.01123313,0.011433,0.01160411,0.01204515,0.01666467,0.01536172,0.01119405,0.01626282,0.00988043,0.01155168,0.02896379,0.05829619,0.05099297])
            miehet_out=np.array([0.2,0.2,0.66461094,0.37941723,0.26512142,0.26185828,0.20991183,0.30861362,0.23762029,0.26189328,0.20347225,0.28104046,0.29357007,0.2,0.2480284,0.2126512,0.23931468,0.2,0.2,0.26901878,0.2,0.2,0.23034196,0.2,0.21402513,0.21896566,0.2,0.2,0.23207021,0.2,0.21423075,0.23841546,0.2,0.2,0.25549925,0.22705244,0.2,0.2,0.22669837,0.2,0.2288134,0.28511592,0.2,0.2,0.2,0.90793963,0.39398423,0.70330214,0.46045549,0.2,1.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.05292256,0.01750036,0.01691198,0.01447573,0.01471096,0.0156654,0.01585881,0.01754919,0.02340029,0.02077623,0.02083558,0.02171934,0.02059431,0.01881693,0.01858696,0.0195151,0.01829413,0.01725306,0.01562272,0.01336461,0.0119053,0.01077552,0.01365969,0.00978515,0.00899341,0.00858642,0.00787912,0.00751071,0.0088586,0.00761172,0.0088657,0.0076065,0.00756657,0.00740616,0.00756783,0.0091613,0.00793852,0.00840022,0.01055831,0.00880526,0.01193877,0.01013033,0.01153145,0.01626043,0.0240468,0.01850403,0.01312574,0.01088288,0.00987963,0.0150996,0.04443502,0.06336293,0.1012035])
            naiset_out=np.array([0.2,0.27147024,0.3704787,0.31737643,0.2,0.2,0.2,0.2,0.2,0.2598532,0.22173443,0.27681092,0.31883932,0.20651673,0.2149801,0.2,0.2,0.23750018,0.26299921,0.25234047,0.21456614,0.29148484,0.2,0.22320929,0.28044291,0.2,0.23486446,0.22753595,0.2,0.24633416,0.2,0.20885073,0.23659595,0.2,0.2,0.2,0.23213148,0.2,0.2,0.23656626,0.2,0.20734843,0.2,0.2,0.2,0.87084035,0.81061779,0.43785401,0.40418594,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.08110862,0.05139424,0.03170343,0.01576139,0.01432729,0.01386155,0.01309388,0.0129411,0.01270171,0.01250646,0.01185441,0.01164048,0.01167356,0.01038841,0.01020722,0.00935404,0.0129547,0.00961691,0.01160626,0.01014739,0.00988385,0.01095481,0.00946891,0.00974302,0.00937503,0.00907738,0.00907371,0.00871926,0.01073578,0.00900237,0.01025936,0.00922496,0.00903192,0.00909494,0.01207014,0.00979101,0.00940717,0.00982112,0.01083065,0.01034568,0.01043592,0.01114552,0.01203989,0.01499024,0.01698,0.01608097,0.00980049,0.0088454,0.00768754,0.00703206,0.01574586,0.024846,0.04193139])
            miehet_out=np.array([0.2,0.2,0.67572848,0.29752823,0.24919303,0.26576246,0.23311954,0.23482191,0.23810693,0.26075093,0.23434227,0.20873656,0.31495823,0.20806993,0.27160161,0.24649968,0.2,0.25555591,0.2,0.2,0.2,0.2,0.22412849,0.2,0.2,0.20046117,0.22771241,0.23418341,0.2,0.22043004,0.2,0.22444974,0.2,0.20905035,0.2,0.25642111,0.2,0.2,0.2,0.22727799,0.20901531,0.2,0.2,0.2,0.2,0.85745888,0.77297705,0.34981865,0.45291958,0.34046096,1.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.0530054,0.01750282,0.01675128,0.01419512,0.01302161,0.01616689,0.01506764,0.01770752,0.02079366,0.01946149,0.01846607,0.01952394,0.01733575,0.01631006,0.01601703,0.01460268,0.01830794,0.01435996,0.01280002,0.0111893,0.01009431,0.01142852,0.0123092,0.00933917,0.00816886,0.00889921,0.00757028,0.00741761,0.00906425,0.00755865,0.00878664,0.00760914,0.00753802,0.00743288,0.0075689,0.00916403,0.00793759,0.00840535,0.01055049,0.00881297,0.01191382,0.01013884,0.01152327,0.01622822,0.02407541,0.01853627,0.0091286,0.00762145,0.00610768,0.01045833,0.02404965,0.03198032,0.04757119])
            naiset_out=np.array([0.2,0.28190483,0.37955783,0.31523848,0.2099056,0.2,0.23038824,0.2,0.2,0.31402288,0.2060127,0.34099557,0.28888405,0.21238457,0.31933859,0.2,0.2,0.24782805,0.24257864,0.24124128,0.22369931,0.2,0.2,0.27229928,0.24769192,0.2,0.20380443,0.23338845,0.2,0.23638131,0.2,0.21248874,0.23307022,0.2,0.2,0.2,0.23213148,0.2,0.2,0.23656626,0.2,0.20734843,0.2,0.2,0.2,0.87084035,0.81061779,0.43785401,0.40418594,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.08083668,0.05071885,0.03145952,0.01522904,0.01345909,0.01272396,0.01186337,0.01104226,0.01110121,0.01072129,0.00989428,0.01007201,0.0097997,0.00957354,0.00850852,0.00770722,0.01181409,0.00835733,0.01017449,0.00967453,0.01125331,0.01049593,0.0091432,0.0100085,0.00906601,0.00916538,0.00901033,0.00875574,0.01104406,0.00908158,0.0101527,0.00920713,0.00910426,0.00909173,0.01208597,0.009787,0.00941458,0.00980942,0.01083922,0.01035683,0.01043805,0.01115369,0.01204831,0.01502489,0.01694682,0.01608912,0.00923667,0.00833143,0.00768754,0.00703206,0.01574586,0.024846,0.04193139])
            miehet_out=np.array([0.2,0.2,0.69030244,0.32036826,0.27026626,0.2771306,0.28859288,0.20917881,0.25475507,0.28471784,0.24727609,0.2,0.35835101,0.2,0.27913985,0.2203689,0.2,0.21392773,0.2,0.2,0.2,0.2,0.20785643,0.2,0.20186546,0.2,0.21766452,0.23820134,0.2,0.22590906,0.2,0.22550408,0.2,0.20905035,0.2,0.25642111,0.2,0.2,0.2,0.22727799,0.20901531,0.2,0.2,0.2,0.2,0.85745888,0.77297705,0.34981865,0.45291958,0.34046096,1.0,0.0,0.0])
        elif self.year==2024:
            naiset_in=np.array([0.05411367,0.01774887,0.01659391,0.01334866,0.01139384,0.01063376,0.01109869,0.01102031,0.0135705,0.01302722,0.01190975,0.012127,0.00891965,0.00610909,0.00605306,0.0062426,0.01167188,0.00847228,0.0083264,0.00809877,0.0085852,0.00734251,0.01561528,0.00768055,0.00774165,0.00935571,0.00710734,0.00751625,0.00949462,0.0074965,0.00872019,0.00756432,0.00755584,0.00745241,0.00752108,0.00912557,0.00789932,0.00834416,0.01050147,0.00873624,0.01182364,0.00994155,0.01123563,0.01594379,0.0236362,0.01779372,0.01303475,0.01311433,0.00933527,0.01442585,0.04146116,0.05876566,0.09331904])
            naiset_out=np.array([0.2,0.31262492,0.42717326,0.39072365,0.31873504,0.23270813,0.28548765,0.24593216,0.2,0.3649622,0.2535156,0.50874756,0.55996385,0.2,0.33835281,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2231711,0.2,0.2,0.2094298,0.2,0.2,0.23178077,0.2,0.20524108,0.23722768,0.2,0.2,0.2,0.23213148,0.2,0.2,0.23656626,0.2,0.20734843,0.2,0.2,0.2,0.87084035,0.81061779,0.43785401,0.40418594,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.0809083,0.05087668,0.03151092,0.01551976,0.0137558,0.01297023,0.01213309,0.01129284,0.0111398,0.01110613,0.01050202,0.01047721,0.0100125,0.00962371,0.00854812,0.00777871,0.01260438,0.00839859,0.01100836,0.01017402,0.00918762,0.01097117,0.00903118,0.01034869,0.00883349,0.00930374,0.00883509,0.00859138,0.01119356,0.00904117,0.01004239,0.00918471,0.0089933,0.00903823,0.01204798,0.00974312,0.00936202,0.00975879,0.01079133,0.01026921,0.01030954,0.01095549,0.01183181,0.01469792,0.01655956,0.01564542,0.01235894,0.01229658,0.01033534,0.00967667,0.02216595,0.03576293,0.06168259])
            miehet_out=np.array([0.2,0.2,0.68144568,0.32104854,0.27332922,0.27483766,0.29132342,0.22501137,0.2265989,0.26314497,0.22027548,0.25665115,0.37174644,0.2,0.27907219,0.24712753,0.2,0.21352081,0.2,0.2,0.2,0.2,0.23428185,0.2,0.20297923,0.2,0.21698061,0.22777284,0.2,0.22082015,0.2,0.22444968,0.2014094,0.20747974,0.2,0.25642111,0.2,0.2,0.2,0.22727799,0.20901531,0.2,0.2,0.2,0.2,0.85745888,0.77297705,0.34981865,0.45291958,0.34046096,1.0,0.0,0.0])
        elif self.year==2025:
            naiset_in=np.array([0.05411367,0.01774887,0.01659391,0.01334866,0.01139384,0.01063376,0.01109869,0.01102031,0.0135705,0.01302722,0.01190975,0.012127,0.00891965,0.00610909,0.00605306,0.0062426,0.01167188,0.00847228,0.0083264,0.00809877,0.0085852,0.00734251,0.01561528,0.00768055,0.00774165,0.00935571,0.00710734,0.00751625,0.00949462,0.0074965,0.00872019,0.00756432,0.00755584,0.00745241,0.00752108,0.00912557,0.00789932,0.00834416,0.01050147,0.00873624,0.01182364,0.00994155,0.01123563,0.01594379,0.0236362,0.01779372,0.01303475,0.01311433,0.00933527,0.01442585,0.04146116,0.05876566,0.09331904])
            naiset_out=np.array([0.2,0.31262492,0.42717326,0.39072365,0.31873504,0.23270813,0.28548765,0.24593216,0.2,0.3649622,0.2535156,0.50874756,0.55996385,0.2,0.33835281,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2231711,0.2,0.2,0.2094298,0.2,0.2,0.23178077,0.2,0.20524108,0.23722768,0.2,0.2,0.2,0.23213148,0.2,0.2,0.23656626,0.2,0.20734843,0.2,0.2,0.2,0.87084035,0.81061779,0.43785401,0.40418594,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.0809083,0.05087668,0.03151092,0.01551976,0.0137558,0.01297023,0.01213309,0.01129284,0.0111398,0.01110613,0.01050202,0.01047721,0.0100125,0.00962371,0.00854812,0.00777871,0.01260438,0.00839859,0.01100836,0.01017402,0.00918762,0.01097117,0.00903118,0.01034869,0.00883349,0.00930374,0.00883509,0.00859138,0.01119356,0.00904117,0.01004239,0.00918471,0.0089933,0.00903823,0.01204798,0.00974312,0.00936202,0.00975879,0.01079133,0.01026921,0.01030954,0.01095549,0.01183181,0.01469792,0.01655956,0.01564542,0.01235894,0.01229658,0.01033534,0.00967667,0.02216595,0.03576293,0.06168259])
            miehet_out=np.array([0.2,0.2,0.68144568,0.32104854,0.27332922,0.27483766,0.29132342,0.22501137,0.2265989,0.26314497,0.22027548,0.25665115,0.37174644,0.2,0.27907219,0.24712753,0.2,0.21352081,0.2,0.2,0.2,0.2,0.23428185,0.2,0.20297923,0.2,0.21698061,0.22777284,0.2,0.22082015,0.2,0.22444968,0.2014094,0.20747974,0.2,0.25642111,0.2,0.2,0.2,0.22727799,0.20901531,0.2,0.2,0.2,0.2,0.85745888,0.77297705,0.34981865,0.45291958,0.34046096,1.0,0.0,0.0])
        elif self.year==2026:
            naiset_in=np.array([0.05411367,0.01774887,0.01659391,0.01334866,0.01139384,0.01063376,0.01109869,0.01102031,0.0135705,0.01302722,0.01190975,0.012127,0.00891965,0.00610909,0.00605306,0.0062426,0.01167188,0.00847228,0.0083264,0.00809877,0.0085852,0.00734251,0.01561528,0.00768055,0.00774165,0.00935571,0.00710734,0.00751625,0.00949462,0.0074965,0.00872019,0.00756432,0.00755584,0.00745241,0.00752108,0.00912557,0.00789932,0.00834416,0.01050147,0.00873624,0.01182364,0.00994155,0.01123563,0.01594379,0.0236362,0.01779372,0.01303475,0.01311433,0.00933527,0.01442585,0.04146116,0.05876566,0.09331904])
            naiset_out=np.array([0.2,0.31262492,0.42717326,0.39072365,0.31873504,0.23270813,0.28548765,0.24593216,0.2,0.3649622,0.2535156,0.50874756,0.55996385,0.2,0.33835281,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2,0.2231711,0.2,0.2,0.2094298,0.2,0.2,0.23178077,0.2,0.20524108,0.23722768,0.2,0.2,0.2,0.23213148,0.2,0.2,0.23656626,0.2,0.20734843,0.2,0.2,0.2,0.87084035,0.81061779,0.43785401,0.40418594,0.2,1.0,0.0,0.0])
            miehet_in=np.array([0.0809083,0.05087668,0.03151092,0.01551976,0.0137558,0.01297023,0.01213309,0.01129284,0.0111398,0.01110613,0.01050202,0.01047721,0.0100125,0.00962371,0.00854812,0.00777871,0.01260438,0.00839859,0.01100836,0.01017402,0.00918762,0.01097117,0.00903118,0.01034869,0.00883349,0.00930374,0.00883509,0.00859138,0.01119356,0.00904117,0.01004239,0.00918471,0.0089933,0.00903823,0.01204798,0.00974312,0.00936202,0.00975879,0.01079133,0.01026921,0.01030954,0.01095549,0.01183181,0.01469792,0.01655956,0.01564542,0.01235894,0.01229658,0.01033534,0.00967667,0.02216595,0.03576293,0.06168259])
            miehet_out=np.array([0.2,0.2,0.68144568,0.32104854,0.27332922,0.27483766,0.29132342,0.22501137,0.2265989,0.26314497,0.22027548,0.25665115,0.37174644,0.2,0.27907219,0.24712753,0.2,0.21352081,0.2,0.2,0.2,0.2,0.23428185,0.2,0.20297923,0.2,0.21698061,0.22777284,0.2,0.22082015,0.2,0.22444968,0.2014094,0.20747974,0.2,0.25642111,0.2,0.2,0.2,0.22727799,0.20901531,0.2,0.2,0.2,0.2,0.85745888,0.77297705,0.34981865,0.45291958,0.34046096,1.0,0.0,0.0])
        else:
            print("Error: Unknown year in ['outsider in', 'outsider out']")
    
        min_age=18
        max_spv=71
        in_m=self.get_w(0,1.5,1.0)
        out_m=self.get_w(0,0.8,1.0)
        in_n=self.get_w(0,1.25,1.0)
        out_n=self.get_w(0,0.85,1.0)
        
        inrate[min_age:max_spv,0]=1.5*miehet_in
        inrate[min_age:max_spv,1]=1.0*miehet_in
        inrate[min_age:max_spv,2]=in_m*miehet_in
        inrate[min_age:max_spv,3]=1.25*naiset_in
        inrate[min_age:max_spv,4]=1.0*naiset_in
        inrate[min_age:max_spv,5]=in_n*naiset_in
        outrate[min_age:max_spv,0]=0.8*miehet_out
        outrate[min_age:max_spv,1]=1.0*miehet_out
        outrate[min_age:max_spv,2]=out_m*miehet_out
        outrate[min_age:max_spv,3]=0.85*naiset_out
        outrate[min_age:max_spv,4]=1.0*naiset_out
        outrate[min_age:max_spv,5]=out_n*naiset_out

        #inrate=1-(1-inrate)**self.timestep
        inrate = self.scale_rates(inrate)
        #outrate=1-(1-outrate)**self.timestep
        outrate = self.scale_rates(outrate)

        ra=int(retirementage)

        outrate[ra:max_spv,0]=1.0
        outrate[ra:max_spv,1]=1.0
        outrate[ra:max_spv,2]=1.0
        outrate[ra:max_spv,3]=1.0
        outrate[ra:max_spv,4]=1.0
        outrate[ra:max_spv,5]=1.0

        inrate[ra:max_spv,0]=0.0
        inrate[ra:max_spv,1]=0.0
        inrate[ra:max_spv,2]=0.0
        inrate[ra:max_spv,3]=0.0
        inrate[ra:max_spv,4]=0.0
        inrate[ra:max_spv,5]=0.0

        return inrate,outrate           

    def get_outsider_rate_v9(self,retirementage,debug=False):
        '''
        työelämän ulkopuolelle jäävien osuudet
        '''
        inrate=np.zeros((101,self.n_groups))
        outrate=np.zeros((101,self.n_groups))
                                                                        
        ### ['outsider in', 'outsider out']
        if self.year==2018:
            naiset_in=np.array([0.07004784,0.01971005,0.01515786,0.01146088,0.00996305,0.00931081,0.01047805,0.01517076,0.01071916,0.0125965,0.01071613,0.00939645,0.00856628,0.00640544,0.00549405,0.00368984,0.0031397,0.00253012,0.00585443,0.00764433,0.00798743,0.00920543,0.00527156,0.00890712,0.01247102,0.00923649,0.01027035,0.01005247,0.00828014,0.00974971,0.00856371,0.00839497,0.00828686,0.00864882,0.00810125,0.01022093,0.0095759,0.00879972,0.00922848,0.00906932,0.00978247,0.00941885,0.00973746,0.00953611,0.0101212,0.00863656,0.00857074,0.00838476,0.00807036,0.00849802,0.05142857,0.15935829,0.18881988])
            naiset_out=np.array([0.19200415,0.41536091,0.42835152,0.32248499,0.2547246,0.25341234,0.14656097,0.13361497,0.21414226,0.11787401,0.2483194,0.20868764,0.35851832,0.24008092,0.41919494,0.43154551,0.11333092,0.22929881,0.13558881,0.14622707,0.15489803,0.16362196,0.20299627,0.18130775,0.18554675,0.19037046,0.19276742,0.19492496,0.23581753,0.19551035,0.19567527,0.20992126,0.2422002,0.19364058,0.20676198,0.19285991,0.1883642,0.18679594,0.18128892,0.20168608,0.17174551,0.16346186,0.22186556,0.2088388,0.60894236,0.60071212,0.56860225,0.42041854,0.26674478,0.172564,0.11041011,0.10197494,0.09309354])
            miehet_in=np.array([0.0836975,0.07045211,0.03488921,0.01490167,0.01213352,0.01118242,0.0105607,0.01022634,0.01021807,0.0101071,0.00973495,0.00967659,0.01097709,0.00980993,0.008835,0.01076506,0.00916065,0.00991929,0.00820308,0.01067562,0.00915391,0.00923207,0.00868036,0.01022524,0.00873991,0.01096572,0.00908074,0.00932166,0.009303,0.00921635,0.01178509,0.00928957,0.01170738,0.00972438,0.01214747,0.01003792,0.01107637,0.0111222,0.01174243,0.01076717,0.01040972,0.01039974,0.01019888,0.01015887,0.00983458,0.00789659,0.00635883,0.00717657,0.00677233,0.00811223,0.05010526,0.16376812,0.2])
            miehet_out=np.array([0.19606582,0.19192953,0.72748406,0.36835407,0.26426285,0.24186528,0.21613798,0.17684739,0.18775975,0.20837804,0.1755928,0.1843733,0.16204073,0.27236628,0.16251288,0.1663633,0.31105158,0.17222832,0.21071971,0.1802458,0.18300687,0.18604616,0.24330542,0.19339706,0.19392248,0.19439376,0.19604978,0.19550734,0.19589669,0.26317009,0.19533896,0.21922558,0.193866,0.23386114,0.19363687,0.26061699,0.18911327,0.18515374,0.18424368,0.23117624,0.19671236,0.2227191,0.20668282,0.29136381,0.64012128,0.69551891,0.36129873,0.37621727,0.12834992,0.23054359,0.09811724,0.09059769,0.08307815])
        elif self.year==2019:
            naiset_in=np.array([0.06564637,0.01902217,0.01448823,0.01082045,0.01109212,0.01004215,0.01026283,0.01365412,0.01827479,0.01276322,0.01373995,0.01327371,0.01281736,0.01164274,0.01120542,0.00909248,0.00829482,0.01071429,0.00748391,0.01288711,0.01209118,0.00881675,0.0097019,0.008263,0.00770188,0.01115443,0.00904404,0.00893885,0.00886527,0.00853667,0.00884556,0.00835272,0.00912228,0.00853821,0.00828153,0.01223007,0.01029054,0.00943753,0.01141329,0.00970092,0.00975177,0.01126902,0.01468933,0.01621651,0.01372193,0.01207236,0.00898899,0.00867883,0.00927186,0.00933135,0.03062857,0.06219239,0.08945869])
            naiset_out=np.array([0.19178804,0.42423335,0.43663502,0.31790591,0.16538567,0.20882335,0.14916768,0.14055882,0.12859735,0.14423108,0.11308722,0.15654926,0.20344343,0.14903259,0.28454863,0.18295258,0.27236472,0.12223616,0.25254045,0.1494872,0.15937634,0.16592301,0.17355635,0.23045181,0.19233187,0.19119576,0.19237129,0.19355147,0.19523512,0.23414426,0.1951638,0.2020788,0.19352296,0.22722834,0.19948744,0.19291497,0.19125084,0.23345795,0.18379165,0.18341401,0.1847578,0.16497039,0.15875277,0.15249305,0.48229716,0.78029139,0.51721906,0.57910774,0.11193013,0.21356326,0.08947868,0.07691874,0.06346934])
            miehet_in=np.array([0.09133574,0.05990905,0.0338092,0.01564472,0.01256785,0.01223247,0.01119321,0.01060807,0.01281032,0.01101086,0.0104177,0.01004189,0.01177723,0.00992917,0.00965382,0.01193703,0.00939804,0.00894238,0.01047202,0.00866136,0.01100149,0.00989391,0.00902219,0.00847837,0.00913585,0.011478,0.00893393,0.01053995,0.00920157,0.00911616,0.00907905,0.0105397,0.00930132,0.00924274,0.01070782,0.01225851,0.01006356,0.01208681,0.01019637,0.01032538,0.01046838,0.01028185,0.00957509,0.00939666,0.01025721,0.00968636,0.0068869,0.00636284,0.01086562,0.00872255,0.02274368,0.03031915,0.03450586])
            miehet_out=np.array([0.19721172,0.1924252,0.69326074,0.37762103,0.21809037,0.26648935,0.2388575,0.19030961,0.17370978,0.22632972,0.20989953,0.22161532,0.16444414,0.19116557,0.25971845,0.16670573,0.21443329,0.24735643,0.17537279,0.21606631,0.18481606,0.18676864,0.24964428,0.23174102,0.19563285,0.19571413,0.2142459,0.19505279,0.20498807,0.20425727,0.21391459,0.19491274,0.20795392,0.2324952,0.19255389,0.19258175,0.24917753,0.18798471,0.1865277,0.23838663,0.17404662,0.26833782,0.2299198,0.15122064,0.4511587,0.806599,0.50547391,0.39477297,0.11144337,0.16966804,0.09571495,0.08785075,0.07998654])
        elif self.year==2020:
            naiset_in=np.array([0.0638432,0.01794411,0.01470897,0.01157992,0.01037943,0.01252044,0.01212171,0.01338389,0.01278498,0.01256116,0.01449252,0.01224671,0.01169219,0.01062379,0.00844724,0.00980561,0.01333678,0.00869865,0.01445535,0.00738492,0.00714585,0.00824829,0.0090641,0.00724939,0.00721824,0.00679412,0.0082627,0.0081868,0.00714409,0.00707865,0.00728586,0.00810547,0.00744627,0.00740978,0.00740087,0.00899618,0.00825592,0.01038742,0.00828282,0.00831311,0.00833251,0.0088908,0.00857395,0.01178575,0.00997305,0.01132976,0.00778676,0.00779265,0.00532909,0.01022503,0.02938689,0.03953488,0.05720721])
            naiset_out=np.array([0.19104065,0.36957765,0.39964086,0.27983572,0.18993734,0.15863943,0.1512542,0.13744206,0.13141584,0.22421433,0.11274488,0.17464578,0.20459889,0.3150887,0.21105695,0.10612847,0.11353233,0.42395904,0.1326867,0.15287083,0.17375329,0.16430525,0.17240942,0.21690624,0.18782386,0.21072961,0.19344023,0.1943581,0.20612262,0.19913772,0.196025,0.1949679,0.1949491,0.19776479,0.24618272,0.192169,0.19158833,0.18991993,0.19043796,0.1978696,0.20538785,0.16445849,0.15971765,0.15201634,0.18613202,0.82645446,0.53832943,0.56091731,0.1939612,0.09548835,0.08309452,0.0698514,0.055759])
            miehet_in=np.array([0.08127843,0.05256221,0.03036412,0.01481352,0.0124702,0.0118955,0.01172959,0.01050108,0.01211824,0.0132486,0.01080666,0.00912507,0.00884368,0.00780596,0.0074567,0.007197,0.00718091,0.01323925,0.00810123,0.01045781,0.00768167,0.00998121,0.01093626,0.00836772,0.00869758,0.00876754,0.01250447,0.00970016,0.00891261,0.0086707,0.0086177,0.01057518,0.00899637,0.00887143,0.00867027,0.00919681,0.0108906,0.00936528,0.01001691,0.01005891,0.00983004,0.00934089,0.00930218,0.01152753,0.01013802,0.01115361,0.00729219,0.00852541,0.00530973,0.01651442,0.02502085,0.02945545,0.03504823])
            miehet_out=np.array([0.19454714,0.19301008,0.66971742,0.3450885,0.23772851,0.20014318,0.28809097,0.26696767,0.17413804,0.16986712,0.32987392,0.1881455,0.28663802,0.25071087,0.16381711,0.21580093,0.16819427,0.17166666,0.30401376,0.17964815,0.23945844,0.18640072,0.18913293,0.33327047,0.1946461,0.19664584,0.19648598,0.195396,0.22970123,0.21679618,0.19599678,0.19539776,0.20965804,0.22180123,0.20145223,0.19136463,0.19178992,0.2161485,0.18641989,0.18019533,0.24545409,0.20690772,0.22017819,0.15434084,0.22202036,0.85951013,0.40735016,0.61911382,0.14831831,0.1140886,0.10733088,0.10057315,0.09381543])
        elif self.year==2021:
            naiset_in=np.array([0.04765074,0.0159321,0.01469004,0.01220926,0.01136782,0.01444004,0.01519211,0.01317378,0.01354389,0.01546279,0.01413973,0.01427189,0.02067768,0.01571148,0.01396833,0.01340612,0.01199779,0.01106597,0.01037546,0.01296859,0.00972029,0.01081839,0.00910359,0.00846094,0.00721559,0.00708397,0.00757389,0.01126659,0.00763363,0.00894072,0.00780926,0.00769637,0.00954098,0.00773954,0.00860742,0.00755869,0.00780415,0.00922988,0.0086747,0.0082466,0.0120388,0.00917288,0.00931965,0.01626718,0.01478443,0.01267322,0.00936708,0.01032201,0.00615322,0.00777749,0.0256262,0.04125561,0.05454545])
            naiset_out=np.array([0.19225597,0.27501638,0.34827987,0.25478612,0.18441684,0.16122635,0.151579,0.14693828,0.15846003,0.11882917,0.17218989,0.09687051,0.08979254,0.21153282,0.12939816,0.19692651,0.16065896,0.13419165,0.2066908,0.14041577,0.28403357,0.162835,0.16883894,0.31538246,0.18930535,0.24139601,0.19305091,0.19472039,0.21442123,0.19536703,0.21220478,0.25654672,0.19517035,0.26248433,0.19249706,0.20091279,0.1910613,0.19054023,0.18748612,0.19245969,0.17523679,0.27069423,0.15785569,0.15044809,0.14254348,0.80489191,0.5283178,0.63221677,0.11353943,0.18290299,0.07716599,0.0632781,0.04853545])
            miehet_in=np.array([0.08391869,0.05539081,0.02333481,0.01406214,0.01232148,0.01154905,0.0117323,0.01049508,0.00955863,0.00907201,0.01280984,0.00915824,0.0084334,0.00798023,0.00746119,0.00718923,0.00686261,0.01581904,0.00762968,0.01314682,0.00794488,0.01027869,0.00865148,0.01064231,0.00845133,0.00806998,0.00950171,0.01185779,0.00863618,0.01075521,0.00888329,0.00869304,0.00977803,0.01143803,0.00908559,0.00872191,0.01110752,0.01058152,0.00947043,0.01126384,0.00980677,0.00946644,0.00985148,0.00980381,0.01445474,0.0076067,0.00709384,0.0087569,0.00610299,0.00891913,0.0,0.0,0.0])
            miehet_out=np.array([0.19489684,0.19273285,0.65470674,0.35845266,0.24597944,0.24978729,0.18207433,0.31769478,0.21804254,0.23445153,0.16836747,0.25825437,0.22311789,0.2230165,0.23401495,0.16712472,0.24827448,0.17121261,0.31506098,0.17955877,0.21502721,0.18636668,0.19004814,0.19229134,0.25241625,0.22718469,0.19756448,0.19690391,0.24265442,0.19577782,0.20632831,0.24104474,0.19507656,0.19470065,0.24940291,0.21992501,0.18988604,0.19095091,0.21375053,0.18462411,0.20331466,0.25409338,0.16149494,0.15510564,0.14772602,0.84828604,0.32695102,0.62888931,0.37866304,0.11082794,0.10344832,0.0960687,0.08868908])
        elif self.year==2022:
            naiset_in=np.array([0.05295866,0.01644888,0.01526092,0.0126836,0.01198017,0.01200358,0.01331794,0.01452026,0.01722704,0.01438759,0.01477464,0.01402234,0.01259841,0.01252312,0.01243393,0.01333178,0.01466799,0.01223962,0.01110827,0.01021192,0.01016648,0.00935178,0.01319994,0.00896217,0.0082846,0.00773188,0.0075128,0.00727266,0.0089718,0.00744139,0.00875583,0.00745624,0.00740234,0.00721306,0.00734114,0.00887372,0.00764837,0.00802396,0.01010765,0.00819609,0.01099148,0.00870592,0.00957916,0.01382638,0.02079348,0.0135941,0.00910924,0.00710114,0.00610768,0.01045833,0.02404965,0.03198032,0.04757119])
            naiset_out=np.array([0.19213987,0.26597059,0.35554117,0.28066845,0.17008348,0.16560116,0.15678501,0.1479065,0.13606992,0.20889959,0.11831152,0.22742041,0.11183004,0.12382045,0.15769217,0.10800587,0.11790666,0.19917743,0.19044514,0.1973363,0.15373114,0.2818779,0.17148419,0.23411207,0.23809319,0.21064568,0.21736359,0.22544273,0.19538353,0.2399329,0.19571618,0.20825674,0.22891893,0.19460187,0.19454305,0.19230785,0.22461658,0.19006926,0.1883749,0.22193282,0.17651909,0.17506381,0.15610699,0.14804002,0.13870838,0.79773859,0.72322736,0.33369642,0.28078268,0.05487256,0.03066987,0.00398867,0.0])
            miehet_in=np.array([0.08099981,0.05096074,0.03036286,0.01519656,0.01350278,0.01295321,0.01227169,0.01174644,0.01148297,0.01112252,0.01037605,0.0101101,0.00978595,0.0091051,0.0087891,0.00841999,0.01071471,0.00845111,0.00972475,0.00916074,0.00971716,0.01017579,0.00893281,0.00985306,0.0089289,0.00883241,0.00877974,0.00856667,0.01114829,0.00887309,0.0099515,0.00901258,0.00880547,0.00884986,0.01184748,0.00947644,0.00906183,0.00933252,0.01037386,0.00960848,0.00944285,0.0096172,0.01023139,0.01278098,0.01409632,0.0125095,0.009303,0.0079208,0.00768754,0.00703206,0.01574586,0.024846,0.04193139])
            miehet_out=np.array([0.19522188,0.19202232,0.660492,0.29698239,0.23066462,0.23797014,0.22941258,0.20212659,0.20594371,0.2395748,0.19709392,0.20209185,0.27448884,0.16219498,0.20430063,0.22882963,0.16846149,0.22801206,0.17530735,0.17998234,0.18423892,0.18618667,0.22027434,0.19291416,0.19464841,0.20306527,0.21752688,0.2312548,0.19703733,0.21941661,0.1957074,0.21909577,0.19552988,0.20398586,0.19425135,0.24990961,0.1922415,0.18927301,0.18990416,0.21194957,0.18814701,0.16815929,0.16370045,0.15714952,0.15026901,0.80051221,0.77297705,0.34981865,0.45291958,0.34046096,0.2,0.2,0.2])
        elif self.year==2023:
            naiset_in=np.array([0.06147311,0.018228,0.0159265,0.01341377,0.01208665,0.01089947,0.01579578,0.01205827,0.01129863,0.01086464,0.01100239,0.01049296,0.01062651,0.00986107,0.01100912,0.0176535,0.01080662,0.00971562,0.01130704,0.01181158,0.00931453,0.00904861,0.00854294,0.01053267,0.00967186,0.00832106,0.00777208,0.007216,0.00902972,0.00732426,0.007938,0.00934936,0.00786813,0.00758222,0.00739033,0.00860553,0.008036,0.00771256,0.00906104,0.00802571,0.0098204,0.00852547,0.01079929,0.01368375,0.0187149,0.01307957,0.01195615,0.00994286,0.00769627,0.0090623,0.02404159,0.04028777,0.05036603])
            naiset_out=np.array([0.1929843,0.32096682,0.34346057,0.28463013,0.29267387,0.18291776,0.16011023,0.22999372,0.19382076,0.14745222,0.18641214,0.11473445,0.1981669,0.21006017,0.10509371,0.11281952,0.20617422,0.20963761,0.13622467,0.14767673,0.20499494,0.16653195,0.25155915,0.18008352,0.18710169,0.25350839,0.25503908,0.23139571,0.19584468,0.206331,0.19454595,0.19442067,0.23052828,0.22505384,0.21246631,0.19227415,0.1926223,0.21179276,0.18831905,0.18514583,0.17755796,0.1737838,0.15733493,0.1495889,0.14069967,0.56142541,0.8413453,0.55094895,0.25543173,0.33322512,0.2,0.2,0.2])
            miehet_in=np.array([0.11601955,0.039567,0.03523336,0.01814862,0.01416097,0.01297462,0.01297301,0.01218918,0.01140536,0.01012959,0.00985937,0.00849689,0.01208143,0.00908765,0.0078873,0.00759692,0.01354359,0.00793109,0.00997297,0.01166694,0.01038828,0.01046171,0.0094098,0.01099024,0.01316495,0.0100865,0.00988899,0.00988486,0.01000628,0.00965115,0.01049113,0.01002192,0.00986755,0.00965981,0.01005031,0.01039522,0.00967754,0.0099573,0.01097337,0.01063237,0.01030122,0.00968882,0.01270349,0.01101189,0.01742195,0.01304697,0.01111348,0.01079116,0.008517,0.00942331,0.02065728,0.0265748,0.03589041])
            miehet_out=np.array([0.19629174,0.1926143,0.64010139,0.40542882,0.27327627,0.18822673,0.25141931,0.25321412,0.29295124,0.20113129,0.31480843,0.19348324,0.1654606,0.29501137,0.20480181,0.28827421,0.16725106,0.1762435,0.17636731,0.18137984,0.18376125,0.1867893,0.22607596,0.19204955,0.19360227,0.21672575,0.27707568,0.19849678,0.1976994,0.19756198,0.19474171,0.19440826,0.21245227,0.24444534,0.19276106,0.19338181,0.22886201,0.19082392,0.19006341,0.18429473,0.2485354,0.17408548,0.16559246,0.18604439,0.15326973,0.61956862,0.80007626,0.63345801,0.2,0.37924118,0.2,0.2,0.2])
        elif self.year==2024:
            naiset_in=np.array([0.061287,0.0182687,0.01592489,0.012743,0.01095566,0.01024062,0.00972951,0.00980847,0.00943706,0.00947883,0.00958228,0.00751289,0.00753048,0.00578101,0.00509907,0.00439295,0.00996156,0.00620844,0.00681535,0.0054763,0.00998699,0.01080918,0.00824135,0.0107582,0.00749455,0.00765962,0.00770048,0.00728426,0.00941926,0.00737889,0.00768043,0.00950669,0.00787368,0.00757247,0.0073688,0.00860514,0.00807467,0.00772828,0.00905377,0.00800119,0.009864,0.00855096,0.01078322,0.01372753,0.01873379,0.01310122,0.01177472,0.01001954,0.00769627,0.0090623,0.02404159,0.04028777,0.05036603])
            naiset_out=np.array([0.19345863,0.32071951,0.38730141,0.33145792,0.25594914,0.23379876,0.16789962,0.20690366,0.16031806,0.14881545,0.3535765,0.1374922,0.35401024,0.23342202,0.24872051,0.14874025,0.11373275,0.12352811,0.132563,0.18373053,0.15393232,0.16458889,0.17242717,0.17950458,0.20740192,0.19004082,0.19358338,0.24583778,0.19572326,0.2071364,0.19512354,0.19485544,0.23410374,0.22552049,0.21116774,0.19309023,0.19336811,0.21262085,0.1895962,0.18678081,0.18002634,0.17778994,0.16304276,0.1564044,0.1488103,0.57114433,0.77002636,0.46709488,0.15739551,0.21935974,0.06865845,0.04953526,0.02876507])
            miehet_in=np.array([0.11538921,0.03935357,0.0351262,0.01789619,0.01422514,0.01295867,0.01236142,0.01175214,0.01164081,0.01041568,0.00992332,0.00940477,0.00892917,0.00886727,0.00765813,0.00759998,0.00890708,0.00998077,0.01039566,0.01170471,0.01092684,0.00941868,0.01107698,0.00938296,0.01215562,0.00984341,0.00977151,0.0093435,0.00938522,0.00999431,0.01035876,0.01003318,0.00980086,0.00965025,0.01011194,0.01036364,0.00970602,0.00993831,0.01101864,0.01060291,0.01032168,0.00972179,0.01273691,0.01099783,0.01734146,0.0130855,0.01098068,0.01071618,0.008517,0.00942331,0.02065728,0.0265748,0.03589041])
            miehet_out=np.array([0.19662523,0.19301413,0.64695992,0.38901445,0.27852546,0.23883946,0.23836901,0.19791917,0.28354896,0.22675262,0.23114618,0.21667435,0.17959636,0.30167383,0.17089916,0.20389032,0.16585149,0.17135392,0.1752947,0.18100335,0.18329251,0.22208018,0.18873792,0.19937098,0.1937151,0.20006097,0.24105846,0.20976615,0.19776199,0.19781443,0.1954126,0.19504849,0.21062365,0.24513,0.19361801,0.19424397,0.22974471,0.19199925,0.19128093,0.18631967,0.25103147,0.17776552,0.16984779,0.19105916,0.15903196,0.62614739,0.74740439,0.57493422,0.1356243,0.30901356,0.12392047,0.11806855,0.11221664])
        elif self.year==2025:
            naiset_in=np.array([0.06130769,0.01829803,0.01579331,0.01255603,0.01084108,0.01020424,0.01002033,0.00998097,0.00971769,0.00975341,0.00981918,0.00806001,0.00818268,0.00615884,0.00736233,0.00578623,0.01199642,0.00686059,0.00932107,0.00946159,0.00891331,0.01141775,0.00793017,0.00849749,0.00801065,0.0086677,0.00771729,0.00742676,0.00903058,0.00741422,0.00812385,0.00945887,0.0078752,0.00757189,0.00738359,0.00859548,0.00807487,0.00773627,0.00904316,0.00800972,0.00986255,0.0085471,0.01077582,0.013727,0.0187698,0.0131235,0.01178928,0.01001592,0.00769627,0.0090623,0.02404159,0.04028777,0.05036603])
            naiset_out=np.array([0.19210079,0.33020181,0.38786411,0.32784926,0.24380096,0.19763764,0.17175923,0.18157152,0.15935545,0.11527286,0.30043789,0.10736255,0.35296854,0.23477694,0.09535319,0.18038665,0.11219437,0.12016327,0.12631522,0.14009068,0.14896534,0.16484235,0.19391081,0.17959004,0.18644218,0.18989237,0.22503266,0.24744709,0.19644051,0.22347319,0.19531577,0.19491925,0.23415599,0.22504332,0.21255287,0.1931316,0.19330154,0.21261311,0.18960922,0.18676559,0.18002955,0.17780357,0.16307226,0.15643802,0.14885613,0.57120114,0.77009293,0.46716998,0.15747792,0.21944824,0.0687518,0.04963225,0.02886447])
            miehet_in=np.array([0.11574639,0.03926601,0.03518029,0.01784354,0.01441921,0.01343717,0.0128722,0.0124563,0.01235722,0.01110755,0.01067657,0.01045574,0.01090475,0.00988178,0.00881835,0.00872971,0.00920741,0.01089645,0.00944104,0.01126959,0.01062915,0.00955576,0.0104147,0.00939163,0.01262675,0.00997025,0.00991284,0.00945202,0.00934421,0.00987121,0.01042839,0.01004947,0.00982101,0.00965494,0.01006782,0.0103848,0.00969913,0.00992836,0.0110045,0.01058651,0.01032331,0.00969401,0.01271063,0.0110025,0.01735392,0.01309181,0.01098868,0.01069955,0.008517,0.00942331,0.02065728,0.0265748,0.03589041])
            miehet_out=np.array([0.1959504,0.192847,0.64775719,0.3741029,0.25458801,0.23138974,0.21703976,0.18995043,0.27463347,0.20935937,0.19447491,0.24771054,0.16312248,0.27341149,0.17480083,0.24667672,0.16836508,0.17210439,0.17487252,0.18005031,0.18459644,0.21972756,0.19000158,0.19635565,0.19419549,0.19804484,0.24525392,0.20830375,0.20260595,0.19798085,0.19549042,0.19508913,0.21153636,0.24512645,0.19367659,0.19423187,0.22972795,0.19200767,0.19129274,0.1863424,0.25102847,0.17784897,0.16991977,0.19114619,0.15913507,0.62627703,0.74756056,0.57511692,0.13583352,0.30924931,0.12418275,0.11835736,0.11253198])
        elif self.year==2026:
            naiset_in=np.array([0.05532985,0.01826592,0.01560432,0.01199544,0.0099536,0.00890528,0.0082572,0.00813002,0.00893888,0.00922207,0.00877013,0.00767773,0.00742864,0.00591066,0.01130304,0.00971249,0.00729596,0.00828657,0.0093332,0.00737011,0.00965231,0.00987658,0.0077499,0.01153701,0.00869942,0.00800546,0.00784841,0.00754499,0.00858293,0.00739204,0.00803608,0.0091751,0.00786563,0.007568,0.00738405,0.0086067,0.00808374,0.0077259,0.00906547,0.00799755,0.00985843,0.00854675,0.01077755,0.013733,0.01876185,0.01313345,0.01177237,0.00994337,0.00769627,0.0090623,0.02404159,0.04028777,0.05036603])
            naiset_out=np.array([0.19210079,0.34010832,0.41672454,0.36090664,0.29128997,0.254394,0.18096789,0.16099062,0.12743989,0.1152728,0.24360965,0.1537362,0.30946069,0.19925648,0.09535319,0.10627575,0.1121966,0.12016266,0.12631612,0.1420144,0.14896627,0.16484235,0.20452277,0.17959103,0.18643887,0.20304117,0.22511643,0.25076833,0.1964453,0.20777761,0.19530839,0.19492394,0.23418545,0.22446019,0.21255261,0.19312223,0.19329387,0.21262315,0.18958183,0.18678731,0.18003875,0.17780478,0.16306535,0.15643623,0.14884846,0.57119492,0.7700955,0.46718866,0.15752004,0.21952113,0.0688628,0.04978868,0.02907365])
            miehet_in=np.array([0.11580942,0.039804,0.03526949,0.01808092,0.0145838,0.013383,0.0130551,0.01263955,0.01237798,0.01125882,0.01086395,0.01028522,0.00962396,0.00941485,0.008358,0.00826152,0.00847573,0.01080493,0.00955457,0.01104387,0.01142757,0.00956566,0.00993872,0.00966813,0.01248486,0.01001531,0.00995394,0.00946517,0.00936919,0.009918,0.01041092,0.01011723,0.00983381,0.00965839,0.01006875,0.01037332,0.00970077,0.00994493,0.01099321,0.0106103,0.01031859,0.00971074,0.01270552,0.01102718,0.01735689,0.01307522,0.01098317,0.01080702,0.008517,0.00942331,0.02065728,0.0265748,0.03589041])
            miehet_out=np.array([0.1959504,0.19284822,0.64201198,0.37577815,0.26825479,0.21441631,0.21481496,0.20585486,0.26126565,0.20630714,0.22789555,0.23034087,0.18974771,0.2767405,0.1769446,0.21037719,0.16836539,0.17210459,0.17487022,0.18004975,0.1845962,0.20527185,0.19000192,0.19318831,0.19419807,0.19939794,0.24729277,0.21835866,0.19817124,0.19797921,0.19548851,0.19508806,0.21246373,0.24512466,0.19367598,0.19423843,0.22972685,0.19199364,0.19130217,0.18630943,0.25103716,0.17779872,0.16993376,0.19116132,0.15916222,0.6263088,0.74759694,0.57515792,0.13587914,0.30929954,0.12423759,0.11841682,0.11259605])
        else:
            print("Error: Unknown year in ['outsider in', 'outsider out']")
    
        min_age=18
        max_spv=71
        in_m=self.get_w(0,1.5,1.0)
        out_m=self.get_w(0,0.8,1.0)
        in_n=self.get_w(0,1.25,1.0)
        out_n=self.get_w(0,0.85,1.0)
        
        inrate[min_age:max_spv,0]=1.5*miehet_in
        inrate[min_age:max_spv,1]=1.0*miehet_in
        inrate[min_age:max_spv,2]=in_m*miehet_in
        inrate[min_age:max_spv,3]=1.25*naiset_in
        inrate[min_age:max_spv,4]=1.0*naiset_in
        inrate[min_age:max_spv,5]=in_n*naiset_in
        outrate[min_age:max_spv,0]=0.8*miehet_out
        outrate[min_age:max_spv,1]=1.0*miehet_out
        outrate[min_age:max_spv,2]=out_m*miehet_out
        outrate[min_age:max_spv,3]=0.85*naiset_out
        outrate[min_age:max_spv,4]=1.0*naiset_out
        outrate[min_age:max_spv,5]=out_n*naiset_out

        #inrate=1-(1-inrate)**self.timestep
        inrate = self.scale_rates(inrate)
        #outrate=1-(1-outrate)**self.timestep
        outrate = self.scale_rates(outrate)

        ra=int(retirementage)

        outrate[ra:max_spv,0]=1.0
        outrate[ra:max_spv,1]=1.0
        outrate[ra:max_spv,2]=1.0
        outrate[ra:max_spv,3]=1.0
        outrate[ra:max_spv,4]=1.0
        outrate[ra:max_spv,5]=1.0

        inrate[ra:max_spv,0]=0.0
        inrate[ra:max_spv,1]=0.0
        inrate[ra:max_spv,2]=0.0
        inrate[ra:max_spv,3]=0.0
        inrate[ra:max_spv,4]=0.0
        inrate[ra:max_spv,5]=0.0

        return inrate,outrate      

    def get_outsider_rate_v10(self,retirementage,debug=False,R70=False):   
        '''
        työelämän ulkopuolelle jäävien osuudet
        '''
        inrate=np.zeros((101,self.n_groups))
        outrate=np.zeros((101,self.n_groups))
                                                                        
        ### ['outsider in', 'outsider out']
        if self.year==2018:
            naiset_in=np.array([0.07004784,0.01971005,0.01515786,0.01146088,0.00996305,0.00931081,0.01047805,0.01517076,0.01071916,0.0125965,0.01071613,0.00939645,0.00856628,0.00640544,0.00549405,0.00368984,0.0031397,0.00253012,0.00585443,0.00764433,0.00798743,0.00920543,0.00527156,0.00890712,0.01247102,0.00923649,0.01027035,0.01005247,0.00828014,0.00974971,0.00856371,0.00839497,0.00828686,0.00864882,0.00810125,0.01022093,0.0095759,0.00879972,0.00922848,0.00906932,0.00978247,0.00941885,0.00973746,0.00953611,0.0101212,0.00863656,0.00857074,0.00838476,0.00807036,0.00849802,0.05142857,0.15935829,0.18881988])
            naiset_out=np.array([0.19200415,0.41536091,0.42835152,0.32248499,0.2547246,0.25341234,0.14656097,0.13361497,0.21414226,0.11787401,0.2483194,0.20868764,0.35851832,0.24008092,0.41919494,0.43154551,0.11333092,0.22929881,0.13558881,0.14622707,0.15489803,0.16362196,0.20299627,0.18130775,0.18554675,0.19037046,0.19276742,0.19492496,0.23581753,0.19551035,0.19567527,0.20992126,0.2422002,0.19364058,0.20676198,0.19285991,0.1883642,0.18679594,0.18128892,0.20168608,0.17174551,0.16346186,0.22186556,0.2088388,0.60894236,0.60071212,0.56860225,0.42041854,0.26674478,0.172564,0.11041011,0.10197494,0.09309354])
            miehet_in=np.array([0.0836975,0.07045211,0.03488921,0.01490167,0.01213352,0.01118242,0.0105607,0.01022634,0.01021807,0.0101071,0.00973495,0.00967659,0.01097709,0.00980993,0.008835,0.01076506,0.00916065,0.00991929,0.00820308,0.01067562,0.00915391,0.00923207,0.00868036,0.01022524,0.00873991,0.01096572,0.00908074,0.00932166,0.009303,0.00921635,0.01178509,0.00928957,0.01170738,0.00972438,0.01214747,0.01003792,0.01107637,0.0111222,0.01174243,0.01076717,0.01040972,0.01039974,0.01019888,0.01015887,0.00983458,0.00789659,0.00635883,0.00717657,0.00677233,0.00811223,0.05010526,0.16376812,0.2])
            miehet_out=np.array([0.19606582,0.19192953,0.72748406,0.36835407,0.26426285,0.24186528,0.21613798,0.17684739,0.18775975,0.20837804,0.1755928,0.1843733,0.16204073,0.27236628,0.16251288,0.1663633,0.31105158,0.17222832,0.21071971,0.1802458,0.18300687,0.18604616,0.24330542,0.19339706,0.19392248,0.19439376,0.19604978,0.19550734,0.19589669,0.26317009,0.19533896,0.21922558,0.193866,0.23386114,0.19363687,0.26061699,0.18911327,0.18515374,0.18424368,0.23117624,0.19671236,0.2227191,0.20668282,0.29136381,0.64012128,0.69551891,0.36129873,0.37621727,0.12834992,0.23054359,0.09811724,0.09059769,0.08307815])
        elif self.year==2019:
            naiset_in=np.array([0.06564637,0.01902217,0.01448823,0.01082045,0.01109212,0.01004215,0.01026283,0.01365412,0.01827479,0.01276322,0.01373995,0.01327371,0.01281736,0.01164274,0.01120542,0.00909248,0.00829482,0.01071429,0.00748391,0.01288711,0.01209118,0.00881675,0.0097019,0.008263,0.00770188,0.01115443,0.00904404,0.00893885,0.00886527,0.00853667,0.00884556,0.00835272,0.00912228,0.00853821,0.00828153,0.01223007,0.01029054,0.00943753,0.01141329,0.00970092,0.00975177,0.01126902,0.01468933,0.01621651,0.01372193,0.01207236,0.00898899,0.00867883,0.00927186,0.00933135,0.03062857,0.06219239,0.08945869])
            naiset_out=np.array([0.19178804,0.42423335,0.43663502,0.31790591,0.16538567,0.20882335,0.14916768,0.14055882,0.12859735,0.14423108,0.11308722,0.15654926,0.20344343,0.14903259,0.28454863,0.18295258,0.27236472,0.12223616,0.25254045,0.1494872,0.15937634,0.16592301,0.17355635,0.23045181,0.19233187,0.19119576,0.19237129,0.19355147,0.19523512,0.23414426,0.1951638,0.2020788,0.19352296,0.22722834,0.19948744,0.19291497,0.19125084,0.23345795,0.18379165,0.18341401,0.1847578,0.16497039,0.15875277,0.15249305,0.48229716,0.78029139,0.51721906,0.57910774,0.11193013,0.21356326,0.08947868,0.07691874,0.06346934])
            miehet_in=np.array([0.09133574,0.05990905,0.0338092,0.01564472,0.01256785,0.01223247,0.01119321,0.01060807,0.01281032,0.01101086,0.0104177,0.01004189,0.01177723,0.00992917,0.00965382,0.01193703,0.00939804,0.00894238,0.01047202,0.00866136,0.01100149,0.00989391,0.00902219,0.00847837,0.00913585,0.011478,0.00893393,0.01053995,0.00920157,0.00911616,0.00907905,0.0105397,0.00930132,0.00924274,0.01070782,0.01225851,0.01006356,0.01208681,0.01019637,0.01032538,0.01046838,0.01028185,0.00957509,0.00939666,0.01025721,0.00968636,0.0068869,0.00636284,0.01086562,0.00872255,0.02274368,0.03031915,0.03450586])
            miehet_out=np.array([0.19721172,0.1924252,0.69326074,0.37762103,0.21809037,0.26648935,0.2388575,0.19030961,0.17370978,0.22632972,0.20989953,0.22161532,0.16444414,0.19116557,0.25971845,0.16670573,0.21443329,0.24735643,0.17537279,0.21606631,0.18481606,0.18676864,0.24964428,0.23174102,0.19563285,0.19571413,0.2142459,0.19505279,0.20498807,0.20425727,0.21391459,0.19491274,0.20795392,0.2324952,0.19255389,0.19258175,0.24917753,0.18798471,0.1865277,0.23838663,0.17404662,0.26833782,0.2299198,0.15122064,0.4511587,0.806599,0.50547391,0.39477297,0.11144337,0.16966804,0.09571495,0.08785075,0.07998654])
        elif self.year==2020:
            naiset_in=np.array([0.0638432,0.01794411,0.01470897,0.01157992,0.01037943,0.01252044,0.01212171,0.01338389,0.01278498,0.01256116,0.01449252,0.01224671,0.01169219,0.01062379,0.00844724,0.00980561,0.01333678,0.00869865,0.01445535,0.00738492,0.00714585,0.00824829,0.0090641,0.00724939,0.00721824,0.00679412,0.0082627,0.0081868,0.00714409,0.00707865,0.00728586,0.00810547,0.00744627,0.00740978,0.00740087,0.00899618,0.00825592,0.01038742,0.00828282,0.00831311,0.00833251,0.0088908,0.00857395,0.01178575,0.00997305,0.01132976,0.00778676,0.00779265,0.00532909,0.01022503,0.02938689,0.03953488,0.05720721])
            naiset_out=np.array([0.19104065,0.36957765,0.39964086,0.27983572,0.18993734,0.15863943,0.1512542,0.13744206,0.13141584,0.22421433,0.11274488,0.17464578,0.20459889,0.3150887,0.21105695,0.10612847,0.11353233,0.42395904,0.1326867,0.15287083,0.17375329,0.16430525,0.17240942,0.21690624,0.18782386,0.21072961,0.19344023,0.1943581,0.20612262,0.19913772,0.196025,0.1949679,0.1949491,0.19776479,0.24618272,0.192169,0.19158833,0.18991993,0.19043796,0.1978696,0.20538785,0.16445849,0.15971765,0.15201634,0.18613202,0.82645446,0.53832943,0.56091731,0.1939612,0.09548835,0.08309452,0.0698514,0.055759])
            miehet_in=np.array([0.08127843,0.05256221,0.03036412,0.01481352,0.0124702,0.0118955,0.01172959,0.01050108,0.01211824,0.0132486,0.01080666,0.00912507,0.00884368,0.00780596,0.0074567,0.007197,0.00718091,0.01323925,0.00810123,0.01045781,0.00768167,0.00998121,0.01093626,0.00836772,0.00869758,0.00876754,0.01250447,0.00970016,0.00891261,0.0086707,0.0086177,0.01057518,0.00899637,0.00887143,0.00867027,0.00919681,0.0108906,0.00936528,0.01001691,0.01005891,0.00983004,0.00934089,0.00930218,0.01152753,0.01013802,0.01115361,0.00729219,0.00852541,0.00530973,0.01651442,0.02502085,0.02945545,0.03504823])
            miehet_out=np.array([0.19454714,0.19301008,0.66971742,0.3450885,0.23772851,0.20014318,0.28809097,0.26696767,0.17413804,0.16986712,0.32987392,0.1881455,0.28663802,0.25071087,0.16381711,0.21580093,0.16819427,0.17166666,0.30401376,0.17964815,0.23945844,0.18640072,0.18913293,0.33327047,0.1946461,0.19664584,0.19648598,0.195396,0.22970123,0.21679618,0.19599678,0.19539776,0.20965804,0.22180123,0.20145223,0.19136463,0.19178992,0.2161485,0.18641989,0.18019533,0.24545409,0.20690772,0.22017819,0.15434084,0.22202036,0.85951013,0.40735016,0.61911382,0.14831831,0.1140886,0.10733088,0.10057315,0.09381543])
        elif self.year==2021:
            naiset_in=np.array([0.04765074,0.0159321,0.01469004,0.01220926,0.01136782,0.01444004,0.01519211,0.01317378,0.01354389,0.01546279,0.01413973,0.01427189,0.02067768,0.01571148,0.01396833,0.01340612,0.01199779,0.01106597,0.01037546,0.01296859,0.00972029,0.01081839,0.00910359,0.00846094,0.00721559,0.00708397,0.00757389,0.01126659,0.00763363,0.00894072,0.00780926,0.00769637,0.00954098,0.00773954,0.00860742,0.00755869,0.00780415,0.00922988,0.0086747,0.0082466,0.0120388,0.00917288,0.00931965,0.01626718,0.01478443,0.01267322,0.00936708,0.01032201,0.00615322,0.00777749,0.0256262,0.04125561,0.05454545])
            naiset_out=np.array([0.19225597,0.27501638,0.34827987,0.25478612,0.18441684,0.16122635,0.151579,0.14693828,0.15846003,0.11882917,0.17218989,0.09687051,0.08979254,0.21153282,0.12939816,0.19692651,0.16065896,0.13419165,0.2066908,0.14041577,0.28403357,0.162835,0.16883894,0.31538246,0.18930535,0.24139601,0.19305091,0.19472039,0.21442123,0.19536703,0.21220478,0.25654672,0.19517035,0.26248433,0.19249706,0.20091279,0.1910613,0.19054023,0.18748612,0.19245969,0.17523679,0.27069423,0.15785569,0.15044809,0.14254348,0.80489191,0.5283178,0.63221677,0.11353943,0.18290299,0.07716599,0.0632781,0.04853545])
            miehet_in=np.array([0.08391869,0.05539081,0.02333481,0.01406214,0.01232148,0.01154905,0.0117323,0.01049508,0.00955863,0.00907201,0.01280984,0.00915824,0.0084334,0.00798023,0.00746119,0.00718923,0.00686261,0.01581904,0.00762968,0.01314682,0.00794488,0.01027869,0.00865148,0.01064231,0.00845133,0.00806998,0.00950171,0.01185779,0.00863618,0.01075521,0.00888329,0.00869304,0.00977803,0.01143803,0.00908559,0.00872191,0.01110752,0.01058152,0.00947043,0.01126384,0.00980677,0.00946644,0.00985148,0.00980381,0.01445474,0.0076067,0.00709384,0.0087569,0.00610299,0.00891913,0.0,0.0,0.0])
            miehet_out=np.array([0.19489684,0.19273285,0.65470674,0.35845266,0.24597944,0.24978729,0.18207433,0.31769478,0.21804254,0.23445153,0.16836747,0.25825437,0.22311789,0.2230165,0.23401495,0.16712472,0.24827448,0.17121261,0.31506098,0.17955877,0.21502721,0.18636668,0.19004814,0.19229134,0.25241625,0.22718469,0.19756448,0.19690391,0.24265442,0.19577782,0.20632831,0.24104474,0.19507656,0.19470065,0.24940291,0.21992501,0.18988604,0.19095091,0.21375053,0.18462411,0.20331466,0.25409338,0.16149494,0.15510564,0.14772602,0.84828604,0.32695102,0.62888931,0.37866304,0.11082794,0.10344832,0.0960687,0.08868908])
        elif self.year==2022:
            naiset_in=np.array([0.05295866,0.01644888,0.01526092,0.0126836,0.01198017,0.01200358,0.01331794,0.01452026,0.01722704,0.01438759,0.01477464,0.01402234,0.01259841,0.01252312,0.01243393,0.01333178,0.01466799,0.01223962,0.01110827,0.01021192,0.01016648,0.00935178,0.01319994,0.00896217,0.0082846,0.00773188,0.0075128,0.00727266,0.0089718,0.00744139,0.00875583,0.00745624,0.00740234,0.00721306,0.00734114,0.00887372,0.00764837,0.00802396,0.01010765,0.00819609,0.01099148,0.00870592,0.00957916,0.01382638,0.02079348,0.0135941,0.00910924,0.00710114,0.00610768,0.01045833,0.02404965,0.03198032,0.04757119])
            naiset_out=np.array([0.19213987,0.26597059,0.35554117,0.28066845,0.17008348,0.16560116,0.15678501,0.1479065,0.13606992,0.20889959,0.11831152,0.22742041,0.11183004,0.12382045,0.15769217,0.10800587,0.11790666,0.19917743,0.19044514,0.1973363,0.15373114,0.2818779,0.17148419,0.23411207,0.23809319,0.21064568,0.21736359,0.22544273,0.19538353,0.2399329,0.19571618,0.20825674,0.22891893,0.19460187,0.19454305,0.19230785,0.22461658,0.19006926,0.1883749,0.22193282,0.17651909,0.17506381,0.15610699,0.14804002,0.13870838,0.79773859,0.72322736,0.33369642,0.28078268,0.05487256,0.03066987,0.00398867,0.0])
            miehet_in=np.array([0.08099981,0.05096074,0.03036286,0.01519656,0.01350278,0.01295321,0.01227169,0.01174644,0.01148297,0.01112252,0.01037605,0.0101101,0.00978595,0.0091051,0.0087891,0.00841999,0.01071471,0.00845111,0.00972475,0.00916074,0.00971716,0.01017579,0.00893281,0.00985306,0.0089289,0.00883241,0.00877974,0.00856667,0.01114829,0.00887309,0.0099515,0.00901258,0.00880547,0.00884986,0.01184748,0.00947644,0.00906183,0.00933252,0.01037386,0.00960848,0.00944285,0.0096172,0.01023139,0.01278098,0.01409632,0.0125095,0.009303,0.0079208,0.00768754,0.00703206,0.01574586,0.024846,0.04193139])
            miehet_out=np.array([0.19522188,0.19202232,0.660492,0.29698239,0.23066462,0.23797014,0.22941258,0.20212659,0.20594371,0.2395748,0.19709392,0.20209185,0.27448884,0.16219498,0.20430063,0.22882963,0.16846149,0.22801206,0.17530735,0.17998234,0.18423892,0.18618667,0.22027434,0.19291416,0.19464841,0.20306527,0.21752688,0.2312548,0.19703733,0.21941661,0.1957074,0.21909577,0.19552988,0.20398586,0.19425135,0.24990961,0.1922415,0.18927301,0.18990416,0.21194957,0.18814701,0.16815929,0.16370045,0.15714952,0.15026901,0.80051221,0.77297705,0.34981865,0.45291958,0.34046096,0.2,0.2,0.2])
        elif self.year==2023:
            naiset_in=np.array([0.06147311,0.018228,0.0159265,0.01341377,0.01208665,0.01089947,0.01579578,0.01205827,0.01129863,0.01086464,0.01100239,0.01049296,0.01062651,0.00986107,0.01100912,0.0176535,0.01080662,0.00971562,0.01130704,0.01181158,0.00931453,0.00904861,0.00854294,0.01053267,0.00967186,0.00832106,0.00777208,0.007216,0.00902972,0.00732426,0.007938,0.00934936,0.00786813,0.00758222,0.00739033,0.00860553,0.008036,0.00771256,0.00906104,0.00802571,0.0098204,0.00852547,0.01079929,0.01368375,0.0187149,0.01307957,0.01195615,0.00994286,0.00769627,0.0090623,0.02404159,0.04028777,0.05036603])
            naiset_out=np.array([0.1929843,0.32096682,0.34346057,0.28463013,0.29267387,0.18291776,0.16011023,0.22999372,0.19382076,0.14745222,0.18641214,0.11473445,0.1981669,0.21006017,0.10509371,0.11281952,0.20617422,0.20963761,0.13622467,0.14767673,0.20499494,0.16653195,0.25155915,0.18008352,0.18710169,0.25350839,0.25503908,0.23139571,0.19584468,0.206331,0.19454595,0.19442067,0.23052828,0.22505384,0.21246631,0.19227415,0.1926223,0.21179276,0.18831905,0.18514583,0.17755796,0.1737838,0.15733493,0.1495889,0.14069967,0.56142541,0.8413453,0.55094895,0.25543173,0.33322512,0.2,0.2,0.2])
            miehet_in=np.array([0.11601955,0.039567,0.03523336,0.01814862,0.01416097,0.01297462,0.01297301,0.01218918,0.01140536,0.01012959,0.00985937,0.00849689,0.01208143,0.00908765,0.0078873,0.00759692,0.01354359,0.00793109,0.00997297,0.01166694,0.01038828,0.01046171,0.0094098,0.01099024,0.01316495,0.0100865,0.00988899,0.00988486,0.01000628,0.00965115,0.01049113,0.01002192,0.00986755,0.00965981,0.01005031,0.01039522,0.00967754,0.0099573,0.01097337,0.01063237,0.01030122,0.00968882,0.01270349,0.01101189,0.01742195,0.01304697,0.01111348,0.01079116,0.008517,0.00942331,0.02065728,0.0265748,0.03589041])
            miehet_out=np.array([0.19629174,0.1926143,0.64010139,0.40542882,0.27327627,0.18822673,0.25141931,0.25321412,0.29295124,0.20113129,0.31480843,0.19348324,0.1654606,0.29501137,0.20480181,0.28827421,0.16725106,0.1762435,0.17636731,0.18137984,0.18376125,0.1867893,0.22607596,0.19204955,0.19360227,0.21672575,0.27707568,0.19849678,0.1976994,0.19756198,0.19474171,0.19440826,0.21245227,0.24444534,0.19276106,0.19338181,0.22886201,0.19082392,0.19006341,0.18429473,0.2485354,0.17408548,0.16559246,0.18604439,0.15326973,0.61956862,0.80007626,0.63345801,0.2,0.37924118,0.2,0.2,0.2])
        elif self.year==2024:
            naiset_in=np.array([0.061287,0.0182687,0.01592489,0.012743,0.01095566,0.01024062,0.00972951,0.00980847,0.00943706,0.00947883,0.00958228,0.00751289,0.00753048,0.00578101,0.00509907,0.00439295,0.00996156,0.00620844,0.00681535,0.0054763,0.00998699,0.01080918,0.00824135,0.0107582,0.00749455,0.00765962,0.00770048,0.00728426,0.00941926,0.00737889,0.00768043,0.00950669,0.00787368,0.00757247,0.0073688,0.00860514,0.00807467,0.00772828,0.00905377,0.00800119,0.009864,0.00855096,0.01078322,0.01372753,0.01873379,0.01310122,0.01177472,0.01001954,0.00769627,0.0090623,0.02404159,0.04028777,0.05036603])
            naiset_out=np.array([0.19345863,0.32071951,0.38730141,0.33145792,0.25594914,0.23379876,0.16789962,0.20690366,0.16031806,0.14881545,0.3535765,0.1374922,0.35401024,0.23342202,0.24872051,0.14874025,0.11373275,0.12352811,0.132563,0.18373053,0.15393232,0.16458889,0.17242717,0.17950458,0.20740192,0.19004082,0.19358338,0.24583778,0.19572326,0.2071364,0.19512354,0.19485544,0.23410374,0.22552049,0.21116774,0.19309023,0.19336811,0.21262085,0.1895962,0.18678081,0.18002634,0.17778994,0.16304276,0.1564044,0.1488103,0.57114433,0.77002636,0.46709488,0.15739551,0.21935974,0.06865845,0.04953526,0.02876507])
            miehet_in=np.array([0.11538921,0.03935357,0.0351262,0.01789619,0.01422514,0.01295867,0.01236142,0.01175214,0.01164081,0.01041568,0.00992332,0.00940477,0.00892917,0.00886727,0.00765813,0.00759998,0.00890708,0.00998077,0.01039566,0.01170471,0.01092684,0.00941868,0.01107698,0.00938296,0.01215562,0.00984341,0.00977151,0.0093435,0.00938522,0.00999431,0.01035876,0.01003318,0.00980086,0.00965025,0.01011194,0.01036364,0.00970602,0.00993831,0.01101864,0.01060291,0.01032168,0.00972179,0.01273691,0.01099783,0.01734146,0.0130855,0.01098068,0.01071618,0.008517,0.00942331,0.02065728,0.0265748,0.03589041])
            miehet_out=np.array([0.19662523,0.19301413,0.64695992,0.38901445,0.27852546,0.23883946,0.23836901,0.19791917,0.28354896,0.22675262,0.23114618,0.21667435,0.17959636,0.30167383,0.17089916,0.20389032,0.16585149,0.17135392,0.1752947,0.18100335,0.18329251,0.22208018,0.18873792,0.19937098,0.1937151,0.20006097,0.24105846,0.20976615,0.19776199,0.19781443,0.1954126,0.19504849,0.21062365,0.24513,0.19361801,0.19424397,0.22974471,0.19199925,0.19128093,0.18631967,0.25103147,0.17776552,0.16984779,0.19105916,0.15903196,0.62614739,0.74740439,0.57493422,0.1356243,0.30901356,0.12392047,0.11806855,0.11221664])
        elif self.year==2025:
            naiset_in=np.array([0.06130769,0.01829803,0.01579331,0.01255603,0.01084108,0.01020424,0.01002033,0.00998097,0.00971769,0.00975341,0.00981918,0.00806001,0.00818268,0.00615884,0.00736233,0.00578623,0.01199642,0.00686059,0.00932107,0.00946159,0.00891331,0.01141775,0.00793017,0.00849749,0.00801065,0.0086677,0.00771729,0.00742676,0.00903058,0.00741422,0.00812385,0.00945887,0.0078752,0.00757189,0.00738359,0.00859548,0.00807487,0.00773627,0.00904316,0.00800972,0.00986255,0.0085471,0.01077582,0.013727,0.0187698,0.0131235,0.01178928,0.01001592,0.00769627,0.0090623,0.02404159,0.04028777,0.05036603])
            naiset_out=np.array([0.19210079,0.33020181,0.38786411,0.32784926,0.24380096,0.19763764,0.17175923,0.18157152,0.15935545,0.11527286,0.30043789,0.10736255,0.35296854,0.23477694,0.09535319,0.18038665,0.11219437,0.12016327,0.12631522,0.14009068,0.14896534,0.16484235,0.19391081,0.17959004,0.18644218,0.18989237,0.22503266,0.24744709,0.19644051,0.22347319,0.19531577,0.19491925,0.23415599,0.22504332,0.21255287,0.1931316,0.19330154,0.21261311,0.18960922,0.18676559,0.18002955,0.17780357,0.16307226,0.15643802,0.14885613,0.57120114,0.77009293,0.46716998,0.15747792,0.21944824,0.0687518,0.04963225,0.02886447])
            miehet_in=np.array([0.11574639,0.03926601,0.03518029,0.01784354,0.01441921,0.01343717,0.0128722,0.0124563,0.01235722,0.01110755,0.01067657,0.01045574,0.01090475,0.00988178,0.00881835,0.00872971,0.00920741,0.01089645,0.00944104,0.01126959,0.01062915,0.00955576,0.0104147,0.00939163,0.01262675,0.00997025,0.00991284,0.00945202,0.00934421,0.00987121,0.01042839,0.01004947,0.00982101,0.00965494,0.01006782,0.0103848,0.00969913,0.00992836,0.0110045,0.01058651,0.01032331,0.00969401,0.01271063,0.0110025,0.01735392,0.01309181,0.01098868,0.01069955,0.008517,0.00942331,0.02065728,0.0265748,0.03589041])
            miehet_out=np.array([0.1959504,0.192847,0.64775719,0.3741029,0.25458801,0.23138974,0.21703976,0.18995043,0.27463347,0.20935937,0.19447491,0.24771054,0.16312248,0.27341149,0.17480083,0.24667672,0.16836508,0.17210439,0.17487252,0.18005031,0.18459644,0.21972756,0.19000158,0.19635565,0.19419549,0.19804484,0.24525392,0.20830375,0.20260595,0.19798085,0.19549042,0.19508913,0.21153636,0.24512645,0.19367659,0.19423187,0.22972795,0.19200767,0.19129274,0.1863424,0.25102847,0.17784897,0.16991977,0.19114619,0.15913507,0.62627703,0.74756056,0.57511692,0.13583352,0.30924931,0.12418275,0.11835736,0.11253198])
        elif self.year==2026:
            naiset_in=np.array([0.05532985,0.01826592,0.01560432,0.01199544,0.0099536,0.00890528,0.0082572,0.00813002,0.00893888,0.00922207,0.00877013,0.00767773,0.00742864,0.00591066,0.01130304,0.00971249,0.00729596,0.00828657,0.0093332,0.00737011,0.00965231,0.00987658,0.0077499,0.01153701,0.00869942,0.00800546,0.00784841,0.00754499,0.00858293,0.00739204,0.00803608,0.0091751,0.00786563,0.007568,0.00738405,0.0086067,0.00808374,0.0077259,0.00906547,0.00799755,0.00985843,0.00854675,0.01077755,0.013733,0.01876185,0.01313345,0.01177237,0.00994337,0.00769627,0.0090623,0.02404159,0.04028777,0.05036603])
            naiset_out=np.array([0.19210079,0.34010832,0.41672454,0.36090664,0.29128997,0.254394,0.18096789,0.16099062,0.12743989,0.1152728,0.24360965,0.1537362,0.30946069,0.19925648,0.09535319,0.10627575,0.1121966,0.12016266,0.12631612,0.1420144,0.14896627,0.16484235,0.20452277,0.17959103,0.18643887,0.20304117,0.22511643,0.25076833,0.1964453,0.20777761,0.19530839,0.19492394,0.23418545,0.22446019,0.21255261,0.19312223,0.19329387,0.21262315,0.18958183,0.18678731,0.18003875,0.17780478,0.16306535,0.15643623,0.14884846,0.57119492,0.7700955,0.46718866,0.15752004,0.21952113,0.0688628,0.04978868,0.02907365])
            miehet_in=np.array([0.11580942,0.039804,0.03526949,0.01808092,0.0145838,0.013383,0.0130551,0.01263955,0.01237798,0.01125882,0.01086395,0.01028522,0.00962396,0.00941485,0.008358,0.00826152,0.00847573,0.01080493,0.00955457,0.01104387,0.01142757,0.00956566,0.00993872,0.00966813,0.01248486,0.01001531,0.00995394,0.00946517,0.00936919,0.009918,0.01041092,0.01011723,0.00983381,0.00965839,0.01006875,0.01037332,0.00970077,0.00994493,0.01099321,0.0106103,0.01031859,0.00971074,0.01270552,0.01102718,0.01735689,0.01307522,0.01098317,0.01080702,0.008517,0.00942331,0.02065728,0.0265748,0.03589041])
            miehet_out=np.array([0.1959504,0.19284822,0.64201198,0.37577815,0.26825479,0.21441631,0.21481496,0.20585486,0.26126565,0.20630714,0.22789555,0.23034087,0.18974771,0.2767405,0.1769446,0.21037719,0.16836539,0.17210459,0.17487022,0.18004975,0.1845962,0.20527185,0.19000192,0.19318831,0.19419807,0.19939794,0.24729277,0.21835866,0.19817124,0.19797921,0.19548851,0.19508806,0.21246373,0.24512466,0.19367598,0.19423843,0.22972685,0.19199364,0.19130217,0.18630943,0.25103716,0.17779872,0.16993376,0.19116132,0.15916222,0.6263088,0.74759694,0.57515792,0.13587914,0.30929954,0.12423759,0.11841682,0.11259605])
        else:
            print("Error: Unknown year in ['outsider in', 'outsider out']")
    
        if R70:
            naiset_in=np.array([0.061287,0.0182687,0.01592489,0.012743,0.01095566,0.01024062,0.00972951,0.00980847,0.00943706,0.00947883,0.00958228,0.00751289,0.00753048,0.00578101,0.00509907,0.00439295,0.00996156,0.00620844,0.00681535,0.0054763,0.00998699,0.01080918,0.00824135,0.0107582,0.00749455,0.00765962,0.00770048,0.00728426,0.00941926,0.00737889,0.00768043,0.00950669,0.00787368,0.00757247,0.0073688,0.00860514,0.00807467,0.00772828,0.00905377,0.00800119,0.009864,0.00855096,0.01078322,0.01372753,0.01873379,0.01310122,0.01177472,0.01001954,0.00769627,0.0090623,0.02404159,0.04028777,0.05036603])
            naiset_out=np.array([0.19345863,0.32071951,0.38730141,0.33145792,0.25594914,0.23379876,0.16789962,0.20690366,0.16031806,0.14881545,0.3535765,0.1374922,0.35401024,0.23342202,0.24872051,0.14874025,0.11373275,0.12352811,0.132563,0.18373053,0.15393232,0.16458889,0.17242717,0.17950458,0.20740192,0.19004082,0.19358338,0.24583778,0.19572326,0.2071364,0.19512354,0.19485544,0.23410374,0.22552049,0.21116774,0.19309023,0.19336811,0.21262085,0.1895962,0.18678081,0.18002634,0.17778994,0.16304276,0.1564044,0.1488103,0.1488103,0.1488103,0.1488103,0.1488103,0.21935974,0.21935974,0.21935974,0.21935974])
            miehet_in=np.array([0.11538921,0.03935357,0.0351262,0.01789619,0.01422514,0.01295867,0.01236142,0.01175214,0.01164081,0.01041568,0.00992332,0.00940477,0.00892917,0.00886727,0.00765813,0.00759998,0.00890708,0.00998077,0.01039566,0.01170471,0.01092684,0.00941868,0.01107698,0.00938296,0.01215562,0.00984341,0.00977151,0.0093435,0.00938522,0.00999431,0.01035876,0.01003318,0.00980086,0.00965025,0.01011194,0.01036364,0.00970602,0.00993831,0.01101864,0.01060291,0.01032168,0.00972179,0.01273691,0.01099783,0.01734146,0.0130855,0.01098068,0.01071618,0.008517,0.00942331,0.02065728,0.0265748,0.03589041])
            miehet_out=np.array([0.19662523,0.19301413,0.64695992,0.38901445,0.27852546,0.23883946,0.23836901,0.19791917,0.28354896,0.22675262,0.23114618,0.21667435,0.17959636,0.30167383,0.17089916,0.20389032,0.16585149,0.17135392,0.1752947,0.18100335,0.18329251,0.22208018,0.18873792,0.19937098,0.1937151,0.20006097,0.24105846,0.20976615,0.19776199,0.19781443,0.1954126,0.19504849,0.21062365,0.24513,0.19361801,0.19424397,0.22974471,0.19199925,0.19128093,0.18631967,0.25103147,0.17776552,0.16984779,0.19105916,0.15903196,0.15903196,0.15903196,0.15903196,0.15903196,0.15903196,0.15903196,0.15903196,0.15903196])

        min_age=18
        max_spv=71
        in_m=self.get_w(0,1.5,1.0)
        out_m=self.get_w(0,0.8,1.0)
        in_n=self.get_w(0,1.25,1.0)
        out_n=self.get_w(0,0.85,1.0)
        
        inrate[min_age:max_spv,0]=1.5*miehet_in
        inrate[min_age:max_spv,1]=1.0*miehet_in
        inrate[min_age:max_spv,2]=in_m*miehet_in
        inrate[min_age:max_spv,3]=1.25*naiset_in
        inrate[min_age:max_spv,4]=1.0*naiset_in
        inrate[min_age:max_spv,5]=in_n*naiset_in
        outrate[min_age:max_spv,0]=0.8*miehet_out
        outrate[min_age:max_spv,1]=1.0*miehet_out
        outrate[min_age:max_spv,2]=out_m*miehet_out
        outrate[min_age:max_spv,3]=0.85*naiset_out
        outrate[min_age:max_spv,4]=1.0*naiset_out
        outrate[min_age:max_spv,5]=out_n*naiset_out

        #inrate=1-(1-inrate)**self.timestep
        inrate = self.scale_rates(inrate)
        #outrate=1-(1-outrate)**self.timestep
        outrate = self.scale_rates(outrate)

        ra=int(retirementage)

        outrate[ra:max_spv,0]=1.0
        outrate[ra:max_spv,1]=1.0
        outrate[ra:max_spv,2]=1.0
        outrate[ra:max_spv,3]=1.0
        outrate[ra:max_spv,4]=1.0
        outrate[ra:max_spv,5]=1.0

        inrate[ra:max_spv,0]=0.0
        inrate[ra:max_spv,1]=0.0
        inrate[ra:max_spv,2]=0.0
        inrate[ra:max_spv,3]=0.0
        inrate[ra:max_spv,4]=0.0
        inrate[ra:max_spv,5]=0.0

        return inrate,outrate                                    
        
    def get_disability_rate(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Data ETK:n tilastotietokannasta ja skaalattu ikäluokittaisillä miesten ja naisten määrillä
        '''
        disab=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            dfactor=np.array([1.2,0.8,0.4,1.1,0.8,0.5])*0.9
        
        dis_miehet=np.array([0.004697942,00.004697942,00.004697942,0.004435302,0.003631736,0.003141361,0.003457091,0.003005607,0.002905609,0.003029283,0.002289213,0.002137714,0.001854558,0.002813517,0.002607335,0.00292628,0.002937462,0.002784612,0.002846377,0.002776506,0.003017675,0.003129845,0.003349059,0.002991577,0.00305634,0.003446143,0.003633971,0.004045113,0.004002001,0.004517725,0.005527525,0.005565513,0.006319492,0.007399175,0.00731299,0.009142823,0.010254463,0.011784364,0.013783743,0.015299156,0.018282001,0.024051257,0.032338044,0.028290544,0.019444444,0.00454486,0.000330718,0,0,0,0,0,0])
        dis_naiset=np.array([0.00532654,0.00532654,0.00532654,0.004917401,0.00453191,0.003799551,0.003253733,0.003092307,0.002822592,0.003309772,0.002482279,0.002615887,0.002416545,0.003546203,0.002665276,0.003095104,0.003129633,0.003406418,0.003171677,0.003320357,0.003391292,0.004007371,0.004310094,0.00438571,0.004267343,0.004889399,0.005043702,0.005793425,0.005569451,0.006298434,0.006363081,0.007043361,0.009389811,0.007457667,0.009251373,0.011154836,0.009524088,0.013689796,0.014658423,0.017440417,0.022804727,0.02677838,0.037438459,0.034691279,0.022649573,0.004414073,0.000264568,0,0,0,0,0,0])
        # ei varhaiseläkkeitä mukana, joten oletetaan ettei tk-intensiteetti laske
        dis_miehet[41:51]=np.maximum(dis_miehet[41:51],0.02829054)
        dis_naiset[41:51]=np.maximum(dis_naiset[41:51],0.03469128)
        
        for g in range(3):
            disab[18:71,g]=dfactor[g]*dis_miehet
            disab[70:(self.max_age+1),g]=24.45*dfactor[g]/1000
        for g in range(3,6):
            disab[18:71,g]=dfactor[g]*dis_naiset
            disab[70:(self.max_age+1),g]=24.45*dfactor[g]/1000

        #disab=1-(1-disab)**self.timestep
        disab = self.scale_rates(disab)

        return disab        
        
    def get_eff_disab_rate(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Laskettu havaitusta työkyvyttömien lukumäärästä
        Siksi efektiivinen 
        '''
        disab=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            dfactor=np.array([1.3,0.95,0.6,1.2,1.0,0.9])
            
        if self.year==2018:
            dis_miehet=np.array([0.003844207,0.003844207,0.003844207,0.002157312,0,0.002915577,0.00081677,0.001404834,0.00177282,0,0,0.001891443,0,0.002265095,0,0.00268058,0.000697237,0,0.002079174,0.000263783,0,0.004538401,0,0.000631472,0.001079217,0.003555183,0.00458235,0.001800932,0.004376534,0.004341663,0.002335098,0.006036927,0.005459469,0.005254058,0.007632643,0.004282522,0.009607954,0.015170352,0.014231176,0.010977463,0.023104034,0.03462797,0.034507729,0.025464606,0.026129996,0.023528766,0.023334155,0.020393979,0.020180711,0.0201807,0.020180711,0.020180711,0.020180711])
            dis_naiset=np.array([0.003152456,0.003152456,0.003152456,0.001820899,0.003082487,0,0.001199533,0.00071851,0.000822116,0,0,3.56077E-05,0.002908854,0,6.90884E-05,0.001931247,0.000380501,0.002139637,0,0.001647453,0.002016588,0.001331603,0.001264028,0.002000195,0.001846965,0.003387732,0.003038917,0.003380599,0.00250926,0.003730162,0.004742885,0.002853525,0.007630704,0.004648271,0.00473735,0.007128777,0.007198634,0.01655657,0.011752225,0.019697643,0.023829746,0.026050823,0.037670072,0.022548783,0.024075564,0.021665082,0.021334812,0.018765714,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929])
        elif self.year==2019:
            dis_miehet=np.array([0.003844207,0.002157312,0,0.002915577,0.00081677,0.001404834,0.00177282,0,0,0.001891443,0,0.002265095,0,0.00268058,0.000697237,0,0.002079174,0.000263783,0,0.004538401,0,0.000631472,0.001079217,0.003555183,0.00458235,0.001800932,0.004376534,0.004341663,0.002335098,0.006036927,0.005459469,0.005254058,0.007632643,0.004282522,0.009607954,0.015170352,0.014231176,0.010977463,0.023104034,0.03462797,0.034507729,0.025464606,0.026129996,0.023528766,0.023334155,0.020393979,0.020180711,0.0201807,0.020180711,0.020180711,0.020180711,0.020180711,0.020180711])
            dis_naiset=np.array([0.003152456,0.001820899,0.003082487,0,0.001199533,0.00071851,0.000822116,0,0,3.56077E-05,0.002908854,0,6.90884E-05,0.001931247,0.000380501,0.002139637,0,0.001647453,0.002016588,0.001331603,0.001264028,0.002000195,0.001846965,0.003387732,0.003038917,0.003380599,0.00250926,0.003730162,0.004742885,0.002853525,0.007630704,0.004648271,0.00473735,0.007128777,0.007198634,0.01655657,0.011752225,0.019697643,0.023829746,0.026050823,0.037670072,0.022548783,0.024075564,0.021665082,0.021334812,0.018765714,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929])
        elif self.year==2020:
            dis_miehet=np.array([0.003844207,0.002157312,0,0.002915577,0.00081677,0.001404834,0.00177282,0,0,0.001891443,0,0.002265095,0,0.00268058,0.000697237,0,0.002079174,0.000263783,0,0.004538401,0,0.000631472,0.001079217,0.003555183,0.00458235,0.001800932,0.004376534,0.004341663,0.002335098,0.006036927,0.005459469,0.005254058,0.007632643,0.004282522,0.009607954,0.015170352,0.014231176,0.010977463,0.023104034,0.03462797,0.034507729,0.025464606,0.026129996,0.023528766,0.023334155,0.020393979,0.020180711,0.0201807,0.020180711,0.020180711,0.020180711,0.020180711,0.020180711])
            dis_naiset=np.array([0.003152456,0.001820899,0.003082487,0,0.001199533,0.00071851,0.000822116,0,0,3.56077E-05,0.002908854,0,6.90884E-05,0.001931247,0.000380501,0.002139637,0,0.001647453,0.002016588,0.001331603,0.001264028,0.002000195,0.001846965,0.003387732,0.003038917,0.003380599,0.00250926,0.003730162,0.004742885,0.002853525,0.007630704,0.004648271,0.00473735,0.007128777,0.007198634,0.01655657,0.011752225,0.019697643,0.023829746,0.026050823,0.037670072,0.022548783,0.024075564,0.021665082,0.021334812,0.018765714,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929])
        elif self.year==2021:
            dis_miehet=np.array([0.003844207,0.002157312,0,0.002915577,0.00081677,0.001404834,0.00177282,0,0,0.001891443,0,0.002265095,0,0.00268058,0.000697237,0,0.002079174,0.000263783,0,0.004538401,0,0.000631472,0.001079217,0.003555183,0.00458235,0.001800932,0.004376534,0.004341663,0.002335098,0.006036927,0.005459469,0.005254058,0.007632643,0.004282522,0.009607954,0.015170352,0.014231176,0.010977463,0.023104034,0.03462797,0.034507729,0.025464606,0.026129996,0.023528766,0.023334155,0.020393979,0.020180711,0.0201807,0.020180711,0.020180711,0.020180711,0.020180711,0.020180711])
            dis_naiset=np.array([0.003152456,0.001820899,0.003082487,0,0.001199533,0.00071851,0.000822116,0,0,3.56077E-05,0.002908854,0,6.90884E-05,0.001931247,0.000380501,0.002139637,0,0.001647453,0.002016588,0.001331603,0.001264028,0.002000195,0.001846965,0.003387732,0.003038917,0.003380599,0.00250926,0.003730162,0.004742885,0.002853525,0.007630704,0.004648271,0.00473735,0.007128777,0.007198634,0.01655657,0.011752225,0.019697643,0.023829746,0.026050823,0.037670072,0.022548783,0.024075564,0.021665082,0.021334812,0.018765714,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929,0.018557929])
        else:
            error(999)
            
        # oletetaan, että tk-alkavuus kasvaa 0,7% vuodessa iästä 59 alkaen
        y=np.arange(53-41)*0.007
        dis2_miehet=dis_miehet
        dis2_miehet[41:]=dis_miehet[41:]+y

        y=np.arange(53-41)*0.007
        dis2_naiset=dis_naiset
        dis2_naiset[41:]=dis_naiset[41:]+y
            
        for g in range(3):
            disab[18:71,g]=dfactor[g]*dis2_miehet
            disab[70:(self.max_age+1),g]=disab[70,g]
        for g in range(3,6):
            disab[18:71,g]=dfactor[g]*dis2_naiset
            disab[70:(self.max_age+1),g]=disab[70,g]
            
        #disab=1-(1-disab)**self.timestep
        disab = self.scale_rates(disab)

        return disab        

    def get_eff_disab_rate_v2(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Laskettu havaitusta työkyvyttömien lukumäärästä
        Siksi efektiivinen 
        Revisio 2021
        '''
        disab=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            dfactor=np.array([1.3,0.99,0.7,1.22,0.99,0.7])
            
        if not self.silent:
            print(f'disability rate from year {self.year}')
        
        if self.year==2018:
            naiset_in=np.array([0.0022405691471677346,0.0028029347008399087,0.002653046320194355,0.0026883764894571273,0.0014880964625165272,0.0012831033837961063,0.0004918476488315644,0.0009138700835908024,0.00043764454148174437,0.0003,0.0003,0.0007444843487586423,0.0008866596300537446,0.0009000126307566958,0.000571566314750823,0.0007934915730612233,0.0014854286103005761,0.00035755311664076246,0.0007809005041911009,0.0007380284551836546,0.001665353939184701,0.0015383300480508117,0.0015327426355888634,0.001703357986695096,0.0024114371504144368,0.0027570209892189635,0.0032683686826615135,0.0029800198035666668,0.0032065977965771817,0.003658944888352902,0.0037769439974031467,0.005074179664769313,0.0050419030685216176,0.005678280791766548,0.005507140687843919,0.006348194637514865,0.010284721923118523,0.011802383127200717,0.01602907094765649,0.018361334284173775,0.023195092802516044,0.0289408628852481,0.02891593368444875,0.052675084076576076,0.04479751311501741,0.07943392685117287,0.11944315089789737,0.1648251852551909,0.21558002992305347,0.27170768490148506,0.33320815019048566,0.40008142579005535,0.47232751170019405])
            miehet_in=np.array([0.0020282359412728906,0.004025272690606772,0.004045430215264155,0.0018245008709171565,0.0015864210370592363,0.0010967912746402365,0.0018933663999702722,0.0014722893149959116,0.0008351804620221053,0.00033,0.00033,0.00033,0.0009648151731765731,0.00033,0.0018031750600651891,0.0012185249213899569,0.0012502187826932353,0.0010253712316433913,0.0008647260385692231,0.0007776113773148861,0.0016835582570671706,0.0015185062240844328,0.0018449433152839076,0.0005631234144229169,0.0019349708144611123,0.0033776255489086867,0.0036495336557529705,0.003953764632295431,0.0038545428452270735,0.004056839876306189,0.004665121956632313,0.005065050074281188,0.006146694368839761,0.006728533250916835,0.006295205930812254,0.007892053935929332,0.010623639897704179,0.014281817085207718,0.01484311006203395,0.017706931055202896,0.025066337254444036,0.03363884617419562,0.03512637075043493,0.05712859849691879,0.045516838926810674,0.07012695785362134,0.09473707678043201,0.11934719570724268,0.14395731463405337,0.16856743356086404,0.1931775524876747,0.21778767141448538,0.24239779034129605])
        elif self.year==2019:
            naiset_in=np.array([0.0030467662075624384,0.0031264126629215283,0.002577567813612649,0.001824015431373127,0.0017642527875080258,0.001019297985969914,0.0008209250247937746,0.0006471881252425429,0.0008202368268938103,0.0004567339631660877,0.0003,0.0003,0.0006869591102671889,0.0008225671833487609,0.0007160031711696683,0.0009356463032724046,0.000987271225820792,0.0017840022937542375,0.0005021567605162354,0.0007961770123721067,0.0009289217390011377,0.0015418759832412365,0.001855455789099436,0.001496798136321204,0.0020177635847036337,0.002221848412033196,0.0028634470147270454,0.0033088359912555403,0.003150767309428243,0.003191598010591702,0.004152565907737649,0.004266148243750837,0.005809516184344099,0.005141658242998873,0.0060934417188670984,0.006323873300449263,0.007738751847758353,0.011874009012314163,0.014016708866707115,0.018696103620300757,0.02330672360071526,0.028052408758834173,0.031502056430273324,0.05371744726773898,0.04653143942831896,0.07897481603834451,0.11482752123922337,0.1540895550309555,0.19676091741354096,0.2428416083869797,0.29233162795127177,0.3452309761064171,0.4015396528524158])
            miehet_in=np.array([0.0008768478960776173,0.0029624874342752895,0.0035670299813887873,0.002822114603201518,0.0010906634546966843,0.0011762647360189578,0.0005529001661454683,0.0015407077388677858,0.0007208028002052651,0.0008206187321800574,0.0003,0.0003,0.0003,0.0009114081642699395,0.0003,0.0014071590546393378,0.000989310388436477,0.0010154218919266875,0.00114604106258592,0.0009116335761962793,0.0009321940460377276,0.0016261662441440935,0.0014917658201391982,0.0016299103757713492,0.0005897349965863893,0.0018936394272891118,0.0034001875265309597,0.0036733501427922465,0.003645807292281047,0.0035033343053438334,0.0037024274107012776,0.004668737325009231,0.005074695759797924,0.006276354369372645,0.006724048357576113,0.006636385518222012,0.00803445222304866,0.010541761327601061,0.014852053262604194,0.016064490963544505,0.021260950204543678,0.02686691568391662,0.03260452989879999,0.054115555593402365,0.044294463927808614,0.06768220785561722,0.09106995178342583,0,0,0,0,0,0])
        elif self.year==2020:
            naiset_in=np.array([0.0032096446692947583,0.0037673799131181605,0.0030652243446419648,0.001747364723624794,0.0006124196364131928,0.0012563367899846016,0.00044262450825248775,0.0008516874812164338,0.0004043765384452949,0.0010072337070020914,0.0005247979884547706,0.0003,0.0003,0.0008519371767038075,0.0009526729770681643,0.00112044044357432,0.0009151473348066909,0.000935774600197938,0.0016892832749937378,0.0004938019987728952,0.0009063955998760385,0.001098506505851516,0.0017689864670849067,0.0018522652389991567,0.0014744438266701867,0.0018798248798918928,0.0022894016732453006,0.002993294800853477,0.0033840684015581904,0.0035126827031577443,0.003433939931678483,0.004486248718504473,0.004503821154181344,0.006180521573662441,0.005643536853758908,0.0069389640840172425,0.007380221896408128,0.008825427344891541,0.013668344894919434,0.016080940260259764,0.023754399687428495,0.02881774779990569,0.0319898873216221,0.05631748847885379,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.0033172663907411245,0.003036255541920993,0.002811700904810991,0.0027461543892335033,0.0019014921038241748,0.0007621518544063064,0.0008875415196744792,0.0006630850059563771,0.0011359549242157374,0.0008073981636737504,0.0008043274102045596,0.0003,0.0003,0.0003,0.0010051249840304813,0.0003,0.0014215361890685403,0.0009257315503269268,0.0010244401520617186,0.001199598959515221,0.001041734179510943,0.0011721010447761698,0.0016547127779423193,0.0014767557949190006,0.00151155522338169,0.0007784091649640849,0.0019341428580230018,0.003531666661902588,0.003753512393498012,0.003966748024269306,0.0036412616803970033,0.004194674277407201,0.004727925122861967,0.005496756903404218,0.006028551189916889,0.007784776572525908,0.007285759457239851,0.009772705997325434,0.011781926003470203,0.01691997231793992,0.020880866567773104,0.02673500505374338,0.03034300914359823,0.05154121162964108,0.04451220283252059,0.06811768566504117,0.09172316849756176,0,0,0,0,0,0])
        elif self.year==2021:
            naiset_in=np.array([0.0032096446692947583,0.0037673799131181605,0.0030652243446419648,0.001747364723624794,0.0006124196364131928,0.0012563367899846016,0.00044262450825248775,0.0008516874812164338,0.0004043765384452949,0.0010072337070020914,0.0005247979884547706,0.0003,0.0003,0.0008519371767038075,0.0009526729770681643,0.00112044044357432,0.0009151473348066909,0.000935774600197938,0.0016892832749937378,0.0004938019987728952,0.0009063955998760385,0.001098506505851516,0.0017689864670849067,0.0018522652389991567,0.0014744438266701867,0.0018798248798918928,0.0022894016732453006,0.002993294800853477,0.0033840684015581904,0.0035126827031577443,0.003433939931678483,0.004486248718504473,0.004503821154181344,0.006180521573662441,0.005643536853758908,0.0069389640840172425,0.007380221896408128,0.008825427344891541,0.013668344894919434,0.016080940260259764,0.023754399687428495,0.02881774779990569,0.0319898873216221,0.05631748847885379,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.0033172663907411245,0.003036255541920993,0.002811700904810991,0.0027461543892335033,0.0019014921038241748,0.0007621518544063064,0.0008875415196744792,0.0006630850059563771,0.0011359549242157374,0.0008073981636737504,0.0008043274102045596,0.0003,0.0003,0.0003,0.0010051249840304813,0.0003,0.0014215361890685403,0.0009257315503269268,0.0010244401520617186,0.001199598959515221,0.001041734179510943,0.0011721010447761698,0.0016547127779423193,0.0014767557949190006,0.00151155522338169,0.0007784091649640849,0.0019341428580230018,0.003531666661902588,0.003753512393498012,0.003966748024269306,0.0036412616803970033,0.004194674277407201,0.004727925122861967,0.005496756903404218,0.006028551189916889,0.007784776572525908,0.007285759457239851,0.009772705997325434,0.011781926003470203,0.01691997231793992,0.020880866567773104,0.02673500505374338,0.03034300914359823,0.05154121162964108,0.04451220283252059,0.06811768566504117,0.09172316849756176,0,0,0,0,0,0])
        elif self.year==2022:
            naiset_in=np.array([0.0032096446692947583,0.0037673799131181605,0.0030652243446419648,0.001747364723624794,0.0006124196364131928,0.0012563367899846016,0.00044262450825248775,0.0008516874812164338,0.0004043765384452949,0.0010072337070020914,0.0005247979884547706,0.0003,0.0003,0.0008519371767038075,0.0009526729770681643,0.00112044044357432,0.0009151473348066909,0.000935774600197938,0.0016892832749937378,0.0004938019987728952,0.0009063955998760385,0.001098506505851516,0.0017689864670849067,0.0018522652389991567,0.0014744438266701867,0.0018798248798918928,0.0022894016732453006,0.002993294800853477,0.0033840684015581904,0.0035126827031577443,0.003433939931678483,0.004486248718504473,0.004503821154181344,0.006180521573662441,0.005643536853758908,0.0069389640840172425,0.007380221896408128,0.008825427344891541,0.013668344894919434,0.016080940260259764,0.023754399687428495,0.02881774779990569,0.0319898873216221,0.05631748847885379,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.0033172663907411245,0.003036255541920993,0.002811700904810991,0.0027461543892335033,0.0019014921038241748,0.0007621518544063064,0.0008875415196744792,0.0006630850059563771,0.0011359549242157374,0.0008073981636737504,0.0008043274102045596,0.0003,0.0003,0.0003,0.0010051249840304813,0.0003,0.0014215361890685403,0.0009257315503269268,0.0010244401520617186,0.001199598959515221,0.001041734179510943,0.0011721010447761698,0.0016547127779423193,0.0014767557949190006,0.00151155522338169,0.0007784091649640849,0.0019341428580230018,0.003531666661902588,0.003753512393498012,0.003966748024269306,0.0036412616803970033,0.004194674277407201,0.004727925122861967,0.005496756903404218,0.006028551189916889,0.007784776572525908,0.007285759457239851,0.009772705997325434,0.011781926003470203,0.01691997231793992,0.020880866567773104,0.02673500505374338,0.03034300914359823,0.05154121162964108,0.04451220283252059,0.06811768566504117,0.09172316849756176,0,0,0,0,0,0])
        elif self.year==2023:
            naiset_in=np.array([0.0032096446692947583,0.0037673799131181605,0.0030652243446419648,0.001747364723624794,0.0006124196364131928,0.0012563367899846016,0.00044262450825248775,0.0008516874812164338,0.0004043765384452949,0.0010072337070020914,0.0005247979884547706,0.0003,0.0003,0.0008519371767038075,0.0009526729770681643,0.00112044044357432,0.0009151473348066909,0.000935774600197938,0.0016892832749937378,0.0004938019987728952,0.0009063955998760385,0.001098506505851516,0.0017689864670849067,0.0018522652389991567,0.0014744438266701867,0.0018798248798918928,0.0022894016732453006,0.002993294800853477,0.0033840684015581904,0.0035126827031577443,0.003433939931678483,0.004486248718504473,0.004503821154181344,0.006180521573662441,0.005643536853758908,0.0069389640840172425,0.007380221896408128,0.008825427344891541,0.013668344894919434,0.016080940260259764,0.023754399687428495,0.02881774779990569,0.0319898873216221,0.05631748847885379,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.0033172663907411245,0.003036255541920993,0.002811700904810991,0.0027461543892335033,0.0019014921038241748,0.0007621518544063064,0.0008875415196744792,0.0006630850059563771,0.0011359549242157374,0.0008073981636737504,0.0008043274102045596,0.0003,0.0003,0.0003,0.0010051249840304813,0.0003,0.0014215361890685403,0.0009257315503269268,0.0010244401520617186,0.001199598959515221,0.001041734179510943,0.0011721010447761698,0.0016547127779423193,0.0014767557949190006,0.00151155522338169,0.0007784091649640849,0.0019341428580230018,0.003531666661902588,0.003753512393498012,0.003966748024269306,0.0036412616803970033,0.004194674277407201,0.004727925122861967,0.005496756903404218,0.006028551189916889,0.007784776572525908,0.007285759457239851,0.009772705997325434,0.011781926003470203,0.01691997231793992,0.020880866567773104,0.02673500505374338,0.03034300914359823,0.05154121162964108,0.04451220283252059,0.06811768566504117,0.09172316849756176,0,0,0,0,0,0])
        elif self.year==2024:
            naiset_in=np.array([0.0032096446692947583,0.0037673799131181605,0.0030652243446419648,0.001747364723624794,0.0006124196364131928,0.0012563367899846016,0.00044262450825248775,0.0008516874812164338,0.0004043765384452949,0.0010072337070020914,0.0005247979884547706,0.0003,0.0003,0.0008519371767038075,0.0009526729770681643,0.00112044044357432,0.0009151473348066909,0.000935774600197938,0.0016892832749937378,0.0004938019987728952,0.0009063955998760385,0.001098506505851516,0.0017689864670849067,0.0018522652389991567,0.0014744438266701867,0.0018798248798918928,0.0022894016732453006,0.002993294800853477,0.0033840684015581904,0.0035126827031577443,0.003433939931678483,0.004486248718504473,0.004503821154181344,0.006180521573662441,0.005643536853758908,0.0069389640840172425,0.007380221896408128,0.008825427344891541,0.013668344894919434,0.016080940260259764,0.023754399687428495,0.02881774779990569,0.0319898873216221,0.05631748847885379,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.0033172663907411245,0.003036255541920993,0.002811700904810991,0.0027461543892335033,0.0019014921038241748,0.0007621518544063064,0.0008875415196744792,0.0006630850059563771,0.0011359549242157374,0.0008073981636737504,0.0008043274102045596,0.0003,0.0003,0.0003,0.0010051249840304813,0.0003,0.0014215361890685403,0.0009257315503269268,0.0010244401520617186,0.001199598959515221,0.001041734179510943,0.0011721010447761698,0.0016547127779423193,0.0014767557949190006,0.00151155522338169,0.0007784091649640849,0.0019341428580230018,0.003531666661902588,0.003753512393498012,0.003966748024269306,0.0036412616803970033,0.004194674277407201,0.004727925122861967,0.005496756903404218,0.006028551189916889,0.007784776572525908,0.007285759457239851,0.009772705997325434,0.011781926003470203,0.01691997231793992,0.020880866567773104,0.02673500505374338,0.03034300914359823,0.05154121162964108,0.04451220283252059,0.06811768566504117,0.09172316849756176,0,0,0,0,0,0])
        elif self.year==2025:
            naiset_in=np.array([0.0032096446692947583,0.0037673799131181605,0.0030652243446419648,0.001747364723624794,0.0006124196364131928,0.0012563367899846016,0.00044262450825248775,0.0008516874812164338,0.0004043765384452949,0.0010072337070020914,0.0005247979884547706,0.0003,0.0003,0.0008519371767038075,0.0009526729770681643,0.00112044044357432,0.0009151473348066909,0.000935774600197938,0.0016892832749937378,0.0004938019987728952,0.0009063955998760385,0.001098506505851516,0.0017689864670849067,0.0018522652389991567,0.0014744438266701867,0.0018798248798918928,0.0022894016732453006,0.002993294800853477,0.0033840684015581904,0.0035126827031577443,0.003433939931678483,0.004486248718504473,0.004503821154181344,0.006180521573662441,0.005643536853758908,0.0069389640840172425,0.007380221896408128,0.008825427344891541,0.013668344894919434,0.016080940260259764,0.023754399687428495,0.02881774779990569,0.0319898873216221,0.05631748847885379,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.0033172663907411245,0.003036255541920993,0.002811700904810991,0.0027461543892335033,0.0019014921038241748,0.0007621518544063064,0.0008875415196744792,0.0006630850059563771,0.0011359549242157374,0.0008073981636737504,0.0008043274102045596,0.0003,0.0003,0.0003,0.0010051249840304813,0.0003,0.0014215361890685403,0.0009257315503269268,0.0010244401520617186,0.001199598959515221,0.001041734179510943,0.0011721010447761698,0.0016547127779423193,0.0014767557949190006,0.00151155522338169,0.0007784091649640849,0.0019341428580230018,0.003531666661902588,0.003753512393498012,0.003966748024269306,0.0036412616803970033,0.004194674277407201,0.004727925122861967,0.005496756903404218,0.006028551189916889,0.007784776572525908,0.007285759457239851,0.009772705997325434,0.011781926003470203,0.01691997231793992,0.020880866567773104,0.02673500505374338,0.03034300914359823,0.05154121162964108,0.04451220283252059,0.06811768566504117,0.09172316849756176,0,0,0,0,0,0])
        elif self.year==2026:
            naiset_in=np.array([0.0032096446692947583,0.0037673799131181605,0.0030652243446419648,0.001747364723624794,0.0006124196364131928,0.0012563367899846016,0.00044262450825248775,0.0008516874812164338,0.0004043765384452949,0.0010072337070020914,0.0005247979884547706,0.0003,0.0003,0.0008519371767038075,0.0009526729770681643,0.00112044044357432,0.0009151473348066909,0.000935774600197938,0.0016892832749937378,0.0004938019987728952,0.0009063955998760385,0.001098506505851516,0.0017689864670849067,0.0018522652389991567,0.0014744438266701867,0.0018798248798918928,0.0022894016732453006,0.002993294800853477,0.0033840684015581904,0.0035126827031577443,0.003433939931678483,0.004486248718504473,0.004503821154181344,0.006180521573662441,0.005643536853758908,0.0069389640840172425,0.007380221896408128,0.008825427344891541,0.013668344894919434,0.016080940260259764,0.023754399687428495,0.02881774779990569,0.0319898873216221,0.05631748847885379,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.0033172663907411245,0.003036255541920993,0.002811700904810991,0.0027461543892335033,0.0019014921038241748,0.0007621518544063064,0.0008875415196744792,0.0006630850059563771,0.0011359549242157374,0.0008073981636737504,0.0008043274102045596,0.0003,0.0003,0.0003,0.0010051249840304813,0.0003,0.0014215361890685403,0.0009257315503269268,0.0010244401520617186,0.001199598959515221,0.001041734179510943,0.0011721010447761698,0.0016547127779423193,0.0014767557949190006,0.00151155522338169,0.0007784091649640849,0.0019341428580230018,0.003531666661902588,0.003753512393498012,0.003966748024269306,0.0036412616803970033,0.004194674277407201,0.004727925122861967,0.005496756903404218,0.006028551189916889,0.007784776572525908,0.007285759457239851,0.009772705997325434,0.011781926003470203,0.01691997231793992,0.020880866567773104,0.02673500505374338,0.03034300914359823,0.05154121162964108,0.04451220283252059,0.06811768566504117,0.09172316849756176,0,0,0,0,0,0])
        else:
            error(999)
            
        # oletetaan, että tk-alkavuus kasvaa 0,7% vuodessa iästä 59 alkaen
        #y=np.arange(53-41)*0.007
        dis2_miehet=dis_miehet
        dis2_miehet[41:]=dis_miehet[41:]#+y

        #y=np.arange(53-41)*0.007
        dis2_naiset=dis_naiset
        dis2_naiset[41:]=dis_naiset[41:]#+y
            
        for g in range(3):
            disab[18:71,g]=dfactor[g]*dis2_miehet
            disab[71:(self.max_age+1),g]=disab[70,g]
        for g in range(3,6):
            disab[18:71,g]=dfactor[g]*dis2_naiset
            disab[71:(self.max_age+1),g]=disab[70,g]
            
        #disab=1-(1-disab)**self.timestep
        disab = self.scale_rates(disab)

        return disab        
        
    def get_eff_disab_rate_v4(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Sisältää myös sairausvakuutuspäivärahasiirtymät
        Laskettu havaitusta työkyvyttömien lukumäärästä
        Siksi efektiivinen 
        Revisio 2022
        
        Huomioi M.Laaksonen: Työkyvyttömyyseläkkeelle siirtyminen: trendit, tilannekuva, tulevaisuus
        '''
        disab=np.zeros((self.max_age+1,self.n_groups,self.n_empl))
        prop=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
            unempfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            dfactor=np.array([1.2,0.99,0.,1.12,0.99,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            
            base=1.05
            unemp=1.0*base
            unempfactor=np.array([unemp,base,base,base,unemp,base,base,base,base,base,base,base,base,unemp,base,0.0])
            
        if not self.silent:
            print(f'disability rate from year {self.year}')
            
        if self.year==2018:
            naiset_in=np.array([0.0022405691471677346,0.0028029347008399087,0.002653046320194355,0.0026883764894571273,0.0014880964625165272,0.0012831033837961063,0.0004918476488315644,0.0009138700835908024,0.00043764454148174437,0.0003,0.0003,0.0007444843487586423,0.0008866596300537446,0.0009000126307566958,0.000571566314750823,0.0007934915730612233,0.0014854286103005761,0.00035755311664076246,0.0007809005041911009,0.0007380284551836546,0.001665353939184701,0.0015383300480508117,0.0015327426355888634,0.001703357986695096,0.0024114371504144368,0.0027570209892189635,0.0032683686826615135,0.0029800198035666668,0.0032065977965771817,0.003658944888352902,0.0037769439974031467,0.005074179664769313,0.0050419030685216176,0.005678280791766548,0.005507140687843919,0.006348194637514865,0.010284721923118523,0.011802383127200717,0.01602907094765649,0.018361334284173775,0.023195092802516044,0.0289408628852481,0.02891593368444875,0.052675084076576076,0.04479751311501741,0.07943392685117287,0.11944315089789737,0.1648251852551909,0.21558002992305347,0.27170768490148506,0.33320815019048566,0.40008142579005535,0.47232751170019405])
            miehet_in=np.array([0.0020282359412728906,0.004025272690606772,0.004045430215264155,0.0018245008709171565,0.0015864210370592363,0.0010967912746402365,0.0018933663999702722,0.0014722893149959116,0.0008351804620221053,0.00033,0.00033,0.00033,0.0009648151731765731,0.00033,0.0018031750600651891,0.0012185249213899569,0.0012502187826932353,0.0010253712316433913,0.0008647260385692231,0.0007776113773148861,0.0016835582570671706,0.0015185062240844328,0.0018449433152839076,0.0005631234144229169,0.0019349708144611123,0.0033776255489086867,0.0036495336557529705,0.003953764632295431,0.0038545428452270735,0.004056839876306189,0.004665121956632313,0.005065050074281188,0.006146694368839761,0.006728533250916835,0.006295205930812254,0.007892053935929332,0.010623639897704179,0.014281817085207718,0.01484311006203395,0.017706931055202896,0.025066337254444036,0.03363884617419562,0.03512637075043493,0.05712859849691879,0.045516838926810674,0.07012695785362134,0.09473707678043201,0.11934719570724268,0.14395731463405337,0.16856743356086404,0.1931775524876747,0.21778767141448538,0.24239779034129605])
        elif self.year==2019:
            naiset_in=np.array([0.0030467662075624384,0.0031264126629215283,0.002577567813612649,0.001824015431373127,0.0017642527875080258,0.001019297985969914,0.0008209250247937746,0.0006471881252425429,0.0008202368268938103,0.0004567339631660877,0.0003,0.0003,0.0006869591102671889,0.0008225671833487609,0.0007160031711696683,0.0009356463032724046,0.000987271225820792,0.0017840022937542375,0.0005021567605162354,0.0007961770123721067,0.0009289217390011377,0.0015418759832412365,0.001855455789099436,0.001496798136321204,0.0020177635847036337,0.002221848412033196,0.0028634470147270454,0.0033088359912555403,0.003150767309428243,0.003191598010591702,0.004152565907737649,0.004266148243750837,0.005809516184344099,0.005141658242998873,0.0060934417188670984,0.006323873300449263,0.007738751847758353,0.011874009012314163,0.014016708866707115,0.018696103620300757,0.02330672360071526,0.028052408758834173,0.031502056430273324,0.05371744726773898,0.04653143942831896,0.07897481603834451,0.11482752123922337,0.1540895550309555,0.19676091741354096,0.2428416083869797,0.29233162795127177,0.3452309761064171,0.4015396528524158])
            miehet_in=np.array([0.0008768478960776173,0.0029624874342752895,0.0035670299813887873,0.002822114603201518,0.0010906634546966843,0.0011762647360189578,0.0005529001661454683,0.0015407077388677858,0.0007208028002052651,0.0008206187321800574,0.0003,0.0003,0.0003,0.0009114081642699395,0.0003,0.0014071590546393378,0.000989310388436477,0.0010154218919266875,0.00114604106258592,0.0009116335761962793,0.0009321940460377276,0.0016261662441440935,0.0014917658201391982,0.0016299103757713492,0.0005897349965863893,0.0018936394272891118,0.0034001875265309597,0.0036733501427922465,0.003645807292281047,0.0035033343053438334,0.0037024274107012776,0.004668737325009231,0.005074695759797924,0.006276354369372645,0.006724048357576113,0.006636385518222012,0.00803445222304866,0.010541761327601061,0.014852053262604194,0.016064490963544505,0.021260950204543678,0.02686691568391662,0.03260452989879999,0.054115555593402365,0.044294463927808614,0.06768220785561722,0.09106995178342583,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176])
        elif self.year==2020:
            naiset_in=np.array([0.0032057900573504252,0.0037665806669729546,0.003063494351008529,0.001746396922614755,0.0006122701824508831,0.0012562114821060876,0.0004424806542084004,0.0008514750837024924,0.0004043160501220667,0.0010071134618272568,0.0005246765706773503,0.0003,0.0003,0.0008519621616641191,0.0009528403622877142,0.0011205097284547314,0.000915063548008863,0.0009357468373485878,0.0016899660304384651,0.0004939560711594078,0.0009065266879820023,0.0010987687887873128,0.0017697888012953042,0.0018529974932293902,0.0014747149721313086,0.0018809028587262256,0.0022907868807317596,0.002994782198499791,0.0033853796324532087,0.0035145742252911216,0.0034373981987301104,0.004488799940429093,0.004507186691935857,0.006185302329706142,0.005649458363183664,0.006948799610713227,0.007385002536567153,0.008833225495820697,0.013685075790395844,0.016101027421286697,0.023759362700734723,0.02884838542248692,0.031942891894368754,0.056270493051600444,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.003312921356677685,0.0030357895520709216,0.002810507502002098,0.0027445417556540615,0.0019006739051494654,0.0007618109716788908,0.00088699580633,0.0006629279823972243,0.0011357265376427702,0.0008074674391362932,0.000804129612326832,0.0003,0.0003,0.0003,0.0010047331504185976,0.0003,0.0014214952075956625,0.0009256277876659401,0.0010246361370275855,0.001199534370179977,0.0010416497882718982,0.001172000728565787,0.0016546178578785268,0.001477014081664504,0.0015113353766801829,0.000778318841281435,0.0019340871316236323,0.0035319782389435154,0.003754687339700251,0.003966748024269306,0.0036423551158887646,0.004194674277407201,0.004729449031040165,0.005498664054739616,0.006026747962114209,0.007790284506777275,0.007292661710263467,0.00977679524007642,0.01179384393409373,0.016933616234332843,0.020878938213157026,0.026739297764895233,0.03020963551685557,0.05140783800289842,0.04451220283252059,0.06811768566504117,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176])            
        elif self.year==2021:
            naiset_in=np.array([0.0032057900573504252,0.0037665806669729546,0.003063494351008529,0.001746396922614755,0.0006122701824508831,0.0012562114821060876,0.0004424806542084004,0.0008514750837024924,0.0004043160501220667,0.0010071134618272568,0.0005246765706773503,0.0003,0.0003,0.0008519621616641191,0.0009528403622877142,0.0011205097284547314,0.000915063548008863,0.0009357468373485878,0.0016899660304384651,0.0004939560711594078,0.0009065266879820023,0.0010987687887873128,0.0017697888012953042,0.0018529974932293902,0.0014747149721313086,0.0018809028587262256,0.0022907868807317596,0.002994782198499791,0.0033853796324532087,0.0035145742252911216,0.0034373981987301104,0.004488799940429093,0.004507186691935857,0.006185302329706142,0.005649458363183664,0.006948799610713227,0.007385002536567153,0.008833225495820697,0.013685075790395844,0.016101027421286697,0.023759362700734723,0.02884838542248692,0.031942891894368754,0.056270493051600444,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.003312921356677685,0.0030357895520709216,0.002810507502002098,0.0027445417556540615,0.0019006739051494654,0.0007618109716788908,0.00088699580633,0.0006629279823972243,0.0011357265376427702,0.0008074674391362932,0.000804129612326832,0.0003,0.0003,0.0003,0.0010047331504185976,0.0003,0.0014214952075956625,0.0009256277876659401,0.0010246361370275855,0.001199534370179977,0.0010416497882718982,0.001172000728565787,0.0016546178578785268,0.001477014081664504,0.0015113353766801829,0.000778318841281435,0.0019340871316236323,0.0035319782389435154,0.003754687339700251,0.003966748024269306,0.0036423551158887646,0.004194674277407201,0.004729449031040165,0.005498664054739616,0.006026747962114209,0.007790284506777275,0.007292661710263467,0.00977679524007642,0.01179384393409373,0.016933616234332843,0.020878938213157026,0.026739297764895233,0.03020963551685557,0.05140783800289842,0.04451220283252059,0.06811768566504117,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176])            
        elif self.year==2022:
            naiset_in=np.array([0.0032057900573504252,0.0037665806669729546,0.003063494351008529,0.001746396922614755,0.0006122701824508831,0.0012562114821060876,0.0004424806542084004,0.0008514750837024924,0.0004043160501220667,0.0010071134618272568,0.0005246765706773503,0.0003,0.0003,0.0008519621616641191,0.0009528403622877142,0.0011205097284547314,0.000915063548008863,0.0009357468373485878,0.0016899660304384651,0.0004939560711594078,0.0009065266879820023,0.0010987687887873128,0.0017697888012953042,0.0018529974932293902,0.0014747149721313086,0.0018809028587262256,0.0022907868807317596,0.002994782198499791,0.0033853796324532087,0.0035145742252911216,0.0034373981987301104,0.004488799940429093,0.004507186691935857,0.006185302329706142,0.005649458363183664,0.006948799610713227,0.007385002536567153,0.008833225495820697,0.013685075790395844,0.016101027421286697,0.023759362700734723,0.02884838542248692,0.031942891894368754,0.056270493051600444,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.003312921356677685,0.0030357895520709216,0.002810507502002098,0.0027445417556540615,0.0019006739051494654,0.0007618109716788908,0.00088699580633,0.0006629279823972243,0.0011357265376427702,0.0008074674391362932,0.000804129612326832,0.0003,0.0003,0.0003,0.0010047331504185976,0.0003,0.0014214952075956625,0.0009256277876659401,0.0010246361370275855,0.001199534370179977,0.0010416497882718982,0.001172000728565787,0.0016546178578785268,0.001477014081664504,0.0015113353766801829,0.000778318841281435,0.0019340871316236323,0.0035319782389435154,0.003754687339700251,0.003966748024269306,0.0036423551158887646,0.004194674277407201,0.004729449031040165,0.005498664054739616,0.006026747962114209,0.007790284506777275,0.007292661710263467,0.00977679524007642,0.01179384393409373,0.016933616234332843,0.020878938213157026,0.026739297764895233,0.03020963551685557,0.05140783800289842,0.04451220283252059,0.06811768566504117,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176])            
        elif self.year==2023:
            naiset_in=np.array([0.0032057900573504252,0.0037665806669729546,0.003063494351008529,0.001746396922614755,0.0006122701824508831,0.0012562114821060876,0.0004424806542084004,0.0008514750837024924,0.0004043160501220667,0.0010071134618272568,0.0005246765706773503,0.0003,0.0003,0.0008519621616641191,0.0009528403622877142,0.0011205097284547314,0.000915063548008863,0.0009357468373485878,0.0016899660304384651,0.0004939560711594078,0.0009065266879820023,0.0010987687887873128,0.0017697888012953042,0.0018529974932293902,0.0014747149721313086,0.0018809028587262256,0.0022907868807317596,0.002994782198499791,0.0033853796324532087,0.0035145742252911216,0.0034373981987301104,0.004488799940429093,0.004507186691935857,0.006185302329706142,0.005649458363183664,0.006948799610713227,0.007385002536567153,0.008833225495820697,0.013685075790395844,0.016101027421286697,0.023759362700734723,0.02884838542248692,0.031942891894368754,0.056270493051600444,0.045876434911668415,0.0829412116600596,0.1260535193268122,0.17521335791192616,0.2304207274154015,0.29167562783723827,0.3589780591774364,0.43232802143599597,0.5117255146129169])
            miehet_in=np.array([0.003312921356677685,0.0030357895520709216,0.002810507502002098,0.0027445417556540615,0.0019006739051494654,0.0007618109716788908,0.00088699580633,0.0006629279823972243,0.0011357265376427702,0.0008074674391362932,0.000804129612326832,0.0003,0.0003,0.0003,0.0010047331504185976,0.0003,0.0014214952075956625,0.0009256277876659401,0.0010246361370275855,0.001199534370179977,0.0010416497882718982,0.001172000728565787,0.0016546178578785268,0.001477014081664504,0.0015113353766801829,0.000778318841281435,0.0019340871316236323,0.0035319782389435154,0.003754687339700251,0.003966748024269306,0.0036423551158887646,0.004194674277407201,0.004729449031040165,0.005498664054739616,0.006026747962114209,0.007790284506777275,0.007292661710263467,0.00977679524007642,0.01179384393409373,0.016933616234332843,0.020878938213157026,0.026739297764895233,0.03020963551685557,0.05140783800289842,0.04451220283252059,0.06811768566504117,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176,0.09172316849756176])            
        else:
            error(999)
            
        # puolet sv:llä olevisa vain 3 kk
        factor_3kk=0.5
            
        sv_miehet=np.maximum(0.005,miehet_in+np.minimum(0.03,miehet_in))
        sv_naiset=np.maximum(0.005,naiset_in+np.minimum(0.03,naiset_in))
        
        proportion_miehet=miehet_in/sv_miehet
        proportion_naiset=naiset_in/sv_naiset
        for g in range(3):
            prop[18:71,g]=proportion_miehet
            prop[18:71,g+3]=proportion_naiset
        prop[71:(self.max_age+1),:]=prop[70,:]

        for s in range(self.n_empl):
            for g in range(3):
                disab[18:71,g,s]=dfactor[g]*sv_miehet*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            for g in range(3,6):
                disab[18:71,g,s]=dfactor[g]*sv_naiset*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            
        disab[18:63,:,:]=disab[18:63,:,:]/factor_3kk

        #disab=1-(1-disab)**self.timestep
        disab = self.scale_rates(disab)
        
        return disab,prop

    def get_eff_disab_rate_v5(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Sisältää myös sairausvakuutuspäivärahasiirtymät
        Laskettu havaitusta työkyvyttömien lukumäärästä
        Siksi efektiivinen 
        Revisio 2022 v2
        
        Huomioi M.Laaksonen: Työkyvyttömyyseläkkeelle siirtyminen: trendit, tilannekuva, tulevaisuus
        '''
        disab=np.zeros((self.max_age+1,self.n_groups,self.n_empl))
        prop=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
            unempfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            dfactor=np.array([1.15,0.95,0.,1.1,0.95,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            
            base=1.05
            unemp=1.00*base
            unempfactor=np.array([unemp,base,base,base,unemp,base,base,base,base,base,base,base,base,unemp,base,0.0])
            
        if not self.silent:
            print(f'disability rate from year {self.year}')
            
        #### ['tk in']
        if self.year==2018:
            naiset_in=np.array([0.002240569147167735,0.00283200685778908,0.002683554316605775,0.002728306113621784,0.001512235687815352,0.001303422648528718,0.0005009792304755283,0.0009323159152463147,0.0004460693990794471,0.0003,0.0003,0.0007573270352170131,0.0009037354258046394,0.0009166277957462678,0.0005815737549401639,0.0008083988371769159,0.001510084271534821,0.0003639081780965127,0.0007958214361767537,0.0007507840318370519,0.001698472202926635,0.001573465081835211,0.001559893144515245,0.001738332165165157,0.002467360212227362,0.002820489723130312,0.003336750495857728,0.003054478295588274,0.003291500443220001,0.003744876625424616,0.003879092466617951,0.005197240490470014,0.005166573309268828,0.005836344156694304,0.00566267281688164,0.006535545480110624,0.01057597733780171,0.01220885369538871,0.01655911309948629,0.01903538725080984,0.02407395738989749,0.02998647907904263,0.02996119159628472,0.03331171122048433,0.03688079221290295,0.04066843457354059,0.04467463830239724,0.04889940339947291,0.0533427298647676,0.0580046176982813,0.06288506690001402,0.06798407746996576,0.07330164940813652])
            miehet_in=np.array([0.002028235941272891,0.00404696695388434,0.004071613706766048,0.001839339483856722,0.001595692616686218,0.001103873761681591,0.001907553966582574,0.001481988346484345,0.000839306463492008,0.00033,0.00033,0.00033,0.0009677408257137869,0.00033,0.001808088646836132,0.001223205614455866,0.001256478631267502,0.001030985403664989,0.000869592092765008,0.0007835833211889488,0.001698165185950294,0.00153213240043596,0.001858105579890286,0.0005696032367561405,0.001957985728145017,0.003418165853108365,0.003704527654272372,0.004010989638867825,0.00392687582987772,0.004122284183719258,0.004740397860921113,0.00515349290557239,0.006259104443302597,0.006849646422602119,0.006429981040608194,0.008089064891771348,0.01088733324212813,0.01465573962073418,0.01524253435900088,0.01822828388625462,0.02584824050185047,0.03481180405701452,0.03637839732392673,0.04166236306515819,0.04752088285988407,0.05337940265460996,0.05923792244933585,0.06509644224406175,0.07095496203878764,0.07681348183351352,0.08267200162823941,0.0885305214229653,0.09438904121769119])
        elif self.year==2019:
            naiset_in=np.array([0.003046766207562438,0.003150132946302043,0.00260641840406524,0.001845391794320784,0.001789917712432442,0.001036606171913843,0.0008348136191145071,0.0006599102228335747,0.000835159404099796,0.000465063704771931,0.0003,0.0003,0.0006983923438590998,0.000837048246377918,0.0007290885155792788,0.0009520694466366827,0.001005762183985924,0.00181751099760298,0.0005112681030935111,0.0008096420051333653,0.000946916879331619,0.001575276914479799,0.001894958271075529,0.001530025662020569,0.002066105348027342,0.002271356813052551,0.002926476384029114,0.003380750954916068,0.003226812714945269,0.003263278898228071,0.004262271251903596,0.004375469840345895,0.005998562210128871,0.005288289345490774,0.00624974223224337,0.006496307916145667,0.007984774576722933,0.0122449436277683,0.01450672241322663,0.01932698234127767,0.02421112173990487,0.02910123208955753,0.03261298957729737,0.03713955636831506,0.0415926998750744,0.04635833805740412,0.05143647091530423,0.0568270984487747,0.06253022065781556,0.0685458375424268,0.07487394910260842,0.08151455533836041,0.08846765624968278])
            miehet_in=np.array([0.0008768478960776173,0.00297836058497371,0.003585739399207565,0.002839319472182281,0.001098393270749022,0.001185941110229571,0.0005569168387246968,0.001551966624116089,0.0007256405470245902,0.0008253817199151582,0.0003,0.0003,0.0003,0.0009153144238223987,0.0003,0.001414807284738952,0.0009923919401956663,0.00101852578455522,0.001152397314025691,0.0009190428998091469,0.0009372261175829127,0.001640481074341562,0.001512034576833872,0.00164748061657052,0.0005954742503205457,0.00191415699911965,0.003450278948210607,0.003730391294937582,0.003706136284169424,0.003562861225112185,0.00376908189264438,0.004747538649958258,0.005170042672026622,0.00640482506416637,0.006874811841995068,0.00681425987544523,0.008218853498992358,0.01084892098769615,0.01519156477199276,0.01659231155540761,0.02191449661961251,0.0277131551744625,0.03367020964056695,0.0382898708577105,0.04371426068328622,0.04916420169920465,0.05461414271512308,0.0600640837310415,0.06551402474695993,0.07096396576287836,0.0764139067787968,0.08186384779471523,0.08731378881063366])
        elif self.year==2020:
            naiset_in=np.array([0.003209644669294758,0.003799920178159763,0.003097094026713886,0.001766807807214461,0.0006215983371057093,0.001277157387834081,0.0004506179126790295,0.0008659402369763224,0.0004119058414391996,0.001023454368450348,0.0005343815173892061,0.0003,0.0003,0.000867675957000051,0.0009681542837569262,0.00114273189033527,0.0009312358426703889,0.0009530299722643059,0.001726478198765984,0.000502720887379183,0.0009241814784370745,0.001119342835425881,0.001805198018594328,0.001889888121063912,0.001505277818954812,0.00191994987846504,0.002343666982835658,0.003065081129439766,0.003462177302382688,0.003595749139462601,0.00351952369408254,0.004608673786768381,0.004633319919296547,0.006352398179369113,0.005810210450915396,0.007130250499470296,0.007606484849054718,0.00906587566371813,0.01412672611440123,0.01665481151406073,0.02460667596543136,0.02991104417659145,0.03323424293143709,0.03801112213569606,0.0433501997911049,0.0492514758976636,0.05571495045537217,0.06274062346423061,0.07032849492423891,0.07847856483539709,0.08719083319770513,0.09646530001116303,0.1063019652757708])
            miehet_in=np.array([0.003317266390741124,0.003051124240647728,0.002826490613966869,0.002760921542465555,0.001915164045653605,0.0007685983955874741,0.0008944749067919717,0.0006680757817282576,0.001140859230707569,0.0008118334239129677,0.0008093295542247348,0.0003,0.0003,0.0003,0.001007018285281474,0.0003,0.001427774550330999,0.0009308201949359495,0.00102871332005268,0.001208342042486007,0.001050359583994814,0.001184069637808307,0.001673499355577991,0.001493635846544821,0.001532911422420672,0.0007900062351251946,0.001965928916071789,0.003585811464186885,0.003804386355373256,0.004034471336943486,0.003700037717545585,0.004274256466370673,0.004819825603729086,0.005604910313348336,0.006155463812861162,0.007947620394379861,0.007450118847029733,0.01002298747099732,0.01213624706541013,0.01744358894392391,0.02156151230689813,0.02754960303869023,0.03139035155774641,0.03620387768083048,0.04101740380391455,0.04588137667816865,0.05074534955242276,0.05560932242667686,0.06047329530093097,0.06533726817518508,0.07020124104943919,0.0750652139236933,0.0799291867979474])
        elif self.year==2021:
            naiset_in=np.array([0.003205790057350425,0.003795577704078534,0.003096572110398722,0.001769619089972586,0.0006212453893815915,0.001278735787279284,0.0004499980927910692,0.000865893285117846,0.000411882052494584,0.001025127792829804,0.000534131614974095,0.0003,0.0003,0.0008667895624878872,0.0009696284555817844,0.001143393248154119,0.0009300739801717957,0.0009548076266401822,0.001718143088333575,0.0005050035938275536,0.0009271505070855574,0.001118200827247567,0.001806246731536946,0.001887472052318504,0.001505592243648464,0.001923192053312339,0.002345710848802115,0.003056599698777474,0.003475953544337118,0.00360515049905342,0.00353435534426048,0.004610900871160373,0.004620089653417353,0.006346200632457465,0.005821034138899248,0.007140898950617545,0.007606025731173752,0.00912562866291117,0.01411319044563914,0.01664435754201162,0.02469419539713107,0.02986972820164304,0.03310572940978351,0.03785386415081961,0.04315624080302161,0.04901285936638951,0.05542371984092331,0.06238882222662302,0.06990816652348864,0.07798175273152015,0.08660958085071757,0.0957916508810809,0.1055279628226101])
            miehet_in=np.array([0.003317266390741124,0.003050770175643737,0.002827436027150884,0.002764378067930459,0.001914591761831917,0.0007678898428028301,0.0008927242147611773,0.0006678836446066648,0.001142552806886844,0.000809992698302891,0.000806814121042284,0.0003,0.0003,0.0003,0.001008427348259692,0.0003,0.001427357788906778,0.0009309448015649064,0.001030477512462847,0.001209766442041297,0.001049927095702576,0.001183333770128438,0.001671732720616837,0.001492828938851356,0.001530755998494177,0.0007886416952107916,0.001966334582394617,0.003575272718208042,0.003822155442534982,0.004032115894549989,0.003701911313988764,0.004269800569055209,0.004810956004998327,0.005613000288792783,0.006170675507518523,0.007961136460477473,0.007470695212052175,0.01001178378296434,0.0120962266004698,0.01740908309657551,0.02153231548584765,0.02763377463177213,0.03136826496359085,0.03618627455437111,0.04100428414515137,0.0458722763099773,0.05074026847480324,0.05560826063962917,0.0604762528044551,0.06534424496928104,0.07021223713410697,0.0750802292989329,0.07994822146375884])
        elif self.year==2022:
            naiset_in=np.array([0.003205790057350425,0.003793630685292842,0.003093070375498094,0.001767071115669378,0.0006211776453331516,0.00127608050960111,0.0004513964014758811,0.0008676008345072638,0.0004127771769126108,0.001025651647021652,0.0005336850419095687,0.0003,0.0003,0.0008674112925738213,0.0009693219183904918,0.001143510650283,0.0009316347943692715,0.0009525039344184183,0.001723934880247049,0.0005047373520757854,0.0009226561340750475,0.001123389049029489,0.001804322830736052,0.001890469642017057,0.001509910630433301,0.001921328572392496,0.00234920690077184,0.00306545181578358,0.003476000756454417,0.003594724217189656,0.003533646038064176,0.004605967202055547,0.004633425552285358,0.006355503611190801,0.005808974365796376,0.007166704508342898,0.007627639155600277,0.009092224107552258,0.01411741562487647,0.01670377163734234,0.02458597256066593,0.02988529377096973,0.0331532996666483,0.03791227067709126,0.04321439543702849,0.04905967394645998,0.05544810620538575,0.06237969221380579,0.0698544319717201,0.07787232547912869,0.08643337273603155,0.09553757374242867,0.1051849284983201])
            miehet_in=np.array([0.003317266390741124,0.003043673049904588,0.002829313705607368,0.002759496414418337,0.001915370497464588,0.0007690027184184313,0.0008929052197771341,0.0006678795480417434,0.001141710372443323,0.0008114234190312451,0.0008088350794745923,0.0003,0.0003,0.0003,0.001009036236095603,0.0003,0.001426123989527994,0.0009297486498588512,0.001029588895142984,0.001209237875775395,0.001052248637897293,0.001184431057949251,0.001672779038311537,0.001497936509303618,0.001534529300043599,0.0007895630165296366,0.001963516404258109,0.00358489423016775,0.003812508313783341,0.004031603653044219,0.003708873322641715,0.004270339579609043,0.004823497259024826,0.005606659776986426,0.006141905437598929,0.00796389795719738,0.007482820996704584,0.01003561967230545,0.0121118737709785,0.01743616466889386,0.02150646882439291,0.0276799920449786,0.03146367395848509,0.03630162400536174,0.04113957405223839,0.04604785035919975,0.05095612666616112,0.05586440297312249,0.06077267928008386,0.06568095558704523,0.0705892318940066,0.07549750820096796,0.08040578450792932])
        elif self.year==2023:
            naiset_in=np.array([0.003205790057350425,0.003793244206978519,0.003090851000693029,0.001768718816390639,0.0006220802284540547,0.001276084550312299,0.0004502739958374131,0.0008659817693224551,0.0004125219973975502,0.001025874591616903,0.000533687797756224,0.0003,0.0003,0.0008666932208113302,0.0009699283207330015,0.001141118337524871,0.0009337775549799416,0.0009502092980506673,0.00172408478598178,0.000503984094786644,0.0009265519259072762,0.001121729207877445,0.001809850576530114,0.001892060174705069,0.0015066868072952,0.001921099258006878,0.002342110691173308,0.003070234952816345,0.003459007887191579,0.003600646444715728,0.003527607480065912,0.004610156230230153,0.004619924833681456,0.00636207038794325,0.005805865627198026,0.00715868570065283,0.007639593963839344,0.009114942836994698,0.01413131290079988,0.01666369567803347,0.02462406926815099,0.02979424893042248,0.03310157374191864,0.03784413895219833,0.04313924977073955,0.0489869061975423,0.05538710823260657,0.06233985587593237,0.0698451491275197,0.07790298798736855,0.08651337245547894,0.09567630253185085,0.1053917782164843])
            miehet_in=np.array([0.003317266390741124,0.003052553577881668,0.002824003331490422,0.002762651614633295,0.001914179697143843,0.0007672471348141539,0.0008940173828491067,0.0006680154157501035,0.001142656680751568,0.0008109156673890497,0.0008079871038088495,0.0003,0.0003,0.0003,0.001008948987974065,0.0003,0.001427492841838225,0.0009302369295662459,0.001029585179305543,0.00120731370362845,0.001049128501065875,0.001183941681613389,0.001670634570544423,0.001492488056009351,0.00152777186769638,0.0007899898696118552,0.001960123675130924,0.003579123797184571,0.003816655164337006,0.004027153008322036,0.003704758544172123,0.004276902361482418,0.004814241952566774,0.005601620018932429,0.00615160128333779,0.007960027576114847,0.007465144517352648,0.009985255708902071,0.01209876466284446,0.01739269197228414,0.02158953622595897,0.02756512642573815,0.03145182078813771,0.03629008481946102,0.04112834885078433,0.04601305200699067,0.05089775516319701,0.05578245831940336,0.0606671614756097,0.06555186463181605,0.07043656778802239,0.07532127094422873,0.08020597410043508])
        elif self.year==2024:
            naiset_in=np.array([0.003205790057350425,0.003796768179708147,0.0031007398401911,0.00177000553173142,0.0006202922152202763,0.001277426952628966,0.0004496764063254305,0.0008658150286146368,0.0004118430797913868,0.001025462698857024,0.0005344786654174449,0.0003,0.0003,0.000866620913730811,0.0009691382617981447,0.001142090796296168,0.0009292117697816296,0.0009551184257909224,0.001722491398069961,0.0005039423601155673,0.0009246160176174261,0.00112163435749935,0.001806632237451709,0.001891675331114365,0.00150895662275571,0.00192298714622814,0.002344161103306969,0.00307065075080677,0.003472171564922221,0.00361142764604485,0.003524804251541114,0.004596350800109359,0.004626819025464433,0.006346453760847216,0.005825961630119947,0.007172726947466318,0.00763571795253041,0.00909043098086146,0.0141590910359328,0.01664870194245949,0.02461630130053801,0.02985977899499483,0.03306862542069407,0.0377960090168844,0.04308283578549062,0.04892910572651276,0.0553348188399508,0.06229997512580476,0.06982457458407462,0.07790861721476039,0.08655210301786206,0.09575503199337965,0.1055174041413132])
            miehet_in=np.array([0.003317266390741124,0.003050416121987851,0.002826189318450603,0.002759513486067853,0.001915388438926224,0.0007683709213346891,0.0008932819631528603,0.0006666959033110477,0.001140991489662623,0.0008121852316000823,0.0008081581929254755,0.0003,0.0003,0.0003,0.001007135408426765,0.0003,0.001430196544666065,0.0009313189396418693,0.001028286900484492,0.001208857901325018,0.00104992026919112,0.001181306744954552,0.001673867487292286,0.001491401170445358,0.001531434174502872,0.0007891659596856931,0.001959539395222482,0.003588164519685764,0.003815537099506407,0.004038856854850682,0.003701579215595345,0.004261394676859026,0.004826238611564865,0.00559601937879816,0.006141941807424723,0.007972193953967553,0.007443720162411006,0.01000268178705509,0.01207588396156187,0.01739598001347379,0.02154084673843953,0.02759046592152158,0.0314000849912261,0.03623113524864215,0.04106218550605821,0.04594252019796288,0.05082285488986756,0.05570318958177223,0.0605835242736769,0.06546385896558157,0.07034419365748625,0.07522452834939092,0.08010486304129559])
        elif self.year==2025:
            naiset_in=np.array([0.003205790057350425,0.003796768179708147,0.0031007398401911,0.00177000553173142,0.0006202922152202763,0.001277426952628966,0.0004496764063254305,0.0008658150286146368,0.0004118430797913868,0.001025462698857024,0.0005344786654174449,0.0003,0.0003,0.000866620913730811,0.0009691382617981447,0.001142090796296168,0.0009292117697816296,0.0009551184257909224,0.001722491398069961,0.0005039423601155673,0.0009246160176174261,0.00112163435749935,0.001806632237451709,0.001891675331114365,0.00150895662275571,0.00192298714622814,0.002344161103306969,0.00307065075080677,0.003472171564922221,0.00361142764604485,0.003524804251541114,0.004596350800109359,0.004626819025464433,0.006346453760847216,0.005825961630119947,0.007172726947466318,0.00763571795253041,0.00909043098086146,0.0141590910359328,0.01664870194245949,0.02461630130053801,0.02985977899499483,0.03306862542069407,0.0377960090168844,0.04308283578549062,0.04892910572651276,0.0553348188399508,0.06229997512580476,0.06982457458407462,0.07790861721476039,0.08655210301786206,0.09575503199337965,0.1055174041413132])
            miehet_in=np.array([0.003317266390741124,0.003050416121987851,0.002826189318450603,0.002759513486067853,0.001915388438926224,0.0007683709213346891,0.0008932819631528603,0.0006666959033110477,0.001140991489662623,0.0008121852316000823,0.0008081581929254755,0.0003,0.0003,0.0003,0.001007135408426765,0.0003,0.001430196544666065,0.0009313189396418693,0.001028286900484492,0.001208857901325018,0.00104992026919112,0.001181306744954552,0.001673867487292286,0.001491401170445358,0.001531434174502872,0.0007891659596856931,0.001959539395222482,0.003588164519685764,0.003815537099506407,0.004038856854850682,0.003701579215595345,0.004261394676859026,0.004826238611564865,0.00559601937879816,0.006141941807424723,0.007972193953967553,0.007443720162411006,0.01000268178705509,0.01207588396156187,0.01739598001347379,0.02154084673843953,0.02759046592152158,0.0314000849912261,0.03623113524864215,0.04106218550605821,0.04594252019796288,0.05082285488986756,0.05570318958177223,0.0605835242736769,0.06546385896558157,0.07034419365748625,0.07522452834939092,0.08010486304129559])
        elif self.year==2026:
            naiset_in=np.array([0.003205790057350425,0.003796768179708147,0.0031007398401911,0.00177000553173142,0.0006202922152202763,0.001277426952628966,0.0004496764063254305,0.0008658150286146368,0.0004118430797913868,0.001025462698857024,0.0005344786654174449,0.0003,0.0003,0.000866620913730811,0.0009691382617981447,0.001142090796296168,0.0009292117697816296,0.0009551184257909224,0.001722491398069961,0.0005039423601155673,0.0009246160176174261,0.00112163435749935,0.001806632237451709,0.001891675331114365,0.00150895662275571,0.00192298714622814,0.002344161103306969,0.00307065075080677,0.003472171564922221,0.00361142764604485,0.003524804251541114,0.004596350800109359,0.004626819025464433,0.006346453760847216,0.005825961630119947,0.007172726947466318,0.00763571795253041,0.00909043098086146,0.0141590910359328,0.01664870194245949,0.02461630130053801,0.02985977899499483,0.03306862542069407,0.0377960090168844,0.04308283578549062,0.04892910572651276,0.0553348188399508,0.06229997512580476,0.06982457458407462,0.07790861721476039,0.08655210301786206,0.09575503199337965,0.1055174041413132])
            miehet_in=np.array([0.003317266390741124,0.003050416121987851,0.002826189318450603,0.002759513486067853,0.001915388438926224,0.0007683709213346891,0.0008932819631528603,0.0006666959033110477,0.001140991489662623,0.0008121852316000823,0.0008081581929254755,0.0003,0.0003,0.0003,0.001007135408426765,0.0003,0.001430196544666065,0.0009313189396418693,0.001028286900484492,0.001208857901325018,0.00104992026919112,0.001181306744954552,0.001673867487292286,0.001491401170445358,0.001531434174502872,0.0007891659596856931,0.001959539395222482,0.003588164519685764,0.003815537099506407,0.004038856854850682,0.003701579215595345,0.004261394676859026,0.004826238611564865,0.00559601937879816,0.006141941807424723,0.007972193953967553,0.007443720162411006,0.01000268178705509,0.01207588396156187,0.01739598001347379,0.02154084673843953,0.02759046592152158,0.0314000849912261,0.03623113524864215,0.04106218550605821,0.04594252019796288,0.05082285488986756,0.05570318958177223,0.0605835242736769,0.06546385896558157,0.07034419365748625,0.07522452834939092,0.08010486304129559])
        else:
            print("Error: Unknown year in ['tk in']")
            
        # puolet sv:llä olevisa vain 3 kk, puolet yhden vuoden, skaalataan alkavuus
        
        # naisilla liian korkea alkavuus! FIXME
        
        svrate_men,svrate_women,mfactor_3m,wfactor_3m=self.get_svrate()

        mfactor_1y=1.0-mfactor_3m
        mlfactor_3m=mfactor_3m*0.25+mfactor_1y*1.0

        wfactor_1y=1.0-wfactor_3m
        wlfactor_3m=wfactor_3m*0.25+wfactor_1y*1.0

        # skaalataan päivät oikeiksi
        svrate_men_scaled = svrate_men/mlfactor_3m
        svrate_women_scaled = svrate_women/wlfactor_3m
        
        sv_miehet = np.maximum(miehet_in,svrate_men_scaled)
        sv_naiset = np.maximum(naiset_in,svrate_women_scaled)

        # vuoden kestäviä sairauspoissaoloja
        sv_miehet_1y = np.maximum(miehet_in,mfactor_1y*sv_miehet)
        sv_naiset_1y = np.maximum(naiset_in,wfactor_1y*sv_naiset)
        
        # mikä osuus menee vuoden kuluttua tk:lle sv:tlä
        proportion_miehet=miehet_in/sv_miehet_1y
        proportion_naiset=naiset_in/sv_naiset_1y
        for g in range(3):
            prop[18:71,g]=proportion_miehet
            prop[18:71,g+3]=proportion_naiset
        prop[71:(self.max_age+1),:]=prop[70,:]

        for s in range(self.n_empl):
            for g in range(3):
                disab[18:71,g,s]=dfactor[g]*sv_miehet*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            for g in range(3,6):
                disab[18:71,g,s]=dfactor[g]*sv_naiset*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            
        #disab[18:63,:,:]=disab[18:63,:,:]
            
        #disab=1-(1-disab)**self.timestep
        disab = self.scale_rates(disab)

        prop2=1-prop**self.timestep
        sv_3m=np.zeros((self.max_age+1,6))
        for k in range(3):
            sv_3m[18:71,k]=mfactor_3m
            sv_3m[18:71,3+k]=wfactor_3m
        
        return disab,prop,sv_3m

    def get_eff_disab_rate_v7(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Sisältää myös sairausvakuutuspäivärahasiirtymät
        Laskettu havaitusta työkyvyttömien lukumäärästä
        Siksi efektiivinen 
        Revisio 2022 v2
        
        Huomioi M.Laaksonen: Työkyvyttömyyseläkkeelle siirtyminen: trendit, tilannekuva, tulevaisuus
        '''
        disab=np.zeros((self.max_age+1,self.n_groups,self.n_empl))
        prop=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
            unempfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            #dfactor=np.array([1.15,0.95,0.,1.1,0.95,0.])
            dfactor=np.array([1.30,1.15,0.,1.3,1.15,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            
            tyot = 0.15
            unemp_factor = 1.0
            base = 1.0/(1.0*(1-tyot)+unemp_factor*tyot)
            unemp = unemp_factor*base
            unempfactor = np.array([unemp,base,base,base,unemp,base,base,base,base,base,base,base,base,unemp,base,0.0])

        if not self.silent:
            #print(f'disability rate from year {self.year}')
            print(f'disability rate from year {self.year}',dfactor)

        ### ['tk in']
        if self.year==2018:
            naiset_in=np.array([0.00225637,0.00285303,0.00272017,0.00276426,0.00153909,0.00133623,0.00051327,0.00095359,0.00045776,0.0003,0.0003,0.00077579,0.00092309,0.00094257,0.00059829,0.00083235,0.00155162,0.00037367,0.00082263,0.00077634,0.00175247,0.00162098,0.00161858,0.00180674,0.00256038,0.00292463,0.00348515,0.00319246,0.00343956,0.00394907,0.00407914,0.00551985,0.00552495,0.0062749,0.00612249,0.00709538,0.01158953,0.01351907,0.01867153,0.02172611,0.02814559,0.03624596,0.03782652,0.04261526,0.04783755,0.05349338,0.05958275,0.06610567,0.07306212,0.08045212,0.08827566,0.09653274,0.10522336])
            miehet_in=np.array([0.00185931,0.00371772,0.00375807,0.00170408,0.00148356,0.00102665,0.00178036,0.00138344,0.00078413,0.0003,0.0003,0.0003,0.00090496,0.0003,0.00168961,0.00114358,0.00117666,0.00096683,0.0008131,0.00073641,0.00159344,0.00143849,0.00175924,0.00053682,0.00184799,0.00323446,0.00350652,0.00382305,0.00374113,0.00395282,0.00457859,0.00498418,0.00607619,0.00672186,0.00634862,0.00804012,0.01089459,0.01486636,0.01569139,0.01916797,0.0276742,0.03822342,0.04262133,0.04935381,0.05690027,0.06444673,0.07199319,0.07953966,0.08708612,0.09463258,0.10217904,0.1097255,0.11727196])
        elif self.year==2019:
            naiset_in=np.array([0.00306887,0.0031827,0.00264089,0.00187973,0.00182645,0.00105895,0.00085691,0.0006749,0.00085614,0.00047844,0.0003,0.0003,0.00071749,0.00085965,0.00074845,0.00097862,0.00103411,0.0018688,0.00052743,0.00083757,0.00097764,0.0016225,0.0019624,0.00157892,0.00213605,0.00236042,0.00305605,0.00354203,0.00337113,0.0034357,0.00449077,0.00462266,0.00636733,0.00566046,0.00677881,0.0070715,0.00874346,0.01355056,0.01619584,0.02203989,0.0280872,0.03494645,0.04133121,0.04761505,0.05400884,0.06133751,0.06960104,0.07879944,0.0889327,0.10000084,0.11200385,0.12494173,0.13881447])
            miehet_in=np.array([0.00088685,0.0030374,0.0036704,0.00291685,0.00112577,0.0012167,0.0005721,0.00159803,0.00074633,0.00085087,0.0003,0.0003,0.0003,0.00093991,0.0003,0.00145376,0.0010228,0.0010536,0.00118903,0.00094701,0.00097095,0.00170075,0.00155771,0.00171266,0.00062054,0.00199498,0.00358022,0.00390274,0.00389756,0.00375149,0.00398744,0.00505185,0.00553712,0.00689561,0.00744478,0.00739903,0.00904614,0.01207542,0.01720109,0.01900131,0.02589446,0.03343346,0.04311191,0.04958962,0.0572367,0.06507226,0.07298195,0.08089165,0.08880135,0.09671105,0.10462075,0.11253044,0.12044014])
        elif self.year==2020:
            naiset_in=np.array([0.00323193,0.00383869,0.0031471,0.00180076,0.00063467,0.00130649,0.00046194,0.00088869,0.00042194,0.0010513,0.00054933,0.0003,0.0003,0.00089114,0.00099375,0.0011762,0.00095871,0.00098373,0.00177475,0.00051963,0.00095348,0.00115648,0.00186677,0.00195713,0.00156159,0.00199954,0.00245051,0.00319213,0.00361785,0.00378299,0.00372717,0.00487488,0.00491652,0.00678899,0.00624518,0.00777229,0.00831243,0.01004951,0.0157061,0.01869725,0.02847693,0.03545819,0.04132344,0.04772777,0.0549854,0.06309633,0.07206055,0.08187807,0.09254888,0.10407299,0.1164504,0.1296811,0.1437651])
            miehet_in=np.array([0.00335051,0.00309845,0.00288003,0.00282229,0.0019599,0.00078613,0.00091771,0.00068483,0.00117611,0.00083439,0.00083119,0.0003,0.0003,0.0003,0.00103673,0.0003,0.00146906,0.00095848,0.00106398,0.0012471,0.00108369,0.00122602,0.00172926,0.00154577,0.0015881,0.00082138,0.00204495,0.00374327,0.00399668,0.00424519,0.00391448,0.00452487,0.00513356,0.00601136,0.0066415,0.00863879,0.00819381,0.0111341,0.01352174,0.01975702,0.02498373,0.03310534,0.03912855,0.04553025,0.05197356,0.05872102,0.06546848,0.07221594,0.07896339,0.08571085,0.09245831,0.09920577,0.10595323])
        elif self.year==2021:
            naiset_in=np.array([0.00258234,0.00393174,0.00370294,0.00235291,0.00081273,0.00037252,0.00106817,0.00053322,0.00065876,0.00044879,0.00085394,0.00061665,0.0003,0.0003,0.00092178,0.00088909,0.00131592,0.00108996,0.00097315,0.00187896,0.00069316,0.00120478,0.00103556,0.00170321,0.00182603,0.00154248,0.0024786,0.00293592,0.00335275,0.00381299,0.00389166,0.0040023,0.00476528,0.00517951,0.00748923,0.0071832,0.00887646,0.00946626,0.01248903,0.01789709,0.02474337,0.03573606,0.04226555,0.04970968,0.05766283,0.06649266,0.07619916,0.08678234,0.0982422,0.11057874,0.12379195,0.13788185,0.15284842])
            miehet_in=np.array([0.0030008,0.00337088,0.00303814,0.00194323,0.00208567,0.00127714,0.00063785,0.00068341,0.00052416,0.00111753,0.00080171,0.00075135,0.0003,0.0003,0.0003,0.00103867,0.0003,0.00141239,0.00086831,0.00134588,0.00152435,0.00125383,0.00081591,0.00154969,0.00182735,0.00197775,0.00097487,0.00223592,0.00377962,0.00402942,0.00421916,0.0044383,0.00488037,0.00526431,0.00606127,0.0071332,0.01003814,0.00905065,0.0128965,0.01535628,0.0255058,0.03086968,0.03828106,0.0446272,0.05194493,0.05926266,0.06658039,0.07389812,0.08121585,0.08853358,0.09585131,0.10316904,0.11048677])
        elif self.year==2022:
            naiset_in=np.array([0.00344635,0.00382563,0.00360961,0.00286523,0.00175386,0.0003,0.0003,0.00045253,0.00048066,0.0005456,0.00056797,0.00102785,0.00072991,0.0003,0.0003,0.00103583,0.00100503,0.00156075,0.00120177,0.00090912,0.0019284,0.00068335,0.00118775,0.00118941,0.00171037,0.00204434,0.00158149,0.00277362,0.00332519,0.00372513,0.00398881,0.00400754,0.00419369,0.00546668,0.00559112,0.00788333,0.00768409,0.01015903,0.01188325,0.01498964,0.02412275,0.03305023,0.04515269,0.05347006,0.06309016,0.07530483,0.09011406,0.10751785,0.12751621,0.15010913,0.17529661,0.20307865,0.23345526])
            miehet_in=np.array([0.00272572,0.00416497,0.00280962,0.00219568,0.00106643,0.00160209,0.00066004,0.00036646,0.00056615,0.00090052,0.00104048,0.00087866,0.00058019,0.0003,0.0003,0.0003,0.00122595,0.00034971,0.00144862,0.00093867,0.00129931,0.00146176,0.00118497,0.00094181,0.00161723,0.00157484,0.00203436,0.00086253,0.00260943,0.00387142,0.00428037,0.00436002,0.00485172,0.00515436,0.00584948,0.00662134,0.00786435,0.01092507,0.01028214,0.01562641,0.02130409,0.03234406,0.03677833,0.04340237,0.05034636,0.05760693,0.0648675,0.07212807,0.07938864,0.0866492,0.09390977,0.10117034,0.10843091])
        elif self.year==2023:
            naiset_in=np.array([0.00344282,0.0038268,0.00360921,0.00286431,0.00175291,0.0003,0.0003,0.00045161,0.00048159,0.00054571,0.00056985,0.00103005,0.00072881,0.0003,0.0003,0.00104062,0.00100686,0.0015631,0.00120448,0.00090692,0.00192606,0.00068454,0.00118632,0.00118926,0.00171338,0.00204568,0.00158361,0.00277576,0.00332441,0.00373015,0.00398101,0.00400924,0.00418564,0.00543948,0.0055975,0.00789257,0.00770291,0.0101623,0.01189964,0.0148807,0.02402645,0.03301036,0.04495881,0.0532236,0.06280932,0.07494783,0.08963911,0.10688316,0.12668,0.14902961,0.17393199,0.20138716,0.2313951])
            miehet_in=np.array([0.00272572,0.00415654,0.00281244,0.00219824,0.00106766,0.00160377,0.00065996,0.0003661,0.00056535,0.0009035,0.00104246,0.00087892,0.00057986,0.0003,0.0003,0.0003,0.00123028,0.00034947,0.00144824,0.0009377,0.00129895,0.00145783,0.00118932,0.00094247,0.0016139,0.00157578,0.00203719,0.00086702,0.0026054,0.00387375,0.0042736,0.00436622,0.00486153,0.00515273,0.00583856,0.00661689,0.00785981,0.01090986,0.01029971,0.01558209,0.02120031,0.03237199,0.03699233,0.04366549,0.05068634,0.05805784,0.06542935,0.07280085,0.08017236,0.08754387,0.09491537,0.10228688,0.10965838])
        elif self.year==2024:
            naiset_in=np.array([0.00340497,0.00380408,0.00358588,0.0028505,0.00174488,0.0003,0.0003,0.00045114,0.00047778,0.00054761,0.0005672,0.00102738,0.00072761,0.0003,0.0003,0.00103815,0.00100586,0.00155831,0.0012035,0.00090337,0.00192583,0.00068091,0.00118867,0.00118731,0.001711,0.00204407,0.00158066,0.00276924,0.00330652,0.00370745,0.00396788,0.00399142,0.00416753,0.00543493,0.00554451,0.00780833,0.00760415,0.01008634,0.01177691,0.0146831,0.0235128,0.03165975,0.0430419,0.05085815,0.05990191,0.07136857,0.08525812,0.10157057,0.12030592,0.14146416,0.1650453,0.19104934,0.21947627])
            miehet_in=np.array([0.00272572,0.00415505,0.00281183,0.00219312,0.00106723,0.00160331,0.00066019,0.00036634,0.00056616,0.00090189,0.00104093,0.00087866,0.00058012,0.0003,0.0003,0.0003,0.0012266,0.00034936,0.00144719,0.00093795,0.00129816,0.00145982,0.0011856,0.00094366,0.00161254,0.0015757,0.00203755,0.00086427,0.00261299,0.0038816,0.00429027,0.00437381,0.00485791,0.00516288,0.00584311,0.00661966,0.00784075,0.01089845,0.01028859,0.0155993,0.02126983,0.03234077,0.03687306,0.04351918,0.05049915,0.05780648,0.0651138,0.07242113,0.07972846,0.08703579,0.09434312,0.10165045,0.10895778])
        elif self.year==2025:
            naiset_in=np.array([0.00340497,0.00380408,0.00358588,0.0028505,0.00174488,0.0003,0.0003,0.00045114,0.00047778,0.00054761,0.0005672,0.00102738,0.00072761,0.0003,0.0003,0.00103815,0.00100586,0.00155831,0.0012035,0.00090337,0.00192583,0.00068091,0.00118867,0.00118731,0.001711,0.00204407,0.00158066,0.00276924,0.00330652,0.00370745,0.00396788,0.00399142,0.00416753,0.00543493,0.00554451,0.00780833,0.00760415,0.01008634,0.01177691,0.0146831,0.0235128,0.03165975,0.0430419,0.05085815,0.05990191,0.07136857,0.08525812,0.10157057,0.12030592,0.14146416,0.1650453,0.19104934,0.21947627])
            miehet_in=np.array([0.00272572,0.00415505,0.00281183,0.00219312,0.00106723,0.00160331,0.00066019,0.00036634,0.00056616,0.00090189,0.00104093,0.00087866,0.00058012,0.0003,0.0003,0.0003,0.0012266,0.00034936,0.00144719,0.00093795,0.00129816,0.00145982,0.0011856,0.00094366,0.00161254,0.0015757,0.00203755,0.00086427,0.00261299,0.0038816,0.00429027,0.00437381,0.00485791,0.00516288,0.00584311,0.00661966,0.00784075,0.01089845,0.01028859,0.0155993,0.02126983,0.03234077,0.03687306,0.04351918,0.05049915,0.05780648,0.0651138,0.07242113,0.07972846,0.08703579,0.09434312,0.10165045,0.10895778])
        elif self.year==2026:
            naiset_in=np.array([0.00340497,0.00380408,0.00358588,0.0028505,0.00174488,0.0003,0.0003,0.00045114,0.00047778,0.00054761,0.0005672,0.00102738,0.00072761,0.0003,0.0003,0.00103815,0.00100586,0.00155831,0.0012035,0.00090337,0.00192583,0.00068091,0.00118867,0.00118731,0.001711,0.00204407,0.00158066,0.00276924,0.00330652,0.00370745,0.00396788,0.00399142,0.00416753,0.00543493,0.00554451,0.00780833,0.00760415,0.01008634,0.01177691,0.0146831,0.0235128,0.03165975,0.0430419,0.05085815,0.05990191,0.07136857,0.08525812,0.10157057,0.12030592,0.14146416,0.1650453,0.19104934,0.21947627])
            miehet_in=np.array([0.00272572,0.00415505,0.00281183,0.00219312,0.00106723,0.00160331,0.00066019,0.00036634,0.00056616,0.00090189,0.00104093,0.00087866,0.00058012,0.0003,0.0003,0.0003,0.0012266,0.00034936,0.00144719,0.00093795,0.00129816,0.00145982,0.0011856,0.00094366,0.00161254,0.0015757,0.00203755,0.00086427,0.00261299,0.0038816,0.00429027,0.00437381,0.00485791,0.00516288,0.00584311,0.00661966,0.00784075,0.01089845,0.01028859,0.0155993,0.02126983,0.03234077,0.03687306,0.04351918,0.05049915,0.05780648,0.0651138,0.07242113,0.07972846,0.08703579,0.09434312,0.10165045,0.10895778])
        else:
            print("Error: Unknown year in ['tk in']")
            
        # puolet sv:llä olevisa vain 3 kk, puolet yhden vuoden, skaalataan alkavuus
        
        svrate_men,svrate_women,mfactor_3m,wfactor_3m=self.get_svrate()

        mfactor_1y=1.0-mfactor_3m
        mlfactor_3m=mfactor_3m*0.25+mfactor_1y*1.0

        wfactor_1y=1.0-wfactor_3m
        wlfactor_3m=wfactor_3m*0.25+wfactor_1y*1.0

        # skaalataan päivät oikeiksi
        svrate_men_scaled = svrate_men/mlfactor_3m
        svrate_women_scaled = svrate_women/wlfactor_3m
        
        sv_miehet = np.maximum(miehet_in,svrate_men_scaled)
        sv_naiset = np.maximum(naiset_in,svrate_women_scaled)

        # vuoden kestäviä sairauspoissaoloja
        sv_miehet_1y = np.maximum(miehet_in,mfactor_1y*sv_miehet)
        sv_naiset_1y = np.maximum(naiset_in,wfactor_1y*sv_naiset)
        
        # mikä osuus menee vuoden kuluttua tk:lle sv:tlä
        proportion_miehet=miehet_in/sv_miehet_1y
        proportion_naiset=naiset_in/sv_naiset_1y
        for g in range(3):
            prop[18:71,g]=proportion_miehet
            prop[18:71,g+3]=proportion_naiset
        prop[71:(self.max_age+1),:]=prop[70,:]

        for s in range(self.n_empl):
            for g in range(3):
                disab[18:71,g,s]=dfactor[g]*sv_miehet*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            for g in range(3,6):
                disab[18:71,g,s]=dfactor[g]*sv_naiset*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            
        #disab[18:63,:,:]=disab[18:63,:,:]
            
        #disab=1-(1-disab)**self.timestep
        disab = self.scale_rates(disab)

        prop2=1-prop**self.timestep
        sv_3m=np.zeros((self.max_age+1,6))
        for k in range(3):
            sv_3m[18:71,k]=mfactor_3m
            sv_3m[18:71,3+k]=wfactor_3m
        
        return disab,prop,sv_3m    

    def get_eff_disab_rate_v8(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Sisältää myös sairausvakuutuspäivärahasiirtymät
        Laskettu havaitusta työkyvyttömien lukumäärästä
        Siksi efektiivinen 
        Revisio 2022 v2
        
        Huomioi M.Laaksonen: Työkyvyttömyyseläkkeelle siirtyminen: trendit, tilannekuva, tulevaisuus
        '''
        disab=np.zeros((self.max_age+1,self.n_groups,self.n_empl))
        prop=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
            unempfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            #dfactor=np.array([1.15,0.95,0.,1.1,0.95,0.])
            dfactor=np.array([1.30,1.15,0.,1.3,1.15,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            
            tyot = 0.15
            unemp_factor = 1.0
            base = 1.0/(1.0*(1-tyot)+unemp_factor*tyot)
            unemp = unemp_factor*base
            unempfactor = np.array([unemp,base,base,base,unemp,base,base,base,base,base,base,base,base,unemp,base,0.0])

        if not self.silent:
            #print(f'disability rate from year {self.year}')
            print(f'disability rate from year {self.year}',dfactor)

        ### ['tk in']
        if self.year==2018:
            naiset_in=np.array([0.00225637,0.00285008,0.00271435,0.00276785,0.00154033,0.00133814,0.00051395,0.00095538,0.00045788,0.0003,0.0003,0.00077766,0.00092625,0.00094422,0.00059885,0.00083168,0.00156033,0.00037611,0.00082238,0.0007759,0.00175537,0.00162593,0.00162143,0.00180463,0.0025606,0.00293531,0.00348759,0.00319533,0.00344962,0.00395607,0.0041035,0.00553503,0.00552203,0.00628402,0.00612934,0.00711743,0.01164223,0.01349441,0.01870928,0.0217421,0.02826794,0.03647967,0.0381614,0.04302442,0.048345,0.05412314,0.06035883,0.06705207,0.07420287,0.08181122,0.08987713,0.09840059,0.1073816])
            miehet_in=np.array([0.00185931,0.0037204,0.00376229,0.00170488,0.00148425,0.00102846,0.00178171,0.00138594,0.00078629,0.0003,0.0003,0.0003,0.00090467,0.0003,0.00169177,0.00114245,0.001177,0.00096655,0.00081553,0.00073639,0.00159503,0.00143929,0.00176062,0.00053746,0.00184884,0.00323015,0.00351168,0.00383087,0.00374413,0.00395601,0.00457679,0.0049912,0.00609688,0.00672768,0.00634706,0.00802239,0.01089487,0.01483398,0.01574633,0.01919038,0.02763018,0.03848508,0.04267813,0.04941108,0.05696625,0.06452143,0.0720766,0.07963177,0.08718695,0.09474212,0.1022973,0.10985247,0.11740765])
        elif self.year==2019:
            naiset_in=np.array([0.00306887,0.00318514,0.00264217,0.00188048,0.00182756,0.00106129,0.00085988,0.00067708,0.00085786,0.00047812,0.0003,0.0003,0.00071875,0.00086086,0.00075061,0.00098142,0.00103407,0.0018778,0.00052787,0.00084005,0.00097885,0.00162863,0.00196386,0.00158666,0.00214389,0.00236137,0.00305038,0.00354138,0.0033879,0.00344541,0.00450279,0.00464248,0.00637852,0.00566497,0.00677508,0.00709288,0.00873168,0.01354954,0.01623703,0.02211649,0.02823728,0.03509072,0.04137658,0.04766147,0.05404771,0.06133354,0.06951897,0.07860399,0.08858859,0.09947279,0.11125658,0.12393996,0.13752293])
            miehet_in=np.array([0.00088685,0.00303895,0.00367446,0.00291354,0.00112685,0.00121923,0.00057297,0.0016022,0.00074732,0.0008505,0.0003,0.0003,0.0003,0.00094141,0.0003,0.00145626,0.00102305,0.0010537,0.00119093,0.0009482,0.00097125,0.00169935,0.00155957,0.00171606,0.00062094,0.00199998,0.00359304,0.00390441,0.00389861,0.0037553,0.00398605,0.00507181,0.00552443,0.00689324,0.00744307,0.00741194,0.00907256,0.01202907,0.01721563,0.0190094,0.0259539,0.03352622,0.04314993,0.0496335,0.05728953,0.06512343,0.07302274,0.08092204,0.08882134,0.09672065,0.10461995,0.11251925,0.12041856])
        elif self.year==2020:
            naiset_in=np.array([0.00323193,0.00383384,0.003145,0.00180205,0.00063525,0.00130915,0.00046249,0.00089388,0.00042327,0.00105389,0.00054989,0.0003,0.0003,0.00089194,0.00099665,0.00117732,0.00096298,0.00098389,0.00177885,0.00052028,0.00095888,0.0011593,0.00186849,0.00196628,0.00156626,0.00200047,0.00244396,0.00320214,0.003633,0.00378895,0.00371891,0.00487773,0.00493077,0.00681306,0.00624296,0.00778716,0.00833528,0.01003545,0.01579388,0.0187828,0.02855178,0.03556758,0.04147866,0.04789985,0.05517911,0.06331644,0.07231184,0.0821653,0.09287684,0.10444643,0.1168741,0.13015983,0.14430363])
            miehet_in=np.array([0.00335051,0.00309742,0.00287581,0.00282109,0.00195912,0.00078904,0.0009211,0.00068722,0.00117746,0.00083708,0.00083147,0.0003,0.0003,0.0003,0.00103936,0.0003,0.00147199,0.00095812,0.00106432,0.00124898,0.00108497,0.00122629,0.00173362,0.00154888,0.00159403,0.00082169,0.00204397,0.00374168,0.00399301,0.00424668,0.00391378,0.00453931,0.00514206,0.00601474,0.00664605,0.00865954,0.00817663,0.01112009,0.01353378,0.01979556,0.02507892,0.03316198,0.03914252,0.04554471,0.05198199,0.05870776,0.06543353,0.07215929,0.07888506,0.08561083,0.0923366,0.09906236,0.10578813])
        elif self.year==2021:
            naiset_in=np.array([0.00258234,0.00394022,0.00369815,0.00235128,0.00081205,0.00037299,0.00107031,0.00053505,0.00066106,0.00044924,0.00085652,0.00061796,0.0003,0.0003,0.00092214,0.00089114,0.00131795,0.00109126,0.00097406,0.00188548,0.00069479,0.00121049,0.00103609,0.00170347,0.00182932,0.00153988,0.00247922,0.00293945,0.00335358,0.00381212,0.00390364,0.00400668,0.00476766,0.00518252,0.00751927,0.00720011,0.00890447,0.00945375,0.01243115,0.01789744,0.0248116,0.03570293,0.04235755,0.04983915,0.05782458,0.06672931,0.07655335,0.08729669,0.09895934,0.1115413,0.12504256,0.13946312,0.154803])
            miehet_in=np.array([0.0030008,0.00336762,0.00303869,0.00194393,0.00208421,0.00127815,0.00063828,0.00068312,0.00052437,0.00111633,0.00080076,0.00075089,0.0003,0.0003,0.0003,0.00104074,0.0003,0.00141431,0.00086948,0.00134667,0.00152561,0.00125404,0.00081721,0.00154952,0.00183205,0.00198312,0.00097483,0.00223906,0.00378443,0.004032,0.00423356,0.00444543,0.0048895,0.00528984,0.006079,0.00713633,0.01006151,0.00906203,0.01296587,0.01539768,0.02553074,0.03105484,0.03845826,0.04483136,0.05218978,0.0595482,0.06690662,0.07426504,0.08162346,0.08898188,0.0963403,0.10369872,0.11105714])
        elif self.year==2022:
            naiset_in=np.array([0.0033569,0.0037245,0.00351963,0.00279682,0.00171304,0.00029243,0.00029243,0.0004412,0.00046909,0.00053279,0.00055619,0.00100437,0.00071198,0.00029243,0.00029243,0.00101478,0.0009853,0.00152975,0.00117824,0.00088558,0.00188545,0.00066746,0.00116153,0.00116037,0.00167532,0.00199424,0.00154781,0.00270908,0.00324559,0.00363543,0.00389434,0.00391092,0.00409073,0.00533868,0.00546183,0.00769237,0.00752029,0.0099382,0.0116379,0.01464381,0.02353104,0.03227211,0.04391448,0.05198362,0.06131857,0.0731392,0.08744549,0.10423745,0.12351508,0.14527839,0.16952736,0.196262,0.22548231])
            miehet_in=np.array([0.00267576,0.00408512,0.00276207,0.00215204,0.00104773,0.00157283,0.00064819,0.00035949,0.00055669,0.00088627,0.00102432,0.00086398,0.00056972,0.0002945,0.0002945,0.0002945,0.00120464,0.00034396,0.0014232,0.00092174,0.00127615,0.00143557,0.00116687,0.00092654,0.00158873,0.00154546,0.00200425,0.00085003,0.00256187,0.00380335,0.00420777,0.00429498,0.00477972,0.00506843,0.00574283,0.00650479,0.00773309,0.01072518,0.01008635,0.0153296,0.02088364,0.03185285,0.03633007,0.04289099,0.04978134,0.05700577,0.06423019,0.07145462,0.07867904,0.08590347,0.09312789,0.10035232,0.10757674])
        elif self.year==2023:
            naiset_in=np.array([0.00335422,0.00372255,0.0035219,0.00279764,0.00171238,0.00029243,0.00029243,0.00044094,0.00046904,0.00053338,0.00055624,0.00100396,0.00071117,0.00029243,0.00029243,0.00101508,0.00098613,0.00153001,0.00117655,0.00088549,0.00188327,0.00066807,0.00116116,0.00116168,0.00167345,0.00199688,0.00154649,0.00271153,0.00324798,0.00364153,0.00389775,0.00391205,0.00409553,0.00533937,0.00546354,0.00769124,0.00752541,0.00992989,0.0116508,0.01460929,0.02355431,0.03225834,0.04382848,0.0518729,0.06118881,0.07296702,0.08720754,0.10391037,0.12307551,0.14470296,0.16879272,0.19534478,0.22435915])
            miehet_in=np.array([0.00267576,0.00408454,0.00275973,0.00215397,0.00104673,0.00157328,0.00064866,0.00035974,0.00055647,0.00088575,0.00102367,0.00086408,0.00056986,0.0002945,0.0002945,0.0002945,0.0012047,0.00034381,0.00142348,0.00092202,0.00127626,0.00143475,0.00116618,0.0009275,0.00158911,0.00154583,0.0020047,0.00085075,0.00255984,0.00380912,0.0042057,0.00429111,0.00477925,0.00506665,0.00575042,0.00650213,0.00773919,0.01071243,0.01009442,0.01534611,0.02088784,0.03187545,0.03635521,0.04292041,0.04981398,0.05704552,0.06427705,0.07150859,0.07874012,0.08597166,0.09320319,0.10043473,0.10766626])
        elif self.year==2024:
            naiset_in=np.array([0.00299754,0.00333872,0.00315536,0.00251142,0.00153968,0.0002641,0.0002641,0.00039814,0.00042386,0.00048281,0.00050187,0.0009041,0.000643,0.0002641,0.0002641,0.0009171,0.00088593,0.00137753,0.00106067,0.00079792,0.00170317,0.00060014,0.00104932,0.00104641,0.00150586,0.00180059,0.00139393,0.00243997,0.00291785,0.00327453,0.00350097,0.00351264,0.00368283,0.00479495,0.00488661,0.0069096,0.00669679,0.00887764,0.01038434,0.01296871,0.02089641,0.02798685,0.03792483,0.04480995,0.05277026,0.0628384,0.07501435,0.08929812,0.10568971,0.12418912,0.14479636,0.16751141,0.19233428])
            miehet_in=np.array([0.00233772,0.00356358,0.00241037,0.00188084,0.00091464,0.00137447,0.00056669,0.0003147,0.00048568,0.00077358,0.00089428,0.00075512,0.00049768,0.0002573,0.0002573,0.0002573,0.00105327,0.00030056,0.00124419,0.0008049,0.00111476,0.00125372,0.00101894,0.00080909,0.00138697,0.00134936,0.00174902,0.00074221,0.0022393,0.00332552,0.00367187,0.00374582,0.00417408,0.00442129,0.00502146,0.0056778,0.00675535,0.00936982,0.00882836,0.01341476,0.01824227,0.02783532,0.03179295,0.0375341,0.04356393,0.04989435,0.05622476,0.06255518,0.06888559,0.07521601,0.08154642,0.08787684,0.09420725])
        elif self.year==2025:
            naiset_in=np.array([0.00299754,0.00333872,0.00315536,0.00251142,0.00153968,0.0002641,0.0002641,0.00039814,0.00042386,0.00048281,0.00050187,0.0009041,0.000643,0.0002641,0.0002641,0.0009171,0.00088593,0.00137753,0.00106067,0.00079792,0.00170317,0.00060014,0.00104932,0.00104641,0.00150586,0.00180059,0.00139393,0.00243997,0.00291785,0.00327453,0.00350097,0.00351264,0.00368283,0.00479495,0.00488661,0.0069096,0.00669679,0.00887764,0.01038434,0.01296871,0.02089641,0.02798685,0.03792483,0.04480995,0.05277026,0.0628384,0.07501435,0.08929812,0.10568971,0.12418912,0.14479636,0.16751141,0.19233428])
            miehet_in=np.array([0.00233772,0.00356358,0.00241037,0.00188084,0.00091464,0.00137447,0.00056669,0.0003147,0.00048568,0.00077358,0.00089428,0.00075512,0.00049768,0.0002573,0.0002573,0.0002573,0.00105327,0.00030056,0.00124419,0.0008049,0.00111476,0.00125372,0.00101894,0.00080909,0.00138697,0.00134936,0.00174902,0.00074221,0.0022393,0.00332552,0.00367187,0.00374582,0.00417408,0.00442129,0.00502146,0.0056778,0.00675535,0.00936982,0.00882836,0.01341476,0.01824227,0.02783532,0.03179295,0.0375341,0.04356393,0.04989435,0.05622476,0.06255518,0.06888559,0.07521601,0.08154642,0.08787684,0.09420725])
        elif self.year==2026:
            naiset_in=np.array([0.00299754,0.00333872,0.00315536,0.00251142,0.00153968,0.0002641,0.0002641,0.00039814,0.00042386,0.00048281,0.00050187,0.0009041,0.000643,0.0002641,0.0002641,0.0009171,0.00088593,0.00137753,0.00106067,0.00079792,0.00170317,0.00060014,0.00104932,0.00104641,0.00150586,0.00180059,0.00139393,0.00243997,0.00291785,0.00327453,0.00350097,0.00351264,0.00368283,0.00479495,0.00488661,0.0069096,0.00669679,0.00887764,0.01038434,0.01296871,0.02089641,0.02798685,0.03792483,0.04480995,0.05277026,0.0628384,0.07501435,0.08929812,0.10568971,0.12418912,0.14479636,0.16751141,0.19233428])
            miehet_in=np.array([0.00233772,0.00356358,0.00241037,0.00188084,0.00091464,0.00137447,0.00056669,0.0003147,0.00048568,0.00077358,0.00089428,0.00075512,0.00049768,0.0002573,0.0002573,0.0002573,0.00105327,0.00030056,0.00124419,0.0008049,0.00111476,0.00125372,0.00101894,0.00080909,0.00138697,0.00134936,0.00174902,0.00074221,0.0022393,0.00332552,0.00367187,0.00374582,0.00417408,0.00442129,0.00502146,0.0056778,0.00675535,0.00936982,0.00882836,0.01341476,0.01824227,0.02783532,0.03179295,0.0375341,0.04356393,0.04989435,0.05622476,0.06255518,0.06888559,0.07521601,0.08154642,0.08787684,0.09420725])
        else:
            print("Error: Unknown year in ['tk in']")
            
        # puolet sv:llä olevisa vain 3 kk, puolet yhden vuoden, skaalataan alkavuus
        
        svrate_men,svrate_women,mfactor_3m,wfactor_3m=self.get_svrate()

        mfactor_1y=1.0-mfactor_3m
        mlfactor_3m=mfactor_3m*0.25+mfactor_1y*1.0

        wfactor_1y=1.0-wfactor_3m
        wlfactor_3m=wfactor_3m*0.25+wfactor_1y*1.0

        # skaalataan päivät oikeiksi
        svrate_men_scaled = svrate_men/mlfactor_3m
        svrate_women_scaled = svrate_women/wlfactor_3m
        
        sv_miehet = np.maximum(miehet_in,svrate_men_scaled)
        sv_naiset = np.maximum(naiset_in,svrate_women_scaled)

        # vuoden kestäviä sairauspoissaoloja
        sv_miehet_1y = np.maximum(miehet_in,mfactor_1y*sv_miehet)
        sv_naiset_1y = np.maximum(naiset_in,wfactor_1y*sv_naiset)
        
        # mikä osuus menee vuoden kuluttua tk:lle sv:tlä
        proportion_miehet=miehet_in/sv_miehet_1y
        proportion_naiset=naiset_in/sv_naiset_1y
        for g in range(3):
            prop[18:71,g]=proportion_miehet
            prop[18:71,g+3]=proportion_naiset
        prop[71:(self.max_age+1),:]=prop[70,:]

        for s in range(self.n_empl):
            for g in range(3):
                disab[18:71,g,s]=dfactor[g]*sv_miehet*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            for g in range(3,6):
                disab[18:71,g,s]=dfactor[g]*sv_naiset*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            
        #disab[18:63,:,:]=disab[18:63,:,:]
            
        #disab=1-(1-disab)**self.timestep
        disab = self.scale_rates(disab)

        prop2=1-prop**self.timestep
        sv_3m=np.zeros((self.max_age+1,6))
        for k in range(3):
            sv_3m[18:71,k]=mfactor_3m
            sv_3m[18:71,3+k]=wfactor_3m
        
        return disab,prop,sv_3m                

    def get_eff_disab_rate_v9(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Sisältää myös sairausvakuutuspäivärahasiirtymät
        Laskettu havaitusta työkyvyttömien lukumäärästä
        Siksi efektiivinen 
        Revisio 2022 v2
        
        Huomioi M.Laaksonen: Työkyvyttömyyseläkkeelle siirtyminen: trendit, tilannekuva, tulevaisuus
        '''
        disab=np.zeros((self.max_age+1,self.n_groups,self.n_empl))
        prop=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
            unempfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            #dfactor=np.array([1.15,0.95,0.,1.1,0.95,0.])
            dfactor=np.array([1.30,1.15,0.,1.3,1.15,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            
            tyot = 0.15
            unemp_factor = 1.0
            base = 1.0/(1.0*(1-tyot)+unemp_factor*tyot)
            unemp = unemp_factor*base
            unempfactor = np.array([unemp,base,base,base,unemp,base,base,base,base,base,base,base,base,unemp,base,0.0])

        if not self.silent:
            #print(f'disability rate from year {self.year}')
            print(f'disability rate from year {self.year}',dfactor)

        ### ['tk in']
        if self.year==2018:
            naiset_in=np.array([0.00225637,0.00285209,0.00271278,0.00277064,0.00153991,0.00133633,0.00051364,0.0009559,0.00045763,0.0003,0.0003,0.00077823,0.00092678,0.00094335,0.0005985,0.00083286,0.0015603,0.00037573,0.00082184,0.00077537,0.00175339,0.0016236,0.00161966,0.00180257,0.00256341,0.002927,0.00348685,0.00319307,0.00344802,0.00395005,0.00409842,0.00553728,0.00553272,0.006292,0.00613101,0.00709902,0.01161997,0.01348052,0.01874522,0.02179251,0.02832049,0.03645741,0.03820837,0.04307415,0.04839456,0.05416959,0.06039925,0.06708352,0.07422242,0.08181594,0.08986409,0.09836685,0.10732424])
            miehet_in=np.array([0.00185931,0.00371953,0.00376178,0.00170605,0.00148389,0.00102728,0.0017809,0.00138748,0.00078524,0.0003,0.0003,0.0003,0.0009053,0.0003,0.00169237,0.00114278,0.00117722,0.00096759,0.00081655,0.00073587,0.00159541,0.0014403,0.00176078,0.0005379,0.00185054,0.00323963,0.00351265,0.00382713,0.00374079,0.003956,0.00458114,0.00498936,0.00609742,0.00673283,0.00633071,0.00802636,0.01089036,0.01483945,0.01576255,0.01914836,0.02764039,0.03852335,0.0425835,0.04928873,0.05682382,0.06435892,0.07189401,0.0794291,0.0869642,0.09449929,0.10203438,0.10956947,0.11710457])
        elif self.year==2019:
            naiset_in=np.array([0.00306887,0.00318567,0.00264321,0.00187976,0.00182701,0.00106054,0.00086037,0.0006769,0.00085839,0.00047839,0.0003,0.0003,0.00071815,0.00086144,0.00075055,0.00098145,0.00103439,0.00187671,0.00052886,0.00084086,0.00097996,0.00162789,0.0019628,0.00158664,0.00214378,0.00236242,0.00305384,0.00354509,0.00338824,0.00344592,0.00450862,0.00464188,0.00637934,0.00566484,0.00677694,0.00709057,0.00874308,0.01354425,0.01620358,0.02212096,0.02817114,0.03509412,0.04134857,0.04763482,0.05401328,0.06129053,0.06946655,0.07854135,0.08851493,0.09938729,0.11115843,0.12382834,0.13739704])
            miehet_in=np.array([0.00088685,0.00303931,0.0036733,0.00290965,0.00112532,0.00121952,0.0005726,0.00160128,0.00074705,0.00085068,0.0003,0.0003,0.0003,0.00094073,0.0003,0.00145537,0.00102318,0.00105399,0.00119087,0.00094987,0.00097345,0.00169998,0.00155932,0.00171478,0.00062136,0.00200034,0.00359622,0.00390708,0.00389816,0.00375702,0.0039845,0.00506507,0.00551869,0.00689281,0.0074336,0.00740385,0.00906551,0.01202401,0.01716287,0.01902815,0.02598603,0.03352582,0.0430892,0.04957078,0.05720643,0.06501153,0.07288296,0.08075439,0.08862582,0.09649725,0.10436868,0.11224011,0.12011154])
        elif self.year==2020:
            naiset_in=np.array([0.00323193,0.00383479,0.00314231,0.00180402,0.00063479,0.00130793,0.00046196,0.00089342,0.00042354,0.00105415,0.00054955,0.0003,0.0003,0.00089171,0.00099707,0.00117701,0.00096141,0.00098363,0.00178024,0.00052052,0.00095955,0.00116075,0.00186808,0.00196619,0.0015671,0.00200243,0.00244122,0.00319859,0.00362879,0.00378771,0.00371779,0.00487587,0.00492899,0.0068159,0.00624748,0.00777514,0.0083245,0.0100485,0.01576059,0.01877768,0.02860321,0.03557404,0.04139112,0.04779875,0.05505402,0.06315692,0.07210746,0.08190563,0.09255143,0.10404487,0.11638594,0.12957465,0.14361098])
            miehet_in=np.array([0.00335051,0.00309853,0.00287504,0.00281907,0.00195887,0.00078877,0.00092035,0.00068737,0.00117683,0.00083678,0.00083165,0.0003,0.0003,0.0003,0.00103878,0.0003,0.00147247,0.00095916,0.0010637,0.00125019,0.00108563,0.00122513,0.0017335,0.00155012,0.00159342,0.00082201,0.00204389,0.00374595,0.00399212,0.00425091,0.00391367,0.00453207,0.00513774,0.00600825,0.00664123,0.00864187,0.00815661,0.01115084,0.01354733,0.01978746,0.02503003,0.03314958,0.03920946,0.04562499,0.05208437,0.05884796,0.06561155,0.07237513,0.07913872,0.0859023,0.09266589,0.09942947,0.10619306])
        elif self.year==2021:
            naiset_in=np.array([0.00258234,0.00393998,0.00369953,0.00234914,0.00081254,0.0003731,0.00106966,0.0005356,0.00066096,0.00044859,0.00085659,0.00061825,0.0003,0.0003,0.00092321,0.00089285,0.00131832,0.00109204,0.00097473,0.00188592,0.00069355,0.00120794,0.00103555,0.0017022,0.00182903,0.00154035,0.00248154,0.00293794,0.00335205,0.00381288,0.0038965,0.00400997,0.00476994,0.00517844,0.00752456,0.00719471,0.00889168,0.00944525,0.01247095,0.0179025,0.02480334,0.03574557,0.04239251,0.0498729,0.0578655,0.06676342,0.07656664,0.08727517,0.09888901,0.11140816,0.12483262,0.13916239,0.15439747])
            miehet_in=np.array([0.0030008,0.00336825,0.00303915,0.00194429,0.00208508,0.00127898,0.00063868,0.00068283,0.00052518,0.00111744,0.00080063,0.00075161,0.0003,0.0003,0.0003,0.00103905,0.0003,0.00141521,0.0008694,0.00134637,0.00152692,0.00125598,0.00081714,0.00154925,0.00183117,0.0019844,0.00097571,0.00223931,0.0037848,0.0040323,0.00423125,0.00444803,0.00489471,0.00528597,0.0060847,0.00712631,0.01004402,0.00905931,0.01295141,0.01541428,0.02552768,0.03095311,0.03847137,0.04485136,0.05221063,0.0595699,0.06692917,0.07428844,0.08164771,0.08900698,0.09636625,0.10372552,0.11108479])
        elif self.year==2022:
            naiset_in=np.array([0.00335532,0.00372643,0.00352197,0.00279816,0.00171282,0.00029243,0.00029243,0.00044062,0.00046928,0.00053356,0.00055548,0.0010033,0.00071179,0.00029243,0.00029243,0.00101446,0.00098473,0.00152611,0.00117637,0.00088679,0.00188279,0.00066717,0.00116104,0.00116031,0.00167535,0.0019968,0.00154525,0.00270901,0.00324557,0.00363531,0.00388917,0.00391111,0.00409207,0.00533863,0.00546573,0.00769608,0.00751594,0.00993473,0.01164027,0.01462332,0.02357118,0.03223343,0.04385258,0.05190566,0.06122625,0.07302524,0.08730263,0.10405843,0.12329263,0.14500524,0.16919625,0.19586567,0.22501348])
            miehet_in=np.array([0.00267576,0.00408239,0.00276342,0.00215336,0.0010475,0.00157273,0.00064819,0.00035972,0.00055621,0.00088532,0.00102452,0.00086474,0.00056974,0.0002945,0.0002945,0.0002945,0.00120393,0.00034394,0.0014218,0.00092173,0.00127597,0.00143484,0.00116733,0.00092678,0.00158784,0.00154537,0.00200059,0.00084996,0.00256352,0.0038038,0.00421047,0.00429197,0.00477815,0.0050656,0.00574412,0.0065051,0.00773215,0.01071333,0.01010135,0.01533486,0.02086318,0.0318896,0.03634375,0.04290435,0.04979672,0.05703011,0.06426349,0.07149688,0.07873026,0.08596365,0.09319703,0.10043042,0.1076638])
        elif self.year==2023:
            naiset_in=np.array([0.00324335,0.00374051,0.00351326,0.00296431,0.00154821,0.00037046,0.00029243,0.00076958,0.00036119,0.00041156,0.0004683,0.0006576,0.000776,0.00029243,0.00029243,0.0004078,0.00120261,0.00171721,0.00192516,0.00102948,0.00144954,0.00029243,0.00085637,0.00133986,0.00200018,0.0023421,0.00163517,0.0023853,0.00244317,0.00188482,0.00494891,0.0054442,0.00667587,0.00503868,0.00676282,0.0076946,0.00739153,0.00787959,0.01165252,0.0149134,0.02253678,0.03099395,0.04283035,0.05062481,0.05955267,0.07049639,0.08345598,0.09843144,0.11542277,0.13442997,0.15545304,0.17849197,0.20354678])
            miehet_in=np.array([0.00222882,0.00372524,0.00295536,0.00226895,0.000856,0.00161584,0.00074841,0.0007035,0.00053783,0.00059098,0.00118427,0.00041031,0.00072212,0.0002945,0.0002945,0.0002945,0.00148831,0.00059603,0.00212812,0.00097852,0.00105226,0.00054485,0.00098932,0.00074731,0.00233774,0.0016278,0.00242512,0.00049825,0.00163669,0.00210629,0.00506532,0.00554179,0.00714399,0.00509599,0.00723771,0.00657973,0.0071561,0.00915217,0.00995177,0.01562721,0.02004217,0.02995747,0.0344639,0.04059193,0.04683311,0.05353085,0.06022859,0.06692632,0.07362406,0.0803218,0.08701953,0.09371727,0.10041501])
        elif self.year==2024:
            naiset_in=np.array([0.00289839,0.00335926,0.00314935,0.00265921,0.00139086,0.00033407,0.0002641,0.0006968,0.00032558,0.00037341,0.00042222,0.00059119,0.00070179,0.0002641,0.0002641,0.00036816,0.00108167,0.00154799,0.00173767,0.00092875,0.00130829,0.0002641,0.00077651,0.00121004,0.00179883,0.00211494,0.00147352,0.00215358,0.00219947,0.00169814,0.00446765,0.00485018,0.00599872,0.0045367,0.00606444,0.00688314,0.00663551,0.00706677,0.01041068,0.01321692,0.01997211,0.02700191,0.03698713,0.04363124,0.05123482,0.06049873,0.07142297,0.08400753,0.09825243,0.11415765,0.1317232,0.15094908,0.17183529])
            miehet_in=np.array([0.00194725,0.00325598,0.00258245,0.00198399,0.00074752,0.00141123,0.00065353,0.00061436,0.00046992,0.00051646,0.00103474,0.00035862,0.00063072,0.0002573,0.0002573,0.0002573,0.00129934,0.00052015,0.00185868,0.00085484,0.00092044,0.00047533,0.00086519,0.00065259,0.00204262,0.00142182,0.00211891,0.00043491,0.00142856,0.0018424,0.00442257,0.00484344,0.00623317,0.00444944,0.00632536,0.00575117,0.00625677,0.00800514,0.00869236,0.01365243,0.01754994,0.02620908,0.03004288,0.03538051,0.04081253,0.04662818,0.05244383,0.05825947,0.06407512,0.06989077,0.07570641,0.08152206,0.08733771])
        elif self.year==2025:
            naiset_in=np.array([0.00289839,0.00336023,0.0031476,0.00266551,0.00139277,0.0003337,0.0002641,0.00069569,0.00032587,0.00037292,0.00042261,0.00059286,0.00070117,0.0002641,0.0002641,0.00036835,0.00108331,0.00154614,0.00173653,0.00092747,0.00130901,0.0002641,0.00077592,0.00121044,0.00179765,0.00211801,0.00147257,0.00215016,0.00219962,0.00169949,0.00447094,0.00485643,0.00598734,0.00453036,0.00605342,0.00687243,0.00663468,0.00705969,0.0103873,0.01322552,0.02000466,0.02704815,0.03700437,0.04365864,0.05126692,0.06053235,0.07145494,0.08403468,0.09827157,0.11416561,0.13171681,0.15092516,0.17179067])
            miehet_in=np.array([0.00194725,0.00325505,0.00258121,0.00198003,0.00074806,0.00141122,0.00065361,0.00061431,0.00047027,0.00051622,0.00103583,0.0003586,0.00063159,0.0002573,0.0002573,0.0002573,0.001299,0.00052135,0.00185827,0.00085355,0.0009193,0.00047515,0.00086461,0.00065249,0.00204241,0.00142271,0.00211709,0.00043511,0.00142782,0.0018435,0.00442471,0.00483889,0.00624304,0.00444717,0.0063326,0.0057488,0.0062536,0.00799841,0.00868918,0.01366509,0.01755126,0.02612868,0.03006877,0.03541366,0.04085081,0.04667569,0.05250058,0.05832546,0.06415035,0.06997524,0.07580012,0.08162501,0.0874499])
        elif self.year==2026:
            naiset_in=np.array([0.00289839,0.00335822,0.00314975,0.00266127,0.00139136,0.00033404,0.0002641,0.00069583,0.00032584,0.00037303,0.00042241,0.00059233,0.00070086,0.0002641,0.0002641,0.00036821,0.00108223,0.00154783,0.0017399,0.00092885,0.00130943,0.0002641,0.00077549,0.0012098,0.00179587,0.00211432,0.00147224,0.00215313,0.00219812,0.00169477,0.00447379,0.00485464,0.00600078,0.00453244,0.00605591,0.00688248,0.00664378,0.00706172,0.01040009,0.0132265,0.01996183,0.02702512,0.03698514,0.0436314,0.05123262,0.06048926,0.0714013,0.08396876,0.09819163,0.1140699,0.13160359,0.15079269,0.1716372])
            miehet_in=np.array([0.00194725,0.0032567,0.00258172,0.00198134,0.00074778,0.00141066,0.00065329,0.00061422,0.00046966,0.00051632,0.00103628,0.00035863,0.00063097,0.0002573,0.0002573,0.0002573,0.00130106,0.00052081,0.001858,0.00085508,0.00091939,0.00047524,0.00086432,0.00065327,0.00204067,0.00142186,0.00211666,0.00043527,0.00143043,0.00184118,0.00442902,0.00484643,0.00624437,0.00444791,0.00633567,0.00575348,0.00625822,0.00800996,0.00870636,0.01367777,0.01752233,0.02617859,0.03015327,0.035515,0.04097431,0.0468373,0.0527003,0.05856329,0.06442629,0.07028928,0.07615228,0.08201527,0.08787827])
        else:
            print("Error: Unknown year in ['tk in']")
            
        # puolet sv:llä olevisa vain 3 kk, puolet yhden vuoden, skaalataan alkavuus
        
        svrate_men,svrate_women,mfactor_3m,wfactor_3m=self.get_svrate()

        mfactor_1y=1.0-mfactor_3m
        mlfactor_3m=mfactor_3m*0.25+mfactor_1y*1.0

        wfactor_1y=1.0-wfactor_3m
        wlfactor_3m=wfactor_3m*0.25+wfactor_1y*1.0

        # skaalataan päivät oikeiksi
        svrate_men_scaled = svrate_men/mlfactor_3m
        svrate_women_scaled = svrate_women/wlfactor_3m
        
        sv_miehet = np.maximum(miehet_in,svrate_men_scaled)
        sv_naiset = np.maximum(naiset_in,svrate_women_scaled)

        # vuoden kestäviä sairauspoissaoloja
        sv_miehet_1y = np.maximum(miehet_in,mfactor_1y*sv_miehet)
        sv_naiset_1y = np.maximum(naiset_in,wfactor_1y*sv_naiset)
        
        # mikä osuus menee vuoden kuluttua tk:lle sv:tlä
        proportion_miehet=miehet_in/sv_miehet_1y
        proportion_naiset=naiset_in/sv_naiset_1y
        for g in range(3):
            prop[18:71,g]=proportion_miehet
            prop[18:71,g+3]=proportion_naiset
        prop[71:(self.max_age+1),:]=prop[70,:]

        for s in range(self.n_empl):
            for g in range(3):
                disab[18:71,g,s]=dfactor[g]*sv_miehet*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            for g in range(3,6):
                disab[18:71,g,s]=dfactor[g]*sv_naiset*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            
        #disab[18:63,:,:]=disab[18:63,:,:]
            
        #disab=1-(1-disab)**self.timestep
        disab = self.scale_rates(disab)

        prop2=1-prop**self.timestep
        sv_3m=np.zeros((self.max_age+1,6))
        for k in range(3):
            sv_3m[18:71,k]=mfactor_3m
            sv_3m[18:71,3+k]=wfactor_3m
        
        return disab,prop,sv_3m     

    def get_eff_disab_rate_v10(self,debug=False):
        '''
        Työkyvyttömyys-alkavuudet eri ryhmille
        Sisältää myös sairausvakuutuspäivärahasiirtymät
        Laskettu havaitusta työkyvyttömien lukumäärästä
        Siksi efektiivinen 
        Revisio 2022 v2
        
        Huomioi M.Laaksonen: Työkyvyttömyyseläkkeelle siirtyminen: trendit, tilannekuva, tulevaisuus
        '''
        disab=np.zeros((self.max_age+1,self.n_groups,self.n_empl))
        prop=np.zeros((self.max_age+1,self.n_groups))
        # male low, male mid, male high, female low, female mid, female high
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
            unempfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,1.0,0.0])
        else:
             # uusitalon selvityksestä Työkyvyttömyyden vuoksi menetetty työura
             # skaalattu alaspäin, jotta tk:laisten kokonaismäärä menee paremmin oikein
            #dfactor=np.array([1.15,0.95,0.,1.1,0.95,0.])
            dfactor=np.array([1.30,1.15,0.,1.3,1.15,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            
            tyot = 0.15
            unemp_factor = 1.0
            base = 1.0/(1.0*(1-tyot)+unemp_factor*tyot)
            unemp = unemp_factor*base
            unempfactor = np.array([unemp,base,base,base,unemp,base,base,base,base,base,base,base,base,unemp,base,0.0])

        if not self.silent:
            #print(f'disability rate from year {self.year}')
            print(f'disability rate from year {self.year}',dfactor)

        ### ['tk in']
        if self.year==2018:
            naiset_in=np.array([0.00225637,0.00285209,0.00271278,0.00277064,0.00153991,0.00133633,0.00051364,0.0009559,0.00045763,0.0003,0.0003,0.00077823,0.00092678,0.00094335,0.0005985,0.00083286,0.0015603,0.00037573,0.00082184,0.00077537,0.00175339,0.0016236,0.00161966,0.00180257,0.00256341,0.002927,0.00348685,0.00319307,0.00344802,0.00395005,0.00409842,0.00553728,0.00553272,0.006292,0.00613101,0.00709902,0.01161997,0.01348052,0.01874522,0.02179251,0.02832049,0.03645741,0.03820837,0.04307415,0.04839456,0.05416959,0.06039925,0.06708352,0.07422242,0.08181594,0.08986409,0.09836685,0.10732424])
            miehet_in=np.array([0.00185931,0.00371953,0.00376178,0.00170605,0.00148389,0.00102728,0.0017809,0.00138748,0.00078524,0.0003,0.0003,0.0003,0.0009053,0.0003,0.00169237,0.00114278,0.00117722,0.00096759,0.00081655,0.00073587,0.00159541,0.0014403,0.00176078,0.0005379,0.00185054,0.00323963,0.00351265,0.00382713,0.00374079,0.003956,0.00458114,0.00498936,0.00609742,0.00673283,0.00633071,0.00802636,0.01089036,0.01483945,0.01576255,0.01914836,0.02764039,0.03852335,0.0425835,0.04928873,0.05682382,0.06435892,0.07189401,0.0794291,0.0869642,0.09449929,0.10203438,0.10956947,0.11710457])
        elif self.year==2019:
            naiset_in=np.array([0.00306887,0.00318567,0.00264321,0.00187976,0.00182701,0.00106054,0.00086037,0.0006769,0.00085839,0.00047839,0.0003,0.0003,0.00071815,0.00086144,0.00075055,0.00098145,0.00103439,0.00187671,0.00052886,0.00084086,0.00097996,0.00162789,0.0019628,0.00158664,0.00214378,0.00236242,0.00305384,0.00354509,0.00338824,0.00344592,0.00450862,0.00464188,0.00637934,0.00566484,0.00677694,0.00709057,0.00874308,0.01354425,0.01620358,0.02212096,0.02817114,0.03509412,0.04134857,0.04763482,0.05401328,0.06129053,0.06946655,0.07854135,0.08851493,0.09938729,0.11115843,0.12382834,0.13739704])
            miehet_in=np.array([0.00088685,0.00303931,0.0036733,0.00290965,0.00112532,0.00121952,0.0005726,0.00160128,0.00074705,0.00085068,0.0003,0.0003,0.0003,0.00094073,0.0003,0.00145537,0.00102318,0.00105399,0.00119087,0.00094987,0.00097345,0.00169998,0.00155932,0.00171478,0.00062136,0.00200034,0.00359622,0.00390708,0.00389816,0.00375702,0.0039845,0.00506507,0.00551869,0.00689281,0.0074336,0.00740385,0.00906551,0.01202401,0.01716287,0.01902815,0.02598603,0.03352582,0.0430892,0.04957078,0.05720643,0.06501153,0.07288296,0.08075439,0.08862582,0.09649725,0.10436868,0.11224011,0.12011154])
        elif self.year==2020:
            naiset_in=np.array([0.00323193,0.00383479,0.00314231,0.00180402,0.00063479,0.00130793,0.00046196,0.00089342,0.00042354,0.00105415,0.00054955,0.0003,0.0003,0.00089171,0.00099707,0.00117701,0.00096141,0.00098363,0.00178024,0.00052052,0.00095955,0.00116075,0.00186808,0.00196619,0.0015671,0.00200243,0.00244122,0.00319859,0.00362879,0.00378771,0.00371779,0.00487587,0.00492899,0.0068159,0.00624748,0.00777514,0.0083245,0.0100485,0.01576059,0.01877768,0.02860321,0.03557404,0.04139112,0.04779875,0.05505402,0.06315692,0.07210746,0.08190563,0.09255143,0.10404487,0.11638594,0.12957465,0.14361098])
            miehet_in=np.array([0.00335051,0.00309853,0.00287504,0.00281907,0.00195887,0.00078877,0.00092035,0.00068737,0.00117683,0.00083678,0.00083165,0.0003,0.0003,0.0003,0.00103878,0.0003,0.00147247,0.00095916,0.0010637,0.00125019,0.00108563,0.00122513,0.0017335,0.00155012,0.00159342,0.00082201,0.00204389,0.00374595,0.00399212,0.00425091,0.00391367,0.00453207,0.00513774,0.00600825,0.00664123,0.00864187,0.00815661,0.01115084,0.01354733,0.01978746,0.02503003,0.03314958,0.03920946,0.04562499,0.05208437,0.05884796,0.06561155,0.07237513,0.07913872,0.0859023,0.09266589,0.09942947,0.10619306])
        elif self.year==2021:
            naiset_in=np.array([0.00258234,0.00393998,0.00369953,0.00234914,0.00081254,0.0003731,0.00106966,0.0005356,0.00066096,0.00044859,0.00085659,0.00061825,0.0003,0.0003,0.00092321,0.00089285,0.00131832,0.00109204,0.00097473,0.00188592,0.00069355,0.00120794,0.00103555,0.0017022,0.00182903,0.00154035,0.00248154,0.00293794,0.00335205,0.00381288,0.0038965,0.00400997,0.00476994,0.00517844,0.00752456,0.00719471,0.00889168,0.00944525,0.01247095,0.0179025,0.02480334,0.03574557,0.04239251,0.0498729,0.0578655,0.06676342,0.07656664,0.08727517,0.09888901,0.11140816,0.12483262,0.13916239,0.15439747])
            miehet_in=np.array([0.0030008,0.00336825,0.00303915,0.00194429,0.00208508,0.00127898,0.00063868,0.00068283,0.00052518,0.00111744,0.00080063,0.00075161,0.0003,0.0003,0.0003,0.00103905,0.0003,0.00141521,0.0008694,0.00134637,0.00152692,0.00125598,0.00081714,0.00154925,0.00183117,0.0019844,0.00097571,0.00223931,0.0037848,0.0040323,0.00423125,0.00444803,0.00489471,0.00528597,0.0060847,0.00712631,0.01004402,0.00905931,0.01295141,0.01541428,0.02552768,0.03095311,0.03847137,0.04485136,0.05221063,0.0595699,0.06692917,0.07428844,0.08164771,0.08900698,0.09636625,0.10372552,0.11108479])
        elif self.year==2022:
            naiset_in=np.array([0.00335532,0.00372643,0.00352197,0.00279816,0.00171282,0.00029243,0.00029243,0.00044062,0.00046928,0.00053356,0.00055548,0.0010033,0.00071179,0.00029243,0.00029243,0.00101446,0.00098473,0.00152611,0.00117637,0.00088679,0.00188279,0.00066717,0.00116104,0.00116031,0.00167535,0.0019968,0.00154525,0.00270901,0.00324557,0.00363531,0.00388917,0.00391111,0.00409207,0.00533863,0.00546573,0.00769608,0.00751594,0.00993473,0.01164027,0.01462332,0.02357118,0.03223343,0.04385258,0.05190566,0.06122625,0.07302524,0.08730263,0.10405843,0.12329263,0.14500524,0.16919625,0.19586567,0.22501348])
            miehet_in=np.array([0.00267576,0.00408239,0.00276342,0.00215336,0.0010475,0.00157273,0.00064819,0.00035972,0.00055621,0.00088532,0.00102452,0.00086474,0.00056974,0.0002945,0.0002945,0.0002945,0.00120393,0.00034394,0.0014218,0.00092173,0.00127597,0.00143484,0.00116733,0.00092678,0.00158784,0.00154537,0.00200059,0.00084996,0.00256352,0.0038038,0.00421047,0.00429197,0.00477815,0.0050656,0.00574412,0.0065051,0.00773215,0.01071333,0.01010135,0.01533486,0.02086318,0.0318896,0.03634375,0.04290435,0.04979672,0.05703011,0.06426349,0.07149688,0.07873026,0.08596365,0.09319703,0.10043042,0.1076638])
        elif self.year==2023:
            naiset_in=np.array([0.00324335,0.00374051,0.00351326,0.00296431,0.00154821,0.00037046,0.00029243,0.00076958,0.00036119,0.00041156,0.0004683,0.0006576,0.000776,0.00029243,0.00029243,0.0004078,0.00120261,0.00171721,0.00192516,0.00102948,0.00144954,0.00029243,0.00085637,0.00133986,0.00200018,0.0023421,0.00163517,0.0023853,0.00244317,0.00188482,0.00494891,0.0054442,0.00667587,0.00503868,0.00676282,0.0076946,0.00739153,0.00787959,0.01165252,0.0149134,0.02253678,0.03099395,0.04283035,0.05062481,0.05955267,0.07049639,0.08345598,0.09843144,0.11542277,0.13442997,0.15545304,0.17849197,0.20354678])
            miehet_in=np.array([0.00222882,0.00372524,0.00295536,0.00226895,0.000856,0.00161584,0.00074841,0.0007035,0.00053783,0.00059098,0.00118427,0.00041031,0.00072212,0.0002945,0.0002945,0.0002945,0.00148831,0.00059603,0.00212812,0.00097852,0.00105226,0.00054485,0.00098932,0.00074731,0.00233774,0.0016278,0.00242512,0.00049825,0.00163669,0.00210629,0.00506532,0.00554179,0.00714399,0.00509599,0.00723771,0.00657973,0.0071561,0.00915217,0.00995177,0.01562721,0.02004217,0.02995747,0.0344639,0.04059193,0.04683311,0.05353085,0.06022859,0.06692632,0.07362406,0.0803218,0.08701953,0.09371727,0.10041501])
        elif self.year==2024:
            naiset_in=np.array([0.00289839,0.00335926,0.00314935,0.00265921,0.00139086,0.00033407,0.0002641,0.0006968,0.00032558,0.00037341,0.00042222,0.00059119,0.00070179,0.0002641,0.0002641,0.00036816,0.00108167,0.00154799,0.00173767,0.00092875,0.00130829,0.0002641,0.00077651,0.00121004,0.00179883,0.00211494,0.00147352,0.00215358,0.00219947,0.00169814,0.00446765,0.00485018,0.00599872,0.0045367,0.00606444,0.00688314,0.00663551,0.00706677,0.01041068,0.01321692,0.01997211,0.02700191,0.03698713,0.04363124,0.05123482,0.06049873,0.07142297,0.08400753,0.09825243,0.11415765,0.1317232,0.15094908,0.17183529])
            miehet_in=np.array([0.00194725,0.00325598,0.00258245,0.00198399,0.00074752,0.00141123,0.00065353,0.00061436,0.00046992,0.00051646,0.00103474,0.00035862,0.00063072,0.0002573,0.0002573,0.0002573,0.00129934,0.00052015,0.00185868,0.00085484,0.00092044,0.00047533,0.00086519,0.00065259,0.00204262,0.00142182,0.00211891,0.00043491,0.00142856,0.0018424,0.00442257,0.00484344,0.00623317,0.00444944,0.00632536,0.00575117,0.00625677,0.00800514,0.00869236,0.01365243,0.01754994,0.02620908,0.03004288,0.03538051,0.04081253,0.04662818,0.05244383,0.05825947,0.06407512,0.06989077,0.07570641,0.08152206,0.08733771])
        elif self.year==2025:
            naiset_in=np.array([0.00289839,0.00336023,0.0031476,0.00266551,0.00139277,0.0003337,0.0002641,0.00069569,0.00032587,0.00037292,0.00042261,0.00059286,0.00070117,0.0002641,0.0002641,0.00036835,0.00108331,0.00154614,0.00173653,0.00092747,0.00130901,0.0002641,0.00077592,0.00121044,0.00179765,0.00211801,0.00147257,0.00215016,0.00219962,0.00169949,0.00447094,0.00485643,0.00598734,0.00453036,0.00605342,0.00687243,0.00663468,0.00705969,0.0103873,0.01322552,0.02000466,0.02704815,0.03700437,0.04365864,0.05126692,0.06053235,0.07145494,0.08403468,0.09827157,0.11416561,0.13171681,0.15092516,0.17179067])
            miehet_in=np.array([0.00194725,0.00325505,0.00258121,0.00198003,0.00074806,0.00141122,0.00065361,0.00061431,0.00047027,0.00051622,0.00103583,0.0003586,0.00063159,0.0002573,0.0002573,0.0002573,0.001299,0.00052135,0.00185827,0.00085355,0.0009193,0.00047515,0.00086461,0.00065249,0.00204241,0.00142271,0.00211709,0.00043511,0.00142782,0.0018435,0.00442471,0.00483889,0.00624304,0.00444717,0.0063326,0.0057488,0.0062536,0.00799841,0.00868918,0.01366509,0.01755126,0.02612868,0.03006877,0.03541366,0.04085081,0.04667569,0.05250058,0.05832546,0.06415035,0.06997524,0.07580012,0.08162501,0.0874499])
        elif self.year==2026:
            naiset_in=np.array([0.00289839,0.00335822,0.00314975,0.00266127,0.00139136,0.00033404,0.0002641,0.00069583,0.00032584,0.00037303,0.00042241,0.00059233,0.00070086,0.0002641,0.0002641,0.00036821,0.00108223,0.00154783,0.0017399,0.00092885,0.00130943,0.0002641,0.00077549,0.0012098,0.00179587,0.00211432,0.00147224,0.00215313,0.00219812,0.00169477,0.00447379,0.00485464,0.00600078,0.00453244,0.00605591,0.00688248,0.00664378,0.00706172,0.01040009,0.0132265,0.01996183,0.02702512,0.03698514,0.0436314,0.05123262,0.06048926,0.0714013,0.08396876,0.09819163,0.1140699,0.13160359,0.15079269,0.1716372])
            miehet_in=np.array([0.00194725,0.0032567,0.00258172,0.00198134,0.00074778,0.00141066,0.00065329,0.00061422,0.00046966,0.00051632,0.00103628,0.00035863,0.00063097,0.0002573,0.0002573,0.0002573,0.00130106,0.00052081,0.001858,0.00085508,0.00091939,0.00047524,0.00086432,0.00065327,0.00204067,0.00142186,0.00211666,0.00043527,0.00143043,0.00184118,0.00442902,0.00484643,0.00624437,0.00444791,0.00633567,0.00575348,0.00625822,0.00800996,0.00870636,0.01367777,0.01752233,0.02617859,0.03015327,0.035515,0.04097431,0.0468373,0.0527003,0.05856329,0.06442629,0.07028928,0.07615228,0.08201527,0.08787827])
        else:
            print("Error: Unknown year in ['tk in']")
            
        # puolet sv:llä olevisa vain 3 kk, puolet yhden vuoden, skaalataan alkavuus
        
        svrate_men,svrate_women,mfactor_3m,wfactor_3m=self.get_svrate()

        mfactor_1y=1.0-mfactor_3m
        mlfactor_3m=mfactor_3m*0.25+mfactor_1y*1.0

        wfactor_1y=1.0-wfactor_3m
        wlfactor_3m=wfactor_3m*0.25+wfactor_1y*1.0

        # skaalataan päivät oikeiksi
        svrate_men_scaled = svrate_men/mlfactor_3m
        svrate_women_scaled = svrate_women/wlfactor_3m
        
        sv_miehet = np.maximum(miehet_in,svrate_men_scaled)
        sv_naiset = np.maximum(naiset_in,svrate_women_scaled)

        # vuoden kestäviä sairauspoissaoloja
        sv_miehet_1y = np.maximum(miehet_in,mfactor_1y*sv_miehet)
        sv_naiset_1y = np.maximum(naiset_in,wfactor_1y*sv_naiset)
        
        # mikä osuus menee vuoden kuluttua tk:lle sv:tlä
        proportion_miehet=miehet_in/sv_miehet_1y
        proportion_naiset=naiset_in/sv_naiset_1y
        for g in range(3):
            prop[18:71,g]=proportion_miehet
            prop[18:71,g+3]=proportion_naiset
        prop[71:(self.max_age+1),:]=prop[70,:]

        for s in range(self.n_empl):
            for g in range(3):
                disab[18:71,g,s]=dfactor[g]*sv_miehet*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            for g in range(3,6):
                disab[18:71,g,s]=dfactor[g]*sv_naiset*unempfactor[s]
                disab[71:(self.max_age+1),g,s]=disab[70,g,s]
            
        #disab[18:63,:,:]=disab[18:63,:,:]
            
        #disab=1-(1-disab)**self.timestep
        disab = self.scale_rates(disab)

        prop2=1-prop**self.timestep
        sv_3m=np.zeros((self.max_age+1,6))
        for k in range(3):
            sv_3m[18:71,k]=mfactor_3m
            sv_3m[18:71,3+k]=wfactor_3m
        
        return disab,prop,sv_3m         
    
    def get_svrate(self):
        '''
        sairaspäivärahalla olevien 
        vuosi?
        '''
        age=np.array([18,22.5,27.5,32.5,37.5,42.5,47.5,52.5,57.5,62.5,67])
        
        #  3kk tasolla, laskettu sairaspoissaolojen htv-luvuista ja lisätty omavastuupäivät (=10*jaksot)
        # laskettu suhteessa väestöön
        #rate_men=np.array([0.002567698,0.009325702,0.010736583,0.011060345,0.011702349,0.012944926,0.015243392,0.019080672,0.025693238,0.022590949,0.002527385])
        #rate_women=np.array([0.00426013,0.014350251,0.01567143,0.016508131,0.018067472,0.019533182,0.022035272,0.025813377,0.029899956,0.026907464,0.002302255])
        
        # 3kk tasolla, laskettu sairaspoissaolojen htv-luvuista ja lisätty omavastuupäivät (=10*jaksot)
        # laskettu suhteessa työvoimaan

        if self.year==2018:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2019:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2020:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2021:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2022:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2023:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2024:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2025:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        elif self.year==2026:
            rate_men=np.array([0.008678758,0.015217602,0.013277805,0.012621973,0.013078015,0.014288881,0.016871083,0.02145755,0.030219637,0.035464077,0.019311905])
            rate_women=np.array([0.01157876,0.022912744,0.020098495,0.020184366,0.021116476,0.021845441,0.024272915,0.028670251,0.034151314,0.04022943,0.016787963])
            ratio_3m_men=np.array([0.290072102,0.379583093,0.425317401,0.452083206,0.460677966,0.461205842,0.440757339,0.400795206,0.363731899,0.359326632,0.493818182])
            ratio_3m_women=np.array([0.280842868,0.40415308,0.498961752,0.523493525,0.503418331,0.495910862,0.487274873,0.470055047,0.443601234,0.418617917,0.597496871])
        else:
            print("Error: Unknown year in ['sv in']")

        
        # 1v tasolla
        #rate=1-(1-rate)**(1.0/self.timestep)
        
        x = np.linspace(18, 70, num=53, endpoint=True)
        f = interp1d(age, rate_men, fill_value='extrapolate')
        xmen = f(x)
        f = interp1d(age, rate_women, fill_value='extrapolate')
        xwomen = f(x)
        f = interp1d(age, ratio_3m_men, fill_value='extrapolate')
        threem = f(x)
        f = interp1d(age, ratio_3m_women, fill_value='extrapolate')
        threew = f(x)
        
        return xmen,xwomen,threem,threew
        
    def print_svrate(self):
        xmen,xwomen,threem,threew = self.get_svrate()
        xmen = 1-(1-xmen)**(1-self.timestep)
        xwomen = 1-(1-xwomen)**(1-self.timestep)

        print(xmen)
        print(xwomen)

    def get_birth_rate_v1(self,debug=False,symmetric=False):
        '''
        Syntyvyysdata
        '''
        birth=np.zeros((self.max_age+1,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        elif symmetric:
            dfactor=np.array([0.8,1.0,1.25,0.8,1.0,1.25])
        else:
            dfactor=np.array([0.75,1.0,1.25,0.5,1.0,1.5])
            
        for g in range(self.n_groups):
            factor=dfactor[g] # tämä vaikeuttaa sovitetta
            birth[15,g]=0.000177167*factor
            birth[16,g]=0.001049171*factor
            birth[17,g]=0.002303504*factor
            birth[18,g]=0.00630474*factor
            birth[19,g]=0.014399394*factor
            birth[20,g]=0.023042239*factor
            birth[21,g]=0.03088312*factor
            birth[22,g]=0.039755923*factor
            birth[23,g]=0.047483352*factor
            birth[24,g]=0.055630287*factor
            birth[25,g]=0.067942889*factor
            birth[26,g]=0.077108925*factor
            birth[27,g]=0.085396679*factor
            birth[28,g]=0.096968809*factor
            birth[29,g]=0.10081728*factor
            birth[30,g]=0.105586061*factor
            birth[31,g]=0.1124004*factor
            birth[32,g]=0.102667839*factor
            birth[33,g]=0.098528489*factor
            birth[34,g]=0.084080311*factor
            birth[35,g]=0.072335459*factor
            birth[36,g]=0.065203338*factor
            birth[37,g]=0.053073374*factor
            birth[38,g]=0.044054569*factor
            birth[39,g]=0.032984136*factor
            birth[40,g]=0.024135797*factor
            birth[41,g]=0.0174215*factor
            birth[42,g]=0.011621238*factor
            birth[43,g]=0.006909705*factor
            birth[44,g]=0.003977037*factor
            birth[45,g]=0.002171444*factor
            birth[46,g]=0.00115119*factor
            birth[47,g]=0.000712692*factor
            birth[48,g]=9.16478E-05*factor
            birth[49,g]=0.000113167*factor

        # syntyvyys on lasten määrä suhteessa naisten määrään
        # ei siis tarvetta kertoa kahdella, vaikka isät pääsevät isyysvapaalle

        #birth=1-(1-birth)**self.timestep
        birth = self.scale_rates(birth)

        return birth
        
    def get_birth_rate_v2(self,debug=False,symmetric=False):
        '''
        Syntyvyysdata
        Päivitetty 13.10.2021
        '''
        birth=np.zeros((self.max_age+1,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        elif symmetric:
            dfactor=np.array([0.8,1.0,1.25,0.8,1.0,1.25])
        else:
            #dfactor=np.array([0.75,1.0,1.375,0.6,1.0,1.6])
            dfactor=np.array([0.6,1.05,0.,0.75,1.05,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            
        #if debug:
        #    dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        #else:
        #    dfactor=np.array([0.835,1.0,1.25,0.8,1.0,1.3])
            
        if self.year==2018:
            bdata=np.array([0.00569959,0.011937244,0.020951263,0.028827696,0.034751037,0.043394825,0.051886089,0.064069418,0.072356108,0.08,0.090506401,0.096027745,0.100822746,0.103865916,0.098191371,0.088888239,0.082899639,0.072963407,0.061780343,0.051564837,0.042105888,0.033690476,0.024182459,0.016327851,0.011475651,0.006451613,0.003594199,0.001798997,0.000968863,0.000512246,0.000217216,0.000122298,8.5022E-05,5.54493E-05,5.50858E-05,2.74183E-05,0])
        elif self.year==2019:
            bdata=np.array([0.005106294,0.01251173,0.017809014,0.026994415,0.032204898,0.043130066,0.048894492,0.057542032,0.069026601,0.074917822,0.084601199,0.091066413,0.096168316,0.097412349,0.094562935,0.087455326,0.082835408,0.073790916,0.063865266,0.048179811,0.03848964,0.031461604,0.023676012,0.016556785,0.010069873,0.006201687,0.004392827,0.002779339,0.001313062,0.000600901,0.00032001,6.20636E-05,9.18189E-05,0,0,0,0])
        elif self.year==2020:
            bdata=np.array([0.005688202,0.010485019,0.018627077,0.023832221,0.033648899,0.039267615,0.047328391,0.060260487,0.066735234,0.079297218,0.084627153,0.094005372,0.099303578,0.102518399,0.096110234,0.090256969,0.083263698,0.075095719,0.063635595,0.052059117,0.040059723,0.033487533,0.024905683,0.016563637,0.010233222,0.006797141,0.003957784,0.002344314,0.001060346,0.000483592,0.00023331,0.000160041,0.000124066,3.06194E-05,0,2.78002E-05,5.52318E-05])
        elif self.year==2021:
            bdata=np.array([0.005688202,0.010485019,0.018627077,0.023832221,0.033648899,0.039267615,0.047328391,0.060260487,0.066735234,0.079297218,0.084627153,0.094005372,0.099303578,0.102518399,0.096110234,0.090256969,0.083263698,0.075095719,0.063635595,0.052059117,0.040059723,0.033487533,0.024905683,0.016563637,0.010233222,0.006797141,0.003957784,0.002344314,0.001060346,0.000483592,0.00023331,0.000160041,0.000124066,3.06194E-05,0,2.78002E-05,5.52318E-05])
        elif self.year==2022:
            bdata=np.array([0.005688202,0.010485019,0.018627077,0.023832221,0.033648899,0.039267615,0.047328391,0.060260487,0.066735234,0.079297218,0.084627153,0.094005372,0.099303578,0.102518399,0.096110234,0.090256969,0.083263698,0.075095719,0.063635595,0.052059117,0.040059723,0.033487533,0.024905683,0.016563637,0.010233222,0.006797141,0.003957784,0.002344314,0.001060346,0.000483592,0.00023331,0.000160041,0.000124066,3.06194E-05,0,2.78002E-05,5.52318E-05])
        elif self.year==2023:
            bdata=np.array([0.005688202,0.010485019,0.018627077,0.023832221,0.033648899,0.039267615,0.047328391,0.060260487,0.066735234,0.079297218,0.084627153,0.094005372,0.099303578,0.102518399,0.096110234,0.090256969,0.083263698,0.075095719,0.063635595,0.052059117,0.040059723,0.033487533,0.024905683,0.016563637,0.010233222,0.006797141,0.003957784,0.002344314,0.001060346,0.000483592,0.00023331,0.000160041,0.000124066,3.06194E-05,0,2.78002E-05,5.52318E-05])
        else:
            print('Unknown year',self.year)

        for g in range(self.n_groups):
            factor=dfactor[g] # tämä vaikeuttaa sovitetta
            birth[18:55,g]=bdata*factor

        # syntyvyys on lasten määrä suhteessa naisten määrään
        # ei siis tarvetta kertoa kahdella, vaikka isät pääsevät isyysvapaalle

        #birth=1-(1-birth)**self.timestep
        birth = self.scale_rates(birth)

        return birth        
        
    def get_birth_rate_v4(self,debug=False,symmetric=False):
        '''
        Syntyvyysdata
        Päivitetty 13.10.2021
        '''
        birth=np.zeros((self.max_age+1,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        elif symmetric:
            dfactor=np.array([0.8,1.0,1.25,0.8,1.0,1.25])
        else:
            #dfactor=np.array([0.75,1.0,1.375,0.6,1.0,1.6])
            dfactor=np.array([0.6,1.05,0.,0.75,1.05,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            dfactor *= 1.1
            
        ### ['syntyneet in']
        if self.year==2018:
            naiset_in=np.array([0.005739483446489816,0.012047778045506179,0.02120820376646518,0.02927337500840223,0.03535270256900702,0.04428300694883133,0.052924536910302036,0.06543048769384845,0.07394656308851225,0.08182598655969685,0.09255092200239633,0.09812680544387861,0.10303030303030303,0.10645100620650742,0.10060636059893578,0.09108074087394354,0.08510948905109489,0.07493702770780857,0.06358821291663008,0.052996503074882434,0.04334668174731758,0.03475377624953948,0.02497915830425788,0.016887266088544045,0.011892781996157717,0.0066985945472188314,0.003744586630197649,0.0018800390469648216,0.0010159753363228699,0.000538521086466292,0.00022922260789835615,0.000129680661371373,9.041591320072333e-05,5.942653394740752e-05,5.931725835631877e-05,2.9667428130655354e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.005320184260040226,0.011150047785919083,0.01979261771227338,0.02749368686868687,0.03261134095887077,0.04113849765258216,0.0494332225347311,0.06088331638992432,0.06785473201026057,0.07551293609813403,0.08515730034955633,0.09053441406786647,0.09501109558642229,0.09718962852727377,0.09178921222727145,0.0833173406442769,0.07776443910897693,0.06873014622876795,0.057202274402442875,0.048762898036169976,0.03948101124846865,0.032086167800453515,0.02272599584246306,0.015551881637571104,0.01084206722081677,0.006070749765964086,0.003457398833503698,0.0017028522775649213,0.0009222158621128284,0.0005008922142566446,0.00021263023601956197,0.00011860285832888572,8.381527114240215e-05,5.4519681605059426e-05,5.446029844243546e-05,2.7221995372260786e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.005143097054089987,0.012640449438202247,0.018056660555536338,0.027443833023728575,0.03278853575863342,0.04397009639976392,0.04997328472200396,0.058764849913847825,0.07054492788606602,0.07672042853379388,0.08661277951501563,0.09319745666753768,0.0984096899339592,0.0996778864623659,0.09697650472713658,0.08971594060016021,0.08494485458947305,0.07588817705299941,0.06571158960281376,0.049673126313331775,0.03964359892838867,0.03244891735285148,0.024478527607361963,0.01713280237080941,0.010444261745988247,0.006440978051833084,0.004573504996397582,0.002902142368017739,0.0013756154068925571,0.0006319337171745541,0.0003373591525538088,6.565341561894757e-05,9.778994719342852e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.004875460183741832,0.011636175576960372,0.01657932348737494,0.025430334524196168,0.030651942021710486,0.04046713742531233,0.04623168178646197,0.0547112462006079,0.06549569991876068,0.07018530419880034,0.07939856130672292,0.08550651287925201,0.0903996300225795,0.091637687459248,0.08829043804329299,0.0816372301654051,0.07748936634311267,0.06922566077832382,0.06009257080097278,0.04465902232951117,0.036437583001328024,0.02957116255801673,0.022573618850951882,0.015584196782073961,0.009604883649295735,0.005865510243793956,0.004138321995464852,0.002676369760028869,0.001243943957051198,0.0005723006486074017,0.0003135877575339459,6.090319437254484e-05,8.911067545891998e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.005727417359024218,0.010591288489864627,0.018900464592425736,0.024267637372161553,0.03430309811874956,0.040053360013340006,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.10172428732345551,0.10497806823868822,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.025719068634910972,0.017164224851345552,0.010611061414602548,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.0011087920688755545,0.000507964152244113,0.0002458210422812193,0.00016914749661705008,0.00013168724279835392,3.270538984824699e-05,0.0,3.0070666065253345e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.022163822309470286,0.031651287345937924,0.03735730504836853,0.044326718745323394,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.031734215605183344,0.023418879219555457,0.015791996841600632,0.00964531052852937,0.006494233568469376,0.0037495833796244863,0.0022091310751104565,0.0010222182135233456,0.0004584452157967123,0.00022286605749944285,0.00015702531248037183,0.00012205541315757354,2.976899261728983e-05,0.0,2.7462719358470875e-05,5.4860653938994955e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.005503278187315283,0.010546533961934695,0.01858388704318937,0.02417460975272828,0.03313965272616715,0.04080176660438254,0.04789625173830083,0.062290626382655964,0.06869120716251777,0.0789619478058026,0.08662993039443155,0.09231200897867564,0.0997394653375623,0.09955888100954827,0.09557794969882098,0.08483641536273115,0.08384673178061608,0.07689566069678339,0.06522304027717626,0.05269940884767321,0.03921676778819636,0.03230333136875193,0.024492753623188406,0.016459453898833142,0.010147492625368732,0.006879373739769897,0.003948291998128217,0.0022826373240467063,0.0010202856799903972,0.00043591979075850045,0.0002414958945697923,0.00016649462222370216,0.00012809427738815767,3.102603083987466e-05,0.0,2.842201000454752e-05,5.562818123661447e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.022163822309470286,0.031651287345937924,0.03735730504836853,0.044326718745323394,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.031734215605183344,0.023418879219555457,0.015791996841600632,0.00964531052852937,0.006494233568469376,0.0037495833796244863,0.0022091310751104565,0.0010222182135233456,0.0004584452157967123,0.00022286605749944285,0.00015702531248037183,0.00012205541315757354,2.976899261728983e-05,0.0,2.7462719358470875e-05,5.4860653938994955e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.005727417359024218,0.010591288489864627,0.018900464592425736,0.024267637372161553,0.03430309811874956,0.040053360013340006,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.10172428732345551,0.10497806823868822,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.025719068634910972,0.017164224851345552,0.010611061414602548,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.0011087920688755545,0.000507964152244113,0.0002458210422812193,0.00016914749661705008,0.00013168724279835392,3.270538984824699e-05,0.0,3.0070666065253345e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.022163822309470286,0.031651287345937924,0.03735730504836853,0.044326718745323394,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.031734215605183344,0.023418879219555457,0.015791996841600632,0.00964531052852937,0.006494233568469376,0.0037495833796244863,0.0022091310751104565,0.0010222182135233456,0.0004584452157967123,0.00022286605749944285,0.00015702531248037183,0.00012205541315757354,2.976899261728983e-05,0.0,2.7462719358470875e-05,5.4860653938994955e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.005727417359024218,0.010591288489864627,0.018900464592425736,0.024267637372161553,0.03430309811874956,0.040053360013340006,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.10172428732345551,0.10497806823868822,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.025719068634910972,0.017164224851345552,0.010611061414602548,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.0011087920688755545,0.000507964152244113,0.0002458210422812193,0.00016914749661705008,0.00013168724279835392,3.270538984824699e-05,0.0,3.0070666065253345e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.022163822309470286,0.031651287345937924,0.03735730504836853,0.044326718745323394,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.031734215605183344,0.023418879219555457,0.015791996841600632,0.00964531052852937,0.006494233568469376,0.0037495833796244863,0.0022091310751104565,0.0010222182135233456,0.0004584452157967123,0.00022286605749944285,0.00015702531248037183,0.00012205541315757354,2.976899261728983e-05,0.0,2.7462719358470875e-05,5.4860653938994955e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        else:
            print('Unknown year',self.year)
            
        bdata=naiset_in[:55-18]

        for g in range(self.n_groups):
            factor=dfactor[g] # tämä vaikeuttaa sovitetta
            birth[18:55,g]=bdata*factor

        # syntyvyys on lasten määrä suhteessa naisten määrään
        # ei siis tarvetta kertoa kahdella, vaikka isät pääsevät isyysvapaalle

        #birth=1-(1-birth)**self.timestep
        birth = self.scale_rates(birth)

        return birth                
        
    def get_birth_rate_v6(self,debug=False,symmetric=False):
        '''
        Syntyvyysdata
        Päivitetty 13.10.2021
        '''
        birth=np.zeros((self.max_age+1,self.n_groups))
        dfactor=np.array([0.75,1.05,0.,0.75,1.05,0.])
        dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
        dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
        dfactor *= 1.1
            
        ### ['syntyneet in']
        if self.year==2018:
            naiset_in=np.array([0.005739483446489816,0.01204777804550618,0.02120820376646518,0.02927337500840223,0.03535270256900702,0.04428300694883133,0.05292453691030204,0.06543048769384845,0.07394656308851225,0.08182598655969685,0.09255092200239633,0.09812680544387861,0.103030303030303,0.1064510062065074,0.1006063605989358,0.09108074087394354,0.08510948905109489,0.07493702770780857,0.06358821291663008,0.05299650307488243,0.04334668174731758,0.03475377624953948,0.02497915830425788,0.01688726608854405,0.01189278199615772,0.006698594547218831,0.003744586630197649,0.001880039046964822,0.00101597533632287,0.000538521086466292,0.0002292226078983561,0.000129680661371373,9.041591320072333e-05,5.942653394740752e-05,5.931725835631877e-05,2.966742813065535e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.005320184260040226,0.01115004778591908,0.01979261771227338,0.02749368686868687,0.03261134095887077,0.04113849765258216,0.0494332225347311,0.06088331638992432,0.06785473201026057,0.07551293609813403,0.08515730034955633,0.09053441406786647,0.09501109558642229,0.09718962852727377,0.09178921222727145,0.0833173406442769,0.07776443910897693,0.06873014622876795,0.05720227440244288,0.04876289803616998,0.03948101124846865,0.03208616780045351,0.02272599584246306,0.0155518816375711,0.01084206722081677,0.006070749765964086,0.003457398833503698,0.001702852277564921,0.0009222158621128284,0.0005008922142566446,0.000212630236019562,0.0001186028583288857,8.381527114240215e-05,5.451968160505943e-05,5.446029844243546e-05,2.722199537226079e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.005143097054089987,0.01264044943820225,0.01805666055553634,0.02744383302372858,0.03278853575863342,0.04397009639976392,0.04997328472200396,0.05876484991384782,0.07054492788606602,0.07672042853379388,0.08661277951501563,0.09319745666753768,0.0984096899339592,0.0996778864623659,0.09697650472713658,0.08971594060016021,0.08494485458947305,0.07588817705299941,0.06571158960281376,0.04967312631333178,0.03964359892838867,0.03244891735285148,0.02447852760736196,0.01713280237080941,0.01044426174598825,0.006440978051833084,0.004573504996397582,0.002902142368017739,0.001375615406892557,0.0006319337171745541,0.0003373591525538088,6.565341561894757e-05,9.778994719342852e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.004875460183741832,0.01163617557696037,0.01657932348737494,0.02543033452419617,0.03065194202171049,0.04046713742531233,0.04623168178646197,0.0547112462006079,0.06549569991876068,0.07018530419880034,0.07939856130672292,0.08550651287925201,0.0903996300225795,0.091637687459248,0.08829043804329299,0.0816372301654051,0.07748936634311267,0.06922566077832382,0.06009257080097278,0.04465902232951117,0.03643758300132802,0.02957116255801673,0.02257361885095188,0.01558419678207396,0.009604883649295735,0.005865510243793956,0.004138321995464852,0.002676369760028869,0.001243943957051198,0.0005723006486074017,0.0003135877575339459,6.090319437254484e-05,8.911067545891998e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.005539976745776623,0.010654060537642,0.01885599915727378,0.02462274438073798,0.03377401363354679,0.04165077163169759,0.04887304887304887,0.06379260122341975,0.07020309746823704,0.08075145370508424,0.088808943331153,0.09452936444086886,0.1021817337820587,0.1018769819729737,0.0978689818468824,0.08698696070709723,0.08612174342511421,0.07906792084045933,0.06722013926084627,0.05429198175835594,0.04047591938973016,0.03328032383981495,0.02527896610524426,0.01705237515225335,0.01051891263798428,0.007147258163894023,0.004109338853037867,0.002377758809901231,0.001065062807380259,0.0004556253457870928,0.0002549255253286718,0.0001763730643056192,0.0001362351418548414,3.316969616558312e-05,0.0,3.079955648638659e-05,6.049240820277055e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2024:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2025:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2026:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        else:
            print("Error: Unknown year in ['syntyneet in']")
            
        bdata=naiset_in[:55-18]

        for g in range(self.n_groups):
            birth[18:55,g]=bdata*dfactor[g]

        # syntyvyys on lasten määrä suhteessa naisten määrään
        # ei siis tarvetta kertoa kahdella, vaikka isät pääsevät isyysvapaalle

        #birth=1-(1-birth)**self.timestep
        birth = self.scale_rates(birth)

        return birth           

    def get_birth_rate_v5(self,debug=False,symmetric=False):
        '''
        Syntyvyysdata
        Päivitetty 13.10.2021
        '''
        birth=np.zeros((self.max_age+1,self.n_groups))
        if debug:
            dfactor=np.array([1.0,1.0,1.0,1.0,1.0,1.0])
        elif symmetric:
            dfactor=np.array([0.8,1.0,1.25,0.8,1.0,1.25])
        else:
            #dfactor=np.array([0.75,1.0,1.375,0.6,1.0,1.6])
            dfactor=np.array([0.6,1.05,0.,0.75,1.05,0.])
            dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
            dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])
            dfactor *= 1.1
            
        ### ['syntyneet in']
        if self.year==2018:
            naiset_in=np.array([0.005739483446489816,0.01204777804550618,0.02120820376646518,0.02927337500840223,0.03535270256900702,0.04428300694883133,0.05292453691030204,0.06543048769384845,0.07394656308851225,0.08182598655969685,0.09255092200239633,0.09812680544387861,0.103030303030303,0.1064510062065074,0.1006063605989358,0.09108074087394354,0.08510948905109489,0.07493702770780857,0.06358821291663008,0.05299650307488243,0.04334668174731758,0.03475377624953948,0.02497915830425788,0.01688726608854405,0.01189278199615772,0.006698594547218831,0.003744586630197649,0.001880039046964822,0.00101597533632287,0.000538521086466292,0.0002292226078983561,0.000129680661371373,9.041591320072333e-05,5.942653394740752e-05,5.931725835631877e-05,2.966742813065535e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.005320184260040226,0.01115004778591908,0.01979261771227338,0.02749368686868687,0.03261134095887077,0.04113849765258216,0.0494332225347311,0.06088331638992432,0.06785473201026057,0.07551293609813403,0.08515730034955633,0.09053441406786647,0.09501109558642229,0.09718962852727377,0.09178921222727145,0.0833173406442769,0.07776443910897693,0.06873014622876795,0.05720227440244288,0.04876289803616998,0.03948101124846865,0.03208616780045351,0.02272599584246306,0.0155518816375711,0.01084206722081677,0.006070749765964086,0.003457398833503698,0.001702852277564921,0.0009222158621128284,0.0005008922142566446,0.000212630236019562,0.0001186028583288857,8.381527114240215e-05,5.451968160505943e-05,5.446029844243546e-05,2.722199537226079e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.005143097054089987,0.01264044943820225,0.01805666055553634,0.02744383302372858,0.03278853575863342,0.04397009639976392,0.04997328472200396,0.05876484991384782,0.07054492788606602,0.07672042853379388,0.08661277951501563,0.09319745666753768,0.0984096899339592,0.0996778864623659,0.09697650472713658,0.08971594060016021,0.08494485458947305,0.07588817705299941,0.06571158960281376,0.04967312631333178,0.03964359892838867,0.03244891735285148,0.02447852760736196,0.01713280237080941,0.01044426174598825,0.006440978051833084,0.004573504996397582,0.002902142368017739,0.001375615406892557,0.0006319337171745541,0.0003373591525538088,6.565341561894757e-05,9.778994719342852e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.004875460183741832,0.01163617557696037,0.01657932348737494,0.02543033452419617,0.03065194202171049,0.04046713742531233,0.04623168178646197,0.0547112462006079,0.06549569991876068,0.07018530419880034,0.07939856130672292,0.08550651287925201,0.0903996300225795,0.091637687459248,0.08829043804329299,0.0816372301654051,0.07748936634311267,0.06922566077832382,0.06009257080097278,0.04465902232951117,0.03643758300132802,0.02957116255801673,0.02257361885095188,0.01558419678207396,0.009604883649295735,0.005865510243793956,0.004138321995464852,0.002676369760028869,0.001243943957051198,0.0005723006486074017,0.0003135877575339459,6.090319437254484e-05,8.911067545891998e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.005539976745776623,0.010654060537642,0.01885599915727378,0.02462274438073798,0.03377401363354679,0.04165077163169759,0.04887304887304887,0.06379260122341975,0.07020309746823704,0.08075145370508424,0.088808943331153,0.09452936444086886,0.1021817337820587,0.1018769819729737,0.0978689818468824,0.08698696070709723,0.08612174342511421,0.07906792084045933,0.06722013926084627,0.05429198175835594,0.04047591938973016,0.03328032383981495,0.02527896610524426,0.01705237515225335,0.01051891263798428,0.007147258163894023,0.004109338853037867,0.002377758809901231,0.001065062807380259,0.0004556253457870928,0.0002549255253286718,0.0001763730643056192,0.0001362351418548414,3.316969616558312e-05,0.0,3.079955648638659e-05,6.049240820277055e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2024:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2025:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2026:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        else:
            print("Error: Unknown year in ['syntyneet in']")
            
        bdata=naiset_in[:55-18]

        for g in range(self.n_groups):
            factor=dfactor[g] # tämä vaikeuttaa sovitetta
            birth[18:55,g]=bdata*factor

        # syntyvyys on lasten määrä suhteessa naisten määrään
        # ei siis tarvetta kertoa kahdella, vaikka isät pääsevät isyysvapaalle

        #birth=1-(1-birth)**self.timestep
        birth = self.scale_rates(birth)

        return birth  

    def get_birth_rate_v7(self,debug=False,symmetric=False):
        '''
        Syntyvyysdata
        Päivitetty 13.10.2021
        '''
        birth=np.zeros((self.max_age+1,self.n_groups))
        dfactor=np.array([0.75,1.05,0.,0.75,1.05,0.])
        dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
        dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])

        #dfactor *= 1.1 # scaling??
        
        ### ['syntyneet in']
        if self.year==2018:
            naiset_in=np.array([0.005739483446489816,0.01204777804550618,0.02120820376646518,0.02927337500840223,0.03535270256900702,0.04428300694883133,0.05292453691030204,0.06543048769384845,0.07394656308851225,0.08182598655969685,0.09255092200239633,0.09812680544387861,0.103030303030303,0.1064510062065074,0.1006063605989358,0.09108074087394354,0.08510948905109489,0.07493702770780857,0.06358821291663008,0.05299650307488243,0.04334668174731758,0.03475377624953948,0.02497915830425788,0.01688726608854405,0.01189278199615772,0.006698594547218831,0.003744586630197649,0.001880039046964822,0.00101597533632287,0.000538521086466292,0.0002292226078983561,0.000129680661371373,9.041591320072333e-05,5.942653394740752e-05,5.931725835631877e-05,2.966742813065535e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.005320184260040226,0.01115004778591908,0.01979261771227338,0.02749368686868687,0.03261134095887077,0.04113849765258216,0.0494332225347311,0.06088331638992432,0.06785473201026057,0.07551293609813403,0.08515730034955633,0.09053441406786647,0.09501109558642229,0.09718962852727377,0.09178921222727145,0.0833173406442769,0.07776443910897693,0.06873014622876795,0.05720227440244288,0.04876289803616998,0.03948101124846865,0.03208616780045351,0.02272599584246306,0.0155518816375711,0.01084206722081677,0.006070749765964086,0.003457398833503698,0.001702852277564921,0.0009222158621128284,0.0005008922142566446,0.000212630236019562,0.0001186028583288857,8.381527114240215e-05,5.451968160505943e-05,5.446029844243546e-05,2.722199537226079e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.005143097054089987,0.01264044943820225,0.01805666055553634,0.02744383302372858,0.03278853575863342,0.04397009639976392,0.04997328472200396,0.05876484991384782,0.07054492788606602,0.07672042853379388,0.08661277951501563,0.09319745666753768,0.0984096899339592,0.0996778864623659,0.09697650472713658,0.08971594060016021,0.08494485458947305,0.07588817705299941,0.06571158960281376,0.04967312631333178,0.03964359892838867,0.03244891735285148,0.02447852760736196,0.01713280237080941,0.01044426174598825,0.006440978051833084,0.004573504996397582,0.002902142368017739,0.001375615406892557,0.0006319337171745541,0.0003373591525538088,6.565341561894757e-05,9.778994719342852e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.004875460183741832,0.01163617557696037,0.01657932348737494,0.02543033452419617,0.03065194202171049,0.04046713742531233,0.04623168178646197,0.0547112462006079,0.06549569991876068,0.07018530419880034,0.07939856130672292,0.08550651287925201,0.0903996300225795,0.091637687459248,0.08829043804329299,0.0816372301654051,0.07748936634311267,0.06922566077832382,0.06009257080097278,0.04465902232951117,0.03643758300132802,0.02957116255801673,0.02257361885095188,0.01558419678207396,0.009604883649295735,0.005865510243793956,0.004138321995464852,0.002676369760028869,0.001243943957051198,0.0005723006486074017,0.0003135877575339459,6.090319437254484e-05,8.911067545891998e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.005161687290626923,0.009917911499436301,0.01703185294324002,0.02334247345848274,0.03026458125193785,0.03840152565880721,0.04735192212506187,0.0608833967864748,0.07055739633976404,0.08072169249106079,0.09612993177098783,0.1025115770702103,0.1099074557586307,0.1134288820231148,0.1092789840229414,0.09879055531263665,0.09495831789551687,0.08483594298446419,0.07213066072754269,0.0577036352611671,0.04893991928607969,0.03595786052180979,0.03012541530725254,0.02057595282961522,0.01225142262742459,0.008215637404227823,0.004468900103362316,0.002347346279303722,0.001411189162067235,0.0008159268929503916,0.0002539636469179697,0.0002462274438073798,6.787253537855906e-05,3.299567756623883e-05,0.0,0.0,6.040106305870983e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.005334369590560639,0.009866465722697322,0.01704979631970783,0.02298930166533947,0.03073470244550957,0.03694992159610316,0.04683267517378675,0.0588131525635032,0.06829656495413945,0.08116670661553212,0.09376833820423044,0.1041623801730185,0.1095736804049169,0.1168863864158953,0.1100032401543492,0.1053829410118474,0.09416459998162947,0.08283849432241529,0.07028763238613346,0.0568597604347455,0.05006541648495421,0.03723963812329055,0.03075320072111712,0.02071636218978549,0.01233178332768762,0.008120684935673226,0.004475294547447255,0.002411223147742218,0.001467901878914405,0.000910647288092376,0.0002459592410400562,0.0002352387673488591,6.54150585464774e-05,3.24380433372259e-05,0.0,0.0,5.944066335780308e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.005334369590560639,0.009866465722697322,0.01704979631970783,0.02298930166533947,0.03073470244550957,0.03694992159610316,0.04683267517378675,0.0588131525635032,0.06829656495413945,0.08116670661553212,0.09376833820423044,0.1041623801730185,0.1095736804049169,0.1168863864158953,0.1100032401543492,0.1053829410118474,0.09416459998162947,0.08283849432241529,0.07028763238613346,0.0568597604347455,0.05006541648495421,0.03723963812329055,0.03075320072111712,0.02071636218978549,0.01233178332768762,0.008120684935673226,0.004475294547447255,0.002411223147742218,0.001467901878914405,0.000910647288092376,0.0002459592410400562,0.0002352387673488591,6.54150585464774e-05,3.24380433372259e-05,0.0,0.0,5.944066335780308e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2024:
            naiset_in=np.array([0.005334369590560639,0.009866465722697322,0.01704979631970783,0.02298930166533947,0.03073470244550957,0.03694992159610316,0.04683267517378675,0.0588131525635032,0.06829656495413945,0.08116670661553212,0.09376833820423044,0.1041623801730185,0.1095736804049169,0.1168863864158953,0.1100032401543492,0.1053829410118474,0.09416459998162947,0.08283849432241529,0.07028763238613346,0.0568597604347455,0.05006541648495421,0.03723963812329055,0.03075320072111712,0.02071636218978549,0.01233178332768762,0.008120684935673226,0.004475294547447255,0.002411223147742218,0.001467901878914405,0.000910647288092376,0.0002459592410400562,0.0002352387673488591,6.54150585464774e-05,3.24380433372259e-05,0.0,0.0,5.944066335780308e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2025:
            naiset_in=np.array([0.005334369590560639,0.009866465722697322,0.01704979631970783,0.02298930166533947,0.03073470244550957,0.03694992159610316,0.04683267517378675,0.0588131525635032,0.06829656495413945,0.08116670661553212,0.09376833820423044,0.1041623801730185,0.1095736804049169,0.1168863864158953,0.1100032401543492,0.1053829410118474,0.09416459998162947,0.08283849432241529,0.07028763238613346,0.0568597604347455,0.05006541648495421,0.03723963812329055,0.03075320072111712,0.02071636218978549,0.01233178332768762,0.008120684935673226,0.004475294547447255,0.002411223147742218,0.001467901878914405,0.000910647288092376,0.0002459592410400562,0.0002352387673488591,6.54150585464774e-05,3.24380433372259e-05,0.0,0.0,5.944066335780308e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2026:
            naiset_in=np.array([0.005334369590560639,0.009866465722697322,0.01704979631970783,0.02298930166533947,0.03073470244550957,0.03694992159610316,0.04683267517378675,0.0588131525635032,0.06829656495413945,0.08116670661553212,0.09376833820423044,0.1041623801730185,0.1095736804049169,0.1168863864158953,0.1100032401543492,0.1053829410118474,0.09416459998162947,0.08283849432241529,0.07028763238613346,0.0568597604347455,0.05006541648495421,0.03723963812329055,0.03075320072111712,0.02071636218978549,0.01233178332768762,0.008120684935673226,0.004475294547447255,0.002411223147742218,0.001467901878914405,0.000910647288092376,0.0002459592410400562,0.0002352387673488591,6.54150585464774e-05,3.24380433372259e-05,0.0,0.0,5.944066335780308e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        else:
            print("Error: Unknown year in ['syntyneet in']")
            
        bdata = naiset_in[:55-18]

        # lasten välillä vuosi, mistä syystä nostetaan syntyvyyttä vastaavasti
        bonus = 1.0 + 1.0/(40.0-18.0)

        for g in range(self.n_groups):
            birth[18:55,g] = bdata*dfactor[g]*bonus*1.1

        # syntyvyys on lasten määrä suhteessa naisten määrään
        # ei siis tarvetta kertoa kahdella, vaikka isät pääsevät isyysvapaalle

        # pitääkö skaalata vai ei??
        #birth=1-(1-birth)**self.timestep

        # jos allaolevan rivin kommentoi, lasten määrä 15-kertaistuu. Miksi?
        birth = birth * self.timestep # siirtymiä ei tapahdu mallissa sukupuolten välillä

        # tämä nelinkertaistaa lasten määrän, miksi?
        #birth *= 2

        return birth                                       

    def get_birth_rate_v8(self,debug=False,symmetric=False):
        '''
        Syntyvyysdata
        Päivitetty 13.10.2021
        '''
        birth=np.zeros((self.max_age+1,self.n_groups))
        dfactor=np.array([0.75,1.05,0.,0.75,1.05,0.])
        dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
        dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])

        #dfactor *= 1.1 # scaling??
        
        ### ['syntyneet in']
        if self.year==2018:
            naiset_in=np.array([0.005739483446489816,0.01204777804550618,0.02120820376646518,0.02927337500840223,0.03535270256900702,0.04428300694883133,0.05292453691030204,0.06543048769384845,0.07394656308851225,0.08182598655969685,0.09255092200239633,0.09812680544387861,0.103030303030303,0.1064510062065074,0.1006063605989358,0.09108074087394354,0.08510948905109489,0.07493702770780857,0.06358821291663008,0.05299650307488243,0.04334668174731758,0.03475377624953948,0.02497915830425788,0.01688726608854405,0.01189278199615772,0.006698594547218831,0.003744586630197649,0.001880039046964822,0.00101597533632287,0.000538521086466292,0.0002292226078983561,0.000129680661371373,9.041591320072333e-05,5.942653394740752e-05,5.931725835631877e-05,2.966742813065535e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.005320184260040226,0.01115004778591908,0.01979261771227338,0.02749368686868687,0.03261134095887077,0.04113849765258216,0.0494332225347311,0.06088331638992432,0.06785473201026057,0.07551293609813403,0.08515730034955633,0.09053441406786647,0.09501109558642229,0.09718962852727377,0.09178921222727145,0.0833173406442769,0.07776443910897693,0.06873014622876795,0.05720227440244288,0.04876289803616998,0.03948101124846865,0.03208616780045351,0.02272599584246306,0.0155518816375711,0.01084206722081677,0.006070749765964086,0.003457398833503698,0.001702852277564921,0.0009222158621128284,0.0005008922142566446,0.000212630236019562,0.0001186028583288857,8.381527114240215e-05,5.451968160505943e-05,5.446029844243546e-05,2.722199537226079e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.005143097054089987,0.01264044943820225,0.01805666055553634,0.02744383302372858,0.03278853575863342,0.04397009639976392,0.04997328472200396,0.05876484991384782,0.07054492788606602,0.07672042853379388,0.08661277951501563,0.09319745666753768,0.0984096899339592,0.0996778864623659,0.09697650472713658,0.08971594060016021,0.08494485458947305,0.07588817705299941,0.06571158960281376,0.04967312631333178,0.03964359892838867,0.03244891735285148,0.02447852760736196,0.01713280237080941,0.01044426174598825,0.006440978051833084,0.004573504996397582,0.002902142368017739,0.001375615406892557,0.0006319337171745541,0.0003373591525538088,6.565341561894757e-05,9.778994719342852e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.004875460183741832,0.01163617557696037,0.01657932348737494,0.02543033452419617,0.03065194202171049,0.04046713742531233,0.04623168178646197,0.0547112462006079,0.06549569991876068,0.07018530419880034,0.07939856130672292,0.08550651287925201,0.0903996300225795,0.091637687459248,0.08829043804329299,0.0816372301654051,0.07748936634311267,0.06922566077832382,0.06009257080097278,0.04465902232951117,0.03643758300132802,0.02957116255801673,0.02257361885095188,0.01558419678207396,0.009604883649295735,0.005865510243793956,0.004138321995464852,0.002676369760028869,0.001243943957051198,0.0005723006486074017,0.0003135877575339459,6.090319437254484e-05,8.911067545891998e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.005161687290626923,0.009917911499436301,0.01703185294324002,0.02334247345848274,0.03026458125193785,0.03840152565880721,0.04735192212506187,0.0608833967864748,0.07055739633976404,0.08072169249106079,0.09612993177098783,0.1025115770702103,0.1099074557586307,0.1134288820231148,0.1092789840229414,0.09879055531263665,0.09495831789551687,0.08483594298446419,0.07213066072754269,0.0577036352611671,0.04893991928607969,0.03595786052180979,0.03012541530725254,0.02057595282961522,0.01225142262742459,0.008215637404227823,0.004468900103362316,0.002347346279303722,0.001411189162067235,0.0008159268929503916,0.0002539636469179697,0.0002462274438073798,6.787253537855906e-05,3.299567756623883e-05,0.0,0.0,6.040106305870983e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.005334369590560639,0.009866465722697322,0.01704979631970783,0.02298930166533947,0.03073470244550957,0.03694992159610316,0.04683267517378675,0.0588131525635032,0.06829656495413945,0.08116670661553212,0.09376833820423044,0.1041623801730185,0.1095736804049169,0.1168863864158953,0.1100032401543492,0.1053829410118474,0.09416459998162947,0.08283849432241529,0.07028763238613346,0.0568597604347455,0.05006541648495421,0.03723963812329055,0.03075320072111712,0.02071636218978549,0.01233178332768762,0.008120684935673226,0.004475294547447255,0.002411223147742218,0.001467901878914405,0.000910647288092376,0.0002459592410400562,0.0002352387673488591,6.54150585464774e-05,3.24380433372259e-05,0.0,0.0,5.944066335780308e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.005334369590560639,0.009866465722697322,0.01704979631970783,0.02298930166533947,0.03073470244550957,0.03694992159610316,0.04683267517378675,0.0588131525635032,0.06829656495413945,0.08116670661553212,0.09376833820423044,0.1041623801730185,0.1095736804049169,0.1168863864158953,0.1100032401543492,0.1053829410118474,0.09416459998162947,0.08283849432241529,0.07028763238613346,0.0568597604347455,0.05006541648495421,0.03723963812329055,0.03075320072111712,0.02071636218978549,0.01233178332768762,0.008120684935673226,0.004475294547447255,0.002411223147742218,0.001467901878914405,0.000910647288092376,0.0002459592410400562,0.0002352387673488591,6.54150585464774e-05,3.24380433372259e-05,0.0,0.0,5.944066335780308e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2024:
            naiset_in=np.array([0.005334369590560639,0.009866465722697322,0.01704979631970783,0.02298930166533947,0.03073470244550957,0.03694992159610316,0.04683267517378675,0.0588131525635032,0.06829656495413945,0.08116670661553212,0.09376833820423044,0.1041623801730185,0.1095736804049169,0.1168863864158953,0.1100032401543492,0.1053829410118474,0.09416459998162947,0.08283849432241529,0.07028763238613346,0.0568597604347455,0.05006541648495421,0.03723963812329055,0.03075320072111712,0.02071636218978549,0.01233178332768762,0.008120684935673226,0.004475294547447255,0.002411223147742218,0.001467901878914405,0.000910647288092376,0.0002459592410400562,0.0002352387673488591,6.54150585464774e-05,3.24380433372259e-05,0.0,0.0,5.944066335780308e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2025:
            naiset_in=np.array([0.005334369590560639,0.009866465722697322,0.01704979631970783,0.02298930166533947,0.03073470244550957,0.03694992159610316,0.04683267517378675,0.0588131525635032,0.06829656495413945,0.08116670661553212,0.09376833820423044,0.1041623801730185,0.1095736804049169,0.1168863864158953,0.1100032401543492,0.1053829410118474,0.09416459998162947,0.08283849432241529,0.07028763238613346,0.0568597604347455,0.05006541648495421,0.03723963812329055,0.03075320072111712,0.02071636218978549,0.01233178332768762,0.008120684935673226,0.004475294547447255,0.002411223147742218,0.001467901878914405,0.000910647288092376,0.0002459592410400562,0.0002352387673488591,6.54150585464774e-05,3.24380433372259e-05,0.0,0.0,5.944066335780308e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2026:
            naiset_in=np.array([0.005334369590560639,0.009866465722697322,0.01704979631970783,0.02298930166533947,0.03073470244550957,0.03694992159610316,0.04683267517378675,0.0588131525635032,0.06829656495413945,0.08116670661553212,0.09376833820423044,0.1041623801730185,0.1095736804049169,0.1168863864158953,0.1100032401543492,0.1053829410118474,0.09416459998162947,0.08283849432241529,0.07028763238613346,0.0568597604347455,0.05006541648495421,0.03723963812329055,0.03075320072111712,0.02071636218978549,0.01233178332768762,0.008120684935673226,0.004475294547447255,0.002411223147742218,0.001467901878914405,0.000910647288092376,0.0002459592410400562,0.0002352387673488591,6.54150585464774e-05,3.24380433372259e-05,0.0,0.0,5.944066335780308e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        else:
            print("Error: Unknown year in ['syntyneet in']")
            
        bdata = naiset_in[:55-18]

        # lasten välillä vuosi, mistä syystä nostetaan syntyvyyttä vastaavasti
        bonus = 1.0 + 1.0/(40.0-18.0)

        for g in range(self.n_groups):
            birth[18:55,g] = bdata*dfactor[g]*bonus*1.1

        # syntyvyys on lasten määrä suhteessa naisten määrään
        # ei siis tarvetta kertoa kahdella, vaikka isät pääsevät isyysvapaalle

        # pitääkö skaalata vai ei??
        #birth=1-(1-birth)**self.timestep
        birth = self.scale_rates(birth)

        # jos allaolevan rivin kommentoi, lasten määrä 15-kertaistuu. Miksi?
        #birth = birth * self.timestep # siirtymiä ei tapahdu mallissa sukupuolten välillä

        return birth                 

    def get_birth_rate_v9(self,debug=False,symmetric=False):
        '''
        Syntyvyysdata
        Päivitetty 13.10.2021
        '''
        birth=np.zeros((self.max_age+1,self.n_groups))
        dfactor=np.array([0.75,1.05,0.,0.75,1.05,0.])
        dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
        dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])

        #dfactor *= 1.1 # scaling??
        
        ### ['syntyneet in']
        if self.year==2018:
            naiset_in=np.array([0.005739483446489816,0.01204777804550618,0.02120820376646518,0.02927337500840223,0.03535270256900702,0.04428300694883133,0.05292453691030204,0.06543048769384845,0.07394656308851225,0.08182598655969685,0.09255092200239633,0.09812680544387861,0.103030303030303,0.1064510062065074,0.1006063605989358,0.09108074087394354,0.08510948905109489,0.07493702770780857,0.06358821291663008,0.05299650307488243,0.04334668174731758,0.03475377624953948,0.02497915830425788,0.01688726608854405,0.01189278199615772,0.006698594547218831,0.003744586630197649,0.001880039046964822,0.00101597533632287,0.000538521086466292,0.0002292226078983561,0.000129680661371373,9.041591320072333e-05,5.942653394740752e-05,5.931725835631877e-05,2.966742813065535e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.005320184260040226,0.01115004778591908,0.01979261771227338,0.02749368686868687,0.03261134095887077,0.04113849765258216,0.0494332225347311,0.06088331638992432,0.06785473201026057,0.07551293609813403,0.08515730034955633,0.09053441406786647,0.09501109558642229,0.09718962852727377,0.09178921222727145,0.0833173406442769,0.07776443910897693,0.06873014622876795,0.05720227440244288,0.04876289803616998,0.03948101124846865,0.03208616780045351,0.02272599584246306,0.0155518816375711,0.01084206722081677,0.006070749765964086,0.003457398833503698,0.001702852277564921,0.0009222158621128284,0.0005008922142566446,0.000212630236019562,0.0001186028583288857,8.381527114240215e-05,5.451968160505943e-05,5.446029844243546e-05,2.722199537226079e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.005143097054089987,0.01264044943820225,0.01805666055553634,0.02744383302372858,0.03278853575863342,0.04397009639976392,0.04997328472200396,0.05876484991384782,0.07054492788606602,0.07672042853379388,0.08661277951501563,0.09319745666753768,0.0984096899339592,0.0996778864623659,0.09697650472713658,0.08971594060016021,0.08494485458947305,0.07588817705299941,0.06571158960281376,0.04967312631333178,0.03964359892838867,0.03244891735285148,0.02447852760736196,0.01713280237080941,0.01044426174598825,0.006440978051833084,0.004573504996397582,0.002902142368017739,0.001375615406892557,0.0006319337171745541,0.0003373591525538088,6.565341561894757e-05,9.778994719342852e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.004875460183741832,0.01163617557696037,0.01657932348737494,0.02543033452419617,0.03065194202171049,0.04046713742531233,0.04623168178646197,0.0547112462006079,0.06549569991876068,0.07018530419880034,0.07939856130672292,0.08550651287925201,0.0903996300225795,0.091637687459248,0.08829043804329299,0.0816372301654051,0.07748936634311267,0.06922566077832382,0.06009257080097278,0.04465902232951117,0.03643758300132802,0.02957116255801673,0.02257361885095188,0.01558419678207396,0.009604883649295735,0.005865510243793956,0.004138321995464852,0.002676369760028869,0.001243943957051198,0.0005723006486074017,0.0003135877575339459,6.090319437254484e-05,8.911067545891998e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.005161687290626923,0.009917911499436301,0.01703185294324002,0.02334247345848274,0.03026458125193785,0.03840152565880721,0.04735192212506187,0.0608833967864748,0.07055739633976404,0.08072169249106079,0.09612993177098783,0.1025115770702103,0.1099074557586307,0.1134288820231148,0.1092789840229414,0.09879055531263665,0.09495831789551687,0.08483594298446419,0.07213066072754269,0.0577036352611671,0.04893991928607969,0.03595786052180979,0.03012541530725254,0.02057595282961522,0.01225142262742459,0.008215637404227823,0.004468900103362316,0.002347346279303722,0.001411189162067235,0.0008159268929503916,0.0002539636469179697,0.0002462274438073798,6.787253537855906e-05,3.299567756623883e-05,0.0,0.0,6.040106305870983e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.00450481,0.00902804,0.01647713,0.02235261,0.02820432,0.03410641,0.04292256,0.05165309,0.06346129,0.07500838,0.08113263,0.09622124,0.09539995,0.10215346,0.09445933,0.09097998,0.08110983,0.07724343,0.0658399,0.05476351,0.04438515,0.03408642,0.02735694,0.0193172,0.01182484,0.00710041,0.00520865,0.00267023,0.00136915,0.00100298,0.0003922,0.00029019,0.0,6.8e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539066,0.00998942,0.0172997,0.02216382,0.03165129,0.03735731,0.04432672,0.05674555,0.06329255,0.07511998,0.0790609,0.08805503,0.09294102,0.09618082,0.09011143,0.08414221,0.07778304,0.07019113,0.05966719,0.04896397,0.03713957,0.03173422,0.02341888,0.015792,0.00964531,0.00649423,0.00374958,0.00220913,0.00102222,0.00045845,0.00022287,0.00015703,0.00012206,2.977e-05,0.0,2.746e-05,5.486e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.003775459513164430,0.009467613428009470,0.01472629405193130,0.02280198643071970,0.02516720678480310,0.03354856342454990,0.03959733788167620,0.0505843071786310,0.05823796087880040,0.06950023353573100,0.07826190264041110,0.0846116351750437,0.0940119589162590,0.0949901686560137,0.0946138580652374,0.0867720786733513,0.08106812542296410,0.07267196214297790,0.06184650928586240,0.0512941593129298,0.04305515449032630,0.03317562239495330,0.02587815816596560,0.01857787106106590,0.01089766184937140,0.008024432600754540,0.003920031360250880,0.002765873377708880,0.001717954127610840,0.000786829681636606,0.0004984734251355220,0.0001297311322284570,0.000181152856780551,0.000070504459407058,0.0,0.0,5.944066335780308e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2024:
            naiset_in=np.array([0.003642987249544630,0.009634296763009630,0.01401536951149330,0.02094845072392810,0.02723574432875960,0.03317276485258450,0.03829303367780340,0.0493489148580968,0.05478236058713500,0.06364627121282890,0.07701446434405540,0.0853284399460963,0.0918948302005550,0.0959871500180011,0.0953126310199290,0.0899124015205774,0.08518497631400860,0.07492535631795390,0.06569710612837300,0.0527403122509813,0.04475887958417560,0.03514700912470430,0.02679740382740470,0.01928695010919820,0.01139701562683590,0.007844781124618240,0.004945270331393420,0.002674690738883320,0.002079628680792070,0.000817092361699552,0.0004050096579226120,0.0002918950475140270,0.000144922285424441,0.000176261148517644,0.000170369360774158,0.000033298924444740,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2025:
            naiset_in=np.array([0.003642987249544630,0.009634296763009630,0.01401536951149330,0.02094845072392810,0.02723574432875960,0.03317276485258450,0.03829303367780340,0.0493489148580968,0.05478236058713500,0.06364627121282890,0.07701446434405540,0.0853284399460963,0.0918948302005550,0.0959871500180011,0.0953126310199290,0.0899124015205774,0.08518497631400860,0.07492535631795390,0.06569710612837300,0.0527403122509813,0.04475887958417560,0.03514700912470430,0.02679740382740470,0.01928695010919820,0.01139701562683590,0.007844781124618240,0.004945270331393420,0.002674690738883320,0.002079628680792070,0.000817092361699552,0.0004050096579226120,0.0002918950475140270,0.000144922285424441,0.000176261148517644,0.000170369360774158,0.000033298924444740,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2026:
            naiset_in=np.array([0.003642987249544630,0.009634296763009630,0.01401536951149330,0.02094845072392810,0.02723574432875960,0.03317276485258450,0.03829303367780340,0.0493489148580968,0.05478236058713500,0.06364627121282890,0.07701446434405540,0.0853284399460963,0.0918948302005550,0.0959871500180011,0.0953126310199290,0.0899124015205774,0.08518497631400860,0.07492535631795390,0.06569710612837300,0.0527403122509813,0.04475887958417560,0.03514700912470430,0.02679740382740470,0.01928695010919820,0.01139701562683590,0.007844781124618240,0.004945270331393420,0.002674690738883320,0.002079628680792070,0.000817092361699552,0.0004050096579226120,0.0002918950475140270,0.000144922285424441,0.000176261148517644,0.000170369360774158,0.000033298924444740,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        else:
            print("Error: Unknown year in ['syntyneet in']")
            
        bdata = naiset_in[:55-18]

        # lasten välillä vuosi, mistä syystä nostetaan syntyvyyttä vastaavasti
        bonus = 1.0 + 1.0/(40.0-18.0)

        for g in range(self.n_groups):
            birth[18:55,g] = bdata*dfactor[g]*bonus*1.1

        # syntyvyys on lasten määrä suhteessa naisten määrään
        # ei siis tarvetta kertoa kahdella, vaikka isät pääsevät isyysvapaalle

        # pitääkö skaalata vai ei??
        birth = self.scale_rates(birth)

        return birth     

    def get_birth_rate_v10(self,debug=False,symmetric=False):
        '''
        Syntyvyysdata
        Päivitetty 13.10.2021
        '''
        birth=np.zeros((self.max_age+1,self.n_groups))
        dfactor=np.array([0.75,1.05,0.,0.75,1.05,0.])
        dfactor[2]=self.get_w(0,dfactor[0],dfactor[1])
        dfactor[5]=self.get_w(1,dfactor[3],dfactor[4])

        #dfactor *= 1.1 # scaling??
        
        ### ['syntyneet in']
        if self.year==2018:
            naiset_in=np.array([0.005739483446489816,0.01204777804550618,0.02120820376646518,0.02927337500840223,0.03535270256900702,0.04428300694883133,0.05292453691030204,0.06543048769384845,0.07394656308851225,0.08182598655969685,0.09255092200239633,0.09812680544387861,0.103030303030303,0.1064510062065074,0.1006063605989358,0.09108074087394354,0.08510948905109489,0.07493702770780857,0.06358821291663008,0.05299650307488243,0.04334668174731758,0.03475377624953948,0.02497915830425788,0.01688726608854405,0.01189278199615772,0.006698594547218831,0.003744586630197649,0.001880039046964822,0.00101597533632287,0.000538521086466292,0.0002292226078983561,0.000129680661371373,9.041591320072333e-05,5.942653394740752e-05,5.931725835631877e-05,2.966742813065535e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.005320184260040226,0.01115004778591908,0.01979261771227338,0.02749368686868687,0.03261134095887077,0.04113849765258216,0.0494332225347311,0.06088331638992432,0.06785473201026057,0.07551293609813403,0.08515730034955633,0.09053441406786647,0.09501109558642229,0.09718962852727377,0.09178921222727145,0.0833173406442769,0.07776443910897693,0.06873014622876795,0.05720227440244288,0.04876289803616998,0.03948101124846865,0.03208616780045351,0.02272599584246306,0.0155518816375711,0.01084206722081677,0.006070749765964086,0.003457398833503698,0.001702852277564921,0.0009222158621128284,0.0005008922142566446,0.000212630236019562,0.0001186028583288857,8.381527114240215e-05,5.451968160505943e-05,5.446029844243546e-05,2.722199537226079e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2019:
            naiset_in=np.array([0.005143097054089987,0.01264044943820225,0.01805666055553634,0.02744383302372858,0.03278853575863342,0.04397009639976392,0.04997328472200396,0.05876484991384782,0.07054492788606602,0.07672042853379388,0.08661277951501563,0.09319745666753768,0.0984096899339592,0.0996778864623659,0.09697650472713658,0.08971594060016021,0.08494485458947305,0.07588817705299941,0.06571158960281376,0.04967312631333178,0.03964359892838867,0.03244891735285148,0.02447852760736196,0.01713280237080941,0.01044426174598825,0.006440978051833084,0.004573504996397582,0.002902142368017739,0.001375615406892557,0.0006319337171745541,0.0003373591525538088,6.565341561894757e-05,9.778994719342852e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.004875460183741832,0.01163617557696037,0.01657932348737494,0.02543033452419617,0.03065194202171049,0.04046713742531233,0.04623168178646197,0.0547112462006079,0.06549569991876068,0.07018530419880034,0.07939856130672292,0.08550651287925201,0.0903996300225795,0.091637687459248,0.08829043804329299,0.0816372301654051,0.07748936634311267,0.06922566077832382,0.06009257080097278,0.04465902232951117,0.03643758300132802,0.02957116255801673,0.02257361885095188,0.01558419678207396,0.009604883649295735,0.005865510243793956,0.004138321995464852,0.002676369760028869,0.001243943957051198,0.0005723006486074017,0.0003135877575339459,6.090319437254484e-05,8.911067545891998e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2020:
            naiset_in=np.array([0.005727417359024218,0.01059128848986463,0.01890046459242574,0.02426763737216155,0.03430309811874956,0.04005336001334001,0.04828193258133925,0.0616650502143103,0.06816135422294255,0.08110212638514526,0.08670537010159651,0.09630583689479538,0.1017242873234555,0.1049780682386882,0.09842716448625606,0.0926950575069941,0.08550675779214809,0.07716610533218086,0.06553524804177546,0.05361265498076101,0.04137449445721435,0.03453863465866466,0.02571906863491097,0.01716422485134555,0.01061106141460255,0.007058537179019107,0.00411962160512664,0.002444757874941232,0.001108792068875555,0.000507964152244113,0.0002458210422812193,0.0001691474966170501,0.0001316872427983539,3.270538984824699e-05,0.0,3.007066606525334e-05,6.002400960384154e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2021:
            naiset_in=np.array([0.005161687290626923,0.009917911499436301,0.01703185294324002,0.02334247345848274,0.03026458125193785,0.03840152565880721,0.04735192212506187,0.0608833967864748,0.07055739633976404,0.08072169249106079,0.09612993177098783,0.1025115770702103,0.1099074557586307,0.1134288820231148,0.1092789840229414,0.09879055531263665,0.09495831789551687,0.08483594298446419,0.07213066072754269,0.0577036352611671,0.04893991928607969,0.03595786052180979,0.03012541530725254,0.02057595282961522,0.01225142262742459,0.008215637404227823,0.004468900103362316,0.002347346279303722,0.001411189162067235,0.0008159268929503916,0.0002539636469179697,0.0002462274438073798,6.787253537855906e-05,3.299567756623883e-05,0.0,0.0,6.040106305870983e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2022:
            naiset_in=np.array([0.00450481,0.00902804,0.01647713,0.02235261,0.02820432,0.03410641,0.04292256,0.05165309,0.06346129,0.07500838,0.08113263,0.09622124,0.09539995,0.10215346,0.09445933,0.09097998,0.08110983,0.07724343,0.0658399,0.05476351,0.04438515,0.03408642,0.02735694,0.0193172,0.01182484,0.00710041,0.00520865,0.00267023,0.00136915,0.00100298,0.0003922,0.00029019,0.0,6.8e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539066,0.00998942,0.0172997,0.02216382,0.03165129,0.03735731,0.04432672,0.05674555,0.06329255,0.07511998,0.0790609,0.08805503,0.09294102,0.09618082,0.09011143,0.08414221,0.07778304,0.07019113,0.05966719,0.04896397,0.03713957,0.03173422,0.02341888,0.015792,0.00964531,0.00649423,0.00374958,0.00220913,0.00102222,0.00045845,0.00022287,0.00015703,0.00012206,2.977e-05,0.0,2.746e-05,5.486e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2023:
            naiset_in=np.array([0.003775459513164430,0.009467613428009470,0.01472629405193130,0.02280198643071970,0.02516720678480310,0.03354856342454990,0.03959733788167620,0.0505843071786310,0.05823796087880040,0.06950023353573100,0.07826190264041110,0.0846116351750437,0.0940119589162590,0.0949901686560137,0.0946138580652374,0.0867720786733513,0.08106812542296410,0.07267196214297790,0.06184650928586240,0.0512941593129298,0.04305515449032630,0.03317562239495330,0.02587815816596560,0.01857787106106590,0.01089766184937140,0.008024432600754540,0.003920031360250880,0.002765873377708880,0.001717954127610840,0.000786829681636606,0.0004984734251355220,0.0001297311322284570,0.000181152856780551,0.000070504459407058,0.0,0.0,5.944066335780308e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2024:
            naiset_in=np.array([0.003642987249544630,0.009634296763009630,0.01401536951149330,0.02094845072392810,0.02723574432875960,0.03317276485258450,0.03829303367780340,0.0493489148580968,0.05478236058713500,0.06364627121282890,0.07701446434405540,0.0853284399460963,0.0918948302005550,0.0959871500180011,0.0953126310199290,0.0899124015205774,0.08518497631400860,0.07492535631795390,0.06569710612837300,0.0527403122509813,0.04475887958417560,0.03514700912470430,0.02679740382740470,0.01928695010919820,0.01139701562683590,0.007844781124618240,0.004945270331393420,0.002674690738883320,0.002079628680792070,0.000817092361699552,0.0004050096579226120,0.0002918950475140270,0.000144922285424441,0.000176261148517644,0.000170369360774158,0.000033298924444740,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2025:
            naiset_in=np.array([0.003642987249544630,0.009634296763009630,0.01401536951149330,0.02094845072392810,0.02723574432875960,0.03317276485258450,0.03829303367780340,0.0493489148580968,0.05478236058713500,0.06364627121282890,0.07701446434405540,0.0853284399460963,0.0918948302005550,0.0959871500180011,0.0953126310199290,0.0899124015205774,0.08518497631400860,0.07492535631795390,0.06569710612837300,0.0527403122509813,0.04475887958417560,0.03514700912470430,0.02679740382740470,0.01928695010919820,0.01139701562683590,0.007844781124618240,0.004945270331393420,0.002674690738883320,0.002079628680792070,0.000817092361699552,0.0004050096579226120,0.0002918950475140270,0.000144922285424441,0.000176261148517644,0.000170369360774158,0.000033298924444740,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        elif self.year==2026:
            naiset_in=np.array([0.003642987249544630,0.009634296763009630,0.01401536951149330,0.02094845072392810,0.02723574432875960,0.03317276485258450,0.03829303367780340,0.0493489148580968,0.05478236058713500,0.06364627121282890,0.07701446434405540,0.0853284399460963,0.0918948302005550,0.0959871500180011,0.0953126310199290,0.0899124015205774,0.08518497631400860,0.07492535631795390,0.06569710612837300,0.0527403122509813,0.04475887958417560,0.03514700912470430,0.02679740382740470,0.01928695010919820,0.01139701562683590,0.007844781124618240,0.004945270331393420,0.002674690738883320,0.002079628680792070,0.000817092361699552,0.0004050096579226120,0.0002918950475140270,0.000144922285424441,0.000176261148517644,0.000170369360774158,0.000033298924444740,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
            miehet_in=np.array([0.00539065619592706,0.009989415189203493,0.01729970039625012,0.02216382230947029,0.03165128734593792,0.03735730504836853,0.04432671874532339,0.05674555190879254,0.0632925503748502,0.07511997558878193,0.07906090362880813,0.08805502770120173,0.09294102124290804,0.09618081777969575,0.09011142811002854,0.08414221218961625,0.07778304385402436,0.07019113460756406,0.05966719492868463,0.04896397334443982,0.03713957375679064,0.03173421560518334,0.02341887921955546,0.01579199684160063,0.00964531052852937,0.006494233568469376,0.003749583379624486,0.002209131075110457,0.001022218213523346,0.0004584452157967123,0.0002228660574994428,0.0001570253124803718,0.0001220554131575735,2.976899261728983e-05,0.0,2.746271935847087e-05,5.486065393899495e-05,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0,0.0])
        else:
            print("Error: Unknown year in ['syntyneet in']")
            
        bdata = naiset_in[:55-18]

        # lasten välillä vuosi, mistä syystä nostetaan syntyvyyttä vastaavasti
        bonus = 1.0 + 1.0/(40.0-18.0)

        for g in range(self.n_groups):
            birth[18:55,g] = bdata*dfactor[g]*bonus*1.1

        # syntyvyys on lasten määrä suhteessa naisten määrään
        # ei siis tarvetta kertoa kahdella, vaikka isät pääsevät isyysvapaalle

        # pitääkö skaalata vai ei??
        birth = self.scale_rates(birth)

        return birth                                                                 
        
    def get_pinkslip_rate(self):
        pinkslip_intensity=np.zeros(6)
        if False:
            pinkslip_intensity[0:3]=0.05 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[3:6]=0.05 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
        else:
            pinkslip_intensity[0]=0.07 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[1]=0.04 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[2]=0.02 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[3]=0.05 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
            pinkslip_intensity[4]=0.04 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
            pinkslip_intensity[5]=0.02 # todennäköisyys tulla irtisanotuksi vuodessa, naiset

        return pinkslip_intensity

    def get_pinkslip_rate_v7(self):
        pinkslip_intensity=np.zeros((6,100))
        if False:
            pinkslip_intensity[0:3,:]=0.05 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[3:6,:]=0.05 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
        else:
            pinkslip_intensity[0,:]=0.07 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[1,:]=0.055 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[2,:]=self.get_w(0,pinkslip_intensity[0,:],pinkslip_intensity[1,:],intensity=0.05) # kokonaisintensiteetti 0,05
            pinkslip_intensity[3,:]=0.05 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
            pinkslip_intensity[4,:]=0.045 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
            pinkslip_intensity[5,:]=self.get_w(1,pinkslip_intensity[3,:],pinkslip_intensity[4,:],intensity=0.04) # kokonaisintensiteetti 0,04

        return pinkslip_intensity

    def get_pinkslip_rate_v8(self):
        pinkslip_intensity=np.zeros((6,100))
        if False:
            pinkslip_intensity[0:3,:]=0.05 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[3:6,:]=0.05 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
        else:
            pinkslip_intensity[0,:]=0.070 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[1,:]=0.053 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[2,:]=self.get_w(0,pinkslip_intensity[0,:],pinkslip_intensity[1,:],intensity=0.05) # kokonaisintensiteetti 0,05
            pinkslip_intensity[3,:]=0.050 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
            pinkslip_intensity[4,:]=0.043 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
            pinkslip_intensity[5,:]=self.get_w(1,pinkslip_intensity[3,:],pinkslip_intensity[4,:],intensity=0.04) # kokonaisintensiteetti 0,04

        return pinkslip_intensity

    def get_pinkslip_rate_v10(self):
        pinkslip_intensity=np.zeros((6,100))
        if False:
            pinkslip_intensity[0:3,:]=0.05 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[3:6,:]=0.05 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
        else:
            pinkslip_intensity[0,:]=0.070 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[1,:]=0.053 # todennäköisyys tulla irtisanotuksi vuodessa, miehet
            pinkslip_intensity[2,:]=self.get_w(0,pinkslip_intensity[0,:],pinkslip_intensity[1,:],intensity=0.05) # kokonaisintensiteetti 0,05
            pinkslip_intensity[3,:]=0.050 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
            pinkslip_intensity[4,:]=0.043 # todennäköisyys tulla irtisanotuksi vuodessa, naiset
            pinkslip_intensity[5,:]=self.get_w(1,pinkslip_intensity[3,:],pinkslip_intensity[4,:],intensity=0.04) # kokonaisintensiteetti 0,04

        return pinkslip_intensity
    
    def map_5year(self,mar):
        arr=np.zeros(self.max_age+2)
        mins=np.array([15,20,25,30,35,40,45,50,55,60,65,70])
        maxs=np.array([20,25,30,35,40,45,50,55,60,65,70,75])
        for i,mini in enumerate(mins):
            for age in range(mini,maxs[i]):
                if age>=self.min_age and age<self.max_age:
                    arr[age]=mar[i]
                    
        return arr
        
    def get_initial_marriage_ratio(self):
        return 0.0367

    def get_marriage_rate(self):
        '''
        Sisältää avoliitot ja avioliitot
        '''
        marriage_rate=np.zeros(105)
        marriage_rate[18:]=np.array([0.061535,0.081337,0.080677,0.073297,0.088120,0.094667,0.099613,0.094117,0.115097,0.107895,0.121581,0.121740,0.116324,0.127059,0.109727,0.119645,0.113208,0.119336,0.120546,0.110704,0.125037,0.105828,0.119247,0.107601,0.109261,0.106336,0.104943,0.104873,0.103252,0.101176,0.100522,0.097700,0.096217,0.094577,0.094306,0.094023,0.093713,0.096377,0.093411,0.091398,0.090822,0.093518,0.093685,0.091468,0.090411,0.092768,0.095283,0.091210,0.095431,0.096708,0.092017,0.092312,0.089747,0.086757,0.085602,0.084154,0.082202,0.078667,0.074467,0.071651,0.066600,0.062303,0.057827,0.054465,0.047675,0.044414,0.040251,0.035600,0.031737,0.028336,0.025519,0.022941,0.019428,0.016490,0.014366,0.012364,0.010709,0.007886,0.007179,0.007030,0.005709,0.004829,0.003198,0.002946,0.062049,0.003788,0.003333])

        # matriisi miesten mukaan (akseli 0)
        marriage_probs = np.array([[0.221,0.493,0.286],[0.12,0.47,0.41],[0.026,0.246,0.728]])

        men = self.group_weights[0,:]
        women = self.group_weights[0,:]

        rate_sum = men @ marriage_probs.T @ women
        
        marriage_rate = self.scale_rates(marriage_rate)

        marriage_matrix = np.zeros((marriage_rate.shape[0],marriage_probs.shape[0],marriage_probs.shape[1]))
        for k in range(marriage_rate.shape[0]):
            marriage_matrix[k,:,:] = marriage_rate[k] / rate_sum * marriage_probs

        return marriage_rate,marriage_matrix

    def get_divorce_rate(self):

        divorce_rate=np.zeros(105)
        divorce_rate[18:]=0.9*np.array([0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.050000,0.05,0.050000,0.050000])

        divorce_rate = self.scale_rates(divorce_rate)

        return divorce_rate

    def setup_salaries_v3(self,min_retirementage):
        # TK:n aineisto vuodelta 2018
        # iät 18-70
        
        if self.year==2018:
            palkat_ika_miehet=12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2019:
            ind=1.019
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
#             palkat_ika_miehet=12.5*np.array([2039,2334,2461,2498,2612,2683,2725,2833,2915,3014,3115,3196,3325,3389,3477,3540,3601,3690,3724,3863,3917,4018,4073,4150,4189,4212,4301,4273,4261,4323,4273,4225,4239,4188,4213,4174,4159,4165,4131,4136,4167,4135,4117,4134,4126,4101,4257,4368,4417,3916,4369,4045,3165,3923])#,2521,2982,3238,2898,3489,3063,6388,6388])
#             palkat_ika_naiset=12.5*np.array([1926,2107,2188,2235,2283,2347,2417,2541,2639,2722,2796,2845,2907,2980,3032,3073,3109,3150,3225,3281,3333,3402,3467,3462,3492,3546,3593,3577,3603,3542,3525,3511,3515,3470,3484,3482,3477,3480,3408,3417,3428,3381,3361,3351,3292,3314,3461,3553,3583,3441,3039,2797,3320,2168])#,2360,3316,4525,4525,4525,2449,2449,1393])
#             palkat_ika_miehet[0:2]=max(palkat_ika_miehet[0:2])
#             palkat_ika_naiset[0:2]=max(palkat_ika_naiset[0:2])
        elif self.year==2020:
            ind=1.019*1.013
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2021:
            ind=1.019*1.013*1.019
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2022:
            ind=1.019*1.013*1.019*1.019 # arvio
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2023:
            ind=1.019*1.013*1.019*1.019*1.019 # arvio
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        else:
            print('Unknown year ',self.year)
            error(1001)
            
        def map_age18(x):
            return int(x-18)
            
        def ifunc(palkat,x1,x2):
            x = np.linspace(18, 72, num=54, endpoint=True)
            f = interp1d(x, palkat, fill_value='extrapolate')
            n_time = int(np.round((x2-x1)*self.inv_timestep))+2
            palkat_x = np.linspace(x1, x2, num=n_time, endpoint=True)
        
            return f(palkat_x)        

        def gfunc(palkat,x1,x2):
            x = np.linspace(18, 73, num=55, endpoint=True)
            n_time = int(np.round((x2-x1)*self.inv_timestep))+2
            palkat_x = np.linspace(x1, x2, num=n_time, endpoint=True)
            g=np.zeros((n_time,3))
            for k in range(3):
                f = interp1d(x, palkat[:,k],fill_value='extrapolate')
                g[:,k]=f(palkat_x)
        
            return g
        
        # filtteri
        m_age=int(min_retirementage-1)
        palkat_miehet_ve=palkat_ika_miehet[map_age18(m_age)]
        palkat_ika_miehet[map_age18(m_age):]=np.minimum(palkat_ika_miehet[map_age18(m_age):],palkat_miehet_ve)
        palkat_naiset_ve=palkat_ika_naiset[map_age18(m_age)]
        palkat_ika_naiset[map_age18(m_age):]=np.minimum(palkat_ika_naiset[map_age18(m_age):],palkat_naiset_ve)

        palkat_ika_miehet=ifunc(palkat_ika_miehet,self.min_age,self.max_age)
        palkat_ika_naiset=ifunc(palkat_ika_naiset,self.min_age,self.max_age)
        
        g_r=np.array([[0.81436,1.00992,1.2469],[0.81436,1.00992,1.2469],[0.81436,1.00992,1.2469],[0.8144725,1.011105,1.2677425],[0.814585,1.01229,1.288585],[0.8146975,1.013475,1.3094275],[0.81481,1.01466,1.33027],[0.81481,1.01466,1.33027],[0.798635,1.0116225,1.34756],[0.78246,1.008585,1.36485],[0.766285,1.0055475,1.38214],[0.75011,1.00251,1.39943],[0.75011,1.00251,1.39943],[0.74420478,0.99822499,1.40395702],[0.73829957,0.99393997,1.40848403],[0.73239435,0.98965496,1.41301105],[0.72648913,0.98536995,1.41753806],[0.72058391,0.98108493,1.42206508],[0.7146787,0.97679992,1.4265921],[0.70877348,0.9725149,1.43111911],[0.70286826,0.96822989,1.43564613],[0.69696304,0.96394488,1.44017314],[0.69105783,0.95965986,1.44470016],[0.68515261,0.95537485,1.44922718],[0.67924739,0.95108984,1.45375419],[0.67334218,0.94680482,1.45828121],[0.66743696,0.94251981,1.46280822],[0.66153174,0.93823479,1.46733524],[0.65562652,0.93394978,1.47186226],[0.64972131,0.92966477,1.47638927],[0.64381609,0.92537975,1.48091629],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433]])
        g_r=gfunc(g_r,self.min_age,self.max_age)
        
        return palkat_ika_miehet,palkat_ika_naiset,g_r
        
    def get_inflation(self):
        '''
        arvot MAALISKUUN lukuja kuluttajahintaindeksin vuosimuutoksessa, https://stat.fi/tilasto/khi
        nämä matchataan ansiotasoindeksin muutokseen
        '''
        return np.array([1.0, # 2018
                        1.010248, # 1.011206, # 1.011399, # 2019
                        1.002917, # 1.006027, # 1.00381, # 2020
                        1.021936, # 1.013334622, # 1.020716, # 2021
                        1.071092, # 1.057976542, # 1.071655, # 2022
                        1.062916, # 1.079315007, # 1.043444, # 2023
                        1.015725, # 1.021795407, # 1.014, # 2024
                        1.005592, # 1.005312194, # 1.006896, # 2025
                        1.015, # 2026
                        1.020]) # 2027

    def get_wageinflation(self):
        '''
        arvot ansiotasoindeksi (y+1)Q1 vs yQ1 tasossa
        '''
        return np.array([1.0, # 2018
                        1.021210603, # 1.021243, # 2019
                        1.019460017, # 1.01987, # 2020
                        1.024215574, # 1.021613, # 2021
                        1.024079442, # 1.022646, # 2022
                        1.042374951, # 1.030886, # 2023
                        1.030721699, # 1.039005, # 2024
                        1.032, # 2025
                        1.038, # 2026
                        1.030]) # 2027

    #  # Depricated, see wages_v1 setup_salaries
    def setup_salaries_v4(self,min_retirementage):
        # TK:n aineisto vuodelta 2018
        # iät 18-70
        # päivitetty 2025
        
        wi = self.get_wageinflation()
        ind2019 = wi[1] # 1.021243 # 1.019
        ind2020 = wi[2] # 1.01987 # 1.013
        ind2021 = wi[3] # 1.021613 # 1.019
        ind2022 = wi[4] # 1.022646 # 1.019
        ind2023 = wi[5] # 1.030886 # 1.02
        ind2024 = wi[6] # 1.03957
        ind2025 = wi[7] # 1.032
        ind2026 = wi[8] # 1.038
        if self.year==2018:
            palkat_ika_miehet=12.5*np.array([2039.15,2256.56,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=12.5*np.array([2058.55,2166.68,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2019:
            ind=ind2019
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2020:
            ind=ind2019*ind2020
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2021:
            ind=ind2019*ind2020*ind2021
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2022:
            ind=ind2019*ind2020*ind2021*ind2022 
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2023:
            ind=ind2019*ind2020*ind2021*ind2022*ind2023 
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2024:
            ind=ind2019*ind2020*ind2021*ind2022*ind2023*ind2024 
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2025:
            ind=ind2019*ind2020*ind2021*ind2022*ind2023*ind2024*ind2025 
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        elif self.year==2026:
            ind=ind2019*ind2020*ind2021*ind2022*ind2023*ind2024*ind2025*ind2026 
            palkat_ika_miehet=ind*12.5*np.array([2339.01,2339.01,2339.01,2489.09,2571.40,2632.58,2718.03,2774.21,2884.89,2987.55,3072.40,3198.48,3283.81,3336.51,3437.30,3483.45,3576.67,3623.00,3731.27,3809.58,3853.66,3995.90,4006.16,4028.60,4104.72,4181.51,4134.13,4157.54,4217.15,4165.21,4141.23,4172.14,4121.26,4127.43,4134.00,4093.10,4065.53,4063.17,4085.31,4071.25,4026.50,4031.17,4047.32,4026.96,4028.39,4163.14,4266.42,4488.40,4201.40,4252.15,4443.96,3316.92,3536.03,3536.03])
            palkat_ika_naiset=ind*12.5*np.array([2223.96,2223.96,2223.96,2257.10,2284.57,2365.57,2443.64,2548.35,2648.06,2712.89,2768.83,2831.99,2896.76,2946.37,2963.84,2993.79,3040.83,3090.43,3142.91,3159.91,3226.95,3272.29,3270.97,3297.32,3333.42,3362.99,3381.84,3342.78,3345.25,3360.21,3324.67,3322.28,3326.72,3326.06,3314.82,3303.73,3302.65,3246.03,3244.65,3248.04,3223.94,3211.96,3167.00,3156.29,3175.23,3228.67,3388.39,3457.17,3400.23,3293.52,2967.68,2702.05,2528.84,2528.84])
        else:
            print('Unknown year ',self.year)
            error(1001)
            
        def map_age18(x):
            return int(x-18)
            
        def ifunc(palkat,x1,x2):
            x = np.linspace(18, 72, num=54, endpoint=True)
            f = interp1d(x, palkat, fill_value='extrapolate')
            n_time = int(np.round((x2-x1)*self.inv_timestep))+2
            palkat_x = np.linspace(x1, x2, num=n_time, endpoint=True)
        
            return f(palkat_x)        

        def gfunc(palkat,x1,x2):
            x = np.linspace(18, 73, num=55, endpoint=True)
            n_time = int(np.round((x2-x1)*self.inv_timestep))+2
            palkat_x = np.linspace(x1, x2, num=n_time, endpoint=True)
            g=np.zeros((n_time,3))
            for k in range(3):
                f = interp1d(x, palkat[:,k],fill_value='extrapolate')
                g[:,k]=f(palkat_x)
        
            return g
        
        # filtteri
        m_age=int(min_retirementage-1)
        palkat_miehet_ve=palkat_ika_miehet[map_age18(m_age)]
        palkat_ika_miehet[map_age18(m_age):]=np.minimum(palkat_ika_miehet[map_age18(m_age):],palkat_miehet_ve)
        palkat_naiset_ve=palkat_ika_naiset[map_age18(m_age)]
        palkat_ika_naiset[map_age18(m_age):]=np.minimum(palkat_ika_naiset[map_age18(m_age):],palkat_naiset_ve)

        palkat_ika_miehet=ifunc(palkat_ika_miehet,self.min_age,self.max_age)
        palkat_ika_naiset=ifunc(palkat_ika_naiset,self.min_age,self.max_age)
        
        g_r=np.array([[0.81436,1.00992,1.2469],[0.81436,1.00992,1.2469],[0.81436,1.00992,1.2469],[0.8144725,1.011105,1.2677425],[0.814585,1.01229,1.288585],[0.8146975,1.013475,1.3094275],[0.81481,1.01466,1.33027],[0.81481,1.01466,1.33027],[0.798635,1.0116225,1.34756],[0.78246,1.008585,1.36485],[0.766285,1.0055475,1.38214],[0.75011,1.00251,1.39943],[0.75011,1.00251,1.39943],[0.74420478,0.99822499,1.40395702],[0.73829957,0.99393997,1.40848403],[0.73239435,0.98965496,1.41301105],[0.72648913,0.98536995,1.41753806],[0.72058391,0.98108493,1.42206508],[0.7146787,0.97679992,1.4265921],[0.70877348,0.9725149,1.43111911],[0.70286826,0.96822989,1.43564613],[0.69696304,0.96394488,1.44017314],[0.69105783,0.95965986,1.44470016],[0.68515261,0.95537485,1.44922718],[0.67924739,0.95108984,1.45375419],[0.67334218,0.94680482,1.45828121],[0.66743696,0.94251981,1.46280822],[0.66153174,0.93823479,1.46733524],[0.65562652,0.93394978,1.47186226],[0.64972131,0.92966477,1.47638927],[0.64381609,0.92537975,1.48091629],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433],[0.63791087,0.92109474,1.4854433]])
        g_r=gfunc(g_r,self.min_age,self.max_age)
        
        return palkat_ika_miehet,palkat_ika_naiset,g_r
        
        
    def get_kassanjasenyys_rate(self):
        rate_age=np.array([18,30,40,50,60,74])
        #rate_obs=np.array([0.429,0.836,0.917,0.946,0.933,0.933])
        #rate_obs=np.array([0.20,0.836,0.917,0.946,0.933,0.933])
        palkansaajista=np.array([0.20,0.836,0.917,0.933,0.933,0.933])
        yrittajista=np.array([0.121,0.121,0.121,0.121,0.121,0.121])
        suhde=0.104 # yrittäjiä/(yrittäjiä+palkansaajia)
        init_rate=(1.0-suhde)*palkansaajista+suhde*yrittajista
        
        already=0.02 # alussa tilassa 0 tai 4 olevat
        rate_obs=init_rate-already
        initial_kassanjasenia=rate_obs[0]
        
        x1=self.min_age
        x2=self.max_age+1
        f = interp1d(rate_age, rate_obs,fill_value='extrapolate')
        n_time = int(np.round((x2-x1)*self.inv_timestep))+1
        jasenyys_x = np.linspace(x1, x2, num=n_time, endpoint=True)
        rate=f(jasenyys_x)
        
        kassanjasenyys_joinrate=rate*0
        for k in range(0,rate.shape[0]-1):
            kassanjasenyys_joinrate[k+1]=(rate[k+1]-rate[k])/(1-rate[k]+already)
            
        kassanjasenyys_rate=rate
            
        return kassanjasenyys_joinrate,kassanjasenyys_rate
        
    def get_reemp_prob(self):
        '''
        reemployment probability in 3 months
        '''
        # reemployment to fulltime work
        reemp_ft=np.zeros(100)
        reemp_ft[0:25]=0.30
        reemp_ft[25:30]=0.45
        reemp_ft[30:50]=0.50
        reemp_ft[50:55]=0.35
        reemp_ft[55:60]=0.25
        reemp_ft[60:65]=0.20
        reemp_ft[65:100]=0.20
        
        # reemployment to parttime work
        reemp_pt=np.zeros(100)
        reemp_pt[0:25]=0.80 # 0.35
        reemp_pt[25:30]=0.70
        reemp_pt[30:50]=0.50
        reemp_pt[50:55]=0.45
        reemp_pt[55:60]=0.45
        reemp_pt[60:65]=0.45
        reemp_pt[65:100]=0.30

        #parttime_fullemp_prob=np.zeros(100)
        #parttime_fullemp_prob[0:25]=0.50
        #parttime_fullemp_prob[25:30]=0.50
        #parttime_fullemp_prob[30:50]=0.50
        #parttime_fullemp_prob[50:55]=0.45
        #parttime_fullemp_prob[55:60]=0.40
        #parttime_fullemp_prob[60:65]=0.40
        #parttime_fullemp_prob[65:100]=0.40

        # keep the ratio of probabilities
        parttime_fullemp_prob=reemp_ft/reemp_pt

        prob_3m_oa=0.2        
        fulltime_pt_prob_3m=0.5
        
        return reemp_ft,reemp_pt,prob_3m_oa,parttime_fullemp_prob,fulltime_pt_prob_3m

    def get_reemp_prob_v5(self):
        '''
        reemployment probability in 3 months
        '''
        # reemployment to fulltime work
        reemp_ft=np.zeros((100,6))
        reemp_ft[0:25,0:3]=0.30 # miehet
        reemp_ft[25:30,0:3]=0.35
        reemp_ft[30:50,0:3]=0.40
        reemp_ft[50:55,0:3]=0.40
        reemp_ft[55:60,0:3]=0.30
        reemp_ft[60:65,0:3]=0.25
        reemp_ft[65:100,0:3]=0.20

        reemp_ft[0:25,3:6]=0.30 # naiset
        reemp_ft[25:30,3:6]=0.35
        reemp_ft[30:50,3:6]=0.40
        reemp_ft[50:55,3:6]=0.35
        reemp_ft[55:60,3:6]=0.30
        reemp_ft[60:65,3:6]=0.25
        reemp_ft[65:100,3:6]=0.20        
        
        # reemployment to parttime work
        reemp_pt=np.zeros((100,6))
        reemp_pt[0:25,0:3]=0.80 # miehet
        reemp_pt[25:30,0:3]=0.80
        reemp_pt[30:50,0:3]=0.70
        reemp_pt[50:55,0:3]=0.50
        reemp_pt[55:60,0:3]=0.50
        reemp_pt[60:65,0:3]=0.50
        reemp_pt[65:100,0:3]=0.30

        reemp_pt[0:25,3:6]=0.80 # naiset
        reemp_pt[25:30,3:6]=0.80
        reemp_pt[30:50,3:6]=0.80
        reemp_pt[50:55,3:6]=0.60
        reemp_pt[55:60,3:6]=0.50
        reemp_pt[60:65,3:6]=0.50
        reemp_pt[65:100,3:6]=0.30

        # keep the ratio of probabilities
        parttime_fullemp_prob=np.minimum(1.0,reemp_ft/reemp_pt)

        prob_3m_oa=0.2        
        fulltime_pt_prob_3m=0.6
        
        return reemp_ft,reemp_pt,prob_3m_oa,parttime_fullemp_prob,fulltime_pt_prob_3m   

    def get_reemp_prob_v7(self):
        '''
        reemployment probability in 3 months
        '''
        # reemployment to fulltime work
        reemp_ft=np.zeros((100,6))
        reemp_ft[0:25,0]=0.45 # miehet, suorittavia töitä löytyy hyvin nuorena, vanhempana huonommin
        reemp_ft[25:30,0]=0.45
        reemp_ft[30:50,0]=0.30
        reemp_ft[50:55,0]=0.25
        reemp_ft[55:60,0]=0.20
        reemp_ft[60:65,0]=0.20
        reemp_ft[65:self.max_retage,0]=0.15
        reemp_ft[self.max_retage:100,0]=0.05

        reemp_ft[0:25,1]=0.35 # miehet
        reemp_ft[25:30,1]=0.35
        reemp_ft[30:50,1]=0.30
        reemp_ft[50:55,1]=0.25
        reemp_ft[55:60,1]=0.20
        reemp_ft[60:65,1]=0.20
        reemp_ft[65:self.max_retage,1]=0.15
        reemp_ft[self.max_retage:100,1]=0.05

        reemp_ft[0:25,2]=0.30 # miehet
        reemp_ft[25:30,2]=0.30
        reemp_ft[30:50,2]=0.35
        reemp_ft[50:55,2]=0.30
        reemp_ft[55:60,2]=0.25
        reemp_ft[60:65,2]=0.25
        reemp_ft[65:self.max_retage,2]=0.20
        reemp_ft[self.max_retage:100,2]=0.05

        reemp_ft[0:25,3]=0.10 # naiset, suorittavia töitä löytyy hyvin nuorena, vanhempana huonommin
        reemp_ft[25:30,3]=0.15
        reemp_ft[30:50,3]=0.30
        reemp_ft[50:55,3]=0.25
        reemp_ft[55:60,3]=0.20
        reemp_ft[60:65,3]=0.175
        reemp_ft[65:self.max_retage,3]=0.10
        reemp_ft[self.max_retage:100,3]=0.025

        reemp_ft[0:25,4]=0.10 # naiset
        reemp_ft[25:30,4]=0.15
        reemp_ft[30:50,4]=0.35
        reemp_ft[50:55,4]=0.30
        reemp_ft[55:60,4]=0.25
        reemp_ft[60:65,4]=0.225
        reemp_ft[65:self.max_retage,4]=0.15
        reemp_ft[self.max_retage:100,4]=0.025

        reemp_ft[0:25,5]=0.10 # naiset
        reemp_ft[25:30,5]=0.15
        reemp_ft[30:50,5]=0.30
        reemp_ft[50:55,5]=0.30
        reemp_ft[55:60,5]=0.275
        reemp_ft[60:65,5]=0.25
        reemp_ft[65:self.max_retage,5]=0.20
        reemp_ft[self.max_retage:100,5]=0.025
        
        # reemployment to parttime work
        reemp_pt=np.zeros((100,6))
        reemp_pt[0:25,0]=0.975 # miehet
        reemp_pt[25:30,0]=0.975
        reemp_pt[30:50,0]=0.80
        reemp_pt[50:55,0]=0.60
        reemp_pt[55:60,0]=0.50
        reemp_pt[60:65,0]=0.40
        reemp_pt[65:self.max_retage,0]=0.25
        reemp_pt[self.max_retage:100,0]=0.05

        reemp_pt[0:25,1]=0.95 # miehet
        reemp_pt[25:30,1]=0.95
        reemp_pt[30:50,1]=0.80
        reemp_pt[50:55,1]=0.60
        reemp_pt[55:60,1]=0.55
        reemp_pt[60:65,1]=0.45
        reemp_pt[65:self.max_retage,1]=0.35
        reemp_pt[self.max_retage:100,1]=0.10

        reemp_pt[0:25,2]=0.90 # miehet
        reemp_pt[25:30,2]=0.90
        reemp_pt[30:50,2]=0.85
        reemp_pt[50:55,2]=0.65
        reemp_pt[55:60,2]=0.55
        reemp_pt[60:65,2]=0.45
        reemp_pt[65:self.max_retage,2]=0.35
        reemp_pt[self.max_retage:100,2]=0.10

        reemp_pt[0:25,3]=0.80 # naiset
        reemp_pt[25:30,3]=0.80
        reemp_pt[30:50,3]=0.85
        reemp_pt[50:55,3]=0.60
        reemp_pt[55:60,3]=0.50
        reemp_pt[60:65,3]=0.35
        reemp_pt[65:self.max_retage,3]=0.30
        reemp_pt[self.max_retage:100,3]=0.10

        reemp_pt[0:25,4]=0.80 # naiset
        reemp_pt[25:30,4]=0.80
        reemp_pt[30:50,4]=0.85
        reemp_pt[50:55,4]=0.65
        reemp_pt[55:60,4]=0.60
        reemp_pt[60:65,4]=0.40
        reemp_pt[65:self.max_retage,4]=0.30
        reemp_pt[self.max_retage:100,4]=0.10

        reemp_pt[0:25,5]=0.80 # naiset
        reemp_pt[25:30,5]=0.80
        reemp_pt[30:50,5]=0.80
        reemp_pt[50:55,5]=0.65
        reemp_pt[55:60,5]=0.60
        reemp_pt[60:65,5]=0.45
        reemp_pt[65:self.max_retage,5]=0.35
        reemp_pt[self.max_retage:100,5]=0.10

        if False:
            for g in range(6):
                print(f'-------------')
                print(f'pt to ft rate ratio {g} 18-29',reemp_pt[18:30,g]/reemp_ft[18:30,g])
                print(f'pt to ft rate ratio {g} 30-39',reemp_pt[30:40,g]/reemp_ft[30:40,g])
                print(f'pt to ft rate ratio {g} 40-49',reemp_pt[40:50,g]/reemp_ft[40:50,g])
                print(f'pt to ft rate ratio {g} 50-59',reemp_pt[50:60,g]/reemp_ft[50:60,g])
                print(f'pt to ft rate ratio {g} 60-69',reemp_pt[60:70,g]/reemp_ft[60:70,g])

        # keep the ratio of probabilities
        parttime_fullemp_prob=np.minimum(1.0,reemp_ft/reemp_pt)

        prob_3m_oa=0.2       
        fulltime_pt_prob_3m=1.0
        
        return reemp_ft,reemp_pt,prob_3m_oa,parttime_fullemp_prob,fulltime_pt_prob_3m      

    def get_reemp_prob_v8(self):
        '''
        reemployment probability in 3 months
        '''
        # reemployment to fulltime work
        reemp_ft=np.zeros((100,6))
        reemp_ft[0:25,0]=0.45 # miehet, suorittavia töitä löytyy hyvin nuorena, vanhempana huonommin
        reemp_ft[25:30,0]=0.45
        reemp_ft[30:50,0]=0.30
        reemp_ft[50:55,0]=0.25
        reemp_ft[55:60,0]=0.20
        reemp_ft[60:65,0]=0.20
        reemp_ft[65:self.max_retage,0]=0.15
        reemp_ft[self.max_retage:100,0]=0.05

        reemp_ft[0:25,1]=0.35 # miehet
        reemp_ft[25:30,1]=0.35
        reemp_ft[30:50,1]=0.30
        reemp_ft[50:55,1]=0.25
        reemp_ft[55:60,1]=0.20
        reemp_ft[60:65,1]=0.20
        reemp_ft[65:self.max_retage,1]=0.15
        reemp_ft[self.max_retage:100,1]=0.05

        reemp_ft[0:25,2]=0.30 # miehet
        reemp_ft[25:30,2]=0.30
        reemp_ft[30:50,2]=0.35
        reemp_ft[50:55,2]=0.30
        reemp_ft[55:60,2]=0.25
        reemp_ft[60:65,2]=0.25
        reemp_ft[65:self.max_retage,2]=0.20
        reemp_ft[self.max_retage:100,2]=0.05

        reemp_ft[0:25,3]=0.15 # naiset, suorittavia töitä löytyy hyvin nuorena, vanhempana huonommin
        reemp_ft[25:30,3]=0.20
        reemp_ft[30:50,3]=0.35
        reemp_ft[50:55,3]=0.25
        reemp_ft[55:60,3]=0.20
        reemp_ft[60:65,3]=0.175
        reemp_ft[65:self.max_retage,3]=0.10
        reemp_ft[self.max_retage:100,3]=0.025

        reemp_ft[0:25,4]=0.15 # naiset
        reemp_ft[25:30,4]=0.20
        reemp_ft[30:50,4]=0.40
        reemp_ft[50:55,4]=0.30
        reemp_ft[55:60,4]=0.25
        reemp_ft[60:65,4]=0.225
        reemp_ft[65:self.max_retage,4]=0.15
        reemp_ft[self.max_retage:100,4]=0.025

        reemp_ft[0:25,5]=0.15 # naiset
        reemp_ft[25:30,5]=0.20
        reemp_ft[30:50,5]=0.30
        reemp_ft[50:55,5]=0.30
        reemp_ft[55:60,5]=0.275
        reemp_ft[60:65,5]=0.25
        reemp_ft[65:self.max_retage,5]=0.20
        reemp_ft[self.max_retage:100,5]=0.025
        
        # reemployment to parttime work
        reemp_pt=np.zeros((100,6))
        reemp_pt[0:25,0]=0.975 # miehet
        reemp_pt[25:30,0]=0.975
        reemp_pt[30:50,0]=0.80
        reemp_pt[50:55,0]=0.65
        reemp_pt[55:60,0]=0.50
        reemp_pt[60:65,0]=0.40
        reemp_pt[65:self.max_retage,0]=0.25
        reemp_pt[self.max_retage:100,0]=0.05

        reemp_pt[0:25,1]=0.95 # miehet
        reemp_pt[25:30,1]=0.95
        reemp_pt[30:50,1]=0.80
        reemp_pt[50:55,1]=0.65
        reemp_pt[55:60,1]=0.55
        reemp_pt[60:65,1]=0.45
        reemp_pt[65:self.max_retage,1]=0.35
        reemp_pt[self.max_retage:100,1]=0.10

        reemp_pt[0:25,2]=0.925 # miehet
        reemp_pt[25:30,2]=0.925
        reemp_pt[30:50,2]=0.85
        reemp_pt[50:55,2]=0.65
        reemp_pt[55:60,2]=0.55
        reemp_pt[60:65,2]=0.45
        reemp_pt[65:self.max_retage,2]=0.35
        reemp_pt[self.max_retage:100,2]=0.10

        reemp_pt[0:25,3]=0.75 # naiset
        reemp_pt[25:30,3]=0.80
        reemp_pt[30:50,3]=0.80
        reemp_pt[50:55,3]=0.60
        reemp_pt[55:60,3]=0.50
        reemp_pt[60:65,3]=0.35
        reemp_pt[65:self.max_retage,3]=0.30
        reemp_pt[self.max_retage:100,3]=0.10

        reemp_pt[0:25,4]=0.75 # naiset
        reemp_pt[25:30,4]=0.80
        reemp_pt[30:50,4]=0.80
        reemp_pt[50:55,4]=0.65
        reemp_pt[55:60,4]=0.60
        reemp_pt[60:65,4]=0.40
        reemp_pt[65:self.max_retage,4]=0.30
        reemp_pt[self.max_retage:100,4]=0.10

        reemp_pt[0:25,5]=0.75 # naiset
        reemp_pt[25:30,5]=0.80
        reemp_pt[30:50,5]=0.75
        reemp_pt[50:55,5]=0.65
        reemp_pt[55:60,5]=0.60
        reemp_pt[60:65,5]=0.45
        reemp_pt[65:self.max_retage,5]=0.35
        reemp_pt[self.max_retage:100,5]=0.10

        if False:
            for g in range(6):
                print(f'-------------')
                print(f'pt to ft rate ratio {g} 18-29',reemp_pt[18:30,g]/reemp_ft[18:30,g])
                print(f'pt to ft rate ratio {g} 30-39',reemp_pt[30:40,g]/reemp_ft[30:40,g])
                print(f'pt to ft rate ratio {g} 40-49',reemp_pt[40:50,g]/reemp_ft[40:50,g])
                print(f'pt to ft rate ratio {g} 50-59',reemp_pt[50:60,g]/reemp_ft[50:60,g])
                print(f'pt to ft rate ratio {g} 60-69',reemp_pt[60:70,g]/reemp_ft[60:70,g])

        # keep the ratio of probabilities
        parttime_fullemp_prob=np.minimum(1.0,reemp_ft/reemp_pt)

        prob_3m_oa=0.2       
        fulltime_pt_prob_3m=1.0
        
        return reemp_ft,reemp_pt,prob_3m_oa,parttime_fullemp_prob,fulltime_pt_prob_3m                        
    
    def get_reemp_prob_v9(self):
        '''
        reemployment probability in 3 months
        '''
        # reemployment to fulltime work
        reemp_ft=np.zeros((100,6))
        reemp_ft[0:25,0]=0.15 # miehet, suorittavia töitä löytyy hyvin nuorena, vanhempana huonommin
        reemp_ft[25:30,0]=0.20
        reemp_ft[30:50,0]=0.25
        reemp_ft[50:55,0]=0.20
        reemp_ft[55:60,0]=0.20
        reemp_ft[60:65,0]=0.10
        reemp_ft[65:self.max_retage,0]=0.15
        reemp_ft[self.max_retage:100,0]=0.05

        reemp_ft[0:25,1]=0.10 # miehet
        reemp_ft[25:30,1]=0.20
        reemp_ft[30:50,1]=0.25
        reemp_ft[50:55,1]=0.20
        reemp_ft[55:60,1]=0.20
        reemp_ft[60:65,1]=0.15
        reemp_ft[65:self.max_retage,1]=0.15
        reemp_ft[self.max_retage:100,1]=0.05

        reemp_ft[0:25,2]=0.10 # miehet
        reemp_ft[25:30,2]=0.20
        reemp_ft[30:50,2]=0.30
        reemp_ft[50:55,2]=0.25
        reemp_ft[55:60,2]=0.25
        reemp_ft[60:65,2]=0.20
        reemp_ft[65:self.max_retage,2]=0.20
        reemp_ft[self.max_retage:100,2]=0.05

        reemp_ft[0:25,3]=0.15 # naiset, suorittavia töitä löytyy hyvin nuorena, vanhempana huonommin
        reemp_ft[25:30,3]=0.15
        reemp_ft[30:50,3]=0.30
        reemp_ft[50:55,3]=0.25
        reemp_ft[55:60,3]=0.20
        reemp_ft[60:65,3]=0.15
        reemp_ft[65:self.max_retage,3]=0.10
        reemp_ft[self.max_retage:100,3]=0.025

        reemp_ft[0:25,4]=0.10 # naiset
        reemp_ft[25:30,4]=0.15
        reemp_ft[30:50,4]=0.30
        reemp_ft[50:55,4]=0.25
        reemp_ft[55:60,4]=0.20
        reemp_ft[60:65,4]=0.20
        reemp_ft[65:self.max_retage,4]=0.15
        reemp_ft[self.max_retage:100,4]=0.025

        reemp_ft[0:25,5]=0.10 # naiset
        reemp_ft[25:30,5]=0.20
        reemp_ft[30:50,5]=0.30
        reemp_ft[50:55,5]=0.25
        reemp_ft[55:60,5]=0.20
        reemp_ft[60:65,5]=0.20
        reemp_ft[65:self.max_retage,5]=0.20
        reemp_ft[self.max_retage:100,5]=0.025
        
        # reemployment to parttime work
        reemp_pt=np.zeros((100,6))
        reemp_pt[0:25,0]=0.70 # miehet
        reemp_pt[25:30,0]=0.70
        reemp_pt[30:50,0]=0.60
        reemp_pt[50:55,0]=0.50
        reemp_pt[55:60,0]=0.45
        reemp_pt[60:65,0]=0.30
        reemp_pt[65:self.max_retage,0]=0.25
        reemp_pt[self.max_retage:100,0]=0.05

        reemp_pt[0:25,1]=0.70 # miehet
        reemp_pt[25:30,1]=0.70
        reemp_pt[30:50,1]=0.60
        reemp_pt[50:55,1]=0.50
        reemp_pt[55:60,1]=0.50
        reemp_pt[60:65,1]=0.35
        reemp_pt[65:self.max_retage,1]=0.30
        reemp_pt[self.max_retage:100,1]=0.10

        reemp_pt[0:25,2]=0.70 # miehet
        reemp_pt[25:30,2]=0.70
        reemp_pt[30:50,2]=0.60
        reemp_pt[50:55,2]=0.55
        reemp_pt[55:60,2]=0.50
        reemp_pt[60:65,2]=0.40
        reemp_pt[65:self.max_retage,2]=0.30
        reemp_pt[self.max_retage:100,2]=0.10

        reemp_pt[0:25,3]=0.70 # naiset
        reemp_pt[25:30,3]=0.70
        reemp_pt[30:50,3]=0.65
        reemp_pt[50:55,3]=0.55
        reemp_pt[55:60,3]=0.50
        reemp_pt[60:65,3]=0.30
        reemp_pt[65:self.max_retage,3]=0.30
        reemp_pt[self.max_retage:100,3]=0.10

        reemp_pt[0:25,4]=0.70 # naiset
        reemp_pt[25:30,4]=0.70
        reemp_pt[30:50,4]=0.65
        reemp_pt[50:55,4]=0.55
        reemp_pt[55:60,4]=0.50
        reemp_pt[60:65,4]=0.35
        reemp_pt[65:self.max_retage,4]=0.30
        reemp_pt[self.max_retage:100,4]=0.10

        reemp_pt[0:25,5]=0.70 # naiset
        reemp_pt[25:30,5]=0.70
        reemp_pt[30:50,5]=0.65
        reemp_pt[50:55,5]=0.55
        reemp_pt[55:60,5]=0.50
        reemp_pt[60:65,5]=0.40
        reemp_pt[65:self.max_retage,5]=0.30
        reemp_pt[self.max_retage:100,5]=0.10

        if False:
            for g in range(6):
                print(f'-------------')
                print(f'pt to ft rate ratio {g} 18-29',reemp_pt[18:30,g]/reemp_ft[18:30,g])
                print(f'pt to ft rate ratio {g} 30-39',reemp_pt[30:40,g]/reemp_ft[30:40,g])
                print(f'pt to ft rate ratio {g} 40-49',reemp_pt[40:50,g]/reemp_ft[40:50,g])
                print(f'pt to ft rate ratio {g} 50-59',reemp_pt[50:60,g]/reemp_ft[50:60,g])
                print(f'pt to ft rate ratio {g} 60-69',reemp_pt[60:70,g]/reemp_ft[60:70,g])

        # keep the ratio of probabilities
        parttime_fullemp_prob=np.minimum(1.0,reemp_ft/reemp_pt)

        prob_3m_oa=0.2       
        fulltime_pt_prob_3m=0.8
        
        return reemp_ft,reemp_pt,prob_3m_oa,parttime_fullemp_prob,fulltime_pt_prob_3m       

    def get_reemp_prob_v10(self):
        '''
        reemployment probability in 3 months
        '''
        # reemployment to fulltime work
        reemp_ft=np.zeros((100,6))
        reemp_ft[0:25,0]=0.15 # miehet, suorittavia töitä löytyy hyvin nuorena, vanhempana huonommin
        reemp_ft[25:30,0]=0.20
        reemp_ft[30:50,0]=0.25
        reemp_ft[50:55,0]=0.20
        reemp_ft[55:60,0]=0.20
        reemp_ft[60:65,0]=0.10
        reemp_ft[65:self.max_retage,0]=0.15
        reemp_ft[self.max_retage:100,0]=0.05

        reemp_ft[0:25,1]=0.10 # miehet
        reemp_ft[25:30,1]=0.20
        reemp_ft[30:50,1]=0.25
        reemp_ft[50:55,1]=0.20
        reemp_ft[55:60,1]=0.20
        reemp_ft[60:65,1]=0.15
        reemp_ft[65:self.max_retage,1]=0.15
        reemp_ft[self.max_retage:100,1]=0.05

        reemp_ft[0:25,2]=0.10 # miehet
        reemp_ft[25:30,2]=0.20
        reemp_ft[30:50,2]=0.30
        reemp_ft[50:55,2]=0.25
        reemp_ft[55:60,2]=0.25
        reemp_ft[60:65,2]=0.20
        reemp_ft[65:self.max_retage,2]=0.20
        reemp_ft[self.max_retage:100,2]=0.05

        reemp_ft[0:25,3]=0.15 # naiset, suorittavia töitä löytyy hyvin nuorena, vanhempana huonommin
        reemp_ft[25:30,3]=0.15
        reemp_ft[30:50,3]=0.30
        reemp_ft[50:55,3]=0.25
        reemp_ft[55:60,3]=0.20
        reemp_ft[60:65,3]=0.15
        reemp_ft[65:self.max_retage,3]=0.10
        reemp_ft[self.max_retage:100,3]=0.025

        reemp_ft[0:25,4]=0.10 # naiset
        reemp_ft[25:30,4]=0.15
        reemp_ft[30:50,4]=0.30
        reemp_ft[50:55,4]=0.25
        reemp_ft[55:60,4]=0.20
        reemp_ft[60:65,4]=0.20
        reemp_ft[65:self.max_retage,4]=0.15
        reemp_ft[self.max_retage:100,4]=0.025

        reemp_ft[0:25,5]=0.10 # naiset
        reemp_ft[25:30,5]=0.20
        reemp_ft[30:50,5]=0.30
        reemp_ft[50:55,5]=0.25
        reemp_ft[55:60,5]=0.20
        reemp_ft[60:65,5]=0.20
        reemp_ft[65:self.max_retage,5]=0.20
        reemp_ft[self.max_retage:100,5]=0.025
        
        # reemployment to parttime work
        reemp_pt=np.zeros((100,6))
        reemp_pt[0:25,0]=0.70 # miehet
        reemp_pt[25:30,0]=0.70
        reemp_pt[30:50,0]=0.60
        reemp_pt[50:55,0]=0.50
        reemp_pt[55:60,0]=0.45
        reemp_pt[60:65,0]=0.30
        reemp_pt[65:self.max_retage,0]=0.25
        reemp_pt[self.max_retage:100,0]=0.05

        reemp_pt[0:25,1]=0.70 # miehet
        reemp_pt[25:30,1]=0.70
        reemp_pt[30:50,1]=0.60
        reemp_pt[50:55,1]=0.50
        reemp_pt[55:60,1]=0.50
        reemp_pt[60:65,1]=0.35
        reemp_pt[65:self.max_retage,1]=0.30
        reemp_pt[self.max_retage:100,1]=0.10

        reemp_pt[0:25,2]=0.70 # miehet
        reemp_pt[25:30,2]=0.70
        reemp_pt[30:50,2]=0.60
        reemp_pt[50:55,2]=0.55
        reemp_pt[55:60,2]=0.50
        reemp_pt[60:65,2]=0.40
        reemp_pt[65:self.max_retage,2]=0.30
        reemp_pt[self.max_retage:100,2]=0.10

        reemp_pt[0:25,3]=0.70 # naiset
        reemp_pt[25:30,3]=0.70
        reemp_pt[30:50,3]=0.65
        reemp_pt[50:55,3]=0.55
        reemp_pt[55:60,3]=0.50
        reemp_pt[60:65,3]=0.30
        reemp_pt[65:self.max_retage,3]=0.30
        reemp_pt[self.max_retage:100,3]=0.10

        reemp_pt[0:25,4]=0.70 # naiset
        reemp_pt[25:30,4]=0.70
        reemp_pt[30:50,4]=0.65
        reemp_pt[50:55,4]=0.55
        reemp_pt[55:60,4]=0.50
        reemp_pt[60:65,4]=0.35
        reemp_pt[65:self.max_retage,4]=0.30
        reemp_pt[self.max_retage:100,4]=0.10

        reemp_pt[0:25,5]=0.70 # naiset
        reemp_pt[25:30,5]=0.70
        reemp_pt[30:50,5]=0.65
        reemp_pt[50:55,5]=0.55
        reemp_pt[55:60,5]=0.50
        reemp_pt[60:65,5]=0.40
        reemp_pt[65:self.max_retage,5]=0.30
        reemp_pt[self.max_retage:100,5]=0.10

        if False:
            for g in range(6):
                print(f'-------------')
                print(f'pt to ft rate ratio {g} 18-29',reemp_pt[18:30,g]/reemp_ft[18:30,g])
                print(f'pt to ft rate ratio {g} 30-39',reemp_pt[30:40,g]/reemp_ft[30:40,g])
                print(f'pt to ft rate ratio {g} 40-49',reemp_pt[40:50,g]/reemp_ft[40:50,g])
                print(f'pt to ft rate ratio {g} 50-59',reemp_pt[50:60,g]/reemp_ft[50:60,g])
                print(f'pt to ft rate ratio {g} 60-69',reemp_pt[60:70,g]/reemp_ft[60:70,g])

        # keep the ratio of probabilities
        parttime_fullemp_prob=np.minimum(1.0,reemp_ft/reemp_pt)

        prob_3m_oa=0.2       
        fulltime_pt_prob_3m=0.8
        
        return reemp_ft,reemp_pt,prob_3m_oa,parttime_fullemp_prob,fulltime_pt_prob_3m             
        
    def get_tyelpremium(self):
        tyel_kokomaksu=np.zeros((2100,5))
        # data
        tyel_kokomaksu[1962:2022]=[5.0,5.0,5.0,5.0,5.0,5.0,5.0,5.15,5.15,5.65,6.1,6.4,6.9,7.9,9.9,12.0,10.0,11.7,13.3,13.3,12.4,11.1,11.1,11.5,12.2,13.0,13.8,14.9,16.9,16.9,14.4,18.5,18.6,20.6,21.1,21.2,21.5,21.5,21.5,21.1,21.1,21.4,21.4,21.6,21.2,21.1,21.1,21.3,21.6,22.1,22.8,22.8,23.6,24.0,24.0,24.4,24.4,24.4,24.4,24.4,24.4]
        # ETK
        tyel_kokomaksu[2023:2085]=np.array([24.4,24.5,24.5,24.6,24.6,24.7,24.8,24.8,24.9,24.9,25.0,24.9,24.9,24.9,24.9,24.8,24.8,24.7,24.7,24.6,24.6,24.6,24.6,24.6,24.7,24.8,24.8,24.9,25.1,25.2,25.4,25.6,25.8,26.0,26.2,26.5,26.7,27.0,27.2,27.5,27.7,27.9,28.1,28.3,28.5,28.7,28.9,29.1,29.2,29.4,29.5,29.7,29.8,29.9,30.1,30.2,30.3,30.3,30.4,30.4,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5,30.5])/100
        ptel=0.5*(tyel_kokomaksu-tyel_kokomaksu[0])+0.0615 # vuonna 2017 ptel oli 6,15 %
        
        return tyel_kokomaksu
        
    def initial_wealth(self,g):
        # kotitalouksien varallisuus
        # / StatFin / Tulot ja kulutus / Kotitalouksien varallisuus / 136l -- Kotitalouksien varat, velat ja tulot viitehenkilön ikäryhmän mukaan, 1987-2019
        # vuodelta 2019
        varat=[-4_257,1_979,17_031,-4_257,1_979,17_031]/2
        std=[4_000,4_000,10_000,4_000,4_000,10_000]/2
        r=std*random.randn(1)+varat[g]
        
        return r
    
    def get_initial_state_weights_v9(self):
        wgr = self.get_group_weights()
        weight = self.get_initial_weights_v9()
        sweight = np.zeros((7,1))
        for k in range(0,7):
            sweight[k,0] = np,sum(weight[k,0:4] * wgr[0:4])
            sweight[k,1] = np,sum(weight[k,4:7] * wgr[4:7])
        
        stateweight = np.zeros((16,1))
        stateweight[13] = sweight[0]
        stateweight[0] = sweight[1]
        stateweight[1] = sweight[2]
        stateweight[10] = sweight[3]
        stateweight[3] = sweight[4]
        stateweight[11] = sweight[5]
        stateweight[12] = sweight[6]

        return stateweight
    
    def get_initial_weights_v9(self):
        '''
        Alkuarvot tilalle 18-vuotiaana
        '''

        initial_weight=np.zeros((6,7))
        if self.year==2018:
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille

            # työttömät miehet, osuus väestästä
            m_tyoton=0.019
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.01609
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om=0.2565  # miehet töissä + opiskelija
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.3443
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.029
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop=0.025
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md=0.008
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.00730
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # opiskelijat+työlliset+muut työvoiman ulkop+työttömät, miehet
            ym=0.686+om+m_tyovoimanulkop+m_tyoton # miehet töissä + opiskelija
            # opiskelijat+työlliset+muut työvoiman ulkop+työttömät, naiset
            yw=0.6076+ow+w_tyovoimanulkop+w_tyoton

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2019: #
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            m_tyoton=0.02133
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.0165347
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om=0.2606  # miehet töissä + opiskelija
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.3633
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.0301
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)

            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop=0.02661
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md=0.01031
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.007156
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2020: #
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            m_tyoton=0.02399
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.02051
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om=0.2053
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.2732
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.03278
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop=0.02433
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md=0.00982
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.00685
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2021:
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            # työttömät miehet, osuus väestästä
            m_tyoton=0.018869
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.0160433
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om= 0.28022   # miehet töissä
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.3858752
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.034
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop= 0.0290785
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md = 0.0057823
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd = 0.009292
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2022:
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille

            # työttömät miehet, osuus väestästä
            m_tyoton = 0.018869
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton = 0.0160433
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om = 0.28022   # miehet töissä
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow = 0.3858752
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop = 0.0344
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop = 0.0290785
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md = 0.009292
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd = 0.0057823
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2023: # 31.1.2025
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            m_tyoton=0.03070
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.0160433
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om= 0.26026   # miehet töissä
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.364
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.038
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop= 0.0285
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md= 0.009292
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.0057823
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2024: # PÄIVITÄ
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            # työttömät miehet, osuus väestästä
            m_tyoton=0.03070
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.0194
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om= 0.26026   # miehet töissä
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.364
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.038
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop= 0.0285
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md= 0.009292
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.0057823
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2025: # PÄIVITÄ
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            m_tyoton=0.03070
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.0194
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om= 0.26026   # miehet töissä
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.364
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.038
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop= 0.0285
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md= 0.009292
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.0057823
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2026: # PÄIVITÄ
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            m_tyoton=0.03070
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.0194
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om= 0.26026   # miehet töissä
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.364
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.038
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop= 0.0285
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md= 0.009292
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.0057823
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        else:
            print('Unsupported year',self.year)
            error(999)

        for k in range(6):
            scale=np.sum(initial_weight[k,:])
            initial_weight[k,:] /= scale

        return initial_weight    
    
        
    def get_initial_weights_v10(self):
        '''
        Alkuarvot tilalle 18-vuotiaana
        '''

        initial_weight=np.zeros((6,7))
        if self.year==2018:
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille

            # työttömät miehet, osuus väestästä
            m_tyoton=0.019
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.01609
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om=0.2565  # miehet töissä + opiskelija
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.3443
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.029
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop=0.025
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md=0.008
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.00730
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # opiskelijat+työlliset+muut työvoiman ulkop+työttömät, miehet
            ym=0.686+om+m_tyovoimanulkop+m_tyoton # miehet töissä + opiskelija
            # opiskelijat+työlliset+muut työvoiman ulkop+työttömät, naiset
            yw=0.6076+ow+w_tyovoimanulkop+w_tyoton

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2019: #
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            m_tyoton=0.02133
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.0165347
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om=0.2606  # miehet töissä + opiskelija
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.3633
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.0301
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)

            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop=0.02661
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md=0.01031
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.007156
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2020: #
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            m_tyoton=0.02399
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.02051
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om=0.2053
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.2732
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.03278
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop=0.02433
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md=0.00982
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.00685
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2021:
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            # työttömät miehet, osuus väestästä
            m_tyoton=0.018869
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.0160433
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om= 0.28022   # miehet töissä
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.3858752
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.034
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop= 0.0290785
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md = 0.0057823
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd = 0.009292
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2022:
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille

            # työttömät miehet, osuus väestästä
            m_tyoton = 0.018869
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton = 0.0160433
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om = 0.28022   # miehet töissä
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow = 0.3858752
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop = 0.0344
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop = 0.0290785
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md = 0.009292
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd = 0.0057823
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2023: # 31.1.2025
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            m_tyoton=0.03070
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.0160433
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om= 0.26026   # miehet töissä
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.364
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.038
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop= 0.0285
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md= 0.009292
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.0057823
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2024: # PÄIVITÄ
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            # työttömät miehet, osuus väestästä
            m_tyoton=0.03070
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.0194
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om= 0.26026   # miehet töissä
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.364
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.038
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop= 0.0285
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md= 0.009292
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.0057823
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2025: # PÄIVITÄ
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            m_tyoton=0.03070
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.0194
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om= 0.26026   # miehet töissä
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.364
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.038
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop= 0.0285
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md= 0.009292
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.0057823
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        elif self.year==2026: # PÄIVITÄ
            # tilat [13,0,1,10,3,11,12] siis [tmtuki,ansiosidonnainen,kokoaikatyö,osaaikatyö,työvoimanulkopuolella,opiskelija]
            # lasketaan painotetut kertoimet eri tulotasoille
            # työttömät miehet, osuus väestästä
            m_tyoton=0.03070
            m1,m2,m3 = self.get_wees(0,1.27,1.0,m_tyoton)
            # työttömät naiset, osuus väestästä
            w_tyoton=0.0194
            w1,w2,w3 = self.get_wees(1,1.2,1.0,w_tyoton)

            # työlliset, miehet
            om= 0.26026   # miehet töissä
            om1,om2,om3 = self.get_wees(0,1.25,1.0,om)
            # työlliset, naiset
            ow=0.364
            ow1,ow2,ow3 = self.get_wees(1,1.2,1.0,ow)

            # työvoiman ulkopuolella, miehet
            m_tyovoimanulkop=0.038
            um1,um2,um3 = self.get_wees(0,1.3,1.0,m_tyovoimanulkop)
            # työvoiman ulkopuolella, naiset
            w_tyovoimanulkop= 0.0285
            uw1,uw2,uw3 = self.get_wees(1,1.2,1.0,w_tyovoimanulkop)

            # työkyvyttömät, miehet
            md= 0.009292
            md1,md2,md3 = self.get_wees(0,1.3,1.0,md)
            # työkyvyttömät, naiset
            wd=0.0057823
            wd1,wd2,wd3 = self.get_wees(1,1.2,1.0,wd)

            # 13,0,1,10,3,11,12
            initial_weight[0,:] = [m1*4/5,m1*1/5,0.68*om1,0.32*om1,md1,um1,1-om1-um1-m1-md1]
            initial_weight[1,:] = [m2*4/5,m2*1/5,0.68*om2,0.32*om2,md2,um2,1-om2-um2-m2-md2]
            initial_weight[2,:] = [m3*4/5,m3*1/5,0.68*om3,0.32*om3,md3,um3,1-om3-um3-m3-md3]
            initial_weight[3,:] = [w1*4/5,w1*1/5,0.44*ow1,0.56*ow1,wd1,uw1,1-ow1-uw1-w1-wd1]
            initial_weight[4,:] = [w2*4/5,w2*1/5,0.44*ow2,0.56*ow2,wd2,uw2,1-ow2-uw2-w2-wd2]
            initial_weight[5,:] = [w3*4/5,w3*1/5,0.44*ow3,0.56*ow3,wd3,uw3,1-ow3-uw3-w3-wd3]
        else:
            print('Unsupported year',self.year)
            error(999)

        for k in range(6):
            scale=np.sum(initial_weight[k,:])
            initial_weight[k,:] /= scale

        return initial_weight    